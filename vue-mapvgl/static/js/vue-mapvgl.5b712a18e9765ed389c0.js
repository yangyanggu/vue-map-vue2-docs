!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("VueMapvgl",[],e):"object"==typeof exports?exports.VueMapvgl=e():t.VueMapvgl=e()}(window,function(){return function(p){function t(t){for(var e,n,i=t[0],o=t[1],a=t[2],r=0,s=[];r<i.length;r++)n=i[r],Object.prototype.hasOwnProperty.call(h,n)&&h[n]&&s.push(h[n][0]),h[n]=0;for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&(p[e]=o[e]);for(c&&c(t);s.length;)s.shift()();return u.push.apply(u,a||[]),l()}function l(){for(var t,e=0;e<u.length;e++){for(var n=u[e],i=!0,o=1;o<n.length;o++){var a=n[o];0!==h[a]&&(i=!1)}i&&(u.splice(e--,1),t=r(r.s=n[0]))}return t}var n={},h={1:0},u=[];function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return p[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=p,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="./";var e=(i=window.webpackJsonpVueMapvgl=window.webpackJsonpVueMapvgl||[]).push.bind(i);i.push=t;for(var i=i.slice(),o=0;o<i.length;o++)t(i[o]);var c=e;return u.push([49,0]),l()}({49:function(t,e,n){t.exports=n(53)},53:function(t,e,n){"use strict";n.r(e),n.d(e,"effect",function(){return Qt}),n.d(e,"util",function(){return te}),n.d(e,"mapvgl",function(){return Jt}),n.d(e,"mapvglThree",function(){return Xt}),n.d(e,"THREE",function(){return Kt});var i=n(45),o=n.n(i);var a={};function r(){!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this._listener=new Map}var s=new(r.prototype.addListener=function(t,e,n){if(!BMapGL)throw new Error("please wait for Map API load");t.on&&(t.on(e,n),this._listener.get(t)||this._listener.set(t,{}),(t=this._listener.get(t))[e]||(t[e]=[]),t[e].push(n))},r.prototype.removeListener=function(e,t,n){if(!BMapGL)throw new Error("please wait for Map API load");var i;this._listener.get(e)&&this._listener.get(e)[t]&&e.off&&(i=this._listener.get(e)[t],n?(n=i.indexOf(n),e.off(i[n]),i.splice(n,1)):(i.forEach(function(t){e.off(t)}),this._listener.get(e)[t]=[]))},r.prototype.addListenerOnce=function(t,e,n,i){return t.on(e,n,i,!0)},r.prototype.trigger=function(t,e,n){return t.emit(e,n)},r.prototype.clearListeners=function(e){var t=this._listener.get(e);t&&Object.keys(t).map(function(t){e.removeEventListener(t)})},r),p="BMAP_READY_EVENT",u="MAPV_READY_EVENT",l={props:{visible:{type:Boolean,default:!0},zoomThreshold:{type:Array,default:function(){return[0,30]}},renderOrder:{type:Number},lazy:{type:Number,default:-1}},data:function(){var e=this;return{lazyTimer:null,unwatchFns:[],handlers:{visible:function(t){e.$options.name&&e.$options.name.endsWith("layer")&&e.$view&&e.$view.showLayer&&(t?e.$view.showLayer(e.$bmapComponent):e.$view.hideLayer(e.$bmapComponent))}}}},mounted:function(){var e=this;this.$view=this.$view||this.$parent.$view,this.$view?this.lazyRegister():this.$on(u,function(t){e.$view=t,e.lazyRegister()})},destroyed:function(){this.lazyTimer&&clearTimeout(this.lazyTimer),this.unregisterEvents(),this.$bmapComponent&&(this.unwatchFns.forEach(function(t){return t()}),this.unwatchFns=[])},methods:{getHandlerFun:function(t){if(this.handlers&&this.handlers[t])return this.handlers[t]},convertProps:function(){var o=this,a={};this.$view&&(a.view=this.$view);var t=this.$options.propsData,r=void 0===t?{}:t,s=this.propsRedirect;return Object.keys(r).reduce(function(t,e){var n=e,i=o.convertSignalProp(n,r[n]);return void 0===i||(s&&s[e]&&(n=s[n]),a[n]=i),t},a)},convertSignalProp:function(t,e){if("",this.converters&&this.converters[t])return this.converters[t].call(this,e);t=a[t];return t?t(e):e},registerEvents:function(){if(this.setEditorEvents&&this.setEditorEvents(),this.$options.propsData){if(this.$options.propsData.events)for(var t in this.events)s.addListener(this.$bmapComponent,t,this.events[t]);if(this.$options.propsData.onceEvents)for(var e in this.onceEvents)s.addListenerOnce(this.$bmapComponent,e,this.onceEvents[e])}},unregisterEvents:function(){s.clearListeners(this.$bmapComponent)},setPropWatchers:function(){var a=this,e=this.propsRedirect,t=this.$options.propsData,t=void 0===t?{}:t;Object.keys(t).forEach(function(n){var i=n;e&&e[n]&&(i=e[n]);var t,o=a.getHandlerFun(i);!o&&"events"!==n||(t=a.$watch(n,function(t){if("events"!==n){var e;if(o&&o===a.$bmapComponent.setOptions)return o.call(a.$bmapComponent,((e={})[i]=a.convertSignalProp(n,t),e));o.call(a.$bmapComponent,a.convertSignalProp(n,t))}},{deep:!0}),a.unwatchFns.push(t))})},initProps:function(){var n=this;[].forEach(function(t){var e;void 0===n[t]||(e=n.getHandlerFun(t))&&e.call(n.$bmapComponent,n.convertSignalProp(t,n[t]))})},printReactiveProp:function(){var e=this;Object.keys(this._props).forEach(function(t){e.$bmapComponent["set"+o()(t)]&&console.log(t)})},lazyRegister:function(){var t=this;this.lazy<0?this.register():this.lazyTimer=setTimeout(function(){t.register()},this.lazy)},register:function(){var t=this.convertProps(),e=this.__initComponent&&this.__initComponent(t);this.registerRest(e),!1===t.visible&&this.handlers.visible&&this.handlers.visible.call(this.$bmapComponent,!1)},registerRest:function(t){!this.$bmapComponent&&t&&(this.$bmapComponent=t),this.registerEvents(),this.initProps(),this.setPropWatchers(),this.events&&this.events.init&&this.events.init(this.$bmapComponent,this.$view,this.bmapManager||this.$parent.bmapManager)},$$getInstance:function(){return this.$bmapComponent}}},h=n(2),c={name:"el-bmapv-view",mixins:[l],props:{vid:{type:String},mapType:{validator:function(t){return-1!==["bmap","blank","cesium","three"].indexOf(t)||!t}},effects:{type:Array},visible:{type:Boolean},events:{type:Object}},computed:{},data:function(){return{converters:{},handlers:{visible:function(t){!0===t?this.show():this.hide()}}}},mounted:function(){var e=this;this.$on(p,function(t){e.lazy<0?e.createView(t):setTimeout(function(){e.createView(t)},e.lazy)})},methods:{createView:function(t){var e,n=this;t&&((e=this.convertProps()).map=t,this.$bmapComponent=this.$view=new h.View(e),this.events&&this.events.init&&this.events.init(this.$bmapComponent),this.$children.forEach(function(t){t.$emit(u,n.$bmapComponent)}))}},destroyed:function(){this.$bmapComponent&&(this.$bmapComponent.removeAllLayers(),this.$bmapComponent.destroy(),this.$bmapComponent=this.$view=null)}},m=n(1),d=Object(m.a)(c,function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default")],2)},[],!1,null,null,null).exports,f=["enablePicked","selectedIndex","selectedColor","autoSelect","onClick","onDblClick","onRightClick","onMousemove"],v={},b={$$pick:function(t,e){return this.$bmapComponent.pick(t,e)}},y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},g=n(2),w={name:"el-bmapv-point-layer",mixins:[l],props:["color","shape","size","unit","borderWidth","borderColor","blend","data"].concat(f),data:function(){return{converters:{},handlers:y({color:function(t){this.setOptions({color:t})},shape:function(t){this.setOptions({shape:t})},size:function(t){this.setOptions({size:t})},borderWidth:function(t){this.setOptions({borderWidth:t})},borderColor:function(t){this.setOptions({borderColor:t})},blend:function(t){this.setOptions({blend:t})},data:function(t){this.setData(t)}},v)}},created:function(){},methods:y({__initComponent:function(t){this.$bmapComponent=new g.PointLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},$=Object(m.a)(w,void 0,void 0,!1,null,null,null).exports,C=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},L=n(2),O={name:"el-bmapv-icon-layer",mixins:[l],props:["icon","width","height","unit","scale","angle","flat","offset","padding","data"].concat(f),data:function(){return{converters:{},handlers:C({data:function(t){this.setData(t)}},v)}},created:function(){},methods:C({__initComponent:function(t){this.$bmapComponent=new L.IconLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},x=Object(m.a)(O,void 0,void 0,!1,null,null,null).exports,j=n(2),z={name:"el-bmapv-point-trip-layer",mixins:[l],props:["color","startTime","endTime","step","trailLength","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new j.PointTripLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},T=Object(m.a)(z,void 0,void 0,!1,null,null,null).exports,_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},E=n(2),M={name:"el-bmapv-heat-point-layer",mixins:[l],props:["effect","girdSize","gradient","max","min","data"].concat(f),data:function(){return{propsRedirect:{effect:"style"},converters:{},handlers:_({data:function(t){this.setData(t)}},v)}},created:function(){},methods:_({__initComponent:function(t){this.$bmapComponent=new E.HeatPointLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},P=Object(m.a)(M,void 0,void 0,!1,null,null,null).exports,A=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},D=n(2),k={name:"el-bmapv-heat-map-layer",mixins:[l],props:["size","gradient","max","min","unit","height","data"].concat(f),data:function(){return{converters:{},handlers:A({data:function(t){this.setData(t)}},v)}},created:function(){},methods:A({__initComponent:function(t){this.$bmapComponent=new D.HeatmapLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},G=Object(m.a)(k,void 0,void 0,!1,null,null,null).exports,W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},R=n(2),S={name:"el-bmapv-heat-grid-layer",mixins:[l],props:["effect","girdSize","gradient","max","min","maxHeight","minHeight","data"].concat(f),data:function(){return{propsRedirect:{effect:"style"},converters:{},handlers:W({data:function(t){this.setData(t)}},v)}},created:function(){},methods:W({__initComponent:function(t){this.$bmapComponent=new R.HeatGridLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},F=Object(m.a)(S,void 0,void 0,!1,null,null,null).exports,V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},H=n(2),U={name:"el-bmapv-spark-layer",mixins:[l],props:["color","height","step","startTime","endTime","data"].concat(f),data:function(){return{converters:{},handlers:V({data:function(t){this.setData(t)}},v)}},created:function(){},methods:V({__initComponent:function(t){this.$bmapComponent=new H.SparkLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},B=Object(m.a)(U,void 0,void 0,!1,null,null,null).exports,I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Z=n(2),q={name:"el-bmapv-circle-layer",mixins:[l],props:["type","color","size","unit","radius","duration","trial","random","data"].concat(f),data:function(){return{converters:{},handlers:I({data:function(t){this.setData(t)}},v)}},created:function(){},methods:I({__initComponent:function(t){this.$bmapComponent=new Z.CircleLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},N=Object(m.a)(q,void 0,void 0,!1,null,null,null).exports,Y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},J=n(2),X={name:"el-bmapv-ripple-layer",mixins:[l],props:["color","size","unit","duration","data"].concat(f),data:function(){return{converters:{},handlers:Y({data:function(t){this.setData(t)}},v)}},created:function(){},methods:Y({__initComponent:function(t){this.$bmapComponent=new J.RippleLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},K=Object(m.a)(X,void 0,void 0,!1,null,null,null).exports,Q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},tt=n(2),et={name:"el-bmapv-text-layer",mixins:[l],props:["fontFamily","color","fontSize","unit","angle","flat","collides","offset","padding","margin","data"].concat(f),data:function(){return{converters:{offset:function(t){return t}},handlers:Q({data:function(t){this.setData(t)}},v)}},created:function(){},methods:Q({__initComponent:function(t){console.log("text layer options: ",t),this.$bmapComponent=new tt.TextLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},nt=Object(m.a)(et,void 0,void 0,!1,null,null,null).exports,it=n(19),ot={name:"el-bmapv-fan-layer",mixins:[l],props:["color","size","unit","step","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new it.FanLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},at=Object(m.a)(ot,void 0,void 0,!1,null,null,null).exports,rt=n(2),st={name:"el-bmapv-simple-line-layer",mixins:[l],props:["color","blend","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new rt.SimpleLineLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},pt=Object(m.a)(st,void 0,void 0,!1,null,null,null).exports,lt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},ht=n(2),ut={name:"el-bmapv-line-layer",mixins:[l],props:["color","blend","width","unit","dashArray","dashOffset","lineCap","lineJoin","miterLimit","antialias","offset","animation","interval","duration","trailLength","minZoom","maxZoom","mapStyle","styleOptions","data"].concat(f),data:function(){return{propsRedirect:{mapStyle:"style"},converters:{},handlers:lt({dashOffset:function(t){this.setOptions({dashOffset:t})},data:function(t){this.setData(t)}},v)}},created:function(){},methods:lt({__initComponent:function(t){this.$bmapComponent=new ht.LineLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},i=Object(m.a)(ut,void 0,void 0,!1,null,null,null).exports,ct=n(2),c={name:"el-bmapv-wall-layer",mixins:[l],props:["color","gradient","height","texture","enablePreciseMap","repeatMap","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new ct.WallLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},w=Object(m.a)(c,void 0,void 0,!1,null,null,null).exports,mt=n(2),O={name:"el-bmapv-heat-line-layer",mixins:[l],props:["gradient","max","min","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new mt.HeatLineLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},z=Object(m.a)(O,void 0,void 0,!1,null,null,null).exports,dt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},ft=n(2),M={name:"el-bmapv-line-flow-layer",mixins:[l],props:["color","blend","width","interval","duration","trailLength","minZoom","maxZoom","data"].concat(f),data:function(){return{propsRedirect:{},converters:{},handlers:dt({data:function(t){this.setData(t)}},v)}},created:function(){},methods:dt({__initComponent:function(t){this.$bmapComponent=new ft.LineFlowLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},k=Object(m.a)(M,void 0,void 0,!1,null,null,null).exports,vt=n(2),S={name:"el-bmapv-line-trip-layer",mixins:[l],props:["color","startTime","endTime","step","trailLength","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new vt.LineTripLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},U=Object(m.a)(S,void 0,void 0,!1,null,null,null).exports,bt=n(2),q={name:"el-bmapv-wall-trip-layer",mixins:[l],props:["color","gradient","height","startTime","endTime","step","trailLength","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new bt.WallTripLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},X=Object(m.a)(q,void 0,void 0,!1,null,null,null).exports,yt=n(19),et={name:"el-bmapv-fly-line-layer",mixins:[l],props:["effect","color","textureColor","textureWidth","textureLength","step","data"],data:function(){return{propsRedirect:{effect:"style"},converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new yt.FlyLineLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},ot=Object(m.a)(et,void 0,void 0,!1,null,null,null).exports,gt=n(55),wt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},$t=n(2),st={name:"el-bmapv-shape-layer",mixins:[l],props:["color","opacity","texture","isTextureFull","textureScale","topColor","blend","riseTime","effect","rippleLayer","data","animationDuration","animationElevation"].concat(f),data:function(){var e=this;return{propsRedirect:{effect:"style"},converters:{},handlers:wt({data:function(t){this.setData(t),e.startAnimation()},animationDuration:function(){e.startAnimation()}},v),animateData:[]}},created:function(){},methods:wt({__initComponent:function(t){this.$bmapComponent=new $t.ShapeLayer(t),this.$view.addLayer(this.$bmapComponent),"ripple"===t.style&&t.rippleLayer&&this.$view.addLayer(t.rippleLayer)},startAnimation:function(){this.animationDuration&&("number"==typeof this.animationDuration?(this.animateData=Object(gt.a)(this.data),this.checkElevation()):console.error("animationDuration必须是number型数据"))},animation:function(){this.animationDuration&&(this.moveElevation(),window.requestAnimationFrame(this.animation))},checkElevation:function(){},moveElevation:function(){}},b),destroyed:function(){this.$bmapComponent&&this.$view&&this.$view.removeLayer(this.$bmapComponent),this.rippleLayer&&this.$view.removeLayer(this.rippleLayer),this.$bmapComponent=null,this.$view=null},render:function(){return null}},ut=Object(m.a)(st,void 0,void 0,!1,null,null,null).exports,Ct=n(2),c={name:"el-bmapv-shape-line-layer",mixins:[l],props:["color","data"],data:function(){return{propsRedirect:{effect:"style"},converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new Ct.ShapeLineLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},O=Object(m.a)(c,void 0,void 0,!1,null,null,null).exports,Lt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Ot=n(2),M={name:"el-bmapv-polygon-layer",mixins:[l],props:["lineColor","lineWidth","lineJoin","dashArray","fillColor","fillOpacity","data"].concat(f),data:function(){return{propsRedirect:{},converters:{},handlers:Lt({data:function(t){this.setData(t)}},v)}},created:function(){},methods:Lt({__initComponent:function(t){this.$bmapComponent=new Ot.PolygonLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},S=Object(m.a)(M,void 0,void 0,!1,null,null,null).exports,xt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},jt=n(2),q={name:"el-bmapv-cluster-layer",mixins:[l],props:["minSize","maxSize","clusterRadius","showText","maxZoom","minZoom","gradient","textOptions","iconOptions","data","beforeRender"].concat(f),data:function(){return{converters:{},handlers:xt({data:function(t){this.setData(t)}},v)}},created:function(){},methods:xt({__initComponent:function(t){this.$bmapComponent=new jt.ClusterLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},et=Object(m.a)(q,void 0,void 0,!1,null,null,null).exports,zt=n(2),st={name:"el-bmapv-honeycomb-layer",mixins:[l],props:["size","height","enableCluster","showText","maxZoom","minZoom","gradient","textOptions","data"],data:function(){return{propsRedirect:{},converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new zt.HoneycombLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},c=Object(m.a)(st,void 0,void 0,!1,null,null,null).exports,Tt=n(2),M={name:"el-bmapv-gltf-layer",mixins:[l],props:["url","scale","unit","data","enablePicked","onClick"],data:function(){return{propsRedirect:{},converters:{},handlers:{data:function(t){this.setData(t,{autoRender:!0})}}}},created:function(){},methods:{__initComponent:function(t){this.$bmapComponent=new Tt.GltfLayer(t),this.$view.addLayer(this.$bmapComponent),t.data&&0<t.data.length&&this.$bmapComponent.setData(t.data,{autoRender:!0})}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},q=Object(m.a)(M,void 0,void 0,!1,null,null,null).exports,_t=n(42),Et=n(56),Mt=n(14),Pt=n(47),At=n(48),Dt=n(19).THREE,kt={AmbientLight:Dt.AmbientLight,DirectionalLight:Dt.DirectionalLight,HemisphereLight:Dt.HemisphereLight,PointLight:Dt.PointLight,RectAreaLight:Dt.RectAreaLight,SpotLight:Dt.SpotLight};function Gt(t,e){var n=e.envMap;n&&(t.material&&n&&(t.material.envMap=n,t.material.needsUpdate=!0),t.children&&0<t.children.length&&t.children.forEach(function(t){Gt(t,e)}))}var Wt=n(0);var Rt=n(19).THREE,St=["loaded","click","mouseover","mouseout"],Ft={AmbientLight:Rt.AmbientLight,DirectionalLight:Rt.DirectionalLight,HemisphereLight:Rt.HemisphereLight,PointLight:Rt.PointLight,RectAreaLight:Rt.RectAreaLight,SpotLight:Rt.SpotLight};function Vt(t){var e=this.getDefaultOptions();this.options=Object(Et.a)(e,t),this.init()}function Ht(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0]}Vt.prototype.getDefaultOptions=function(){return{autoScale:!0,scale:1,move:{smooth:!1,duration:200},rotate:{x:0,y:0,z:0},translate:{x:0,y:0,z:0},up:{x:0,y:1,z:0},light:[],animation:{type:"none",unit:"px",options:{offset:{x:0,y:0,z:20},duration:2e3,delay:0}},userData:null,track:{focus:!1,autoRotate:!0,tilt:45,offsetHeading:0,zoom:0},tooltip:{offset:{x:0,y:-20},isCustom:!1,content:""},infoWindow:{visible:!1,offset:{x:0,y:-20},anchor:"bottom",content:""}}},Vt.prototype.init=function(){this.initLayer(),this.events=new Map,this.loadModel()},Vt.prototype.initLayer=function(){this.threeLayer=this.options.view},Vt.prototype.loadModel=function(){var t,e=this,n=this.options.url;window.VueMapvglGltfCache||(window.VueMapvglGltfCache={}),!1!==window.VueMapvglGltfCache[n]?(void 0===window.VueMapvglGltfCache[n]&&(window.VueMapvglGltfCache[n]=!1),"gltf"===(t=(t=n.split("?")[0]).substring(t.lastIndexOf(".")+1,t.length))||"glb"===t?this.loadGltf(n):"json"===t&&this.loadObject(n)):setTimeout(function(){e.loadModel()},20)},Vt.prototype.loadGltf=function(n){var t,e,i=this;!1===window.VueMapvglGltfCache[n]?(new Pt.a).load(n,function(t){var e=(window.VueMapvglGltfCache[n]=t).scene;i.addObject3D(e,t.animations)}):(e=(t=window.VueMapvglGltfCache[n]).scene,this.addObject3D(e,t.animations))},Vt.prototype.loadObject=function(e){var n=this;!1===window.VueMapvglGltfCache[e]?(new Rt.ObjectLoader).load(e,function(t){window.VueMapvglGltfCache[e]=t,n.addObject3D(t)}):this.addObject3D(window.VueMapvglGltfCache[e])},Vt.prototype.addObject3D=function(t,e){var n=t.clone(!0),i=this.options,o=i.data,a=o.geometry.coordinates,r=o.angle,s=i.autoScale,p=i.scale,l=i.rotate,t=i.translate,o=i.up,r=void 0!==r?Math.PI/180*r:l.z;n.scale.set(p,p,p),n.translateX(t.x),n.translateY(t.y),n.translateZ(t.z),n.lookAt(o.x,o.y,o.z);a=this.convertPosition(a),a=new BMapGL.Point(a[0],a[1]);if(this.point=a,s?this.group=this.add(n,a):(this.threeLayer.add(n,a),a=this.threeLayer.getWorld().children,this.group=a[a.length-1]),e){for(var h=new Rt.AnimationMixer(n),u={},c=0;c<e.length;c++){var m=e[c];u[m.name]=h.clipAction(m)}n.customAnimations={actions:u,mixer:h}}i.userData&&(this.group.userData=i.userData),this.group.isCustomGroup=!0,this.group.events={},this.object=n,this.group.rotation.set(l.x,l.y,r),!1===i.visible&&this.hide(),this.refreshRender();l=new Wt.d,r=new Wt.vb,i=new Wt.vb;l.setFromObject(this.object),l.getSize(r),l.getCenter(i);l=new Wt.e(r.x,r.y,r.z),i=new Wt.P({color:"rgb(255,255,255)"});i.transparent=!0,i.opacity=0;i=new Wt.O(l,i);i.position.z=r.z/2,i.sourceObject=this.group,i.renderOrder=1,this.box=i,this.group.add(i),this.threeLayer.eventObjects.push(i),Gt(n,this.threeLayer),this.createLight(),this.createAnimation(),this.addEvents(),this.addOrUpdateTooltip(),this.addOrUpdateInfoWindow(),this.emit("loaded",{object:n,group:this.group,threeLayer:this.threeLayer})},Vt.prototype.addEvents=function(){var t=this;this.group.events.click=function(){t.emit("click",t.group)},this.group.events.mouseover=function(){t.emit("mouseover",t.group)},this.group.events.mouseout=function(){t.emit("mouseout",t.group)}},Vt.prototype.remove=function(){this.threeLayer.getWorld().remove(this.group),this.moveRequestAnimationFrame&&window.cancelAnimationFrame(this.moveRequestAnimationFrame),this.linerAnimationFrame&&window.cancelAnimationFrame(this.linerAnimationFrame),this.animationGroup&&(this.animationGroup.removeAll(),this.animationGroup=null),this.mapEvents&&((t=this.threeLayer.webglLayer.map.map).removeEventListener("moving",this.mapEvents.moving),t.removeEventListener("dragging",this.mapEvents.dragging),t.removeEventListener("zooming",this.mapEvents.zooming)),this.group&&(this.group.object=null),this.object=null,this.group=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),this.infoWindow&&(this.infoWindow.remove(),this.infoWindow=null);var t=this.threeLayer.eventObjects.indexOf(this.box);-1<t&&this.threeLayer.eventObjects.splice(t,1),this.box&&(this.box.sourceObject=null),this.box=null,this.events=null,this.updateThreeLayer()},Vt.prototype.createLight=function(){var i=this,t=this.options.light,o={type:"DirectionalLight",args:[],position:{x:0,y:0,z:0},lookAt:{x:0,y:0,z:0}};0<t.length&&t.forEach(function(t){var e,n;t=Object(Et.a)({},o,t),Ft[t.type]?(e=new(Function.prototype.bind.apply(Ft[t.type],[null].concat(t.args))),n=t.position,t=t.lookAt,e.position.set(n.x,n.y,n.z),e.lookAt(t.x,t.y,t.z),i.group.add(e)):console.warn("当前设置的灯光类型不存在")})},Vt.prototype.convertPosition=function(t){return this.threeLayer.webglLayer.map.lnglatToMercator(t[0],t[1])},Vt.prototype.add=function(t,e){this.threeLayer.scene.add(t);var n=this.threeLayer,i=new Rt.Group;i.isGeoGroup=!0,i.object=t,i.add(t);var o=[0,0];return!0===n.enabledPointOffset&&(o=n.getPointOffset()),i.position.x=e.lng-o[0],i.position.y=e.lat-o[1],i.position.z=t.position.z,!1===this.options.visible&&(i.visible=!1),i.track=this.options.track,n.getWorld().add(i),i},Vt.prototype.createAnimation=function(){var t=this.options.animation;"none"!==t.type&&(this.animationGroup||(this.animationGroup=new Mt.a.Group),this.animationGroup.removeAll(),"liner"===t.type?this.createLinerAnimation():"self"===t.type&&this.createSelfAnimation())},Vt.prototype.createLinerAnimation=function(){var t=this,e=this.options.animation.options,n=e.offset,i=this.group,o={x:i.translate.x||0,y:i.translate.y||0,z:i.translate.z||0},a={x:i.translate.x||0,y:i.translate.y||0,z:i.translate.z||0},r={x:a.x+n.x,y:a.y+n.y,z:a.z+n.z},s={x:o.x,y:o.y,z:o.z},p=this;function l(){var t=p.threeLayer.webglLayer.map.getZoomUnits();"px"!==p.options.animation.unit&&(t=1),i.translateX((o.x-s.x)*t),i.translateY((o.y-s.y)*t),i.translateZ((o.z-s.z)*t),s.x=o.x,s.y=o.y,s.z=o.z,p.refreshRender()}n=this.animationGroup,r=new Mt.a.Tween(o,n).to(r).delay(e.delay).duration(e.duration).easing(Mt.a.Easing.Cubic.In).onUpdate(function(){l()}),e=new Mt.a.Tween(o,n).to(a).duration(e.duration).easing(Mt.a.Easing.Cubic.Out).onUpdate(function(){l()});r.chain(e),e.chain(r),r.start(),this.animate(function(){t.animationGroup.update()})},Vt.prototype.animate=function(t){var e=this;this.linerAnimationFrame=requestAnimationFrame(function(){e.animate(t)}),t()},Vt.prototype.createSelfAnimation=function(){var t,n=this,i=this.object.customAnimations;for(t in i.clock=new Rt.Clock,i.actions)i.actions[t].play();this.animate(function(){var t=i.clock.getDelta(),e=i.mixer;e&&e.update(t),n.refreshRender()})},Vt.prototype.move=function(t){var e=this;if(this.group){var n=this.group.track,i=this.threeLayer.webglLayer.map.map,o=this.group.rotation.z,a=t.angle,r=void 0!==a?Math.PI/180*a:o,s=this.options.move,p=t.geometry.coordinates,t=this.convertPosition(p);if(!s.smooth||"hidden"===document.visibilityState)return this.group.position.x=t[0],this.group.position.y=t[1],this.group.rotation.z=r,n&&!0===n.focus&&this.moveMapCenter(i,{center:new BMapGL.Point(p[0],p[1]),heading:a-90+(n.offsetHeading||0),tilt:n.tilt,zoom:n.zoom},n),this.infoWindow&&this.changeTipPosition(this.group.position,this.threeLayer.webglLayer.map.map,this.options.infoWindow.offset,this.infoWindow),void this.refreshRender();this.moveGroup||(this.moveGroup=new Mt.a.Group),this.moveRequestAnimationFrame&&window.cancelAnimationFrame(this.moveRequestAnimationFrame),this.moveGroup.getAll().forEach(function(t){t.end()}),this.moveGroup.removeAll();var p=this.group,l={x:p.position.x,y:p.position.y,rotateZ:o},r={x:t[0],y:t[1],rotateZ:r};n&&!0===n.focus&&(l.heading=i.getHeading(),l.tilt=i.getTilt(),r.heading=a+(n.offsetHeading||0)-90,r.tilt=n.tilt,n.zoom&&(l.zoom=i.getZoom(),r.zoom=n.zoom)),new Mt.a.Tween(l,this.moveGroup).easing(Mt.a.Easing.Linear.None).duration(s.duration).to(r).onUpdate(function(){var t;e.group.position.x=l.x,e.group.position.y=l.y,e.group.rotation.z=l.rotateZ,n&&!0===n.focus&&(t=i.mercatorToLnglat(l.x,l.y),t=new BMapGL.Point(t[0],t[1]),e.moveMapCenter(i,{center:t,heading:l.heading,tilt:l.tilt,zoom:l.zoom},n)),e.infoWindow&&e.changeTipPosition(l,e.threeLayer.webglLayer.map.map,e.options.infoWindow.offset,e.infoWindow),e.refreshRender()}).onComplete(function(){window.cancelAnimationFrame(e.moveRequestAnimationFrame)}).start(),this.moveAnimate()}},Vt.prototype.moveMapCenter=function(t,e,n){var i=this;clearTimeout(this.moveMapCenterTimer);var o=e.center,a=e.heading,r=e.tilt,s=e.zoom;"hidden"===document.visibilityState?this.moveMapCenterTimer=setTimeout(function(){i.moveMapCenter(t,e,n)},100):(s&&t.setZoom(s,{noAnimation:!0}),t.panTo(o,{noAnimation:!0}),n.autoRotate&&(t.setHeading(a,{noAnimation:!0}),t.setTilt(r,{noAnimation:!0})))},Vt.prototype.moveAnimate=function(){var t=this;this.moveRequestAnimationFrame=requestAnimationFrame(function(){t.moveAnimate()}),this.moveGroup.update()},Vt.prototype.show=function(){this.group&&(this.group.visible=!0,this.updateThreeLayer())},Vt.prototype.hide=function(){this.group&&(this.group.visible=!1,this.updateThreeLayer())},Vt.prototype.refreshRender=function(){this.group.visible&&this.updateThreeLayer()},Vt.prototype.updateThreeLayer=function(){this.threeLayer.needsUpdate=!0},Vt.prototype.on=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];St.includes(t)?(this.events.get(t)||this.events.set(t,[]),this.events.get(t).push({handler:e,isOnce:n})):console.warn("事件["+t+"]不在可操作事件列表中！")},Vt.prototype.off=function(t,e){var n;St.includes(t)?(n=this.events.get(t))&&(e=n.indexOf(e),n.splice(e,1)):console.warn("事件["+t+"]不在可操作事件列表中！")},Vt.prototype.removeEventListener=function(t){St.includes(t)?this.events.delete(t):console.warn("事件["+t+"]不在可操作事件列表中！")},Vt.prototype.emit=function(t,e){var n=this.events.get(t);if(n)for(var i=n.length,o=0;o<i;o++){var a=n[o];a.handler.call(this,e),a.isOnce&&(n.splice(o,1),o--,i--)}},Vt.prototype.setUserData=function(t){this.group&&(this.group.userData=t)},Vt.prototype.setTrack=function(t){var e=this;if(this.group){if(!t)return this.options.track=void 0,void(this.group.track=void 0);!0===(t=Object(Et.a)({},this.getDefaultOptions().track,t)).focus&&this.threeLayer.getWorld().children.forEach(function(t){t!==e.group&&(t.track=void 0)}),this.group.track=t}},Vt.prototype.addOrUpdateTooltip=function(){var t,e,n,i=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=Object(Et.a)({},this.options.tooltip,o);(this.options.tooltip=a)&&a.content&&this.group&&(t=this.threeLayer.webglLayer.map.map,e=a.content,o=a.isCustom,this.tooltip?this.tooltip.innerHTML=e:((n=Ht('<div class="bmap-gl-tooltip-container">\n                '+e+"\n              </div>")).style.display="none",n.style.zIndex="100",n.style.position="absolute",n.style.transform="translate(-50%,-100%)",o||(n.style.background="#fff",n.style.padding="5px 10px"),t.container.appendChild(n),this.tooltip=n,this.on("mouseover",function(){i.changeTipPosition(i.group.position,t,a.offset,n),n.style.display="block"}),this.on("mouseout",function(){n.style.display="none"})))},Vt.prototype.addOrUpdateInfoWindow=function(){var t,e,n,i,o,a=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=Object(Et.a)({},this.options.infoWindow,r);(this.options.infoWindow=s)&&(s.content||s.ele)&&this.group&&(t=this.threeLayer.webglLayer.map.map,e=s.content,n=s.ele,this.infoWindow?(n||(this.infoWindow.innerHTML=e),!0===s.visible?this.infoWindow.style.display="block":this.infoWindow.style.display="none"):(i="vue-"+function(){for(var t=[],e="0123456789abcdef",n=0;n<36;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}(),(o=Ht('<div class="bmap-gl-info-window-container">\n                <div id="'+i+'"></div>\n              </div>')).style.display="none",o.style.zIndex="99",o.style.position="absolute",r=s.anchor,o.style.transform="bottom"===r?"translate(-50%,-100%)":"left"===r?"translate(-100%,-50%)":"top"===r?"translate(-50%,0)":"right"===r?"translate(0,-50%)":"left-top"===r?"":"left-bottom"===r?"translate(0,-100%)":"right-top"===r?"translate(-100%,0)":"right-bottom"===r?"translate(-100%,-100%)":"translate(-50%,-100%)",s.visible&&(o.style.display="block"),t.container.appendChild(o),this.infoWindow=o,n?n.$mount("#"+i):o.innerHtml=e,this.changeTipPosition(this.group.position,t,s.offset,o),this.mapEvents={moving:function(){a.changeTipPosition(a.group.position,t,s.offset,o)},dragging:function(){a.changeTipPosition(a.group.position,t,s.offset,o)},zooming:function(){a.changeTipPosition(a.group.position,t,s.offset,o)}},t.addEventListener("moving",this.mapEvents.moving),t.addEventListener("dragging",this.mapEvents.dragging),t.addEventListener("zooming",this.mapEvents.zooming)))},Vt.prototype.changeTipPosition=function(t,e,n,i){t=e.mercatorToLnglat(t.x,t.y),e=e.pointToPixel(new BMapGL.Point(t[0],t[1])),t=e.x+n.x,n=e.y+n.y;i.style.left=t+"px",i.style.top=n+"px"};var Ut=Vt,st={name:"el-bmapv-gltf-three-layer",mixins:[l],props:["url","autoScale","scale","rotate","translate","up","move","animation","light","visible","data","userData","track","tooltip","infoWindow","events"],data:function(){return{converters:{},handlers:{data:function(t){this.move(t)},visible:function(t){!1===t?this.hide():this.show()},userData:function(t){this.setUserData(t)},track:function(t){this.setTrack(t)},tooltip:function(t){this.addOrUpdateTooltip(t)},infoWindow:function(t){this.addOrUpdateInfoWindow({visible:t.visible})}},preTooltip:"",preInfoWindow:"",hasTooltipSlot:!1}},created:function(){0<(this.$slots.tooltip||[]).length&&(this.hasTooltipSlot=!0),this.tooltipVM=new _t.a({data:function(){return{node:""}},render:function(t){var e=this.node;return t("div",{ref:"node"},Array.isArray(e)?e:[e])}}).$mount(),this.infoWindowVM=new _t.a({data:function(){return{node:""}},render:function(t){var e=this.node;return t("div",{ref:"node"},Array.isArray(e)?e:[e])}})},updated:function(){var e=this;this.$nextTick(function(){var t;e.$bmapComponent&&e.hasTooltipSlot&&((t=e.tooltipVM.$refs.node.outerHTML)!==e.preTooltip&&(e.$bmapComponent.addOrUpdateTooltip({content:t,isCustom:!0}),e.preTooltip=t))})},methods:{__initComponent:function(t){this.$bmapComponent=new Ut(t),this.$slots.tooltip&&this.$slots.tooltip.length?this.$bmapComponent.addOrUpdateTooltip({content:this.tooltipVM.$refs.node.outerHTML,isCustom:!0}):this.$bmapComponent.addOrUpdateTooltip(),this.$slots.infoWindow&&this.$slots.infoWindow.length?this.$bmapComponent.addOrUpdateInfoWindow({ele:this.infoWindowVM}):this.$bmapComponent.addOrUpdateInfoWindow()}},destroyed:function(){this.$bmapComponent&&(this.$bmapComponent.remove(),this.$bmapComponent=null),this.tooltipVM&&(this.tooltipVM.$destroy(),this.tooltipVM=null),this.infoWindowVM&&(this.infoWindowVM.$destroy(),this.infoWindowVM=null)},render:function(){var t=this.$slots.tooltip||[];t.length&&(this.tooltipVM.node=t);t=this.$slots.infoWindow||[];return t.length&&(this.infoWindowVM.node=t),null}},M=Object(m.a)(st,void 0,void 0,!1,null,null,null).exports,Bt=n(19),It=new Wt.jb,Zt=new Wt.ub,st={name:"el-bmapv-three-view",mixins:[l],props:{vid:{type:String},lights:{type:Array},hdr:{type:Object},events:{type:Object},debug:{type:Boolean,default:!1}},computed:{},data:function(){return{converters:{},handlers:{visible:function(){}},animationFrame:null,timeout:null}},mounted:function(){},methods:{__initComponent:function(t){var e=this,n=new Bt.ThreeLayer({enabledPointOffset:!1,webglLayer:t.view.webglLayer});n.eventObjects||(n.eventObjects=[]),this.$bmapComponent=this.$view=n,t.view.addLayer(n),t.debug&&(h=(l=t.view.webglLayer.map.map).getCenter(),l=l.lnglatToMercator(h.lng,h.lat),(h=new Wt.b(1e12)).position.set(l[0],l[1],0),n.getWorld().add(h));var i,o,a,r,s,p,l=t.view.webglLayer.canvas,h=n.getCamera();h.aspect=l.offsetWidth/l.offsetHeight,h.updateProjectionMatrix(),t.lights&&(r=t.lights,i=n.getWorld(),null!==r&&0!==r.length?null!==i?(o={type:"DirectionalLight",args:[]},0<r.length&&r.forEach(function(t){var e,n;t=Object(Et.a)({},o,t),kt[t.type]?(e=new(Function.prototype.bind.apply(kt[t.type],[null].concat(t.args))),n=t.position,t=t.lookAt,n&&e.position.set(n.x,n.y,n.z),t&&e.lookAt(t.x,t.y,t.z),i.add(e)):console.warn("当前设置的灯光类型不存在")})):console.warn("存放光源的group不可为空"):console.warn("光源配置不可为空")),t.hdr&&(h=t.hdr,a=n,h.urls?(h=Object(Et.a)({},{urls:"",path:"/",exposure:1},h),(r=a.getRenderer()).physicallyCorrectLights=!0,r.outputEncoding=Dt.sRGBEncoding,r.toneMappingExposure=h.exposure,(t=h.urls)instanceof Array||(t=[t]),(s=new Dt.PMREMGenerator(r)).compileCubemapShader(),p=(new At.a).setDataType(Dt.UnsignedByteType).setPath(h.path).load(t,function(){var t=s.fromCubemap(p);p.magFilter=Dt.LinearFilter,p.needsUpdate=!0,a.envMap=t?t.texture:null,Gt(a.getWorld(),a),a.needsUpdate=!0})):console.warn("HDR贴图不可为空")),n.needsUpdate=!0,this.$children.forEach(function(t){t.$emit(u,e.$bmapComponent)}),this.bindEvents(),this.requestFrame()},requestFrame:function(){var t=this;this.animationFrame=requestAnimationFrame(this.requestFrame),this.$bmapComponent.needsUpdate&&(this.$bmapComponent.needsUpdate=!1,this.timeout=setTimeout(function(){t.$bmapComponent.update()},1))},bindEvents:function(){var t=this.$bmapComponent.webglLayer.map.map.getContainer().querySelector("#mask");t.addEventListener("click",this.clickGltf),this.$bmapComponent.webglLayer.map.map.addEventListener("resize",this.resizeCamera),t.addEventListener("mousemove",this.hoverGltf)},resizeCamera:function(t){var e=this.$bmapComponent.getCamera();e.aspect=t.size.width/t.size.height,e.updateProjectionMatrix()},intersectGltf:function(t){var e=t.srcElement,n=e.getBoundingClientRect(),i=n.top+window.pageYOffset-e.clientTop,e=n.left+window.pageXOffset-e.clientLeft;Zt.x=(t.x+window.pageXOffset-e)/n.width*2-1,Zt.y=2*-((t.y+window.pageYOffset-i)/n.height)+1;n=this.$bmapComponent.getCamera();It.setFromCamera(Zt,n);var o=It.intersectObjects(this.$bmapComponent.eventObjects||[]),a=o.length;if(0<a){for(var r=null,s=0;s<a;s++){var p=o[s].object.sourceObject;if(!1!==p.visible){r=p;break}}return r}return null},clickGltf:function(t){var e=this.intersectGltf(t);e&&e.events&&e.events.click&&(e.events.click(),t.preventDefault(),t.stopPropagation())},hoverGltf:function(t){t=this.intersectGltf(t);t?t.events&&t.events.mouseover&&!t.isHover&&(t.isHover=!0,t.events.mouseover()):this.$bmapComponent.eventObjects.forEach(function(t){!0===t.sourceObject.isHover&&(t.sourceObject.isHover=!1,t.sourceObject.events.mouseout())})},getGroup:function(t){return t.isCustomGroup?t:this.getGroup(t.parent)}},destroyed:function(){this.$bmapComponent&&(this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.timeout&&clearTimeout(this.timeout),this.$bmapComponent.webglLayer.map.map.removeEventListener("click",this.clickGltf),this.$bmapComponent.webglLayer.map.map.removeEventListener("resize",this.resizeCamera),this.$bmapComponent.destroy(),this.$bmapComponent=null)}},st=Object(m.a)(st,function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default")],2)},[],!1,null,null,null).exports,qt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Nt=n(2),b={name:"el-bmapv-marker-list-layer",mixins:[l],props:["fillColor","fillSize","fillBorderColor","fillBorderWidth","shadowColor","shadowSize","shadowBorderColor","shadowBorderWidth","fontColor","fontSize","fontFamily","data"].concat(f),data:function(){return{converters:{},handlers:qt({data:function(t){this.setData(t)}},v)}},created:function(){},methods:qt({__initComponent:function(t){this.$bmapComponent=new Nt.MarkerListLayer(t),this.$view.addLayer(this.$bmapComponent)}},b),destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},b=Object(m.a)(b,void 0,void 0,!1,null,null,null).exports,Yt=n(2),l={name:"el-bmapv-bar-layer",mixins:[l],props:["type","color","size","height","unit","edgeCount","data"],data:function(){return{converters:{},handlers:{data:function(t){this.setData(t)}}}},created:function(){},methods:{__initComponent:function(t){delete t.view,this.$bmapComponent=new Yt.BarLayer(t),this.$view.addLayer(this.$bmapComponent)}},destroyed:function(){this.$bmapComponent&&this.$view&&(this.$view.removeLayer(this.$bmapComponent),this.$bmapComponent=null,this.$view=null)},render:function(){return null}},l=Object(m.a)(l,void 0,void 0,!1,null,null,null).exports,Jt=n(2),Xt=n(19),Kt=Xt.THREE,Qt={BloomEffect:Jt.BloomEffect,BrightEffect:Jt.BrightEffect},te={Intensity:Jt.Intensity,BezierCurve:Jt.BezierCurve,GeodesicCurve:Jt.GeodesicCurve,OdCurve:Jt.OdCurve},ee=[d,$,x,T,P,G,F,B,N,K,nt,at,pt,i,w,z,k,U,X,ot,ut,O,S,et,c,q,M,st,b,l],l=function(e){ee.map(function(t){e.component(t.name,t)})};"undefined"!=typeof window&&window.Vue&&l(window.Vue);e.default={install:l}}})});