(window.webpackJsonpVueMapvgl=window.webpackJsonpVueMapvgl||[]).push([[0],[function(t,e,r){"use strict";r.d(e,"a",function(){return Wh}),r.d(e,"b",function(){return eg}),r.d(e,"c",function(){return Bl}),r.d(e,"d",function(){return Lr}),r.d(e,"e",function(){return ta}),r.d(e,"f",function(){return di}),r.d(e,"g",function(){return Di}),r.d(e,"h",function(){return wu}),r.d(e,"i",function(){return H}),r.d(e,"j",function(){return ai}),r.d(e,"k",function(){return ga}),r.d(e,"l",function(){return Aa}),r.d(e,"m",function(){return sd}),r.d(e,"n",function(){return ag}),r.d(e,"o",function(){return Lp}),r.d(e,"p",function(){return X}),r.d(e,"q",function(){return Kh}),r.d(e,"r",function(){return Ot}),r.d(e,"s",function(){return g}),r.d(e,"t",function(){return Gs}),r.d(e,"u",function(){return Ft}),r.d(e,"v",function(){return nf}),r.d(e,"w",function(){return rl}),r.d(e,"x",function(){return il}),r.d(e,"y",function(){return xh}),r.d(e,"z",function(){return Re}),r.d(e,"A",function(){return Pe}),r.d(e,"B",function(){return tu}),r.d(e,"C",function(){return ql}),r.d(e,"D",function(){return au}),r.d(e,"E",function(){return nu}),r.d(e,"F",function(){return ze}),r.d(e,"G",function(){return Et}),r.d(e,"H",function(){return Lt}),r.d(e,"I",function(){return It}),r.d(e,"J",function(){return Zh}),r.d(e,"K",function(){return Xp}),r.d(e,"L",function(){return Qn}),r.d(e,"M",function(){return ar}),r.d(e,"N",function(){return an}),r.d(e,"O",function(){return Ki}),r.d(e,"P",function(){return li}),r.d(e,"Q",function(){return ih}),r.d(e,"R",function(){return nh}),r.d(e,"S",function(){return wt}),r.d(e,"T",function(){return Mt}),r.d(e,"U",function(){return St}),r.d(e,"V",function(){return Ct}),r.d(e,"W",function(){return Ph}),r.d(e,"X",function(){return Dn}),r.d(e,"Y",function(){return Mp}),r.d(e,"Z",function(){return ua}),r.d(e,"ab",function(){return _p}),r.d(e,"bb",function(){return mu}),r.d(e,"cb",function(){return lu}),r.d(e,"db",function(){return qf}),r.d(e,"eb",function(){return Bh}),r.d(e,"fb",function(){return zt}),r.d(e,"gb",function(){return He}),r.d(e,"hb",function(){return y}),r.d(e,"ib",function(){return Nt}),r.d(e,"jb",function(){return rm}),r.d(e,"kb",function(){return k}),r.d(e,"lb",function(){return Ul}),r.d(e,"mb",function(){return Fl}),r.d(e,"nb",function(){return qr}),r.d(e,"ob",function(){return dp}),r.d(e,"pb",function(){return Ye}),r.d(e,"qb",function(){return ld}),r.d(e,"rb",function(){return Ne}),r.d(e,"sb",function(){return Be}),r.d(e,"tb",function(){return Rt}),r.d(e,"ub",function(){return or}),r.d(e,"vb",function(){return Tr}),r.d(e,"wb",function(){return Gh}),r.d(e,"xb",function(){return Ue});var n=function(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t};function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function E(t){return function(){var s=t.apply(this,arguments);return new Promise(function(a,o){return function e(t,r){try{var n=s[t](r),i=n.value}catch(t){return void o(t)}if(!n.done)return Promise.resolve(i).then(function(t){e("next",t)},function(t){e("throw",t)});a(i)}("next")})}}function z(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var G=0,V=1,W=2,I=1,A=2,L=3,g=0,j=1,X=2,q=0,Y=1,Z=2,J=3,K=4,Q=5,$=100,tt=101,et=102,rt=103,nt=104,it=200,at=201,ot=202,st=203,lt=204,ut=205,ct=206,ht=207,dt=208,pt=209,ft=210,mt=0,gt=1,vt=2,yt=3,xt=4,bt=5,_t=6,At=7,w=0,M=1,C=2,Tt=0,T=1,S=2,R=3,P=4,D=5,O=301,F=302,s=303,l=304,B=306,N=307,k=1e3,H=1001,wt=1002,Mt=1003,Ct=1004,St=1005,Et=1006,It=1007,Lt=1008,Rt=1009,o=1010,u=1011,Pt=1012,c=1013,Dt=1014,Ot=1015,Ft=1016,h=1017,d=1018,p=1019,Bt=1020,f=1021,Nt=1022,zt=1023,m=1024,v=1025,y=zt,Ut=1026,kt=1027,x=1028,b=1029,_=1030,Ht=1031,Gt=1032,Vt=1033,Wt=33776,jt=33777,Xt=33778,qt=33779,Yt=35840,Zt=35841,Jt=35842,Kt=35843,Qt=36196,$t=37492,te=37496,ee=37808,re=37809,ne=37810,ie=37811,ae=37812,oe=37813,se=37814,le=37815,ue=37816,ce=37817,he=37818,de=37819,pe=37820,fe=37821,me=36492,ge=37840,ve=37841,ye=37842,xe=37843,be=37844,_e=37845,Ae=37846,we=37847,Me=37848,Ce=37849,Te=37850,Se=37851,Ee=37852,Ie=37853,Le=2201,Re=2300,Pe=2301,De=2400,Oe=2401,Fe=2500,Be=1,Ne=2,ze=3e3,Ue=3001,ke=3007,He=3002,Ge=3003,Ve=3004,We=3005,je=3006,Xe=3200,qe=3201,Ye=0,Ze=1,Je=7680,Ke=519,Qe=35044,$e=35048,tr="300 es";function er(){}Object.assign(er.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&(void 0===(t=this._listeners[t])||-1!==(e=t.indexOf(e))&&t.splice(e,1))},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var r=e.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,t)}}}});for(var rr=[],nr=0;nr<256;nr++)rr[nr]=(nr<16?"0":"")+nr.toString(16);var ir=1234567,ar={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(rr[255&t]+rr[t>>8&255]+rr[t>>16&255]+rr[t>>24&255]+"-"+rr[255&e]+rr[e>>8&255]+"-"+rr[e>>16&15|64]+rr[e>>24&255]+"-"+rr[63&r|128]+rr[r>>8&255]+"-"+rr[r>>16&255]+rr[r>>24&255]+rr[255&n]+rr[n>>8&255]+rr[n>>16&255]+rr[n>>24&255]).toUpperCase()},clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},damp:function(t,e,r,n){return ar.lerp(t,e,1-Math.exp(-r*n))},pingpong:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return e-Math.abs(ar.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((ir=16807*(ir=void 0!==t?t%2147483647:ir)%2147483647)-1)/2147483646},degToRad:function(t){return t*ar.DEG2RAD},radToDeg:function(t){return t*ar.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,r,n,i){var a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),u=a((e+n)/2),c=o((e+n)/2),h=a((e-n)/2),d=o((e-n)/2),p=a((n-e)/2),f=o((n-e)/2);switch(i){case"XYX":t.set(s*c,l*h,l*d,s*u);break;case"YZY":t.set(l*d,s*c,l*h,s*u);break;case"ZXZ":t.set(l*h,l*d,s*c,s*u);break;case"XZX":t.set(s*c,l*f,l*p,s*u);break;case"YXY":t.set(l*p,s*c,l*f,s*u);break;case"ZYZ":t.set(l*f,l*p,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}},or=(sr.prototype.set=function(t,e){return this.x=t,this.y=e,this},sr.prototype.setScalar=function(t){return this.x=t,this.y=t,this},sr.prototype.setX=function(t){return this.x=t,this},sr.prototype.setY=function(t){return this.y=t,this},sr.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},sr.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},sr.prototype.clone=function(){return new this.constructor(this.x,this.y)},sr.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},sr.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},sr.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},sr.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},sr.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sr.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},sr.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this},sr.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},sr.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},sr.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},sr.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},sr.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},sr.prototype.applyMatrix3=function(t){var e=this.x,r=this.y,t=t.elements;return this.x=t[0]*e+t[3]*r+t[6],this.y=t[1]*e+t[4]*r+t[7],this},sr.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},sr.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},sr.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},sr.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},sr.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},sr.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},sr.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},sr.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},sr.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},sr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},sr.prototype.dot=function(t){return this.x*t.x+this.y*t.y},sr.prototype.cross=function(t){return this.x*t.y-this.y*t.x},sr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},sr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},sr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},sr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},sr.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},sr.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},sr.prototype.distanceToSquared=function(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t},sr.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},sr.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},sr.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},sr.prototype.lerpVectors=function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this},sr.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},sr.prototype.fromArray=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this},sr.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t},sr.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},sr.prototype.rotateAround=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=this.x-t.x,e=this.y-t.y;return this.x=i*r-e*n+t.x,this.y=i*n+e*r+t.y,this},sr.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this},n(sr,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),sr);function sr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,sr),this.x=t,this.y=e}or.prototype.isVector2=!0;var lr=(ur.prototype.set=function(t,e,r,n,i,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=n,u[2]=o,u[3]=e,u[4]=i,u[5]=s,u[6]=r,u[7]=a,u[8]=l,this},ur.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},ur.prototype.copy=function(t){var e=this.elements,t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},ur.prototype.extractBasis=function(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},ur.prototype.setFromMatrix4=function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},ur.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},ur.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},ur.prototype.multiplyMatrices=function(t,e){var r=t.elements,n=e.elements,i=this.elements,a=r[0],o=r[3],s=r[6],l=r[1],u=r[4],c=r[7],h=r[2],d=r[5],p=r[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],t=n[7],e=n[2],r=n[5],n=n[8];return i[0]=a*f+o*v+s*e,i[3]=a*m+o*y+s*r,i[6]=a*g+o*t+s*n,i[1]=l*f+u*v+c*e,i[4]=l*m+u*y+c*r,i[7]=l*g+u*t+c*n,i[2]=h*f+d*v+p*e,i[5]=h*m+d*y+p*r,i[8]=h*g+d*t+p*n,this},ur.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},ur.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],t=t[8];return e*a*t-e*o*l-r*i*t+r*o*s+n*i*l-n*a*s},ur.prototype.invert=function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=u*a-o*l,h=o*s-u*i,d=l*i-a*s,p=e*c+r*h+n*d;if(0==p)return this.set(0,0,0,0,0,0,0,0,0);p=1/p;return t[0]=c*p,t[1]=(n*l-u*r)*p,t[2]=(o*r-n*a)*p,t[3]=h*p,t[4]=(u*e-n*s)*p,t[5]=(n*i-o*e)*p,t[6]=d*p,t[7]=(r*s-l*e)*p,t[8]=(a*e-r*i)*p,this},ur.prototype.transpose=function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},ur.prototype.getNormalMatrix=function(t){return this.setFromMatrix4(t).invert().transpose()},ur.prototype.transposeIntoArray=function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},ur.prototype.setUvTransform=function(t,e,r,n,i,a,o){var s=Math.cos(i),i=Math.sin(i);return this.set(r*s,r*i,-r*(s*a+i*o)+a+t,-n*i,n*s,-n*(-i*a+s*o)+o+e,0,0,1),this},ur.prototype.scale=function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},ur.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements,i=n[0],a=n[3],o=n[6],s=n[1],l=n[4],t=n[7];return n[0]=e*i+r*s,n[3]=e*a+r*l,n[6]=e*o+r*t,n[1]=-r*i+e*s,n[4]=-r*a+e*l,n[7]=-r*o+e*t,this},ur.prototype.translate=function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},ur.prototype.equals=function(t){for(var e=this.elements,r=t.elements,n=0;n<9;n++)if(e[n]!==r[n])return!1;return!0},ur.prototype.fromArray=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0;r<9;r++)this.elements[r]=t[r+e];return this},ur.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t},ur.prototype.clone=function(){return(new this.constructor).fromArray(this.elements)},ur);function ur(){U(this,ur),this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}lr.prototype.isMatrix3=!0;var cr,hr=void 0,dr={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;var e,r=void 0;return 2048<(r=t instanceof HTMLCanvasElement?t:((hr=void 0===hr?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):hr).width=t.width,hr.height=t.height,e=hr.getContext("2d"),t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),hr)).width||2048<r.height?r.toDataURL("image/jpeg",.6):r.toDataURL("image/png")}},pr=0,fr=(a(mr,cr=er),mr.prototype.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},mr.prototype.clone=function(){return(new this.constructor).copy(this)},mr.prototype.copy=function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},mr.prototype.toJSON=function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=ar.generateUUID()),!e&&void 0===t.images[n.uuid]){var i=void 0;if(Array.isArray(n))for(var i=[],a=0,o=n.length;a<o;a++)n[a].isDataTexture?i.push(gr(n[a].image)):i.push(gr(n[a]));else i=gr(n);t.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return e||(t.textures[this.uuid]=r),r},mr.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})},mr.prototype.transformUv=function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case k:t.x=t.x-Math.floor(t.x);break;case H:t.x=t.x<0?0:1;break;case wt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case k:t.y=t.y-Math.floor(t.y);break;case H:t.y=t.y<0?0:1;break;case wt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t},n(mr,[{key:"needsUpdate",set:function(t){!0===t&&this.version++}}]),mr);function mr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:mr.DEFAULT_IMAGE,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:mr.DEFAULT_MAPPING,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:H,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:H,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:Et,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:Lt,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:zt,s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:Rt,l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:1,u=9<arguments.length&&void 0!==arguments[9]?arguments[9]:ze;U(this,mr);var c=z(this,cr.call(this));return Object.defineProperty(c,"id",{value:pr++}),c.uuid=ar.generateUUID(),c.name="",c.image=t,c.mipmaps=[],c.mapping=e,c.wrapS=r,c.wrapT=n,c.magFilter=i,c.minFilter=a,c.anisotropy=l,c.format=o,c.internalFormat=null,c.type=s,c.offset=new or(0,0),c.repeat=new or(1,1),c.center=new or(0,0),c.rotation=0,c.matrixAutoUpdate=!0,c.matrix=new lr,c.generateMipmaps=!0,c.premultiplyAlpha=!1,c.flipY=!0,c.unpackAlignment=4,c.encoding=u,c.version=0,c.onUpdate=null,c}function gr(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?dr.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}fr.DEFAULT_IMAGE=void 0,fr.DEFAULT_MAPPING=300,fr.prototype.isTexture=!0;var vr=(yr.prototype.set=function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},yr.prototype.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},yr.prototype.setX=function(t){return this.x=t,this},yr.prototype.setY=function(t){return this.y=t,this},yr.prototype.setZ=function(t){return this.z=t,this},yr.prototype.setW=function(t){return this.w=t,this},yr.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},yr.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},yr.prototype.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},yr.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},yr.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},yr.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},yr.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},yr.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},yr.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},yr.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},yr.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},yr.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},yr.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},yr.prototype.applyMatrix4=function(t){var e=this.x,r=this.y,n=this.z,i=this.w,t=t.elements;return this.x=t[0]*e+t[4]*r+t[8]*n+t[12]*i,this.y=t[1]*e+t[5]*r+t[9]*n+t[13]*i,this.z=t[2]*e+t[6]*r+t[10]*n+t[14]*i,this.w=t[3]*e+t[7]*r+t[11]*n+t[15]*i,this},yr.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},yr.prototype.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},yr.prototype.setAxisAngleFromRotationMatrix=function(t){var e=void 0,r=void 0,n=void 0,i=void 0,a=t.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],p=a[6],f=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+c+f-3)<.1)return this.set(1,0,0,0),this;var e=Math.PI,m=(o+1)/2,g=(c+1)/2,v=(f+1)/2,y=(s+u)/4,t=(l+d)/4,a=(h+p)/4;return g<m&&v<m?i=m<.01?(r=0,n=.707106781):(n=y/(r=Math.sqrt(m)),t/r):v<g?i=g<.01?(n=0,r=.707106781):(r=y/(n=Math.sqrt(g)),a/n):v<.01?(n=r=.707106781,i=0):(r=t/(i=Math.sqrt(v)),n=a/i),this.set(r,n,i,e),this}e=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(e)<.001&&(e=1),this.x=(p-h)/e,this.y=(l-d)/e,this.z=(u-s)/e,this.w=Math.acos((o+c+f-1)/2),this},yr.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},yr.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},yr.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},yr.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},yr.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},yr.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},yr.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},yr.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},yr.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},yr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},yr.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},yr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},yr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},yr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},yr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},yr.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},yr.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},yr.prototype.lerpVectors=function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this},yr.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},yr.prototype.fromArray=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},yr.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},yr.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},yr.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},n(yr,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),yr);function yr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,yr),this.x=t,this.y=e,this.z=r,this.w=n}vr.prototype.isVector4=!0;var xr,br,_r=(a(Ar,xr=er),Ar.prototype.setTexture=function(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t},Ar.prototype.setSize=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;this.width===t&&this.height===e&&this.depth===r||(this.width=t,this.height=e,this.depth=r,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},Ar.prototype.clone=function(){return(new this.constructor).copy(this)},Ar.prototype.copy=function(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},Ar.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})},Ar);function Ar(t,e,r){U(this,Ar);var n=z(this,xr.call(this));return n.width=t,n.height=e,n.depth=1,n.scissor=new vr(0,0,t,e),n.scissorTest=!1,n.viewport=new vr(0,0,t,e),r=r||{},n.texture=new fr(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),n.texture.image={},n.texture.image.width=t,n.texture.image.height=e,n.texture.image.depth=1,n.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,n.texture.minFilter=void 0!==r.minFilter?r.minFilter:Et,n.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,n.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,n.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,n}function wr(t,e,r){U(this,wr);r=z(this,br.call(this,t,e,r));return r.samples=4,r}_r.prototype.isWebGLRenderTarget=!0,(a(wr,br=_r),wr.prototype.copy=function(t){return br.prototype.copy.call(this,t),this.samples=t.samples,this},wr).prototype.isWebGLMultisampleRenderTarget=!0;var Mr=(Cr.slerp=function(t,e,r,n){return r.copy(t).slerp(e,n)},Cr.slerpFlat=function(t,e,r,n,i,a,o){var s=r[n+0],l=r[n+1],u=r[n+2],c=r[n+3],h=i[a+0],d=i[a+1],p=i[a+2],f=i[a+3];return 0===o?(t[e+0]=s,t[e+1]=l,t[e+2]=u,void(t[e+3]=c)):1===o?(t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f)):(c===f&&s===h&&l===d&&u===p||(r=1-o,i=0<=(n=s*h+l*d+u*p+c*f)?1:-1,(a=1-n*n)>Number.EPSILON&&(a=Math.sqrt(a),n=Math.atan2(a,n*i),r=Math.sin(r*n)/a,o=Math.sin(o*n)/a),s=s*r+h*(i=o*i),l=l*r+d*i,u=u*r+p*i,c=c*r+f*i,r===1-o&&(s*=o=1/Math.sqrt(s*s+l*l+u*u+c*c),l*=o,u*=o,c*=o)),t[e]=s,t[e+1]=l,t[e+2]=u,void(t[e+3]=c))},Cr.multiplyQuaternionsFlat=function(t,e,r,n,i,a){var o=r[n],s=r[n+1],l=r[n+2],u=r[n+3],c=i[a],r=i[a+1],n=i[a+2],a=i[a+3];return t[e]=o*a+u*c+s*n-l*r,t[e+1]=s*a+u*r+l*c-o*n,t[e+2]=l*a+u*n+o*r-s*c,t[e+3]=u*a-o*c-s*r-l*n,t},Cr.prototype.set=function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this._onChangeCallback(),this},Cr.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},Cr.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},Cr.prototype.setFromEuler=function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,n=t._y,i=t._z,a=t._order,o=Math.cos,t=Math.sin,s=o(r/2),l=o(n/2),u=o(i/2),c=t(r/2),h=t(n/2),d=t(i/2);switch(a){case"XYZ":this._x=c*l*u+s*h*d,this._y=s*h*u-c*l*d,this._z=s*l*d+c*h*u,this._w=s*l*u-c*h*d;break;case"YXZ":this._x=c*l*u+s*h*d,this._y=s*h*u-c*l*d,this._z=s*l*d-c*h*u,this._w=s*l*u+c*h*d;break;case"ZXY":this._x=c*l*u-s*h*d,this._y=s*h*u+c*l*d,this._z=s*l*d+c*h*u,this._w=s*l*u-c*h*d;break;case"ZYX":this._x=c*l*u-s*h*d,this._y=s*h*u+c*l*d,this._z=s*l*d-c*h*u,this._w=s*l*u+c*h*d;break;case"YZX":this._x=c*l*u+s*h*d,this._y=s*h*u+c*l*d,this._z=s*l*d-c*h*u,this._w=s*l*u-c*h*d;break;case"XZY":this._x=c*l*u-s*h*d,this._y=s*h*u-c*l*d,this._z=s*l*d+c*h*u,this._w=s*l*u+c*h*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this},Cr.prototype.setFromAxisAngle=function(t,e){var r=e/2,e=Math.sin(r);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(r),this._onChangeCallback(),this},Cr.prototype.setFromRotationMatrix=function(t){var e,r=t.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],l=r[9],u=r[2],c=r[6],t=r[10],r=n+s+t;return 0<r?(r=.5/Math.sqrt(r+1),this._w=.25/r,this._x=(c-l)*r,this._y=(a-u)*r,this._z=(o-i)*r):s<n&&t<n?(e=2*Math.sqrt(1+n-s-t),this._w=(c-l)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(a+u)/e):t<s?(e=2*Math.sqrt(1+s-n-t),this._w=(a-u)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(l+c)/e):(s=2*Math.sqrt(1+t-n-s),this._w=(o-i)/s,this._x=(a+u)/s,this._y=(l+c)/s,this._z=.25*s),this._onChangeCallback(),this},Cr.prototype.setFromUnitVectors=function(t,e){var r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=r,this.normalize()},Cr.prototype.angleTo=function(t){return 2*Math.acos(Math.abs(ar.clamp(this.dot(t),-1,1)))},Cr.prototype.rotateTowards=function(t,e){var r=this.angleTo(t);if(0===r)return this;r=Math.min(1,e/r);return this.slerp(t,r),this},Cr.prototype.identity=function(){return this.set(0,0,0,1)},Cr.prototype.invert=function(){return this.conjugate()},Cr.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},Cr.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},Cr.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},Cr.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},Cr.prototype.normalize=function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},Cr.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},Cr.prototype.premultiply=function(t){return this.multiplyQuaternions(t,this)},Cr.prototype.multiplyQuaternions=function(t,e){var r=t._x,n=t._y,i=t._z,a=t._w,o=e._x,s=e._y,t=e._z,e=e._w;return this._x=r*e+a*o+n*t-i*s,this._y=n*e+a*s+i*o-r*t,this._z=i*e+a*t+r*s-n*o,this._w=a*e-r*o-n*s-i*t,this._onChangeCallback(),this},Cr.prototype.slerp=function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,a=this._w,o=a*t._w+r*t._x+n*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),1<=o)return this._w=a,this._x=r,this._y=n,this._z=i,this;t=1-o*o;if(t<=Number.EPSILON){var s=1-e;return this._w=s*a+e*this._w,this._x=s*r+e*this._x,this._y=s*n+e*this._y,this._z=s*i+e*this._z,this.normalize(),this._onChangeCallback(),this}s=Math.sqrt(t),t=Math.atan2(s,o),o=Math.sin((1-e)*t)/s,s=Math.sin(e*t)/s;return this._w=a*o+this._w*s,this._x=r*o+this._x*s,this._y=n*o+this._y*s,this._z=i*o+this._z*s,this._onChangeCallback(),this},Cr.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},Cr.prototype.fromArray=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},Cr.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},Cr.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},Cr.prototype._onChange=function(t){return this._onChangeCallback=t,this},Cr.prototype._onChangeCallback=function(){},n(Cr,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),Cr);function Cr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,Cr),this._x=t,this._y=e,this._z=r,this._w=n}Mr.prototype.isQuaternion=!0;var Tr=(Sr.prototype.set=function(t,e,r){return void 0===r&&(r=this.z),this.x=t,this.y=e,this.z=r,this},Sr.prototype.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},Sr.prototype.setX=function(t){return this.x=t,this},Sr.prototype.setY=function(t){return this.y=t,this},Sr.prototype.setZ=function(t){return this.z=t,this},Sr.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},Sr.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},Sr.prototype.clone=function(){return new this.constructor(this.x,this.y,this.z)},Sr.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},Sr.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},Sr.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},Sr.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},Sr.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},Sr.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},Sr.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},Sr.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},Sr.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},Sr.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},Sr.prototype.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},Sr.prototype.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ir.setFromEuler(t))},Sr.prototype.applyAxisAngle=function(t,e){return this.applyQuaternion(Ir.setFromAxisAngle(t,e))},Sr.prototype.applyMatrix3=function(t){var e=this.x,r=this.y,n=this.z,t=t.elements;return this.x=t[0]*e+t[3]*r+t[6]*n,this.y=t[1]*e+t[4]*r+t[7]*n,this.z=t[2]*e+t[5]*r+t[8]*n,this},Sr.prototype.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},Sr.prototype.applyMatrix4=function(t){var e=this.x,r=this.y,n=this.z,i=t.elements,t=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*t,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*t,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*t,this},Sr.prototype.applyQuaternion=function(t){var e=this.x,r=this.y,n=this.z,i=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*n-o*r,u=s*r+o*e-i*n,t=s*n+i*r-a*e,n=-i*e-a*r-o*n;return this.x=l*s+n*-i+u*-o-t*-a,this.y=u*s+n*-a+t*-i-l*-o,this.z=t*s+n*-o+l*-a-u*-i,this},Sr.prototype.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},Sr.prototype.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},Sr.prototype.transformDirection=function(t){var e=this.x,r=this.y,n=this.z,t=t.elements;return this.x=t[0]*e+t[4]*r+t[8]*n,this.y=t[1]*e+t[5]*r+t[9]*n,this.z=t[2]*e+t[6]*r+t[10]*n,this.normalize()},Sr.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},Sr.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},Sr.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},Sr.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},Sr.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},Sr.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},Sr.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},Sr.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},Sr.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},Sr.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},Sr.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},Sr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},Sr.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},Sr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},Sr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Sr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},Sr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Sr.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},Sr.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},Sr.prototype.lerpVectors=function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this},Sr.prototype.cross=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},Sr.prototype.crossVectors=function(t,e){var r=t.x,n=t.y,i=t.z,a=e.x,t=e.y,e=e.z;return this.x=n*e-i*t,this.y=i*a-r*e,this.z=r*t-n*a,this},Sr.prototype.projectOnVector=function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);e=t.dot(this)/e;return this.copy(t).multiplyScalar(e)},Sr.prototype.projectOnPlane=function(t){return Er.copy(this).projectOnVector(t),this.sub(Er)},Sr.prototype.reflect=function(t){return this.sub(Er.copy(t).multiplyScalar(2*this.dot(t)))},Sr.prototype.angleTo=function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;e=this.dot(t)/e;return Math.acos(ar.clamp(e,-1,1))},Sr.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},Sr.prototype.distanceToSquared=function(t){var e=this.x-t.x,r=this.y-t.y,t=this.z-t.z;return e*e+r*r+t*t},Sr.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},Sr.prototype.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},Sr.prototype.setFromSphericalCoords=function(t,e,r){var n=Math.sin(e)*t;return this.x=n*Math.sin(r),this.y=Math.cos(e)*t,this.z=n*Math.cos(r),this},Sr.prototype.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},Sr.prototype.setFromCylindricalCoords=function(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this},Sr.prototype.setFromMatrixPosition=function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},Sr.prototype.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=t,this},Sr.prototype.setFromMatrixColumn=function(t,e){return this.fromArray(t.elements,4*e)},Sr.prototype.setFromMatrix3Column=function(t,e){return this.fromArray(t.elements,3*e)},Sr.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},Sr.prototype.fromArray=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},Sr.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},Sr.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},Sr.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},Sr);function Sr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;U(this,Sr),this.x=t,this.y=e,this.z=r}Tr.prototype.isVector3=!0;var Er=new Tr,Ir=new Mr,Lr=(Rr.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},Rr.prototype.setFromArray=function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},Rr.prototype.setFromBufferAttribute=function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},Rr.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},Rr.prototype.setFromCenterAndSize=function(t,e){e=Dr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this},Rr.prototype.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},Rr.prototype.clone=function(){return(new this.constructor).copy(this)},Rr.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},Rr.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},Rr.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},Rr.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Tr),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},Rr.prototype.getSize=function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Tr),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},Rr.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},Rr.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},Rr.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},Rr.prototype.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Or.copy(e.boundingBox),Or.applyMatrix4(t.matrixWorld),this.union(Or));for(var r=t.children,n=0,i=r.length;n<i;n++)this.expandByObject(r[n]);return this},Rr.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},Rr.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},Rr.prototype.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Tr),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},Rr.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},Rr.prototype.intersectsSphere=function(t){return this.clampPoint(t.center,Dr),Dr.distanceToSquared(t.center)<=t.radius*t.radius},Rr.prototype.intersectsPlane=function(t){var e=void 0,r=void 0,r=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant},Rr.prototype.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(Hr),Gr.subVectors(this.max,Hr),Fr.subVectors(t.a,Hr),Br.subVectors(t.b,Hr),Nr.subVectors(t.c,Hr),zr.subVectors(Br,Fr),Ur.subVectors(Nr,Br),kr.subVectors(Fr,Nr);t=[0,-zr.z,zr.y,0,-Ur.z,Ur.y,0,-kr.z,kr.y,zr.z,0,-zr.x,Ur.z,0,-Ur.x,kr.z,0,-kr.x,-zr.y,zr.x,0,-Ur.y,Ur.x,0,-kr.y,kr.x,0];return!!jr(t,Fr,Br,Nr,Gr)&&(!!jr(t=[1,0,0,0,1,0,0,0,1],Fr,Br,Nr,Gr)&&(Vr.crossVectors(zr,Ur),jr(t=[Vr.x,Vr.y,Vr.z],Fr,Br,Nr,Gr)))},Rr.prototype.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Tr),e.copy(t).clamp(this.min,this.max)},Rr.prototype.distanceToPoint=function(t){return Dr.copy(t).clamp(this.min,this.max).sub(t).length()},Rr.prototype.getBoundingSphere=function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Dr).length(),t},Rr.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},Rr.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},Rr.prototype.applyMatrix4=function(t){return this.isEmpty()||(Pr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Pr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Pr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Pr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Pr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Pr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Pr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Pr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Pr)),this},Rr.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},Rr.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},Rr);function Rr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr(1/0,1/0,1/0),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr(-1/0,-1/0,-1/0);U(this,Rr),this.min=t,this.max=e}Lr.prototype.isBox3=!0;var Pr=[new Tr,new Tr,new Tr,new Tr,new Tr,new Tr,new Tr,new Tr],Dr=new Tr,Or=new Lr,Fr=new Tr,Br=new Tr,Nr=new Tr,zr=new Tr,Ur=new Tr,kr=new Tr,Hr=new Tr,Gr=new Tr,Vr=new Tr,Wr=new Tr;function jr(t,e,r,n,i){for(var a=0,o=t.length-3;a<=o;a+=3){Wr.fromArray(t,a);var s=i.x*Math.abs(Wr.x)+i.y*Math.abs(Wr.y)+i.z*Math.abs(Wr.z),l=e.dot(Wr),u=r.dot(Wr),c=n.dot(Wr);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var Xr=new Lr,qr=(Yr.prototype.set=function(t,e){return this.center.copy(t),this.radius=e,this},Yr.prototype.setFromPoints=function(t,e){var r=this.center;void 0!==e?r.copy(e):Xr.setFromPoints(t).getCenter(r);for(var n=0,i=0,a=t.length;i<a;i++)n=Math.max(n,r.distanceToSquared(t[i]));return this.radius=Math.sqrt(n),this},Yr.prototype.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},Yr.prototype.isEmpty=function(){return this.radius<0},Yr.prototype.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},Yr.prototype.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},Yr.prototype.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},Yr.prototype.intersectsSphere=function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},Yr.prototype.intersectsBox=function(t){return t.intersectsSphere(this)},Yr.prototype.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},Yr.prototype.clampPoint=function(t,e){var r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Tr),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},Yr.prototype.getBoundingBox=function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Lr),this.isEmpty()?t.makeEmpty():(t.set(this.center,this.center),t.expandByScalar(this.radius)),t},Yr.prototype.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},Yr.prototype.translate=function(t){return this.center.add(t),this},Yr.prototype.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},Yr.prototype.clone=function(){return(new this.constructor).copy(this)},Yr);function Yr(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;U(this,Yr),this.center=t,this.radius=e}var Zr=new Tr,Jr=new Tr,Kr=new Tr,Qr=new Tr,$r=new Tr,tn=new Tr,en=new Tr,rn=(nn.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},nn.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},nn.prototype.at=function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Tr),e.copy(this.direction).multiplyScalar(t).add(this.origin)},nn.prototype.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},nn.prototype.recast=function(t){return this.origin.copy(this.at(t,Zr)),this},nn.prototype.closestPointToPoint=function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Tr),e.subVectors(t,this.origin);t=e.dot(this.direction);return t<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},nn.prototype.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},nn.prototype.distanceSqToPoint=function(t){var e=Zr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Zr.copy(this.direction).multiplyScalar(e).add(this.origin),Zr.distanceToSquared(t))},nn.prototype.distanceSqToSegment=function(t,e,r,n){Jr.copy(t).add(e).multiplyScalar(.5),Kr.copy(e).sub(t).normalize(),Qr.copy(this.origin).sub(Jr);var i=.5*t.distanceTo(e),a=-this.direction.dot(Kr),o=Qr.dot(this.direction),s=-Qr.dot(Kr),l=Qr.lengthSq(),u=Math.abs(1-a*a),c=void 0,h=void 0,t=void 0,e=void 0;return t=0<u?(h=a*o-s,e=i*u,0<=(c=a*s-o)?-e<=h?h<=e?(c*=u=1/u)*(c+a*(h*=u)+2*o)+h*(a*c+h+2*s)+l:(h=i,-(c=Math.max(0,-(a*h+o)))*c+h*(h+2*s)+l):(h=-i,-(c=Math.max(0,-(a*h+o)))*c+h*(h+2*s)+l):h<=-e?-(c=Math.max(0,-(-a*i+o)))*c+(h=0<c?-i:Math.min(Math.max(-i,-s),i))*(h+2*s)+l:h<=e?(c=0,(h=Math.min(Math.max(-i,-s),i))*(h+2*s)+l):-(c=Math.max(0,-(a*i+o)))*c+(h=0<c?i:Math.min(Math.max(-i,-s),i))*(h+2*s)+l):(h=0<a?-i:i,-(c=Math.max(0,-(a*h+o)))*c+h*(h+2*s)+l),r&&r.copy(this.direction).multiplyScalar(c).add(this.origin),n&&n.copy(Kr).multiplyScalar(h).add(Jr),t},nn.prototype.intersectSphere=function(t,e){Zr.subVectors(t.center,this.origin);var r=Zr.dot(this.direction),n=Zr.dot(Zr)-r*r,t=t.radius*t.radius;if(t<n)return null;t=Math.sqrt(t-n),n=r-t,t=r+t;return n<0&&t<0?null:n<0?this.at(t,e):this.at(n,e)},nn.prototype.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},nn.prototype.distanceToPlane=function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;e=-(this.origin.dot(t.normal)+t.constant)/e;return 0<=e?e:null},nn.prototype.intersectPlane=function(t,e){t=this.distanceToPlane(t);return null===t?null:this.at(t,e)},nn.prototype.intersectsPlane=function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},nn.prototype.intersectBox=function(t,e){var r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin,n=0<=l?(r=(t.min.x-h.x)*l,(t.max.x-h.x)*l):(r=(t.max.x-h.x)*l,(t.min.x-h.x)*l);return(a=0<=u?(i=(t.min.y-h.y)*u,(t.max.y-h.y)*u):(i=(t.max.y-h.y)*u,(t.min.y-h.y)*u))<r||n<i?null:((r<i||r!=r)&&(r=i),(a<n||n!=n)&&(n=a),(s=0<=c?(o=(t.min.z-h.z)*c,(t.max.z-h.z)*c):(o=(t.max.z-h.z)*c,(t.min.z-h.z)*c))<r||n<o?null:((r<o||r!=r)&&(r=o),(n=s<n||n!=n?s:n)<0?null:this.at(0<=r?r:n,e)))},nn.prototype.intersectsBox=function(t){return null!==this.intersectBox(t,Zr)},nn.prototype.intersectTriangle=function(t,e,r,n,i){$r.subVectors(e,t),tn.subVectors(r,t),en.crossVectors($r,tn);e=this.direction.dot(en),r=void 0;if(0<e){if(n)return null;r=1}else{if(!(e<0))return null;r=-1,e=-e}Qr.subVectors(this.origin,t);n=r*this.direction.dot(tn.crossVectors(Qr,tn));if(n<0)return null;t=r*this.direction.dot($r.cross(Qr));if(t<0)return null;if(e<n+t)return null;r=-r*Qr.dot(en);return r<0?null:this.at(r/e,i)},nn.prototype.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},nn.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},nn.prototype.clone=function(){return(new this.constructor).copy(this)},nn);function nn(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr(0,0,-1);U(this,nn),this.origin=t,this.direction=e}var an=(on.prototype.set=function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},on.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},on.prototype.clone=function(){return(new on).fromArray(this.elements)},on.prototype.copy=function(t){var e=this.elements,t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},on.prototype.copyPosition=function(t){var e=this.elements,t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},on.prototype.setFromMatrix3=function(t){t=t.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this},on.prototype.extractBasis=function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},on.prototype.makeBasis=function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},on.prototype.extractRotation=function(t){var e=this.elements,r=t.elements,n=1/sn.setFromMatrixColumn(t,0).length(),i=1/sn.setFromMatrixColumn(t,1).length(),t=1/sn.setFromMatrixColumn(t,2).length();return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=0,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=0,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},on.prototype.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,r,n,i,a,o,s,l,u,c,h,d=this.elements,p=t.x,f=t.y,m=t.z,g=Math.cos(p),v=Math.sin(p),y=Math.cos(f),x=Math.sin(f),p=Math.cos(m),f=Math.sin(m);return"XYZ"===t.order?(e=g*p,n=g*f,r=v*p,m=v*f,d[0]=y*p,d[4]=-y*f,d[8]=x,d[1]=n+r*x,d[5]=e-m*x,d[9]=-v*y,d[2]=m-e*x,d[6]=r+n*x,d[10]=g*y):"YXZ"===t.order?(i=y*p,e=y*f,r=x*p,n=x*f,d[0]=i+n*v,d[4]=r*v-e,d[8]=g*x,d[1]=g*f,d[5]=g*p,d[9]=-v,d[2]=e*v-r,d[6]=n+i*v,d[10]=g*y):"ZXY"===t.order?(s=y*p,i=y*f,a=x*p,o=x*f,d[0]=s-o*v,d[4]=-g*f,d[8]=a+i*v,d[1]=i+a*v,d[5]=g*p,d[9]=o-s*v,d[2]=-g*x,d[6]=v,d[10]=g*y):"ZYX"===t.order?(a=g*p,o=g*f,l=v*p,s=v*f,d[0]=y*p,d[4]=l*x-o,d[8]=a*x+s,d[1]=y*f,d[5]=s*x+a,d[9]=o*x-l,d[2]=-x,d[6]=v*y,d[10]=g*y):"YZX"===t.order?(c=g*y,l=g*x,u=v*y,h=v*x,d[0]=y*p,d[4]=h-c*f,d[8]=u*f+l,d[1]=f,d[5]=g*p,d[9]=-v*p,d[2]=-x*p,d[6]=l*f+u,d[10]=c-h*f):"XZY"===t.order&&(u=g*y,c=g*x,h=v*y,t=v*x,d[0]=y*p,d[4]=-f,d[8]=x*p,d[1]=u*f+t,d[5]=g*p,d[9]=c*f-h,d[2]=h*f-c,d[6]=v*p,d[10]=t*f+u),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},on.prototype.makeRotationFromQuaternion=function(t){return this.compose(un,t,cn)},on.prototype.lookAt=function(t,e,r){var n=this.elements;return pn.subVectors(t,e),0===pn.lengthSq()&&(pn.z=1),pn.normalize(),hn.crossVectors(r,pn),0===hn.lengthSq()&&(1===Math.abs(r.z)?pn.x+=1e-4:pn.z+=1e-4,pn.normalize(),hn.crossVectors(r,pn)),hn.normalize(),dn.crossVectors(pn,hn),n[0]=hn.x,n[4]=dn.x,n[8]=pn.x,n[1]=hn.y,n[5]=dn.y,n[9]=pn.y,n[2]=hn.z,n[6]=dn.z,n[10]=pn.z,this},on.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},on.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},on.prototype.multiplyMatrices=function(t,e){var r=t.elements,n=e.elements,i=this.elements,a=r[0],o=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],b=r[15],_=n[0],A=n[4],w=n[8],M=n[12],C=n[1],T=n[5],S=n[9],E=n[13],I=n[2],L=n[6],R=n[10],P=n[14],t=n[3],e=n[7],r=n[11],n=n[15];return i[0]=a*_+o*C+s*I+l*t,i[4]=a*A+o*T+s*L+l*e,i[8]=a*w+o*S+s*R+l*r,i[12]=a*M+o*E+s*P+l*n,i[1]=u*_+c*C+h*I+d*t,i[5]=u*A+c*T+h*L+d*e,i[9]=u*w+c*S+h*R+d*r,i[13]=u*M+c*E+h*P+d*n,i[2]=p*_+f*C+m*I+g*t,i[6]=p*A+f*T+m*L+g*e,i[10]=p*w+f*S+m*R+g*r,i[14]=p*M+f*E+m*P+g*n,i[3]=v*_+y*C+x*I+b*t,i[7]=v*A+y*T+x*L+b*e,i[11]=v*w+y*S+x*R+b*r,i[15]=v*M+y*E+x*P+b*n,this},on.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},on.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+i*s*c-n*l*c-i*o*h+r*l*h+n*o*d-r*s*d)+t[7]*(+e*s*d-e*l*h+i*a*h-n*a*d+n*l*u-i*s*u)+t[11]*(+e*l*c-e*o*d-i*a*c+r*a*d+i*o*u-r*l*u)+t[15]*(-n*o*u-e*s*c+e*o*h+n*a*c-r*a*h+r*s*u)},on.prototype.transpose=function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},on.prototype.setPosition=function(t,e,r){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=r),this},on.prototype.invert=function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=c*m*l-f*h*l+f*s*d-o*m*d-c*s*g+o*h*g,y=p*h*l-u*m*l-p*s*d+a*m*d+u*s*g-a*h*g,x=u*f*l-p*c*l+p*o*d-a*f*d-u*o*g+a*c*g,b=p*c*s-u*f*s-p*o*h+a*f*h+u*o*m-a*c*m,_=e*v+r*y+n*x+i*b;if(0==_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);_=1/_;return t[0]=v*_,t[1]=(f*h*i-c*m*i-f*n*d+r*m*d+c*n*g-r*h*g)*_,t[2]=(o*m*i-f*s*i+f*n*l-r*m*l-o*n*g+r*s*g)*_,t[3]=(c*s*i-o*h*i-c*n*l+r*h*l+o*n*d-r*s*d)*_,t[4]=y*_,t[5]=(u*m*i-p*h*i+p*n*d-e*m*d-u*n*g+e*h*g)*_,t[6]=(p*s*i-a*m*i-p*n*l+e*m*l+a*n*g-e*s*g)*_,t[7]=(a*h*i-u*s*i+u*n*l-e*h*l-a*n*d+e*s*d)*_,t[8]=x*_,t[9]=(p*c*i-u*f*i-p*r*d+e*f*d+u*r*g-e*c*g)*_,t[10]=(a*f*i-p*o*i+p*r*l-e*f*l-a*r*g+e*o*g)*_,t[11]=(u*o*i-a*c*i-u*r*l+e*c*l+a*r*d-e*o*d)*_,t[12]=b*_,t[13]=(u*f*n-p*c*n+p*r*h-e*f*h-u*r*m+e*c*m)*_,t[14]=(p*o*n-a*f*n-p*r*s+e*f*s+a*r*m-e*o*m)*_,t[15]=(a*c*n-u*o*n+u*r*s-e*c*s-a*r*h+e*o*h)*_,this},on.prototype.scale=function(t){var e=this.elements,r=t.x,n=t.y,t=t.z;return e[0]*=r,e[4]*=n,e[8]*=t,e[1]*=r,e[5]*=n,e[9]*=t,e[2]*=r,e[6]*=n,e[10]*=t,e[3]*=r,e[7]*=n,e[11]*=t,this},on.prototype.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,t))},on.prototype.makeTranslation=function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},on.prototype.makeRotationX=function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},on.prototype.makeRotationY=function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},on.prototype.makeRotationZ=function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},on.prototype.makeRotationAxis=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,a=t.x,o=t.y,s=t.z,e=i*a,t=i*o;return this.set(e*a+r,e*o-n*s,e*s+n*o,0,e*o+n*s,t*o+r,t*s-n*a,0,e*s-n*o,t*s+n*a,i*s*s+r,0,0,0,0,1),this},on.prototype.makeScale=function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},on.prototype.makeShear=function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},on.prototype.compose=function(t,e,r){var n=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,p=i*c,e=a*u,i=a*c,a=o*c,o=s*l,l=s*u,u=s*c,s=r.x,c=r.y,r=r.z;return n[0]=(1-(e+a))*s,n[1]=(d+u)*s,n[2]=(p-l)*s,n[3]=0,n[4]=(d-u)*c,n[5]=(1-(h+a))*c,n[6]=(i+o)*c,n[7]=0,n[8]=(p+l)*r,n[9]=(i-o)*r,n[10]=(1-(h+e))*r,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},on.prototype.decompose=function(t,e,r){var n=this.elements,i=sn.set(n[0],n[1],n[2]).length(),a=sn.set(n[4],n[5],n[6]).length(),o=sn.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],ln.copy(this);var s=1/i,t=1/a,n=1/o;return ln.elements[0]*=s,ln.elements[1]*=s,ln.elements[2]*=s,ln.elements[4]*=t,ln.elements[5]*=t,ln.elements[6]*=t,ln.elements[8]*=n,ln.elements[9]*=n,ln.elements[10]*=n,e.setFromRotationMatrix(ln),r.x=i,r.y=a,r.z=o,this},on.prototype.makePerspective=function(t,e,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(e-t),l=2*i/(r-n),t=(e+t)/(e-t),r=(r+n)/(r-n),n=-(a+i)/(a-i),i=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=t,o[12]=0,o[1]=0,o[5]=l,o[9]=r,o[13]=0,o[2]=0,o[6]=0,o[10]=n,o[14]=i,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},on.prototype.makeOrthographic=function(t,e,r,n,i,a){var o=this.elements,s=1/(e-t),l=1/(r-n),u=1/(a-i),t=(e+t)*s,n=(r+n)*l,i=(a+i)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-t,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-n,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-i,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},on.prototype.equals=function(t){for(var e=this.elements,r=t.elements,n=0;n<16;n++)if(e[n]!==r[n])return!1;return!0},on.prototype.fromArray=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0;r<16;r++)this.elements[r]=t[r+e];return this},on.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},on);function on(){U(this,on),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}an.prototype.isMatrix4=!0;var sn=new Tr,ln=new an,un=new Tr(0,0,0),cn=new Tr(1,1,1),hn=new Tr,dn=new Tr,pn=new Tr,fn=new an,mn=new Mr,gn=(vn.prototype.set=function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this._onChangeCallback(),this},vn.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},vn.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},vn.prototype.setFromRotationMatrix=function(t,e,r){var n=ar.clamp,t=t.elements,i=t[0],a=t[4],o=t[8],s=t[1],l=t[5],u=t[9],c=t[2],h=t[6],d=t[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(n(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-n(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(n(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==r&&this._onChangeCallback(),this},vn.prototype.setFromQuaternion=function(t,e,r){return fn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(fn,e,r)},vn.prototype.setFromVector3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},vn.prototype.reorder=function(t){return mn.setFromEuler(this),this.setFromQuaternion(mn,t)},vn.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},vn.prototype.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},vn.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},vn.prototype.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new Tr(this._x,this._y,this._z)},vn.prototype._onChange=function(t){return this._onChangeCallback=t,this},vn.prototype._onChangeCallback=function(){},n(vn,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),vn);function vn(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:vn.DefaultOrder;U(this,vn),this._x=t,this._y=e,this._z=r,this._order=n}gn.prototype.isEuler=!0,gn.DefaultOrder="XYZ",gn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var yn=(xn.prototype.set=function(t){this.mask=1<<t|0},xn.prototype.enable=function(t){this.mask|=1<<t|0},xn.prototype.enableAll=function(){this.mask=-1},xn.prototype.toggle=function(t){this.mask^=1<<t|0},xn.prototype.disable=function(t){this.mask&=~(1<<t|0)},xn.prototype.disableAll=function(){this.mask=0},xn.prototype.test=function(t){return 0!=(this.mask&t.mask)},xn);function xn(){U(this,xn),this.mask=1}var bn=0,_n=new Tr,An=new Mr,wn=new an,Mn=new Tr,Cn=new Tr,Tn=new Tr,Sn=new Mr,En=new Tr(1,0,0),In=new Tr(0,1,0),Ln=new Tr(0,0,1),Rn={type:"added"},Pn={type:"removed"};function Dn(){Object.defineProperty(this,"id",{value:bn++}),this.uuid=ar.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Dn.DefaultUp.clone();var t=new Tr,e=new gn,r=new Mr,n=new Tr(1,1,1);e._onChange(function(){r.setFromEuler(e,!1)}),r._onChange(function(){e.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new an},normalMatrix:{value:new lr}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=Dn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new yn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Dn.DefaultUp=new Tr(0,1,0),Dn.DefaultMatrixAutoUpdate=!0,Dn.prototype=Object.assign(Object.create(er.prototype),{constructor:Dn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return An.setFromAxisAngle(t,e),this.quaternion.multiply(An),this},rotateOnWorldAxis:function(t,e){return An.setFromAxisAngle(t,e),this.quaternion.premultiply(An),this},rotateX:function(t){return this.rotateOnAxis(En,t)},rotateY:function(t){return this.rotateOnAxis(In,t)},rotateZ:function(t){return this.rotateOnAxis(Ln,t)},translateOnAxis:function(t,e){return _n.copy(t).applyQuaternion(this.quaternion),this.position.add(_n.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(En,t)},translateY:function(t){return this.translateOnAxis(In,t)},translateZ:function(t){return this.translateOnAxis(Ln,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(wn.copy(this.matrixWorld).invert())},lookAt:function(t,e,r){t.isVector3?Mn.copy(t):Mn.set(t,e,r);r=this.parent;this.updateWorldMatrix(!0,!1),Cn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wn.lookAt(Cn,Mn,this.up):wn.lookAt(Mn,Cn,this.up),this.quaternion.setFromRotationMatrix(wn),r&&(wn.extractRotation(r.matrixWorld),An.setFromRotationMatrix(wn),this.quaternion.premultiply(An.invert()))},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(Rn)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var r=this.children.indexOf(t);return-1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(Pn)),this},clear:function(){for(var t=0;t<this.children.length;t++){var e=this.children[t];e.parent=null,e.dispatchEvent(Pn)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),wn.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),wn.multiply(t.parent.matrixWorld)),t.applyMatrix4(wn),this.add(t),t.updateWorldMatrix(!1,!0),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Tr),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Mr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cn,t,Tn),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Tr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cn,Sn,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Tr),this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var n=this.children,i=0,a=n.length;i<a;i++)n[i].updateWorldMatrix(!1,!0)},toJSON:function(r){var t=void 0===r||"string"==typeof r,e={};t&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n,i,a,o,s,l={};function u(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(r)),e.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){l.geometry=u(r.geometries,this.geometry);var c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){var h=c.shapes;if(Array.isArray(h))for(var d=0,p=h.length;d<p;d++){var f=h[d];u(r.shapes,f)}else u(r.shapes,h)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(r.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var m=[],g=0,v=this.material.length;g<v;g++)m.push(u(r.materials,this.material[g]));l.material=m}else l.material=u(r.materials,this.material);if(0<this.children.length){l.children=[];for(var y=0;y<this.children.length;y++)l.children.push(this.children[y].toJSON(r).object)}if(0<this.animations.length){l.animations=[];for(var x=0;x<this.animations.length;x++){var b=this.animations[x];l.animations.push(u(r.animations,b))}}return t&&(n=_(r.geometries),i=_(r.materials),a=_(r.textures),o=_(r.images),s=_(r.shapes),c=_(r.skeletons),t=_(r.animations),0<n.length&&(e.geometries=n),0<i.length&&(e.materials=i),0<a.length&&(e.textures=a),0<o.length&&(e.images=o),0<s.length&&(e.shapes=s),0<c.length&&(e.skeletons=c),0<t.length&&(e.animations=t)),e.object=l,e;function _(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}});var On=new Tr,Fn=new Tr,Bn=new lr,Nn=(zn.prototype.set=function(t,e){return this.normal.copy(t),this.constant=e,this},zn.prototype.setComponents=function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},zn.prototype.setFromNormalAndCoplanarPoint=function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},zn.prototype.setFromCoplanarPoints=function(t,e,r){e=On.subVectors(r,e).cross(Fn.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(e,t),this},zn.prototype.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},zn.prototype.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},zn.prototype.negate=function(){return this.constant*=-1,this.normal.negate(),this},zn.prototype.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},zn.prototype.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},zn.prototype.projectPoint=function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Tr),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},zn.prototype.intersectLine=function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Tr);var r=t.delta(On),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;n=-(t.start.dot(this.normal)+this.constant)/n;return n<0||1<n?void 0:e.copy(r).multiplyScalar(n).add(t.start)},zn.prototype.intersectsLine=function(t){var e=this.distanceToPoint(t.start),t=this.distanceToPoint(t.end);return e<0&&0<t||t<0&&0<e},zn.prototype.intersectsBox=function(t){return t.intersectsPlane(this)},zn.prototype.intersectsSphere=function(t){return t.intersectsPlane(this)},zn.prototype.coplanarPoint=function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Tr),t.copy(this.normal).multiplyScalar(-this.constant)},zn.prototype.applyMatrix4=function(t,e){e=e||Bn.getNormalMatrix(t),t=this.coplanarPoint(On).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize();return this.constant=-t.dot(e),this},zn.prototype.translate=function(t){return this.constant-=t.dot(this.normal),this},zn.prototype.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},zn.prototype.clone=function(){return(new this.constructor).copy(this)},zn);function zn(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr(1,0,0),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,zn),this.normal=t,this.constant=e}Nn.prototype.isPlane=!0;var Un=new Tr,kn=new Tr,Hn=new Tr,Gn=new Tr,Vn=new Tr,Wn=new Tr,jn=new Tr,Xn=new Tr,qn=new Tr,Yn=new Tr,Zn=(Jn.getNormal=function(t,e,r,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Tr),n.subVectors(r,e),Un.subVectors(t,e),n.cross(Un);e=n.lengthSq();return 0<e?n.multiplyScalar(1/Math.sqrt(e)):n.set(0,0,0)},Jn.getBarycoord=function(t,e,r,n,i){Un.subVectors(n,e),kn.subVectors(r,e),Hn.subVectors(t,e);var a=Un.dot(Un),o=Un.dot(kn),n=Un.dot(Hn),r=kn.dot(kn),t=kn.dot(Hn),e=a*r-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Tr),0==e)return i.set(-2,-1,-1);e=1/e,r=(r*n-o*t)*e,e*=a*t-o*n;return i.set(1-r-e,e,r)},Jn.containsPoint=function(t,e,r,n){return this.getBarycoord(t,e,r,n,Gn),0<=Gn.x&&0<=Gn.y&&Gn.x+Gn.y<=1},Jn.getUV=function(t,e,r,n,i,a,o,s){return this.getBarycoord(t,e,r,n,Gn),s.set(0,0),s.addScaledVector(i,Gn.x),s.addScaledVector(a,Gn.y),s.addScaledVector(o,Gn.z),s},Jn.isFrontFacing=function(t,e,r,n){return Un.subVectors(r,e),kn.subVectors(t,e),Un.cross(kn).dot(n)<0},Jn.prototype.set=function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},Jn.prototype.setFromPointsAndIndices=function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},Jn.prototype.clone=function(){return(new this.constructor).copy(this)},Jn.prototype.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},Jn.prototype.getArea=function(){return Un.subVectors(this.c,this.b),kn.subVectors(this.a,this.b),.5*Un.cross(kn).length()},Jn.prototype.getMidpoint=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Tr),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},Jn.prototype.getNormal=function(t){return Jn.getNormal(this.a,this.b,this.c,t)},Jn.prototype.getPlane=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Nn),t.setFromCoplanarPoints(this.a,this.b,this.c)},Jn.prototype.getBarycoord=function(t,e){return Jn.getBarycoord(t,this.a,this.b,this.c,e)},Jn.prototype.getUV=function(t,e,r,n,i){return Jn.getUV(t,this.a,this.b,this.c,e,r,n,i)},Jn.prototype.containsPoint=function(t){return Jn.containsPoint(t,this.a,this.b,this.c)},Jn.prototype.isFrontFacing=function(t){return Jn.isFrontFacing(this.a,this.b,this.c,t)},Jn.prototype.intersectsBox=function(t){return t.intersectsTriangle(this)},Jn.prototype.closestPointToPoint=function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Tr);var r=this.a,n=this.b,i=this.c,a=void 0,o=void 0;Vn.subVectors(n,r),Wn.subVectors(i,r),Xn.subVectors(t,r);var s=Vn.dot(Xn),l=Wn.dot(Xn);if(s<=0&&l<=0)return e.copy(r);qn.subVectors(t,n);var u=Vn.dot(qn),c=Wn.dot(qn);if(0<=u&&c<=u)return e.copy(n);var h=s*c-u*l;if(h<=0&&0<=s&&u<=0)return a=s/(s-u),e.copy(r).addScaledVector(Vn,a);Yn.subVectors(t,i);var d=Vn.dot(Yn),t=Wn.dot(Yn);if(0<=t&&d<=t)return e.copy(i);s=d*l-s*t;if(s<=0&&0<=l&&t<=0)return o=l/(l-t),e.copy(r).addScaledVector(Wn,o);l=u*t-d*c;if(l<=0&&0<=c-u&&0<=d-t)return jn.subVectors(i,n),o=(c-u)/(c-u+(d-t)),e.copy(n).addScaledVector(jn,o);l=1/(l+s+h),a=s*l,o=h*l;return e.copy(r).addScaledVector(Vn,a).addScaledVector(Wn,o)},Jn.prototype.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},Jn);function Jn(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Tr;U(this,Jn),this.a=t,this.b=e,this.c=r}var Kn=0;function Qn(){Object.defineProperty(this,"id",{value:Kn++}),this.uuid=ar.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Y,this.side=g,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=lt,this.blendDst=ut,this.blendEquation=$,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=yt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ke,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Je,this.stencilZFail=Je,this.stencilZPass=Je,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Qn.prototype=Object.assign(Object.create(er.prototype),{constructor:Qn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(var e in t){var r,n=t[e];void 0!==n?"shading"!==e?void 0!==(r=this[e])?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n):console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Y&&(r.blending=this.blending),this.side!==g&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),0<this.alphaTest&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),1<this.wireframeLinewidth&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.morphNormals&&(r.morphNormals=!0),!0===this.skinning&&(r.skinning=!0),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),e&&(e=n(t.textures),t=n(t.images),0<e.length&&(r.textures=e),0<t.length&&(r.images=t)),r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,r=null;if(null!==e)for(var n=e.length,r=new Array(n),i=0;i!==n;++i)r[i]=e[i].clone();return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Qn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});var $n={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ti={h:0,s:0,l:0},ei={h:0,s:0,l:0};function ri(t,e,r){return r<0&&(r+=1),1<r&&--r,r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function ni(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ii(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var ai=(oi.prototype.set=function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},oi.prototype.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},oi.prototype.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},oi.prototype.setRGB=function(t,e,r){return this.r=t,this.g=e,this.b=r,this},oi.prototype.setHSL=function(t,e,r){return t=ar.euclideanModulo(t,1),e=ar.clamp(e,0,1),r=ar.clamp(r,0,1),0===e?this.r=this.g=this.b=r:(e=2*r-(r=r<=.5?r*(1+e):r+e-r*e),this.r=ri(e,r,t+1/3),this.g=ri(e,r,t),this.b=ri(e,r,t-1/3)),this},oi.prototype.setStyle=function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r=void 0;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var n=void 0,i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[4]),this.setHSL(o,s,l)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){i=r[1],r=i.length;if(3===r)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},oi.prototype.setColorName=function(t){var e=$n[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},oi.prototype.clone=function(){return new this.constructor(this.r,this.g,this.b)},oi.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},oi.prototype.copyGammaToLinear=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},oi.prototype.copyLinearToGamma=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,e=0<e?1/e:1;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},oi.prototype.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},oi.prototype.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},oi.prototype.copySRGBToLinear=function(t){return this.r=ni(t.r),this.g=ni(t.g),this.b=ni(t.b),this},oi.prototype.copyLinearToSRGB=function(t){return this.r=ii(t.r),this.g=ii(t.g),this.b=ii(t.b),this},oi.prototype.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},oi.prototype.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},oi.prototype.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},oi.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},oi.prototype.getHSL=function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e=this.r,r=this.g,n=this.b,i=Math.max(e,r,n),a=Math.min(e,r,n),o=void 0,s=void 0,l=(a+i)/2;if(a===i)s=o=0;else{var u=i-a,s=l<=.5?u/(i+a):u/(2-i-a);switch(i){case e:o=(r-n)/u+(r<n?6:0);break;case r:o=(n-e)/u+2;break;case n:o=(e-r)/u+4}o/=6}return t.h=o,t.s=s,t.l=l,t},oi.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},oi.prototype.offsetHSL=function(t,e,r){return this.getHSL(ti),ti.h+=t,ti.s+=e,ti.l+=r,this.setHSL(ti.h,ti.s,ti.l),this},oi.prototype.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},oi.prototype.addColors=function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},oi.prototype.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},oi.prototype.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},oi.prototype.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},oi.prototype.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},oi.prototype.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},oi.prototype.lerpColors=function(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this},oi.prototype.lerpHSL=function(t,e){this.getHSL(ti),t.getHSL(ei);var r=ar.lerp(ti.h,ei.h,e),t=ar.lerp(ti.s,ei.s,e),e=ar.lerp(ti.l,ei.l,e);return this.setHSL(r,t,e),this},oi.prototype.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},oi.prototype.fromArray=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},oi.prototype.toArray=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},oi.prototype.fromBufferAttribute=function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},oi.prototype.toJSON=function(){return this.getHex()},oi);function oi(t,e,r){return U(this,oi),void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}ai.NAMES=$n,ai.prototype.isColor=!0,ai.prototype.r=1,ai.prototype.g=1,ai.prototype.b=1;var si,li=(a(ui,si=Qn),ui.prototype.copy=function(t){return si.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},ui);function ui(t){U(this,ui);var e=z(this,si.call(this));return e.type="MeshBasicMaterial",e.color=new ai(16777215),e.map=null,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=null,e.aoMapIntensity=1,e.specularMap=null,e.alphaMap=null,e.envMap=null,e.combine=w,e.reflectivity=1,e.refractionRatio=.98,e.wireframe=!1,e.wireframeLinewidth=1,e.wireframeLinecap="round",e.wireframeLinejoin="round",e.skinning=!1,e.morphTargets=!1,e.setValues(t),e}li.prototype.isMeshBasicMaterial=!0;var ci=new Tr,hi=new or;function di(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.usage=Qe,this.updateRange={offset:0,count:-1},this.version=0}function pi(t,e,r){di.call(this,new Int8Array(t),e,r)}function fi(t,e,r){di.call(this,new Uint8Array(t),e,r)}function mi(t,e,r){di.call(this,new Uint8ClampedArray(t),e,r)}function gi(t,e,r){di.call(this,new Int16Array(t),e,r)}function vi(t,e,r){di.call(this,new Uint16Array(t),e,r)}function yi(t,e,r){di.call(this,new Int32Array(t),e,r)}function xi(t,e,r){di.call(this,new Uint32Array(t),e,r)}function bi(t,e,r){di.call(this,new Uint16Array(t),e,r)}function _i(t,e,r){di.call(this,new Float32Array(t),e,r)}function Ai(t,e,r){di.call(this,new Float64Array(t),e,r)}function wi(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e}Object.defineProperty(di.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(di.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new ai),e[r++]=a.r,e[r++]=a.g,e[r++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new or),e[r++]=a.x,e[r++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Tr),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new vr),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z,e[r++]=a.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(var e=0,r=this.count;e<r;e++)hi.fromBufferAttribute(this,e),hi.applyMatrix3(t),this.setXY(e,hi.x,hi.y);else if(3===this.itemSize)for(var n=0,i=this.count;n<i;n++)ci.fromBufferAttribute(this,n),ci.applyMatrix3(t),this.setXYZ(n,ci.x,ci.y,ci.z);return this},applyMatrix4:function(t){for(var e=0,r=this.count;e<r;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.applyMatrix4(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},applyNormalMatrix:function(t){for(var e=0,r=this.count;e<r;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.applyNormalMatrix(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},transformDirection:function(t){for(var e=0,r=this.count;e<r;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.transformDirection(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},set:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(pi.prototype=Object.create(di.prototype)).constructor=pi,(fi.prototype=Object.create(di.prototype)).constructor=fi,(mi.prototype=Object.create(di.prototype)).constructor=mi,(gi.prototype=Object.create(di.prototype)).constructor=gi,(vi.prototype=Object.create(di.prototype)).constructor=vi,(yi.prototype=Object.create(di.prototype)).constructor=yi,(xi.prototype=Object.create(di.prototype)).constructor=xi,((bi.prototype=Object.create(di.prototype)).constructor=bi).prototype.isFloat16BufferAttribute=!0,(_i.prototype=Object.create(di.prototype)).constructor=_i,(Ai.prototype=Object.create(di.prototype)).constructor=Ai;var Mi={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Ci(t,e){return new Mi[t](e)}var Ti=0,Si=new an,Ei=new Dn,Ii=new Tr,Li=new Lr,Ri=new Lr,Pi=new Tr;function Di(){Object.defineProperty(this,"id",{value:Ti++}),this.uuid=ar.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Di.prototype=Object.assign(Object.create(er.prototype),{constructor:Di,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(65535<wi(t)?xi:vi)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&(e=(new lr).getNormalMatrix(t),r.applyNormalMatrix(e),r.needsUpdate=!0);r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Si.makeRotationX(t),this.applyMatrix4(Si),this},rotateY:function(t){return Si.makeRotationY(t),this.applyMatrix4(Si),this},rotateZ:function(t){return Si.makeRotationZ(t),this.applyMatrix4(Si),this},translate:function(t,e,r){return Si.makeTranslation(t,e,r),this.applyMatrix4(Si),this},scale:function(t,e,r){return Si.makeScale(t,e,r),this.applyMatrix4(Si),this},lookAt:function(t){return Ei.lookAt(t),Ei.updateMatrix(),this.applyMatrix4(Ei.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ii).negate(),this.translate(Ii.x,Ii.y,Ii.z),this},setFromPoints:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new _i(e,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Lr);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Tr(-1/0,-1/0,-1/0),new Tr(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var r=0,n=e.length;r<n;r++){var i=e[r];Li.setFromBufferAttribute(i),this.morphTargetsRelative?(Pi.addVectors(this.boundingBox.min,Li.min),this.boundingBox.expandByPoint(Pi),Pi.addVectors(this.boundingBox.max,Li.max),this.boundingBox.expandByPoint(Pi)):(this.boundingBox.expandByPoint(Li.min),this.boundingBox.expandByPoint(Li.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new qr);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Tr,1/0);if(t){var r=this.boundingSphere.center;if(Li.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var a=e[n];Ri.setFromBufferAttribute(a),this.morphTargetsRelative?(Pi.addVectors(Li.min,Ri.min),Li.expandByPoint(Pi),Pi.addVectors(Li.max,Ri.max),Li.expandByPoint(Pi)):(Li.expandByPoint(Ri.min),Li.expandByPoint(Ri.max))}Li.getCenter(r);for(var o=0,s=0,l=t.count;s<l;s++)Pi.fromBufferAttribute(t,s),o=Math.max(o,r.distanceToSquared(Pi));if(e)for(var u=0,c=e.length;u<c;u++)for(var h=e[u],d=this.morphTargetsRelative,p=0,f=h.count;p<f;p++)Pi.fromBufferAttribute(h,p),d&&(Ii.fromBufferAttribute(t,p),Pi.add(Ii)),o=Math.max(o,r.distanceToSquared(Pi));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var t=this.index,e=this.attributes;if(null!==t&&void 0!==e.position&&void 0!==e.normal&&void 0!==e.uv){var r=t.array,i=e.position.array,n=e.normal.array,a=e.uv.array,o=i.length/3;void 0===e.tangent&&this.setAttribute("tangent",new di(new Float32Array(4*o),4));for(var s=e.tangent.array,l=[],u=[],c=0;c<o;c++)l[c]=new Tr,u[c]=new Tr;for(var h=new Tr,d=new Tr,p=new Tr,f=new or,m=new or,g=new or,v=new Tr,y=new Tr,x=this.groups,b=0,_=(x=0===x.length?[{start:0,count:r.length}]:x).length;b<_;++b)for(var A=x[b],w=A.start,M=w,C=w+A.count;M<C;M+=3)!function(t,e,r){h.fromArray(i,3*t),d.fromArray(i,3*e),p.fromArray(i,3*r),f.fromArray(a,2*t),m.fromArray(a,2*e),g.fromArray(a,2*r),d.sub(h),p.sub(h),m.sub(f),g.sub(f);var n=1/(m.x*g.y-g.x*m.y);isFinite(n)&&(v.copy(d).multiplyScalar(g.y).addScaledVector(p,-m.y).multiplyScalar(n),y.copy(p).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(n),l[t].add(v),l[e].add(v),l[r].add(v),u[t].add(y),u[e].add(y),u[r].add(y))}(r[M+0],r[M+1],r[M+2]);for(var T=new Tr,S=new Tr,E=new Tr,I=new Tr,L=0,R=x.length;L<R;++L)for(var P=x[L],D=P.start,O=D,F=D+P.count;O<F;O+=3)B(r[O+0]),B(r[O+1]),B(r[O+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function B(t){E.fromArray(n,3*t),I.copy(E);var e=l[t];T.copy(e),T.sub(E.multiplyScalar(E.dot(e))).normalize(),S.crossVectors(I,e);e=S.dot(u[t])<0?-1:1;s[4*t]=T.x,s[4*t+1]=T.y,s[4*t+2]=T.z,s[4*t+3]=e}},computeVertexNormals:function(){var t=this.index,e=this.getAttribute("position");if(void 0!==e){var r=this.getAttribute("normal");if(void 0===r)r=new di(new Float32Array(3*e.count),3),this.setAttribute("normal",r);else for(var n=0,i=r.count;n<i;n++)r.setXYZ(n,0,0,0);var a=new Tr,o=new Tr,s=new Tr,l=new Tr,u=new Tr,c=new Tr,h=new Tr,d=new Tr;if(t)for(var p=0,f=t.count;p<f;p+=3){var m=t.getX(p+0),g=t.getX(p+1),v=t.getX(p+2);a.fromBufferAttribute(e,m),o.fromBufferAttribute(e,g),s.fromBufferAttribute(e,v),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),l.fromBufferAttribute(r,m),u.fromBufferAttribute(r,g),c.fromBufferAttribute(r,v),l.add(h),u.add(h),c.add(h),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(g,u.x,u.y,u.z),r.setXYZ(v,c.x,c.y,c.z)}else for(var y=0,x=e.count;y<x;y+=3)a.fromBufferAttribute(e,y+0),o.fromBufferAttribute(e,y+1),s.fromBufferAttribute(e,y+2),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),r.setXYZ(y+0,h.x,h.y,h.z),r.setXYZ(y+1,h.x,h.y,h.z),r.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r,n=this.attributes;for(r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=t.attributes[r],o=a.array,a=a.itemSize*e,s=Math.min(o.length,i.length-a),l=0,u=a;l<s;l++,u++)i[u]=o[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,r=t.count;e<r;e++)Pi.fromBufferAttribute(t,e),Pi.normalize(),t.setXYZ(e,Pi.x,Pi.y,Pi.z)},toNonIndexed:function(){function t(t,e){for(var r=t.array,n=t.itemSize,t=t.normalized,i=new r.constructor(e.length*n),a=0,o=0,s=0,l=e.length;s<l;s++)for(var a=e[s]*n,u=0;u<n;u++)i[o++]=r[a++];return new di(i,n,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var e,r=new Di,n=this.index.array,i=this.attributes;for(e in i){var a=t(i[e],n);r.setAttribute(e,a)}var o,s=this.morphAttributes;for(o in s){for(var l=[],u=s[o],c=0,h=u.length;c<h;c++){var d=t(u[c],n);l.push(d)}r.morphAttributes[o]=l}r.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,f=0,m=p.length;f<m;f++){var g=p[f];r.addGroup(g.start,g.count,g.materialIndex)}return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e,r=this.parameters;for(e in r)void 0!==r[e]&&(t[e]=r[e]);return t}t.data={attributes:{}};var n=this.index;null!==n&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var i,a=this.attributes;for(i in a){var o=a[i],s=o.toJSON(t.data);""!==o.name&&(s.name=o.name),t.data.attributes[i]=s}var l,u={},c=!1;for(l in this.morphAttributes){for(var h=this.morphAttributes[l],d=[],p=0,f=h.length;p<f;p++){var m=h[p],g=m.toJSON(t.data);""!==m.name&&(g.name=m.name),d.push(g)}0<d.length&&(u[l]=d,c=!0)}c&&(t.data.morphAttributes=u,t.data.morphTargetsRelative=this.morphTargetsRelative);n=this.groups;0<n.length&&(t.data.groups=JSON.parse(JSON.stringify(n)));n=this.boundingSphere;return null!==n&&(t.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),t},clone:function(){return(new Di).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var e={};this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone(e));var n,i=t.attributes;for(n in i){var a=i[n];this.setAttribute(n,a.clone(e))}var o,s=t.morphAttributes;for(o in s){for(var l=[],u=s[o],c=0,h=u.length;c<h;c++)l.push(u[c].clone(e));this.morphAttributes[o]=l}this.morphTargetsRelative=t.morphTargetsRelative;for(var d=t.groups,p=0,f=d.length;p<f;p++){var m=d[p];this.addGroup(m.start,m.count,m.materialIndex)}r=t.boundingBox;null!==r&&(this.boundingBox=r.clone());r=t.boundingSphere;return null!==r&&(this.boundingSphere=r.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Oi=new an,Fi=new rn,Bi=new qr,Ni=new Tr,zi=new Tr,Ui=new Tr,ki=new Tr,Hi=new Tr,Gi=new Tr,Vi=new Tr,Wi=new Tr,ji=new Tr,Xi=new or,qi=new or,Yi=new or,Zi=new Tr,Ji=new Tr;function Ki(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Di,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new li;Dn.call(this),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}function Qi(t,e,r,n,i,a,o,s,l,u,c,h){Ni.fromBufferAttribute(i,u),zi.fromBufferAttribute(i,c),Ui.fromBufferAttribute(i,h);var d=t.morphTargetInfluences;if(e.morphTargets&&a&&d){Vi.set(0,0,0),Wi.set(0,0,0),ji.set(0,0,0);for(var p=0,f=a.length;p<f;p++){var m=d[p],g=a[p];0!==m&&(ki.fromBufferAttribute(g,u),Hi.fromBufferAttribute(g,c),Gi.fromBufferAttribute(g,h),o?(Vi.addScaledVector(ki,m),Wi.addScaledVector(Hi,m),ji.addScaledVector(Gi,m)):(Vi.addScaledVector(ki.sub(Ni),m),Wi.addScaledVector(Hi.sub(zi),m),ji.addScaledVector(Gi.sub(Ui),m)))}Ni.add(Vi),zi.add(Wi),Ui.add(ji)}t.isSkinnedMesh&&e.skinning&&(t.boneTransform(u,Ni),t.boneTransform(c,zi),t.boneTransform(h,Ui));var v,y,x,v=(v=t,y=r,x=n,i=Ni,t=zi,r=Ui,n=Zi,null===((e=e).side===j?x.intersectTriangle(r,t,i,!0,n):x.intersectTriangle(i,t,r,e.side!==X,n))?null:(Ji.copy(n),Ji.applyMatrix4(v.matrixWorld),(n=y.ray.origin.distanceTo(Ji))<y.near||n>y.far?null:{distance:n,point:Ji.clone(),object:v}));return v&&(s&&(Xi.fromBufferAttribute(s,u),qi.fromBufferAttribute(s,c),Yi.fromBufferAttribute(s,h),v.uv=Zn.getUV(Zi,Ni,zi,Ui,Xi,qi,Yi,new or)),l&&(Xi.fromBufferAttribute(l,u),qi.fromBufferAttribute(l,c),Yi.fromBufferAttribute(l,h),v.uv2=Zn.getUV(Zi,Ni,zi,Ui,Xi,qi,Yi,new or)),l={a:u,b:c,c:h,normal:new Tr,materialIndex:0},Zn.getNormal(Ni,zi,Ui,l.normal),v.face=l),v}Ki.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Ki,isMesh:!0,copy:function(t){return Dn.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,r=Object.keys(e);if(0<r.length){var n=e[r[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=n.length;i<a;i++){var o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{t=t.morphTargets;void 0!==t&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),Bi.copy(r.boundingSphere),Bi.applyMatrix4(i),!1!==t.ray.intersectsSphere(Bi)&&(Oi.copy(i).invert(),Fi.copy(t.ray).applyMatrix4(Oi),null===r.boundingBox||!1!==Fi.intersectsBox(r.boundingBox)))){var a=void 0;if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,l=r.morphAttributes.position,u=r.morphTargetsRelative,c=r.attributes.uv,h=r.attributes.uv2,d=r.groups,p=r.drawRange;if(null!==o)if(Array.isArray(n))for(var f=0,m=d.length;f<m;f++)for(var g=d[f],v=n[g.materialIndex],y=Math.max(g.start,p.start),x=Math.min(g.start+g.count,p.start+p.count);y<x;y+=3){var b=o.getX(y),_=o.getX(y+1),A=o.getX(y+2);(a=Qi(this,v,t,Fi,s,l,u,c,h,b,_,A))&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=g.materialIndex,e.push(a))}else for(var w=Math.max(0,p.start),M=Math.min(o.count,p.start+p.count);w<M;w+=3){var C=o.getX(w),T=o.getX(w+1),S=o.getX(w+2);(a=Qi(this,n,t,Fi,s,l,u,c,h,C,T,S))&&(a.faceIndex=Math.floor(w/3),e.push(a))}else if(void 0!==s)if(Array.isArray(n))for(var E=0,I=d.length;E<I;E++)for(var L=d[E],R=n[L.materialIndex],P=Math.max(L.start,p.start),D=Math.min(L.start+L.count,p.start+p.count);P<D;P+=3)(a=Qi(this,R,t,Fi,s,l,u,c,h,P,P+1,P+2))&&(a.faceIndex=Math.floor(P/3),a.face.materialIndex=L.materialIndex,e.push(a));else for(var O=Math.max(0,p.start),F=Math.min(s.count,p.start+p.count);O<F;O+=3)(a=Qi(this,n,t,Fi,s,l,u,c,h,O,O+1,O+2))&&(a.faceIndex=Math.floor(O/3),e.push(a))}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var $i,ta=(a(ea,$i=Di),ea);function ea(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1;U(this,ea);var o=z(this,$i.call(this));o.type="BoxGeometry",o.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var R=o,n=Math.floor(n),i=Math.floor(i),a=Math.floor(a),P=[],D=[],O=[],F=[],B=0,N=0;function s(t,e,r,n,i,a,o,s,l,u,c){for(var h=a/l,d=o/u,p=a/2,f=o/2,m=s/2,g=l+1,v=u+1,y=0,x=0,b=new Tr,_=0;_<v;_++)for(var A=_*d-f,w=0;w<g;w++){var M=w*h-p;b[t]=M*n,b[e]=A*i,b[r]=m,D.push(b.x,b.y,b.z),b[t]=0,b[e]=0,b[r]=0<s?1:-1,O.push(b.x,b.y,b.z),F.push(w/l),F.push(1-_/u),y+=1}for(var C=0;C<u;C++)for(var T=0;T<l;T++){var S=B+T+g*C,E=B+T+g*(C+1),I=B+(T+1)+g*(C+1),L=B+(T+1)+g*C;P.push(S,E,L),P.push(E,I,L),x+=6}R.addGroup(N,x,c),N+=x,B+=y}return s("z","y","x",-1,-1,r,e,t,a,i,0),s("z","y","x",1,-1,r,e,-t,a,i,1),s("x","z","y",1,1,t,r,e,n,a,2),s("x","z","y",1,-1,t,r,-e,n,a,3),s("x","y","z",1,-1,t,e,r,n,i,4),s("x","y","z",-1,-1,t,e,-r,n,i,5),o.setIndex(P),o.setAttribute("position",new _i(D,3)),o.setAttribute("normal",new _i(O,3)),o.setAttribute("uv",new _i(F,2)),o}function ra(t){var e,r={};for(e in t)for(var n in r[e]={},t[e]){var i=t[e][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?r[e][n]=i.clone():Array.isArray(i)?r[e][n]=i.slice():r[e][n]=i}return r}function na(t){for(var e={},r=0;r<t.length;r++){var n,i=ra(t[r]);for(n in i)e[n]=i[n]}return e}var ia={clone:ra,merge:na},aa="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",oa="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function sa(t){Qn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=aa,this.fragmentShader=oa,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function la(){Dn.call(this),this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an}function ua(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:50,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2e3;la.call(this),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}((sa.prototype=Object.create(Qn.prototype)).constructor=sa).prototype.isShaderMaterial=!0,sa.prototype.copy=function(t){return Qn.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ra(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},sa.prototype.toJSON=function(t){var e,r=Qn.prototype.toJSON.call(this,t);for(e in r.glslVersion=this.glslVersion,r.uniforms={},this.uniforms){var n=this.uniforms[e].value;n&&n.isTexture?r.uniforms[e]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?r.uniforms[e]={type:"c",value:n.getHex()}:n&&n.isVector2?r.uniforms[e]={type:"v2",value:n.toArray()}:n&&n.isVector3?r.uniforms[e]={type:"v3",value:n.toArray()}:n&&n.isVector4?r.uniforms[e]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?r.uniforms[e]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?r.uniforms[e]={type:"m4",value:n.toArray()}:r.uniforms[e]={value:n}}0<Object.keys(this.defines).length&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader;var i,a={};for(i in this.extensions)!0===this.extensions[i]&&(a[i]=!0);return 0<Object.keys(a).length&&(r.extensions=a),r},la.prototype=Object.assign(Object.create(Dn.prototype),{constructor:la,isCamera:!0,copy:function(t,e){return Dn.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Tr),this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Dn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,e){Dn.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),ua.prototype=Object.assign(Object.create(la.prototype),{constructor:ua,isPerspectiveCamera:!0,copy:function(t,e){return la.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t;this.fov=2*ar.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ar.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ar.RAD2DEG*Math.atan(Math.tan(.5*ar.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,r,n,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=this.near,r=e*Math.tan(.5*ar.DEG2RAD*this.fov)/this.zoom,n=2*r,i=this.aspect*n,a=-.5*i,o=this.view;null!==this.view&&this.view.enabled&&(t=o.fullWidth,s=o.fullHeight,a+=o.offsetX*i/t,r-=o.offsetY*n/s,i*=o.width/t,n*=o.height/s);var s=this.filmOffset;0!==s&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,r,r-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){t=Dn.prototype.toJSON.call(this,t);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var ca,ha=90,da=1,pa=(a(fa,ca=Dn),fa.prototype.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,n=this.children,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=t.xr.enabled,h=t.getRenderTarget();t.xr.enabled=!1;n=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,a),t.setRenderTarget(r,2),t.render(e,o),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,l),r.texture.generateMipmaps=n,t.setRenderTarget(r,5),t.render(e,u),t.setRenderTarget(h),t.xr.enabled=c},fa);function fa(t,e,r){U(this,fa);var n=z(this,ca.call(this));if(n.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),z(n);n.renderTarget=r;r=new ua(ha,da,t,e);r.layers=n.layers,r.up.set(0,-1,0),r.lookAt(new Tr(1,0,0)),n.add(r);r=new ua(ha,da,t,e);r.layers=n.layers,r.up.set(0,-1,0),r.lookAt(new Tr(-1,0,0)),n.add(r);r=new ua(ha,da,t,e);r.layers=n.layers,r.up.set(0,0,1),r.lookAt(new Tr(0,1,0)),n.add(r);r=new ua(ha,da,t,e);r.layers=n.layers,r.up.set(0,0,-1),r.lookAt(new Tr(0,-1,0)),n.add(r);r=new ua(ha,da,t,e);r.layers=n.layers,r.up.set(0,-1,0),r.lookAt(new Tr(0,0,1)),n.add(r);e=new ua(ha,da,t,e);return e.layers=n.layers,e.up.set(0,-1,0),e.lookAt(new Tr(0,0,-1)),n.add(e),n}var ma,ga=(a(va,ma=fr),n(va,[{key:"images",get:function(){return this.image},set:function(t){this.image=t}}]),va);function va(t,e,r,n,i,a,o,s,l,u){U(this,va),t=void 0!==t?t:[],e=void 0!==e?e:O,o=void 0!==o?o:Nt;u=z(this,ma.call(this,t,e,r,n,i,a,o,s,l,u));return u._needsFlipEnvMap=!0,u.flipY=!1,u}ga.prototype.isCubeTexture=!0;var ya,xa=(a(ba,ya=_r),ba.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=zt,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;var r={tEquirect:{value:null}},n="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new ta(5,5,5),i=new sa({name:"CubemapFromEquirect",uniforms:ra(r),vertexShader:n,fragmentShader:i,side:j,blending:q});i.uniforms.tEquirect.value=e;a=new Ki(a,i),i=e.minFilter;return e.minFilter===Lt&&(e.minFilter=Et),new pa(1,10,this).update(t,a),e.minFilter=i,a.geometry.dispose(),a.material.dispose(),this},ba.prototype.clear=function(t,e,r,n){for(var i=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(e,r,n);t.setRenderTarget(i)},ba);function ba(t,e,r){U(this,ba),Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=r);t=z(this,ya.call(this,t,t,e));return e=e||{},t.texture=new ga(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),t.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,t.texture.minFilter=void 0!==e.minFilter?e.minFilter:Et,t.texture._needsFlipEnvMap=!1,t}xa.prototype.isWebGLCubeRenderTarget=!0;var _a,Aa=(a(wa,_a=fr),wa);function wa(t,e,r,n,i,a,o,s,l,u,c,h){U(this,wa);h=z(this,_a.call(this,null,a,o,s,l,u,n,i,c,h));return h.image={data:t||null,width:e||1,height:r||1},h.magFilter=void 0!==l?l:Mt,h.minFilter=void 0!==u?u:Mt,h.generateMipmaps=!1,h.flipY=!1,h.unpackAlignment=1,h.needsUpdate=!0,h}Aa.prototype.isDataTexture=!0;var Ma=new qr,Ca=new Tr,Ta=(Sa.prototype.set=function(t,e,r,n,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},Sa.prototype.copy=function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this},Sa.prototype.setFromProjectionMatrix=function(t){var e=this.planes,r=t.elements,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=r[6],c=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],t=r[14],r=r[15];return e[0].setComponents(o-n,c-s,f-h,r-m).normalize(),e[1].setComponents(o+n,c+s,f+h,r+m).normalize(),e[2].setComponents(o+i,c+l,f+d,r+g).normalize(),e[3].setComponents(o-i,c-l,f-d,r-g).normalize(),e[4].setComponents(o-a,c-u,f-p,r-t).normalize(),e[5].setComponents(o+a,c+u,f+p,r+t).normalize(),this},Sa.prototype.intersectsObject=function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ma.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ma)},Sa.prototype.intersectsSprite=function(t){return Ma.center.set(0,0,0),Ma.radius=.7071067811865476,Ma.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ma)},Sa.prototype.intersectsSphere=function(t){for(var e=this.planes,r=t.center,n=-t.radius,i=0;i<6;i++)if(e[i].distanceToPoint(r)<n)return!1;return!0},Sa.prototype.intersectsBox=function(t){for(var e=this.planes,r=0;r<6;r++){var n=e[r];if(Ca.x=(0<n.normal.x?t.max:t.min).x,Ca.y=(0<n.normal.y?t.max:t.min).y,Ca.z=(0<n.normal.z?t.max:t.min).z,n.distanceToPoint(Ca)<0)return!1}return!0},Sa.prototype.containsPoint=function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0},Sa.prototype.clone=function(){return(new this.constructor).copy(this)},Sa);function Sa(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Nn,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Nn,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Nn,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Nn,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:new Nn,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:new Nn;U(this,Sa),this.planes=[t,e,r,n,i,a]}function Ea(){var r=null,t=!1,n=null,i=null;function a(t,e){n(t,e),i=r.requestAnimationFrame(a)}return{start:function(){!0!==t&&null!==n&&(i=r.requestAnimationFrame(a),t=!0)},stop:function(){r.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(t){n=t},setContext:function(t){r=t}}}function Ia(l,t){var u=t.isWebGL2,c=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),c.get(t)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=c.get(t);e&&(l.deleteBuffer(e.buffer),c.delete(t))},update:function(t,e){var r,n,i,a,o,s;t.isGLBufferAttribute?(!(s=c.get(t))||s.version<t.version)&&c.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}):(t.isInterleavedBufferAttribute&&(t=t.data),void 0===(r=c.get(t))?c.set(t,(i=e,a=(n=t).array,o=n.usage,s=l.createBuffer(),l.bindBuffer(i,s),l.bufferData(i,a,o),n.onUploadCallback(),o=5126,a instanceof Float32Array?o=5126:a instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):a instanceof Uint16Array?n.isFloat16BufferAttribute?u?o=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):o=5123:a instanceof Int16Array?o=5122:a instanceof Uint32Array?o=5125:a instanceof Int32Array?o=5124:a instanceof Int8Array?o=5120:a instanceof Uint8Array&&(o=5121),{buffer:s,type:o,bytesPerElement:a.BYTES_PER_ELEMENT,version:n.version})):r.version<t.version&&(o=r.buffer,a=e,e=(n=t).array,n=n.updateRange,l.bindBuffer(a,o),-1===n.count?l.bufferSubData(a,0,e):(u?l.bufferSubData(a,n.offset*e.BYTES_PER_ELEMENT,e,n.offset,n.count):l.bufferSubData(a,n.offset*e.BYTES_PER_ELEMENT,e.subarray(n.offset,n.offset+n.count)),n.count=-1),r.version=t.version))}}}var La,Ra=(a(Pa,La=Di),Pa);function Pa(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,Pa);var i=z(this,La.call(this));i.type="PlaneGeometry",i.parameters={width:t,height:e,widthSegments:r,heightSegments:n};for(var a=t/2,o=e/2,s=Math.floor(r),l=Math.floor(n),u=s+1,c=l+1,h=t/s,d=e/l,p=[],f=[],m=[],g=[],v=0;v<c;v++)for(var y=v*d-o,x=0;x<u;x++){var b=x*h-a;f.push(b,-y,0),m.push(0,0,1),g.push(x/s),g.push(1-v/l)}for(var _=0;_<l;_++)for(var A=0;A<s;A++){var w=A+u*_,M=A+u*(_+1),C=A+1+u*(_+1),T=A+1+u*_;p.push(w,M,T),p.push(M,C,T)}return i.setIndex(p),i.setAttribute("position",new _i(f,3)),i.setAttribute("normal",new _i(m,3)),i.setAttribute("uv",new _i(g,2)),i}var Da={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Oa={common:{diffuse:{value:new ai(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new lr},uv2Transform:{value:new lr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new or(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ai(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ai(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new lr}},sprite:{diffuse:{value:new ai(15658734)},opacity:{value:1},center:{value:new or(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new lr}}},Fa={basic:{uniforms:na([Oa.common,Oa.specularmap,Oa.envmap,Oa.aomap,Oa.lightmap,Oa.fog]),vertexShader:Da.meshbasic_vert,fragmentShader:Da.meshbasic_frag},lambert:{uniforms:na([Oa.common,Oa.specularmap,Oa.envmap,Oa.aomap,Oa.lightmap,Oa.emissivemap,Oa.fog,Oa.lights,{emissive:{value:new ai(0)}}]),vertexShader:Da.meshlambert_vert,fragmentShader:Da.meshlambert_frag},phong:{uniforms:na([Oa.common,Oa.specularmap,Oa.envmap,Oa.aomap,Oa.lightmap,Oa.emissivemap,Oa.bumpmap,Oa.normalmap,Oa.displacementmap,Oa.fog,Oa.lights,{emissive:{value:new ai(0)},specular:{value:new ai(1118481)},shininess:{value:30}}]),vertexShader:Da.meshphong_vert,fragmentShader:Da.meshphong_frag},standard:{uniforms:na([Oa.common,Oa.envmap,Oa.aomap,Oa.lightmap,Oa.emissivemap,Oa.bumpmap,Oa.normalmap,Oa.displacementmap,Oa.roughnessmap,Oa.metalnessmap,Oa.fog,Oa.lights,{emissive:{value:new ai(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Da.meshphysical_vert,fragmentShader:Da.meshphysical_frag},toon:{uniforms:na([Oa.common,Oa.aomap,Oa.lightmap,Oa.emissivemap,Oa.bumpmap,Oa.normalmap,Oa.displacementmap,Oa.gradientmap,Oa.fog,Oa.lights,{emissive:{value:new ai(0)}}]),vertexShader:Da.meshtoon_vert,fragmentShader:Da.meshtoon_frag},matcap:{uniforms:na([Oa.common,Oa.bumpmap,Oa.normalmap,Oa.displacementmap,Oa.fog,{matcap:{value:null}}]),vertexShader:Da.meshmatcap_vert,fragmentShader:Da.meshmatcap_frag},points:{uniforms:na([Oa.points,Oa.fog]),vertexShader:Da.points_vert,fragmentShader:Da.points_frag},dashed:{uniforms:na([Oa.common,Oa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Da.linedashed_vert,fragmentShader:Da.linedashed_frag},depth:{uniforms:na([Oa.common,Oa.displacementmap]),vertexShader:Da.depth_vert,fragmentShader:Da.depth_frag},normal:{uniforms:na([Oa.common,Oa.bumpmap,Oa.normalmap,Oa.displacementmap,{opacity:{value:1}}]),vertexShader:Da.normal_vert,fragmentShader:Da.normal_frag},sprite:{uniforms:na([Oa.sprite,Oa.fog]),vertexShader:Da.sprite_vert,fragmentShader:Da.sprite_frag},background:{uniforms:{uvTransform:{value:new lr},t2D:{value:null}},vertexShader:Da.background_vert,fragmentShader:Da.background_frag},cube:{uniforms:na([Oa.envmap,{opacity:{value:1}}]),vertexShader:Da.cube_vert,fragmentShader:Da.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Da.equirect_vert,fragmentShader:Da.equirect_frag},distanceRGBA:{uniforms:na([Oa.common,Oa.displacementmap,{referencePosition:{value:new Tr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Da.distanceRGBA_vert,fragmentShader:Da.distanceRGBA_frag},shadow:{uniforms:na([Oa.lights,Oa.fog,{color:{value:new ai(0)},opacity:{value:1}}]),vertexShader:Da.shadow_vert,fragmentShader:Da.shadow_frag}};function Ba(a,o,r,s,n){var l=new ai(0),u=0,c=void 0,h=void 0,d=null,p=0,f=null;function m(t,e){r.buffers.color.setClear(t.r,t.g,t.b,e,n)}return{getClearColor:function(){return l},setClearColor:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;l.set(t),m(l,u=e)},getClearAlpha:function(){return u},setClearAlpha:function(t){m(l,u=t)},render:function(t,e,r,n){var i=!0===e.isScene?e.background:null;i&&i.isTexture&&(i=o.get(i)),e=(e=a.xr).getSession&&e.getSession(),null===(i=e&&"additive"===e.environmentBlendMode?null:i)?m(l,u):i&&i.isColor&&(m(i,1),n=!0),(a.autoClear||n)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),i&&(i.isCubeTexture||i.isWebGLCubeRenderTarget||i.mapping===B)?(void 0===h&&((h=new Ki(new ta(1,1,1),new sa({name:"BackgroundCubeMaterial",uniforms:ra(Fa.cube.uniforms),vertexShader:Fa.cube.vertexShader,fragmentShader:Fa.cube.fragmentShader,side:j,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(h)),i.isWebGLCubeRenderTarget&&(i=i.texture),h.material.uniforms.envMap.value=i,h.material.uniforms.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,d===i&&p===i.version&&f===a.toneMapping||(h.material.needsUpdate=!0,p=(d=i).version,f=a.toneMapping),t.unshift(h,h.geometry,h.material,0,0,null)):i&&i.isTexture&&(void 0===c&&((c=new Ki(new Ra(2,2),new sa({name:"BackgroundMaterial",uniforms:ra(Fa.background.uniforms),vertexShader:Fa.background.vertexShader,fragmentShader:Fa.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(c)),!0===(c.material.uniforms.t2D.value=i).matrixAutoUpdate&&i.updateMatrix(),c.material.uniforms.uvTransform.value.copy(i.matrix),d===i&&p===i.version&&f===a.toneMapping||(c.material.needsUpdate=!0,p=(d=i).version,f=a.toneMapping),t.unshift(c,c.geometry,c.material,0,0,null))}}}function Na(_,A,w,M){var a=_.getParameter(34921),o=M.isWebGL2?null:A.get("OES_vertex_array_object"),l=M.isWebGL2||null!==o,u={},t=d(null),c=t;function h(t){return M.isWebGL2?_.bindVertexArray(t):o.bindVertexArrayOES(t)}function s(t){return M.isWebGL2?_.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function d(t){for(var e=[],r=[],n=[],i=0;i<a;i++)e[i]=0,r[i]=0,n[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:r,attributeDivisors:n,object:t,attributes:{},index:null}}function C(){for(var t=c.newAttributes,e=0,r=t.length;e<r;e++)t[e]=0}function T(t){S(t,0)}function S(t,e){var r=c.newAttributes,n=c.enabledAttributes,i=c.attributeDivisors;r[t]=1,0===n[t]&&(_.enableVertexAttribArray(t),n[t]=1),i[t]!==e&&((M.isWebGL2?_:A.get("ANGLE_instanced_arrays"))[M.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),i[t]=e)}function E(){for(var t=c.newAttributes,e=c.enabledAttributes,r=0,n=e.length;r<n;r++)e[r]!==t[r]&&(_.disableVertexAttribArray(r),e[r]=0)}function I(t,e,r,n,i,a){!0!==M.isWebGL2||5124!==r&&5125!==r?_.vertexAttribPointer(t,e,r,n,i,a):_.vertexAttribIPointer(t,e,r,i,a)}function p(){e(),c!==t&&h((c=t).object)}function e(){t.geometry=null,t.program=null,t.wireframe=!1}return{setup:function(t,e,r,s,n){var i,a=!1;l?(i=function(t,e,r){var n=!0===r.wireframe,r=u[t.id];void 0===r&&(r={},u[t.id]=r);t=r[e.id];void 0===t&&(t={},r[e.id]=t);e=t[n];void 0===e&&(e=d(M.isWebGL2?_.createVertexArray():o.createVertexArrayOES()),t[n]=e);return e}(s,r,e),c!==i&&h((c=i).object),(a=function(t,e){var r,n=c.attributes,i=t.attributes,a=0;for(r in i){var o=n[r],s=i[r];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;a++}return c.attributesNum!==a||c.index!==e}(s,n))&&function(t){var e,r={},n=s.attributes,i=0;for(e in n){var a=n[e],o={};(o.attribute=a).data&&(o.data=a.data),r[e]=o,i++}c.attributes=r,c.attributesNum=i,c.index=t}(n)):(i=!0===e.wireframe,c.geometry===s.id&&c.program===r.id&&c.wireframe===i||(c.geometry=s.id,c.program=r.id,c.wireframe=i,a=!0)),!0===t.isInstancedMesh&&(a=!0),null!==n&&w.update(n,34963),a&&(function(t,e,r,n){if(!1!==M.isWebGL2||!t.isInstancedMesh&&!n.isInstancedBufferGeometry||null!==A.get("ANGLE_instanced_arrays")){C();var i,a=n.attributes,o=r.getAttributes(),s=e.defaultAttributeValues;for(i in o){var l=o[i];if(0<=l){var u=a[i];if(void 0!==u){var c,h,d,p,f,m=u.normalized,g=u.itemSize,v=w.get(u);void 0!==v&&(c=v.buffer,h=v.type,d=v.bytesPerElement,u.isInterleavedBufferAttribute?(p=u.data,f=p.stride,v=u.offset,p&&p.isInstancedInterleavedBuffer?(S(l,p.meshPerAttribute),void 0===n._maxInstanceCount&&(n._maxInstanceCount=p.meshPerAttribute*p.count)):T(l),_.bindBuffer(34962,c),I(l,g,h,m,f*d,v*d)):(u.isInstancedBufferAttribute?(S(l,u.meshPerAttribute),void 0===n._maxInstanceCount&&(n._maxInstanceCount=u.meshPerAttribute*u.count)):T(l),_.bindBuffer(34962,c),I(l,g,h,m,0,0)))}else if("instanceMatrix"===i){m=w.get(t.instanceMatrix);void 0!==m&&(x=m.buffer,y=m.type,S(l+0,1),S(l+1,1),S(l+2,1),S(l+3,1),_.bindBuffer(34962,x),_.vertexAttribPointer(l+0,4,y,!1,64,0),_.vertexAttribPointer(l+1,4,y,!1,64,16),_.vertexAttribPointer(l+2,4,y,!1,64,32),_.vertexAttribPointer(l+3,4,y,!1,64,48))}else if("instanceColor"===i){var y,x=w.get(t.instanceColor);void 0!==x&&(y=x.buffer,x=x.type,S(l,1),_.bindBuffer(34962,y),_.vertexAttribPointer(l,3,x,!1,12,0))}else if(void 0!==s){var b=s[i];if(void 0!==b)switch(b.length){case 2:_.vertexAttrib2fv(l,b);break;case 3:_.vertexAttrib3fv(l,b);break;case 4:_.vertexAttrib4fv(l,b);break;default:_.vertexAttrib1fv(l,b)}}}}E()}}(t,e,r,s),null!==n&&_.bindBuffer(34963,w.get(n).buffer))},reset:p,resetDefaultState:e,dispose:function(){for(var t in p(),u){var e,r=u[t];for(e in r){var n,i=r[e];for(n in i)s(i[n].object),delete i[n];delete r[e]}delete u[t]}},releaseStatesOfGeometry:function(t){if(void 0!==u[t.id]){var e,r=u[t.id];for(e in r){var n,i=r[e];for(n in i)s(i[n].object),delete i[n];delete r[e]}delete u[t.id]}},releaseStatesOfProgram:function(t){for(var e in u){e=u[e];if(void 0!==e[t.id]){var r,n=e[t.id];for(r in n)s(n[r].object),delete n[r];delete e[t.id]}}},initAttributes:C,enableAttribute:T,disableUnusedAttributes:E}}function za(a,o,s,t){var l=t.isWebGL2,u=void 0;this.setMode=function(t){u=t},this.render=function(t,e){a.drawArrays(u,t,e),s.update(e,u,1)},this.renderInstances=function(t,e,r){if(0!==r){var n=void 0,i=void 0;if(l)n=a,i="drawArraysInstanced";else if(i="drawArraysInstancedANGLE",null===(n=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");n[i](u,t,e,r),s.update(e,u,r)}}}function Ua(e,r,t){var n=void 0;function i(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==t.precision?t.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===t.logarithmicDepthBuffer,u=e.getParameter(34930),c=e.getParameter(35660),h=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),s=0<c,t=a||r.has("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){return void 0!==n?n:n=!0===r.has("EXT_texture_filter_anisotropic")?(t=r.get("EXT_texture_filter_anisotropic"),e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT)):0;var t},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:s,floatFragmentTextures:t,floatVertexTextures:s&&t,maxSamples:a?e.getParameter(36183):0}}function ka(u){var c=this,h=null,d=0,p=!1,f=!1,m=new Nn,g=new lr,v={value:null,needsUpdate:!1};function y(){v.value!==h&&(v.value=h,v.needsUpdate=0<d),c.numPlanes=d,c.numIntersection=0}function x(t,e,r,n){var i=null!==t?t.length:0,a=null;if(0!==i){if(a=v.value,!0!==n||null===a){var n=r+4*i,o=e.matrixWorldInverse;g.getNormalMatrix(o),(null===a||a.length<n)&&(a=new Float32Array(n));for(var s=0,l=r;s!==i;++s,l+=4)m.copy(t[s]).applyMatrix4(o,g),m.normal.toArray(a,l),a[l+3]=m.constant}v.value=a,v.needsUpdate=!0}return c.numPlanes=i,c.numIntersection=0,a}this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,r){var n=0!==t.length||e||0!==d||p;return p=e,h=x(t,r,0),d=t.length,n},this.beginShadows=function(){f=!0,x(null)},this.endShadows=function(){f=!1,y()},this.setState=function(t,e,r){var n=t.clippingPlanes,i=t.clipIntersection,a=t.clipShadows,t=u.get(t);if(!p||null===n||0===n.length||f&&!a)f?x(null):y();else{var a=f?0:d,o=4*a,s=t.clippingState||null;v.value=s;for(var s=x(n,e,o,r),l=0;l!==o;++l)s[l]=h[l];t.clippingState=s,this.numIntersection=i?this.numPlanes:0,this.numPlanes+=a}}}function Ha(n){var i=new WeakMap;function a(t,e){return e===s?t.mapping=O:e===l&&(t.mapping=F),t}function o(t){var e=t.target;e.removeEventListener("dispose",o);t=i.get(e);void 0!==t&&(i.delete(e),t.dispose())}return{get:function(t){if(t&&t.isTexture){var e=t.mapping;if(e===s||e===l){if(i.has(t))return a(i.get(t).texture,t.mapping);var r=t.image;if(r&&0<r.height){e=n.getRenderTarget(),r=new xa(r.height/2);return r.fromEquirectangularTexture(n,t),i.set(t,r),n.setRenderTarget(e),t.addEventListener("dispose",o),a(r.texture,t.mapping)}return null}}return t},dispose:function(){i=new WeakMap}}}function Ga(r){var n={};function i(t){if(void 0!==n[t])return n[t];var e=void 0;switch(t){case"WEBGL_depth_texture":e=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=r.getExtension(t)}return n[t]=e}return{has:function(t){return null!==i(t)},init:function(t){t.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(t){var e=i(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function Va(t,v,n,i){var a={},y=new WeakMap;function o(t){var e,r=t.target;for(e in null!==r.index&&v.remove(r.index),r.attributes)v.remove(r.attributes[e]);r.removeEventListener("dispose",o),delete a[r.id];t=y.get(r);t&&(v.remove(t),y.delete(r)),i.releaseStatesOfGeometry(r),!0===r.isInstancedBufferGeometry&&delete r._maxInstanceCount,n.memory.geometries--}function s(t){var e=[],r=t.index,n=t.attributes.position,i=0;if(null!==r)for(var a=r.array,i=r.version,o=0,s=a.length;o<s;o+=3){var l=a[o+0],u=a[o+1],c=a[o+2];e.push(l,u,u,c,c,l)}else{var h=n.array;i=n.version;for(var d=0,p=h.length/3-1;d<p;d+=3){var f=d+0,m=d+1,g=d+2;e.push(f,m,m,g,g,f)}}h=new(65535<wi(e)?xi:vi)(e,1);h.version=i;i=y.get(t);i&&v.remove(i),y.set(t,h)}return{get:function(t,e){return!0===a[e.id]||(e.addEventListener("dispose",o),a[e.id]=!0,n.memory.geometries++),e},update:function(t){var e,r=t.attributes;for(e in r)v.update(r[e],34962);var n,i=t.morphAttributes;for(n in i)for(var a=i[n],o=0,s=a.length;o<s;o++)v.update(a[o],34962)},getWireframeAttribute:function(t){var e,r=y.get(t);return(!r||null!==(e=t.index)&&r.version<e.version)&&s(t),y.get(t)}}}function Wa(a,o,s,t){var l=t.isWebGL2,u=void 0;var c=void 0,h=void 0;this.setMode=function(t){u=t},this.setIndex=function(t){c=t.type,h=t.bytesPerElement},this.render=function(t,e){a.drawElements(u,e,c,t*h),s.update(e,u,1)},this.renderInstances=function(t,e,r){if(0!==r){var n=void 0,i=void 0;if(l)n=a,i="drawElementsInstanced";else if(i="drawElementsInstancedANGLE",null===(n=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");n[i](u,e,c,t*h,r),s.update(e,u,r)}}}function ja(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,e,r){switch(n.calls++,e){case 4:n.triangles+=r*(t/3);break;case 1:n.lines+=r*(t/2);break;case 3:n.lines+=r*(t-1);break;case 2:n.lines+=r*t;break;case 0:n.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e)}}}}function Xa(t,e){return t[0]-e[0]}function qa(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Ya(v){for(var y={},x=new Float32Array(8),b=[],t=0;t<8;t++)b[t]=[t,0];return{update:function(t,e,r,n){var i=t.morphTargetInfluences,a=void 0===i?0:i.length;if(void 0===(o=y[e.id])){for(var o=[],s=0;s<a;s++)o[s]=[s,0];y[e.id]=o}for(var l=0;l<a;l++){var u=o[l];u[0]=l,u[1]=i[l]}o.sort(qa);for(var c=0;c<8;c++)c<a&&o[c][1]?(b[c][0]=o[c][0],b[c][1]=o[c][1]):(b[c][0]=Number.MAX_SAFE_INTEGER,b[c][1]=0);b.sort(Xa);for(var h=r.morphTargets&&e.morphAttributes.position,d=r.morphNormals&&e.morphAttributes.normal,p=0,f=0;f<8;f++){var m=b[f],g=m[0],m=m[1];g!==Number.MAX_SAFE_INTEGER&&m?(h&&e.getAttribute("morphTarget"+f)!==h[g]&&e.setAttribute("morphTarget"+f,h[g]),d&&e.getAttribute("morphNormal"+f)!==d[g]&&e.setAttribute("morphNormal"+f,d[g]),p+=x[f]=m):(h&&!0===e.hasAttribute("morphTarget"+f)&&e.deleteAttribute("morphTarget"+f),d&&!0===e.hasAttribute("morphNormal"+f)&&e.deleteAttribute("morphNormal"+f),x[f]=0)}r=e.morphTargetsRelative?1:1-p,n.getUniforms().setValue(v,"morphTargetBaseInfluence",r),n.getUniforms().setValue(v,"morphTargetInfluences",x)}}}function Za(t,n,i,a){var o=new WeakMap;function s(t){t=t.target;t.removeEventListener("dispose",s),i.remove(t.instanceMatrix),null!==t.instanceColor&&i.remove(t.instanceColor)}return{update:function(t){var e=a.render.frame,r=t.geometry,r=n.get(t,r);return o.get(r)!==e&&(n.update(r),o.set(r,e)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),i.update(t.instanceMatrix,34962),null!==t.instanceColor&&i.update(t.instanceColor,34962)),r},dispose:function(){o=new WeakMap}}}Fa.physical={uniforms:na([Fa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new or(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ai(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Da.meshphysical_vert,fragmentShader:Da.meshphysical_frag};var Ja,Ka=(a(Qa,Ja=fr),Qa);function Qa(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,Qa);var i=z(this,Ja.call(this,null));return i.image={data:t,width:e,height:r,depth:n},i.magFilter=Mt,i.minFilter=Mt,i.wrapR=H,i.generateMipmaps=!1,i.flipY=!1,i.needsUpdate=!0,i}Ka.prototype.isDataTexture2DArray=!0;var $a,to=(a(eo,$a=fr),eo);function eo(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,eo);var i=z(this,$a.call(this,null));return i.image={data:t,width:e,height:r,depth:n},i.magFilter=Mt,i.minFilter=Mt,i.wrapR=H,i.generateMipmaps=!1,i.flipY=!1,i.needsUpdate=!0,i}to.prototype.isDataTexture3D=!0;var ro=new fr,no=new Ka,io=new to,ao=new ga,oo=[],so=[],lo=new Float32Array(16),uo=new Float32Array(9),co=new Float32Array(4);function ho(t,e,r){var n=t[0];if(n<=0||0<n)return t;var i=e*r,a=oo[i];if(void 0===a&&(a=new Float32Array(i),oo[i]=a),0!==e){n.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=r,t[o].toArray(a,s)}return a}function po(t,e){if(t.length===e.length){for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return;return 1}}function fo(t,e){for(var r=0,n=e.length;r<n;r++)t[r]=e[r]}function mo(t,e){var r=so[e];void 0===r&&(r=new Int32Array(e),so[e]=r);for(var n=0;n!==e;++n)r[n]=t.allocateTextureUnit();return r}function go(t,e){var r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function vo(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y):po(r,e)||(t.uniform2fv(this.addr,e),fo(r,e))}function yo(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z):void 0!==e.r?r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b):po(r,e)||(t.uniform3fv(this.addr,e),fo(r,e))}function xo(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w):po(r,e)||(t.uniform4fv(this.addr,e),fo(r,e))}function bo(t,e){var r=this.cache,n=e.elements;void 0===n?po(r,e)||(t.uniformMatrix2fv(this.addr,!1,e),fo(r,e)):po(r,n)||(co.set(n),t.uniformMatrix2fv(this.addr,!1,co),fo(r,n))}function _o(t,e){var r=this.cache,n=e.elements;void 0===n?po(r,e)||(t.uniformMatrix3fv(this.addr,!1,e),fo(r,e)):po(r,n)||(uo.set(n),t.uniformMatrix3fv(this.addr,!1,uo),fo(r,n))}function Ao(t,e){var r=this.cache,n=e.elements;void 0===n?po(r,e)||(t.uniformMatrix4fv(this.addr,!1,e),fo(r,e)):po(r,n)||(lo.set(n),t.uniformMatrix4fv(this.addr,!1,lo),fo(r,n))}function wo(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTexture2D(e||ro,i)}function Mo(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(e||no,i)}function Co(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(e||io,i)}function To(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTextureCube(e||ao,i)}function So(t,e){var r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function Eo(t,e){var r=this.cache;po(r,e)||(t.uniform2iv(this.addr,e),fo(r,e))}function Io(t,e){var r=this.cache;po(r,e)||(t.uniform3iv(this.addr,e),fo(r,e))}function Lo(t,e){var r=this.cache;po(r,e)||(t.uniform4iv(this.addr,e),fo(r,e))}function Ro(t,e){var r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function Po(t,e){t.uniform1fv(this.addr,e)}function Do(t,e){t.uniform1iv(this.addr,e)}function Oo(t,e){t.uniform2iv(this.addr,e)}function Fo(t,e){t.uniform3iv(this.addr,e)}function Bo(t,e){t.uniform4iv(this.addr,e)}function No(t,e){e=ho(e,this.size,2);t.uniform2fv(this.addr,e)}function zo(t,e){e=ho(e,this.size,3);t.uniform3fv(this.addr,e)}function Uo(t,e){e=ho(e,this.size,4);t.uniform4fv(this.addr,e)}function ko(t,e){e=ho(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,e)}function Ho(t,e){e=ho(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,e)}function Go(t,e){e=ho(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,e)}function Vo(t,e,r){var n=e.length,i=mo(r,n);t.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.safeSetTexture2D(e[a]||ro,i[a])}function Wo(t,e,r){var n=e.length,i=mo(r,n);t.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.safeSetTextureCube(e[a]||ao,i[a])}function jo(t,e,r){this.id=t,this.addr=r,this.cache=[],this.setValue=function(t){switch(t){case 5126:return go;case 35664:return vo;case 35665:return yo;case 35666:return xo;case 35674:return bo;case 35675:return _o;case 35676:return Ao;case 5124:case 35670:return So;case 35667:case 35671:return Eo;case 35668:case 35672:return Io;case 35669:case 35673:return Lo;case 5125:return Ro;case 35678:case 36198:case 36298:case 36306:case 35682:return wo;case 35679:case 36299:case 36307:return Co;case 35680:case 36300:case 36308:case 36293:return To;case 36289:case 36303:case 36311:case 36292:return Mo}}(e.type)}function Xo(t,e,r){this.id=t,this.addr=r,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Po;case 35664:return No;case 35665:return zo;case 35666:return Uo;case 35674:return ko;case 35675:return Ho;case 35676:return Go;case 5124:case 35670:return Do;case 35667:case 35671:return Oo;case 35668:case 35672:return Fo;case 35669:case 35673:return Bo;case 35678:case 36198:case 36298:case 36306:case 35682:return Vo;case 35680:case 36300:case 36308:case 36293:return Wo}}(e.type)}function qo(t){this.id=t,this.seq=[],this.map={}}Xo.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),fo(e,t)},qo.prototype.setValue=function(t,e,r){for(var n=this.seq,i=0,a=n.length;i!==a;++i){var o=n[i];o.setValue(t,e[o.id],r)}};var Yo=/(\w+)(\])?(\[|\.)?/g;function Zo(t,e){t.seq.push(e),t.map[e.id]=e}function Jo(t,e){this.seq=[],this.map={};for(var r=t.getProgramParameter(e,35718),n=0;n<r;++n){var i=t.getActiveUniform(e,n);!function(t,e,r){var n=t.name,i=n.length;for(Yo.lastIndex=0;;){var a=Yo.exec(n),o=Yo.lastIndex,s=a[1],l="]"===a[2],a=a[3];if(l&&(s|=0),void 0===a||"["===a&&o+2===i){Zo(r,new(void 0===a?jo:Xo)(s,t,e));break}a=r.map[s];void 0===a&&Zo(r,a=new qo(s)),r=a}}(i,t.getUniformLocation(e,i.name),this)}}function Ko(t,e,r){e=t.createShader(e);return t.shaderSource(e,r),t.compileShader(e),e}Jo.prototype.setValue=function(t,e,r,n){e=this.map[e];void 0!==e&&e.setValue(t,r,n)},Jo.prototype.setOptional=function(t,e,r){e=e[r];void 0!==e&&this.setValue(t,r,e)},Jo.upload=function(t,e,r,n){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=r[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},Jo.seqWithValue=function(t,e){for(var r=[],n=0,i=t.length;n!==i;++n){var a=t[n];a.id in e&&r.push(a)}return r};var Qo=0;function $o(t){switch(t){case ze:return["Linear","( value )"];case Ue:return["sRGB","( value )"];case He:return["RGBE","( value )"];case Ve:return["RGBM","( value, 7.0 )"];case We:return["RGBM","( value, 16.0 )"];case je:return["RGBD","( value, 256.0 )"];case ke:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Ge:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function ts(t,e,r){var n=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return n&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+function(t){for(var e=t.split("\n"),r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join("\n")}(t.getShaderSource(e))}function es(t,e){e=$o(e);return"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function rs(t){return""!==t}function ns(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function is(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var as=/^[ \t]*#include +<([\w\d./]+)>/gm;function os(t){return t.replace(as,ss)}function ss(t,e){var r=Da[e];if(void 0===r)throw new Error("Can not resolve #include <"+e+">");return os(r)}var ls=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,us=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function cs(t){return t.replace(us,ds).replace(ls,hs)}function hs(t,e,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ds(0,e,r,n)}function ds(t,e,r,n){for(var i="",a=parseInt(e);a<parseInt(r);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function ps(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function fs(t,e,r,n){var i=t.getContext(),a=r.defines,o=r.vertexShader,s=r.fragmentShader,l=(g="SHADOWMAP_TYPE_BASIC",(f=r).shadowMapType===I?g="SHADOWMAP_TYPE_PCF":f.shadowMapType===A?g="SHADOWMAP_TYPE_PCF_SOFT":f.shadowMapType===L&&(g="SHADOWMAP_TYPE_VSM"),g),u=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case O:case F:e="ENVMAP_TYPE_CUBE";break;case B:case N:e="ENVMAP_TYPE_CUBE_UV"}return e}(r),c=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case F:case N:e="ENVMAP_MODE_REFRACTION"}return e}(r),h=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case w:e="ENVMAP_BLENDING_MULTIPLY";break;case M:e="ENVMAP_BLENDING_MIX";break;case C:e="ENVMAP_BLENDING_ADD"}return e}(r),d=0<t.gammaFactor?t.gammaFactor:1,p=r.isWebGL2?"":[(v=r).extensionDerivatives||v.envMapCubeUV||v.bumpMap||v.tangentSpaceNormalMap||v.clearcoatNormalMap||v.flatShading||"physical"===v.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(v.extensionFragDepth||v.logarithmicDepthBuffer)&&v.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",v.extensionDrawBuffers&&v.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(v.extensionShaderTextureLOD||v.envMap)&&v.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(rs).join("\n"),f=function(t){var e,r=[];for(e in t){var n=t[e];!1!==n&&r.push("#define "+e+" "+n)}return r.join("\n")}(a),m=i.createProgram(),g=void 0,v=void 0,a=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(0<(g=[f].filter(rs).join("\n")).length&&(g+="\n"),0<(v=[p,f].filter(rs).join("\n")).length&&(v+="\n")):(g=[ps(r),"#define SHADER_NAME "+r.shaderName,f,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(rs).join("\n"),v=[p,ps(r),"#define SHADER_NAME "+r.shaderName,f,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+c:"",r.envMap?"#define "+h:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Tt?"#define TONE_MAPPING":"",r.toneMapping!==Tt?Da.tonemapping_pars_fragment:"",r.toneMapping!==Tt?function(t,e){var r=void 0;switch(e){case T:r="Linear";break;case S:r="Reinhard";break;case R:r="OptimizedCineon";break;case P:r="ACESFilmic";break;case D:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",Da.encodings_pars_fragment,r.map?es("mapTexelToLinear",r.mapEncoding):"",r.matcap?es("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?es("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?es("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?es("lightMapTexelToLinear",r.lightMapEncoding):"",(y="linearToOutputTexel",x=$o(x=r.outputEncoding),"vec4 "+y+"( vec4 value ) { return LinearTo"+x[0]+x[1]+"; }"),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(rs).join("\n")),o=is(o=ns(o=os(o),r),r),s=is(s=ns(s=os(s),r),r),o=cs(o),s=cs(s),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(a="#version 300 es\n",g=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",r.glslVersion===tr?"":"out highp vec4 pc_fragColor;",r.glslVersion===tr?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);var y,x,c=a+v+s,h=Ko(i,35633,a+g+o),l=Ko(i,35632,c);i.attachShader(m,h),i.attachShader(m,l),void 0!==r.index0AttributeName?i.bindAttribLocation(m,0,r.index0AttributeName):!0===r.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),t.debug.checkShaderErrors&&(y=i.getProgramInfoLog(m).trim(),x=i.getShaderInfoLog(h).trim(),s=i.getShaderInfoLog(l).trim(),!(o=a=!0)===i.getProgramParameter(m,35714)?(a=!1,c=ts(i,h,"vertex"),t=ts(i,l,"fragment"),console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(m,35715),"gl.getProgramInfoLog",y,c,t)):""!==y?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",y):""!==x&&""!==s||(o=!1),o&&(this.diagnostics={runnable:a,programLog:y,vertexShader:{log:x,prefix:g},fragmentShader:{log:s,prefix:v}})),i.deleteShader(h),i.deleteShader(l);var b=void 0;this.getUniforms=function(){return b=void 0===b?new Jo(i,m):b};var _=void 0;return this.getAttributes=function(){return _=void 0===_?function(t,e){for(var r={},n=t.getProgramParameter(e,35721),i=0;i<n;i++){var a=t.getActiveAttrib(e,i).name;r[a]=t.getAttribLocation(e,a)}return r}(i,m):_},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=Qo++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=h,this.fragmentShader=l,this}function ms(h,d,p,f,o,m){var s=[],g=f.isWebGL2,v=f.logarithmicDepthBuffer,y=f.floatVertexTextures,x=f.maxVertexUniforms,b=f.vertexTextures,_=f.precision,A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},i=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function w(t){return t&&t.isTexture?t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t.texture.encoding):ze}return{getParameters:function(t,e,r,n,i){var a=n.fog,o=t.isMeshStandardMaterial?n.environment:null,s=d.get(t.envMap||o),n=A[t.type],o=i.isSkinnedMesh?(l=(u=i).skeleton.bones,y?1024:(u=Math.floor((x-20)/4),(u=Math.min(u,l.length))<l.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+l.length+" bones. This GPU supports "+u+"."),0):u)):0;null!==t.precision&&(_=f.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",_,"instead.");var l=void 0,u=void 0;u=n?(l=(c=Fa[n]).vertexShader,c.fragmentShader):(l=t.vertexShader,t.fragmentShader);var c=h.getRenderTarget();return{isWebGL2:g,shaderID:n,shaderName:t.type,vertexShader:l,fragmentShader:u,defines:t.defines,isRawShaderMaterial:!0===t.isRawShaderMaterial,glslVersion:t.glslVersion,precision:_,instancing:!0===i.isInstancedMesh,instancingColor:!0===i.isInstancedMesh&&null!==i.instanceColor,supportsVertexTextures:b,outputEncoding:null!==c?w(c.texture):h.outputEncoding,map:!!t.map,mapEncoding:w(t.map),matcap:!!t.matcap,matcapEncoding:w(t.matcap),envMap:!!s,envMapMode:s&&s.mapping,envMapEncoding:w(s),envMapCubeUV:!!s&&(s.mapping===B||s.mapping===N),lightMap:!!t.lightMap,lightMapEncoding:w(t.lightMap),aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:w(t.emissiveMap),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===Ze,tangentSpaceNormalMap:t.normalMapType===Ye,clearcoatMap:!!t.clearcoatMap,clearcoatRoughnessMap:!!t.clearcoatRoughnessMap,clearcoatNormalMap:!!t.clearcoatNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,sheen:!!t.sheen,transmissionMap:!!t.transmissionMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,vertexUvs:!!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatMap||t.clearcoatRoughnessMap||t.clearcoatNormalMap||t.displacementMap||t.transmissionMap),uvsVertexOnly:!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap||t.transmissionMap||!t.displacementMap),fog:!!a,useFog:t.fog,fogExp2:a&&a.isFogExp2,flatShading:!!t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:v,skinning:t.skinning&&0<o,maxBones:o,useVertexTexture:y,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:h.maxMorphTargets,maxMorphNormals:h.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numDirLightShadows:e.directionalShadowMap.length,numPointLightShadows:e.pointShadowMap.length,numSpotLightShadows:e.spotShadowMap.length,numClippingPlanes:m.numPlanes,numClipIntersection:m.numIntersection,dithering:t.dithering,shadowMapEnabled:h.shadowMap.enabled&&0<r.length,shadowMapType:h.shadowMap.type,toneMapping:t.toneMapped?h.toneMapping:Tt,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===X,flipSided:t.side===j,depthPacking:void 0!==t.depthPacking&&t.depthPacking,index0AttributeName:t.index0AttributeName,extensionDerivatives:t.extensions&&t.extensions.derivatives,extensionFragDepth:t.extensions&&t.extensions.fragDepth,extensionDrawBuffers:t.extensions&&t.extensions.drawBuffers,extensionShaderTextureLOD:t.extensions&&t.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||p.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||p.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||p.has("EXT_shader_texture_lod"),customProgramCacheKey:t.customProgramCacheKey()}},getProgramCacheKey:function(t){var e=[];if(t.shaderID?e.push(t.shaderID):(e.push(t.fragmentShader),e.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)e.push(r),e.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var n=0;n<i.length;n++)e.push(t[i[n]]);e.push(h.outputEncoding),e.push(h.gammaFactor)}return e.push(t.customProgramCacheKey),e.join()},getUniforms:function(t){var e=A[t.type];return e?(e=Fa[e],ia.clone(e.uniforms)):t.uniforms},acquireProgram:function(t,e){for(var r=void 0,n=0,i=s.length;n<i;n++){var a=s[n];if(a.cacheKey===e){++(r=a).usedTimes;break}}return void 0===r&&(r=new fs(h,e,t,o),s.push(r)),r},releaseProgram:function(t){var e;0==--t.usedTimes&&(e=s.indexOf(t),s[e]=s[s.length-1],s.pop(),t.destroy())},programs:s}}function gs(){var n=new WeakMap;return{get:function(t){var e=n.get(t);return void 0===e&&(e={},n.set(t,e)),e},remove:function(t){n.delete(t)},update:function(t,e,r){n.get(t)[e]=r},dispose:function(){n=new WeakMap}}}function vs(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ys(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function xs(l){var u=[],c=0,o=[],s=[],h={id:-1};function d(t,e,r,n,i,a){var o=u[c],s=l.get(r);return void 0===o?(o={id:t.id,object:t,geometry:e,material:r,program:s.program||h,groupOrder:n,renderOrder:t.renderOrder,z:i,group:a},u[c]=o):(o.id=t.id,o.object=t,o.geometry=e,o.material=r,o.program=s.program||h,o.groupOrder=n,o.renderOrder=t.renderOrder,o.z=i,o.group=a),c++,o}return{opaque:o,transparent:s,init:function(){c=0,o.length=0,s.length=0},push:function(t,e,r,n,i,a){a=d(t,e,r,n,i,a),(!0===r.transparent?s:o).push(a)},unshift:function(t,e,r,n,i,a){a=d(t,e,r,n,i,a),(!0===r.transparent?s:o).unshift(a)},finish:function(){for(var t=c,e=u.length;t<e;t++){var r=u[t];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(t,e){1<o.length&&o.sort(t||vs),1<s.length&&s.sort(e||ys)}}}function bs(n){var i=new WeakMap;return{get:function(t,e){var r=void 0;return!1===i.has(t)?(r=new xs(n),i.set(t,[r])):e>=i.get(t).length?(r=new xs(n),i.get(t).push(r)):r=i.get(t)[e],r},dispose:function(){i=new WeakMap}}}function _s(){var r={};return{get:function(t){if(void 0!==r[t.id])return r[t.id];var e=void 0;switch(t.type){case"DirectionalLight":e={direction:new Tr,color:new ai};break;case"SpotLight":e={position:new Tr,direction:new Tr,color:new ai,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new Tr,color:new ai,distance:0,decay:0};break;case"HemisphereLight":e={direction:new Tr,skyColor:new ai,groundColor:new ai};break;case"RectAreaLight":e={color:new ai,position:new Tr,halfWidth:new Tr,halfHeight:new Tr}}return r[t.id]=e}}}var As=0;function ws(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Ms(S,E){for(var r,I=new _s,L=(r={},{get:function(t){if(void 0!==r[t.id])return r[t.id];var e=void 0;switch(t.type){case"DirectionalLight":case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new or};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new or,shadowCameraNear:1,shadowCameraFar:1e3}}return r[t.id]=e}}),R={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},t=0;t<9;t++)R.probe.push(new Tr);var f=new Tr,m=new an,g=new an;return{setup:function(t){for(var e=0,r=0,n=0,i=0;i<9;i++)R.probe[i].set(0,0,0);var a=0,o=0,s=0,l=0,u=0,c=0,h=0,d=0;t.sort(ws);for(var p=0,f=t.length;p<f;p++){var m,g,v,y,x,b=t[p],_=b.color,A=b.intensity,w=b.distance,M=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)e+=_.r*A,r+=_.g*A,n+=_.b*A;else if(b.isLightProbe)for(var C=0;C<9;C++)R.probe[C].addScaledVector(b.sh.coefficients[C],A);else b.isDirectionalLight?((v=I.get(b)).color.copy(b.color).multiplyScalar(b.intensity),b.castShadow&&(m=b.shadow,(g=L.get(b)).shadowBias=m.bias,g.shadowNormalBias=m.normalBias,g.shadowRadius=m.radius,g.shadowMapSize=m.mapSize,R.directionalShadow[a]=g,R.directionalShadowMap[a]=M,R.directionalShadowMatrix[a]=b.shadow.matrix,c++),R.directional[a]=v,a++):b.isSpotLight?((g=I.get(b)).position.setFromMatrixPosition(b.matrixWorld),g.color.copy(_).multiplyScalar(A),g.distance=w,g.coneCos=Math.cos(b.angle),g.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),g.decay=b.decay,b.castShadow&&(v=b.shadow,(w=L.get(b)).shadowBias=v.bias,w.shadowNormalBias=v.normalBias,w.shadowRadius=v.radius,w.shadowMapSize=v.mapSize,R.spotShadow[s]=w,R.spotShadowMap[s]=M,R.spotShadowMatrix[s]=b.shadow.matrix,d++),R.spot[s]=g,s++):b.isRectAreaLight?((y=I.get(b)).color.copy(_).multiplyScalar(A),y.halfWidth.set(.5*b.width,0,0),y.halfHeight.set(0,.5*b.height,0),R.rectArea[l]=y,l++):b.isPointLight?((x=I.get(b)).color.copy(b.color).multiplyScalar(b.intensity),x.distance=b.distance,x.decay=b.decay,b.castShadow&&(_=b.shadow,(y=L.get(b)).shadowBias=_.bias,y.shadowNormalBias=_.normalBias,y.shadowRadius=_.radius,y.shadowMapSize=_.mapSize,y.shadowCameraNear=_.camera.near,y.shadowCameraFar=_.camera.far,R.pointShadow[o]=y,R.pointShadowMap[o]=M,R.pointShadowMatrix[o]=b.shadow.matrix,h++),R.point[o]=x,o++):b.isHemisphereLight&&((x=I.get(b)).skyColor.copy(b.color).multiplyScalar(A),x.groundColor.copy(b.groundColor).multiplyScalar(A),R.hemi[u]=x,u++)}0<l&&(E.isWebGL2||!0===S.has("OES_texture_float_linear")?(R.rectAreaLTC1=Oa.LTC_FLOAT_1,R.rectAreaLTC2=Oa.LTC_FLOAT_2):!0===S.has("OES_texture_half_float_linear")?(R.rectAreaLTC1=Oa.LTC_HALF_1,R.rectAreaLTC2=Oa.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),R.ambient[0]=e,R.ambient[1]=r,R.ambient[2]=n;var T=R.hash;T.directionalLength===a&&T.pointLength===o&&T.spotLength===s&&T.rectAreaLength===l&&T.hemiLength===u&&T.numDirectionalShadows===c&&T.numPointShadows===h&&T.numSpotShadows===d||(R.directional.length=a,R.spot.length=s,R.rectArea.length=l,R.point.length=o,R.hemi.length=u,R.directionalShadow.length=c,R.directionalShadowMap.length=c,R.pointShadow.length=h,R.pointShadowMap.length=h,R.spotShadow.length=d,R.spotShadowMap.length=d,R.directionalShadowMatrix.length=c,R.pointShadowMatrix.length=h,R.spotShadowMatrix.length=d,T.directionalLength=a,T.pointLength=o,T.spotLength=s,T.rectAreaLength=l,T.hemiLength=u,T.numDirectionalShadows=c,T.numPointShadows=h,T.numSpotShadows=d,R.version=As++)},setupView:function(t,e){for(var r=0,n=0,i=0,a=0,o=0,s=e.matrixWorldInverse,l=0,u=t.length;l<u;l++){var c,h,d,p=t[l];p.isDirectionalLight?((c=R.directional[r]).direction.setFromMatrixPosition(p.matrixWorld),f.setFromMatrixPosition(p.target.matrixWorld),c.direction.sub(f),c.direction.transformDirection(s),r++):p.isSpotLight?((h=R.spot[i]).position.setFromMatrixPosition(p.matrixWorld),h.position.applyMatrix4(s),h.direction.setFromMatrixPosition(p.matrixWorld),f.setFromMatrixPosition(p.target.matrixWorld),h.direction.sub(f),h.direction.transformDirection(s),i++):p.isRectAreaLight?((h=R.rectArea[a]).position.setFromMatrixPosition(p.matrixWorld),h.position.applyMatrix4(s),g.identity(),m.copy(p.matrixWorld),m.premultiply(s),g.extractRotation(m),h.halfWidth.set(.5*p.width,0,0),h.halfHeight.set(0,.5*p.height,0),h.halfWidth.applyMatrix4(g),h.halfHeight.applyMatrix4(g),a++):p.isPointLight?((d=R.point[n]).position.setFromMatrixPosition(p.matrixWorld),d.position.applyMatrix4(s),n++):p.isHemisphereLight&&((d=R.hemi[o]).direction.setFromMatrixPosition(p.matrixWorld),d.direction.transformDirection(s),d.direction.normalize(),o++)}},state:R}}function Cs(t,e){var r=new Ms(t,e),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(){r.setup(n)},setupLightsView:function(t){r.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){i.push(t)}}}function Ts(n,i){var a=new WeakMap;return{get:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=void 0;return!1===a.has(t)?(r=new Cs(n,i),a.set(t,[r])):e>=a.get(t).length?(r=new Cs(n,i),a.get(t).push(r)):r=a.get(t)[e],r},dispose:function(){a=new WeakMap}}}var Ss,Es=(a(Is,Ss=Qn),Is.prototype.copy=function(t){return Ss.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Is);function Is(t){U(this,Is);var e=z(this,Ss.call(this));return e.type="MeshDepthMaterial",e.depthPacking=Xe,e.skinning=!1,e.morphTargets=!1,e.map=null,e.alphaMap=null,e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.wireframe=!1,e.wireframeLinewidth=1,e.fog=!1,e.setValues(t),e}Es.prototype.isMeshDepthMaterial=!0;var Ls,Rs=(a(Ps,Ls=Qn),Ps.prototype.copy=function(t){return Ls.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Ps);function Ps(t){U(this,Ps);var e=z(this,Ls.call(this));return e.type="MeshDistanceMaterial",e.referencePosition=new Tr,e.nearDistance=1,e.farDistance=1e3,e.skinning=!1,e.morphTargets=!1,e.map=null,e.alphaMap=null,e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.fog=!1,e.setValues(t),e}Rs.prototype.isMeshDistanceMaterial=!0;var Ds="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Os="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function Fs(v,y,x){var b=new Ta,_=new or,A=new or,w=new vr,i=[],a=[],d={},p={0:j,1:g,2:X},M=new sa({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new or},radius:{value:4}},vertexShader:Os,fragmentShader:Ds}),C=M.clone();C.defines.HORIZONTAL_PASS=1;var t=new Di;t.setAttribute("position",new di(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var T=new Ki(t,M),S=this;function f(t,e,r){var n=t<<0|e<<1|r<<2,r=i[n];return void 0===r&&(r=new Es({depthPacking:qe,morphTargets:t,skinning:e}),i[n]=r),r}function m(t,e,r){var n=t<<0|e<<1|r<<2,r=a[n];return void 0===r&&(r=new Rs({morphTargets:t,skinning:e}),a[n]=r),r}function E(t,e,r,n,i,a,o){var s,l,u=null,c=f,h=t.customDepthMaterial;return!0===n.isPointLight&&(c=m,h=t.customDistanceMaterial),u=void 0===h?(!(s=!1)===r.morphTargets&&(s=e.morphAttributes&&e.morphAttributes.position&&0<e.morphAttributes.position.length),!(l=!1)===t.isSkinnedMesh&&(!0===r.skinning?l=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),c(s,l,!0===t.isInstancedMesh)):h,v.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length&&(l=u.uuid,t=r.uuid,void 0===(h=d[l])&&(h={},d[l]=h),void 0===(l=h[t])&&(l=u.clone(),h[t]=l),u=l),u.visible=r.visible,u.wireframe=r.wireframe,u.side=o===L?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:p[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===n.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(n.matrixWorld),u.nearDistance=i,u.farDistance=a),u}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=I,this.render=function(t,e,r){if(!1!==S.enabled&&(!1!==S.autoUpdate||!1!==S.needsUpdate)&&0!==t.length){var n=v.getRenderTarget(),i=v.getActiveCubeFace(),a=v.getActiveMipmapLevel(),o=v.state;o.setBlending(q),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var s=0,l=t.length;s<l;s++){var u=t[s],c=u.shadow;if(void 0!==c){if(!1!==c.autoUpdate||!1!==c.needsUpdate){_.copy(c.mapSize);var h,d,p=c.getFrameExtents();_.multiply(p),A.copy(c.mapSize),(_.x>x||_.y>x)&&(_.x>x&&(A.x=Math.floor(x/p.x),_.x=A.x*p.x,c.mapSize.x=A.x),_.y>x&&(A.y=Math.floor(x/p.y),_.y=A.y*p.y,c.mapSize.y=A.y)),null!==c.map||c.isPointLightShadow||this.type!==L||(h={minFilter:Et,magFilter:Et,format:zt},c.map=new _r(_.x,_.y,h),c.map.texture.name=u.name+".shadowMap",c.mapPass=new _r(_.x,_.y,h),c.camera.updateProjectionMatrix()),null===c.map&&(d={minFilter:Mt,magFilter:Mt,format:zt},c.map=new _r(_.x,_.y,d),c.map.texture.name=u.name+".shadowMap",c.camera.updateProjectionMatrix()),v.setRenderTarget(c.map),v.clear();for(var f=c.getViewportCount(),m=0;m<f;m++){var g=c.getViewport(m);w.set(A.x*g.x,A.y*g.y,A.x*g.z,A.y*g.w),o.viewport(w),c.updateMatrices(u,m),b=c.getFrustum(),function t(e,r,n,i,a){if(!1===e.visible)return;var o=e.layers.test(r.layers);if(o&&(e.isMesh||e.isLine||e.isPoints)&&(e.castShadow||e.receiveShadow&&a===L)&&(!e.frustumCulled||b.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var s=y.update(e),l=e.material;if(Array.isArray(l))for(var u=s.groups,c=0,h=u.length;c<h;c++){var d=u[c],p=l[d.materialIndex];p&&p.visible&&(p=E(e,s,p,i,n.near,n.far,a),v.renderBufferDirect(n,null,s,p,e,d))}else l.visible&&(o=E(e,s,l,i,n.near,n.far,a),v.renderBufferDirect(n,null,s,o,e,null))}var f=e.children;for(var m=0,g=f.length;m<g;m++)t(f[m],r,n,i,a)}(e,r,c.camera,u,this.type)}c.isPointLightShadow||this.type!==L||(p=c,h=r,d=void 0,d=y.update(T),M.uniforms.shadow_pass.value=p.map.texture,M.uniforms.resolution.value=p.mapSize,M.uniforms.radius.value=p.radius,v.setRenderTarget(p.mapPass),v.clear(),v.renderBufferDirect(h,null,d,M,T,null),C.uniforms.shadow_pass.value=p.mapPass.texture,C.uniforms.resolution.value=p.mapSize,C.uniforms.radius.value=p.radius,v.setRenderTarget(p.map),v.clear(),v.renderBufferDirect(h,null,d,C,T,null)),c.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",u,"has no shadow.")}S.needsUpdate=!1,v.setRenderTarget(n,i,a)}}}function Bs(c,t,e){var r=e.isWebGL2;var n=new function(){var e=!1,a=new vr,r=null,o=new vr(0,0,0,0);return{setMask:function(t){r===t||e||(c.colorMask(t,t,t,t),r=t)},setLocked:function(t){e=t},setClear:function(t,e,r,n,i){!0===i&&(t*=n,e*=n,r*=n),a.set(t,e,r,n),!1===o.equals(a)&&(c.clearColor(t,e,r,n),o.copy(a))},reset:function(){e=!1,r=null,o.set(-1,0,0,0)}}},i=new function(){var e=!1,r=null,n=null,i=null;return{setTest:function(t){(t?P:D)(2929)},setMask:function(t){r===t||e||(c.depthMask(t),r=t)},setFunc:function(t){if(n!==t){if(t)switch(t){case mt:c.depthFunc(512);break;case gt:c.depthFunc(519);break;case vt:c.depthFunc(513);break;case yt:c.depthFunc(515);break;case xt:c.depthFunc(514);break;case bt:c.depthFunc(518);break;case _t:c.depthFunc(516);break;case At:c.depthFunc(517);break;default:c.depthFunc(515)}else c.depthFunc(515);n=t}},setLocked:function(t){e=t},setClear:function(t){i!==t&&(c.clearDepth(t),i=t)},reset:function(){e=!1,i=n=r=null}}},a=new function(){var e=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?P:D)(2960)},setMask:function(t){r===t||e||(c.stencilMask(t),r=t)},setFunc:function(t,e,r){n===t&&i===e&&a===r||(c.stencilFunc(t,e,r),n=t,i=e,a=r)},setOp:function(t,e,r){o===t&&s===e&&l===r||(c.stencilOp(t,e,r),o=t,s=e,l=r)},setLocked:function(t){e=t},setClear:function(t){u!==t&&(c.clearStencil(t),u=t)},reset:function(){e=!1,u=l=s=o=a=i=n=r=null}}},o={},s=null,l=!1,u=null,h=null,d=null,p=null,f=null,m=null,g=null,v=!1,y=null,x=null,b=null,_=null,A=null,w=c.getParameter(35661),M=!1,C=0,e=c.getParameter(7938);-1!==e.indexOf("WebGL")?(C=parseFloat(/^WebGL (\d)/.exec(e)[1]),M=1<=C):-1!==e.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(e)[1]),M=2<=C);var T=null,S={},E=new vr,I=new vr;function L(t,e,r){var n=new Uint8Array(4),i=c.createTexture();c.bindTexture(t,i),c.texParameteri(t,10241,9728),c.texParameteri(t,10240,9728);for(var a=0;a<r;a++)c.texImage2D(e+a,0,6408,1,1,0,6408,5121,n);return i}var R={};function P(t){!0!==o[t]&&(c.enable(t),o[t]=!0)}function D(t){!1!==o[t]&&(c.disable(t),o[t]=!1)}R[3553]=L(3553,3553,1),R[34067]=L(34067,34069,6),n.setClear(0,0,0,1),i.setClear(1),a.setClear(0),P(2929),i.setFunc(yt),z(!1),U(V),P(2884),N(q);var O,F=((C={})[$]=32774,C[tt]=32778,C[et]=32779,C);r?(F[rt]=32775,F[nt]=32776):null!==(O=t.get("EXT_blend_minmax"))&&(F[rt]=O.MIN_EXT,F[nt]=O.MAX_EXT);var B=((O={})[it]=0,O[at]=1,O[ot]=768,O[lt]=770,O[ft]=776,O[dt]=774,O[ct]=772,O[st]=769,O[ut]=771,O[pt]=775,O[ht]=773,O);function N(t,e,r,n,i,a,o,s){if(t!==q){if(!1===l&&(P(3042),l=!0),t===Q)i=i||e,a=a||r,o=o||n,e===h&&i===f||(c.blendEquationSeparate(F[e],F[i]),h=e,f=i),r===d&&n===p&&a===m&&o===g||(c.blendFuncSeparate(B[r],B[n],B[a],B[o]),d=r,p=n,m=a,g=o),u=t,v=null;else if(t!==u||s!==v){if(h===$&&f===$||(c.blendEquation(32774),f=h=$),s)switch(t){case Y:c.blendFuncSeparate(1,771,1,771);break;case Z:c.blendFunc(1,1);break;case J:c.blendFuncSeparate(0,0,769,771);break;case K:c.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Y:c.blendFuncSeparate(770,771,1,771);break;case Z:c.blendFunc(770,1);break;case J:c.blendFunc(0,769);break;case K:c.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=m=p=d=null,u=t,v=s}}else!0===l&&(D(3042),l=!1)}function z(t){y!==t&&(t?c.frontFace(2304):c.frontFace(2305),y=t)}function U(t){t!==G?(P(2884),t!==x&&(t===V?c.cullFace(1029):t===W?c.cullFace(1028):c.cullFace(1032))):D(2884),x=t}function k(t,e,r){t?(P(32823),_===e&&A===r||(c.polygonOffset(e,r),_=e,A=r)):D(32823)}function H(t){T!==(t=void 0===t?33984+w-1:t)&&(c.activeTexture(t),T=t)}return{buffers:{color:n,depth:i,stencil:a},enable:P,disable:D,useProgram:function(t){return s!==t&&(c.useProgram(t),s=t,!0)},setBlending:N,setMaterial:function(t,e){(t.side===X?D:P)(2884);var r=t.side===j;z(r=e?!r:r),t.blending===Y&&!1===t.transparent?N(q):N(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite),r=t.stencilWrite,a.setTest(r),r&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),k(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:z,setCullFace:U,setLineWidth:function(t){t!==b&&(M&&c.lineWidth(t),b=t)},setPolygonOffset:k,setScissorTest:function(t){(t?P:D)(3089)},activeTexture:H,bindTexture:function(t,e){null===T&&H();var r=S[T];void 0===r&&(r={type:void 0,texture:void 0},S[T]=r),r.type===t&&r.texture===e||(c.bindTexture(t,e||R[t]),r.type=t,r.texture=e)},unbindTexture:function(){var t=S[T];void 0!==t&&void 0!==t.type&&(c.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{c.compressedTexImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{c.texImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{c.texImage3D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===E.equals(t)&&(c.scissor(t.x,t.y,t.z,t.w),E.copy(t))},viewport:function(t){!1===I.equals(t)&&(c.viewport(t.x,t.y,t.z,t.w),I.copy(t))},reset:function(){c.disable(3042),c.disable(2884),c.disable(2929),c.disable(32823),c.disable(3089),c.disable(2960),c.blendEquation(32774),c.blendFunc(1,0),c.blendFuncSeparate(1,0,1,0),c.colorMask(!0,!0,!0,!0),c.clearColor(0,0,0,0),c.depthMask(!0),c.depthFunc(513),c.clearDepth(1),c.stencilMask(4294967295),c.stencilFunc(519,0,4294967295),c.stencilOp(7680,7680,7680),c.clearStencil(0),c.cullFace(1029),c.frontFace(2305),c.polygonOffset(0,0),c.activeTexture(33984),c.useProgram(null),c.lineWidth(1),c.scissor(0,0,c.canvas.width,c.canvas.height),c.viewport(0,0,c.canvas.width,c.canvas.height),o={},v=l=!(S={}),A=_=b=x=y=g=m=f=p=d=h=u=s=T=null,n.reset(),i.reset(),a.reset()}}}function Ns(b,n,_,h,i,A,d){var t,w=i.isWebGL2,e=i.maxTextures,M=i.maxCubemapSize,g=i.maxTextureSize,r=i.maxSamples,a=new WeakMap,o=void 0,s=!1;try{s="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function l(t,e){return s?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function C(t,e,r,n){var i=1;if((i=t.width>n||t.height>n?n/Math.max(t.width,t.height):i)<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){n=e?ar.floorPowerOfTwo:Math.floor,e=n(i*t.width),i=n(i*t.height);void 0===o&&(o=l(e,i));r=r?l(e,i):o;return r.width=e,r.height=i,r.getContext("2d").drawImage(t,0,0,e,i),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+e+"x"+i+")."),r}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function T(t){return ar.isPowerOfTwo(t.width)&&ar.isPowerOfTwo(t.height)}function S(t,e){return t.generateMipmaps&&e&&t.minFilter!==Mt&&t.minFilter!==Et}function E(t,e,r,n){b.generateMipmap(t),h.get(e).__maxMipLevel=Math.log2(Math.max(r,n))}function I(t,e,r){if(!1===w)return e;if(null!==t){if(void 0!==b[t])return b[t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+t+"'")}t=e;return 6403===e&&(5126===r&&(t=33326),5131===r&&(t=33325),5121===r&&(t=33321)),6407===e&&(5126===r&&(t=34837),5131===r&&(t=34843),5121===r&&(t=32849)),6408===e&&(5126===r&&(t=34836),5131===r&&(t=34842),5121===r&&(t=32856)),33325!==t&&33326!==t&&34842!==t&&34836!==t||n.get("EXT_color_buffer_float"),t}function u(t){return t===Mt||t===Ct||t===St?9728:9729}function c(t){var e,r=t.target;r.removeEventListener("dispose",c),e=r,void 0!==(t=h.get(e)).__webglInit&&(b.deleteTexture(t.__webglTexture),h.remove(e)),r.isVideoTexture&&a.delete(r),d.memory.textures--}function p(t){t=t.target;t.removeEventListener("dispose",p),function(t){var e=t.texture,r=h.get(t),n=h.get(e);if(t){if(void 0!==n.__webglTexture&&b.deleteTexture(n.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var i=0;i<6;i++)b.deleteFramebuffer(r.__webglFramebuffer[i]),r.__webglDepthbuffer&&b.deleteRenderbuffer(r.__webglDepthbuffer[i]);else b.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&b.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&b.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&b.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&b.deleteRenderbuffer(r.__webglDepthRenderbuffer);h.remove(e),h.remove(t)}}(t),d.memory.textures--}var f=0;function m(t,e){var r,n=h.get(t);if(t.isVideoTexture&&(i=t,r=d.render.frame,a.get(i)!==r&&(a.set(i,r),i.update())),0<t.version&&n.__version!==t.version){var i=t.image;if(void 0===i)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==i.complete)return void P(n,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}_.activeTexture(33984+e),_.bindTexture(3553,n.__webglTexture)}function v(t,e){var r=h.get(t);0<t.version&&r.__version!==t.version?function(t,e,r){if(6===e.image.length){R(t,e),_.activeTexture(33984+r),_.bindTexture(34067,t.__webglTexture),b.pixelStorei(37440,e.flipY),b.pixelStorei(37441,e.premultiplyAlpha),b.pixelStorei(3317,e.unpackAlignment),b.pixelStorei(37443,0);for(var n=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),i=e.image[0]&&e.image[0].isDataTexture,a=[],o=0;o<6;o++)a[o]=n||i?i?e.image[o].image:e.image[o]:C(e.image[o],!1,!0,M);var s=a[0],r=T(s)||w,l=A.convert(e.format),u=A.convert(e.type),c=I(e.internalFormat,l,u);L(34067,e,r);var h=void 0;if(n){for(var d=0;d<6;d++){h=a[d].mipmaps;for(var p=0;p<h.length;p++){var f=h[p];e.format!==zt&&e.format!==Nt?null!==l?_.compressedTexImage2D(34069+d,p,c,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_.texImage2D(34069+d,p,c,f.width,f.height,0,l,u,f.data)}}t.__maxMipLevel=h.length-1}else{h=e.mipmaps;for(var m=0;m<6;m++)if(i){_.texImage2D(34069+m,0,c,a[m].width,a[m].height,0,l,u,a[m].data);for(var g=0;g<h.length;g++){var v=h[g].image[m].image;_.texImage2D(34069+m,g+1,c,v.width,v.height,0,l,u,v.data)}}else{_.texImage2D(34069+m,0,c,l,u,a[m]);for(var y=0;y<h.length;y++){var x=h[y];_.texImage2D(34069+m,y+1,c,l,u,x.image[m])}}t.__maxMipLevel=h.length}S(e,r)&&E(34067,e,s.width,s.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}}(r,t,e):(_.activeTexture(33984+e),_.bindTexture(34067,r.__webglTexture))}var y=((t={})[k]=10497,t[H]=33071,t[wt]=33648,t),x=((t={})[Mt]=9728,t[Ct]=9984,t[St]=9986,t[Et]=9729,t[It]=9985,t[Lt]=9987,t);function L(t,e,r){r?(b.texParameteri(t,10242,y[e.wrapS]),b.texParameteri(t,10243,y[e.wrapT]),32879!==t&&35866!==t||b.texParameteri(t,32882,y[e.wrapR]),b.texParameteri(t,10240,x[e.magFilter]),b.texParameteri(t,10241,x[e.minFilter])):(b.texParameteri(t,10242,33071),b.texParameteri(t,10243,33071),32879!==t&&35866!==t||b.texParameteri(t,32882,33071),e.wrapS===H&&e.wrapT===H||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),b.texParameteri(t,10240,u(e.magFilter)),b.texParameteri(t,10241,u(e.minFilter)),e.minFilter!==Mt&&e.minFilter!==Et&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===n.has("EXT_texture_filter_anisotropic")&&(r=n.get("EXT_texture_filter_anisotropic"),e.type===Ot&&!1===n.has("OES_texture_float_linear")||!1===w&&e.type===Ft&&!1===n.has("OES_texture_half_float_linear")||(1<e.anisotropy||h.get(e).__currentAnisotropy)&&(b.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,i.getMaxAnisotropy())),h.get(e).__currentAnisotropy=e.anisotropy))}function R(t,e){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",c),t.__webglTexture=b.createTexture(),d.memory.textures++)}function P(t,e,r){var n=3553;e.isDataTexture2DArray&&(n=35866),e.isDataTexture3D&&(n=32879),R(t,e),_.activeTexture(33984+r),_.bindTexture(n,t.__webglTexture),b.pixelStorei(37440,e.flipY),b.pixelStorei(37441,e.premultiplyAlpha),b.pixelStorei(3317,e.unpackAlignment),b.pixelStorei(37443,0);var r=(i=e,!w&&(i.wrapS!==H||i.wrapT!==H||i.minFilter!==Mt&&i.minFilter!==Et)&&!1===T(e.image)),i=C(e.image,r,!1,g),r=T(i)||w,a=A.convert(e.format),o=A.convert(e.type),s=I(e.internalFormat,a,o);L(n,e,r);var l=void 0,u=e.mipmaps;if(e.isDepthTexture)s=6402,w?s=e.type===Ot?36012:e.type===Dt?33190:e.type===Bt?35056:33189:e.type===Ot&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),e.format===Ut&&6402===s&&e.type!==Pt&&e.type!==Dt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=Pt,o=A.convert(e.type)),e.format===kt&&6402===s&&(s=34041,e.type!==Bt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=Bt,o=A.convert(e.type))),_.texImage2D(3553,0,s,i.width,i.height,0,a,o,null);else if(e.isDataTexture)if(0<u.length&&r){for(var c=0,h=u.length;c<h;c++)l=u[c],_.texImage2D(3553,c,s,l.width,l.height,0,a,o,l.data);e.generateMipmaps=!1,t.__maxMipLevel=u.length-1}else _.texImage2D(3553,0,s,i.width,i.height,0,a,o,i.data),t.__maxMipLevel=0;else if(e.isCompressedTexture){for(var d=0,p=u.length;d<p;d++)l=u[d],e.format!==zt&&e.format!==Nt?null!==a?_.compressedTexImage2D(3553,d,s,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_.texImage2D(3553,d,s,l.width,l.height,0,a,o,l.data);t.__maxMipLevel=u.length-1}else if(e.isDataTexture2DArray)_.texImage3D(35866,0,s,i.width,i.height,i.depth,0,a,o,i.data),t.__maxMipLevel=0;else if(e.isDataTexture3D)_.texImage3D(32879,0,s,i.width,i.height,i.depth,0,a,o,i.data),t.__maxMipLevel=0;else if(0<u.length&&r){for(var f=0,m=u.length;f<m;f++)l=u[f],_.texImage2D(3553,f,s,a,o,l);e.generateMipmaps=!1,t.__maxMipLevel=u.length-1}else _.texImage2D(3553,0,s,a,o,i),t.__maxMipLevel=0;S(e,r)&&E(n,e,i.width,i.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function D(t,e,r,n){var i=e.texture,a=A.convert(i.format),o=A.convert(i.type),s=I(i.internalFormat,a,o);32879===n||35866===n?_.texImage3D(n,0,s,e.width,e.height,e.depth,0,a,o,null):_.texImage2D(n,0,s,e.width,e.height,0,a,o,null),b.bindFramebuffer(36160,t),b.framebufferTexture2D(36160,r,n,h.get(i).__webglTexture,0),b.bindFramebuffer(36160,null)}function O(t,e,r){var n,i,a;b.bindRenderbuffer(36161,t),e.depthBuffer&&!e.stencilBuffer?(i=33189,r?((n=e.depthTexture)&&n.isDepthTexture&&(n.type===Ot?i=36012:n.type===Dt&&(i=33190)),n=B(e),b.renderbufferStorageMultisample(36161,n,i,e.width,e.height)):b.renderbufferStorage(36161,i,e.width,e.height),b.framebufferRenderbuffer(36160,36096,36161,t)):e.depthBuffer&&e.stencilBuffer?(r?(a=B(e),b.renderbufferStorageMultisample(36161,a,35056,e.width,e.height)):b.renderbufferStorage(36161,34041,e.width,e.height),b.framebufferRenderbuffer(36160,33306,36161,t)):(i=e.texture,a=A.convert(i.format),t=A.convert(i.type),t=I(i.internalFormat,a,t),r?(r=B(e),b.renderbufferStorageMultisample(36161,r,t,e.width,e.height)):b.renderbufferStorage(36161,t,e.width,e.height)),b.bindRenderbuffer(36161,null)}function F(t){var e=h.get(t),r=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,e){if(e&&e.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(b.bindFramebuffer(36160,t),!e.depthTexture||!e.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(h.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),m(e.depthTexture,0),t=h.get(e.depthTexture).__webglTexture,e.depthTexture.format===Ut)b.framebufferTexture2D(36160,36096,3553,t,0);else{if(e.depthTexture.format!==kt)throw new Error("Unknown depthTexture format");b.framebufferTexture2D(36160,33306,3553,t,0)}}(e.__webglFramebuffer,t)}else if(r){e.__webglDepthbuffer=[];for(var n=0;n<6;n++)b.bindFramebuffer(36160,e.__webglFramebuffer[n]),e.__webglDepthbuffer[n]=b.createRenderbuffer(),O(e.__webglDepthbuffer[n],t,!1)}else b.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=b.createRenderbuffer(),O(e.__webglDepthbuffer,t,!1);b.bindFramebuffer(36160,null)}function B(t){return w&&t.isWebGLMultisampleRenderTarget?Math.min(r,t.samples):0}var N=!1,z=!1;this.allocateTextureUnit=function(){var t=f;return e<=t&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+e),f+=1,t},this.resetTextureUnits=function(){f=0},this.setTexture2D=m,this.setTexture2DArray=function(t,e){var r=h.get(t);0<t.version&&r.__version!==t.version?P(r,t,e):(_.activeTexture(33984+e),_.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){var r=h.get(t);0<t.version&&r.__version!==t.version?P(r,t,e):(_.activeTexture(33984+e),_.bindTexture(32879,r.__webglTexture))},this.setTextureCube=v,this.setupRenderTarget=function(t){var e=t.texture,r=h.get(t),n=h.get(e);t.addEventListener("dispose",p),n.__webglTexture=b.createTexture(),d.memory.textures++;var i,a=!0===t.isWebGLCubeRenderTarget,o=!0===t.isWebGLMultisampleRenderTarget,s=e.isDataTexture3D||e.isDataTexture2DArray,l=T(t)||w;if(!w||e.format!==Nt||e.type!==Ot&&e.type!==Ft||(e.format=zt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),a){r.__webglFramebuffer=[];for(var u=0;u<6;u++)r.__webglFramebuffer[u]=b.createFramebuffer()}else r.__webglFramebuffer=b.createFramebuffer(),o&&(w?(r.__webglMultisampledFramebuffer=b.createFramebuffer(),r.__webglColorRenderbuffer=b.createRenderbuffer(),b.bindRenderbuffer(36161,r.__webglColorRenderbuffer),i=A.convert(e.format),o=A.convert(e.type),i=I(e.internalFormat,i,o),o=B(t),b.renderbufferStorageMultisample(36161,o,i,t.width,t.height),b.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),b.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),b.bindRenderbuffer(36161,null),t.depthBuffer&&(r.__webglDepthRenderbuffer=b.createRenderbuffer(),O(r.__webglDepthRenderbuffer,t,!0)),b.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(a){_.bindTexture(34067,n.__webglTexture),L(34067,e,l);for(var c=0;c<6;c++)D(r.__webglFramebuffer[c],t,36064,34069+c);S(e,l)&&E(34067,e,t.width,t.height),_.bindTexture(34067,null)}else{a=3553;s&&(w?a=e.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),_.bindTexture(a,n.__webglTexture),L(a,e,l),D(r.__webglFramebuffer,t,36064,a),S(e,l)&&E(3553,e,t.width,t.height),_.bindTexture(3553,null)}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(t){var e,r,n=t.texture;S(n,T(t)||w)&&(e=t.isWebGLCubeRenderTarget?34067:3553,r=h.get(n).__webglTexture,_.bindTexture(e,r),E(e,n,t.width,t.height),_.bindTexture(e,null))},this.updateMultisampleRenderTarget=function(t){var e,r,n,i;t.isWebGLMultisampleRenderTarget&&(w?(e=h.get(t),b.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),b.bindFramebuffer(36009,e.__webglFramebuffer),r=t.width,n=t.height,i=16384,t.depthBuffer&&(i|=256),t.stencilBuffer&&(i|=1024),b.blitFramebuffer(0,0,r,n,0,0,r,n,i,9728),b.bindFramebuffer(36160,e.__webglMultisampledFramebuffer)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),N=!0),t=t.texture),m(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),v(t,e)}}function zs(t,r,e){var n=e.isWebGL2;return{convert:function(t){var e=void 0;if(t===Rt)return 5121;if(t===h)return 32819;if(t===d)return 32820;if(t===p)return 33635;if(t===o)return 5120;if(t===u)return 5122;if(t===Pt)return 5123;if(t===c)return 5124;if(t===Dt)return 5125;if(t===Ot)return 5126;if(t===Ft)return n?5131:null!==(e=r.get("OES_texture_half_float"))?e.HALF_FLOAT_OES:null;if(t===f)return 6406;if(t===Nt)return 6407;if(t===zt)return 6408;if(t===m)return 6409;if(t===v)return 6410;if(t===Ut)return 6402;if(t===kt)return 34041;if(t===x)return 6403;if(t===b)return 36244;if(t===_)return 33319;if(t===Ht)return 33320;if(t===Gt)return 36248;if(t===Vt)return 36249;if(t===Wt||t===jt||t===Xt||t===qt){if(null===(e=r.get("WEBGL_compressed_texture_s3tc")))return null;if(t===Wt)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===jt)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===Xt)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===qt)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===Yt||t===Zt||t===Jt||t===Kt){if(null===(e=r.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===Yt)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Zt)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===Jt)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Kt)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===Qt)return null!==(e=r.get("WEBGL_compressed_texture_etc1"))?e.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===$t||t===te)&&null!==(e=r.get("WEBGL_compressed_texture_etc"))){if(t===$t)return e.COMPRESSED_RGB8_ETC2;if(t===te)return e.COMPRESSED_RGBA8_ETC2_EAC}return t===ee||t===re||t===ne||t===ie||t===ae||t===oe||t===se||t===le||t===ue||t===ce||t===he||t===de||t===pe||t===fe||t===ge||t===ve||t===ye||t===xe||t===be||t===_e||t===Ae||t===we||t===Me||t===Ce||t===Te||t===Se||t===Ee||t===Ie?null!==(e=r.get("WEBGL_compressed_texture_astc"))?t:null:t===me?null!==(e=r.get("EXT_texture_compression_bptc"))?t:null:t===Bt?n?34042:null!==(e=r.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Us(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];ua.call(this),this.cameras=t}Us.prototype=Object.assign(Object.create(ua.prototype),{constructor:Us,isArrayCamera:!0});var ks,Hs,Gs=(a(Vs,ks=Dn),Vs);function Vs(){U(this,Vs);var t=z(this,ks.call(this));return t.type="Group",t}function Ws(){this._targetRay=null,this._grip=null,this._hand=null}function js(p,i){var a=this,f=null,o=1,m=null,s="local-floor",g=null,v=[],u=new Map,l=new ua;l.layers.enable(1),l.viewport=new vr;var c=new ua;c.layers.enable(2),c.viewport=new vr;var y=[l,c],x=new Us;x.layers.enable(1),x.layers.enable(2);var e,h=null,d=null;function b(t){var e=u.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function _(){u.forEach(function(t,e){t.disconnect(e)}),u.clear(),d=h=null,p.setFramebuffer(null),p.setRenderTarget(p.getRenderTarget()),S.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function A(t){for(var e=f.inputSources,r=0;r<v.length;r++)u.set(e[r],v[r]);for(var n=0;n<t.removed.length;n++){var i=t.removed[n],a=u.get(i);a&&(a.dispatchEvent({type:"disconnected",data:i}),u.delete(i))}for(var o=0;o<t.added.length;o++){var s=t.added[o],l=u.get(s);l&&l.dispatchEvent({type:"connected",data:s})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=v[t];return void 0===e&&(e=new Ws,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=v[t];return void 0===e&&(e=new Ws,v[t]=e),e.getGripSpace()},this.getHand=function(t){var e=v[t];return void 0===e&&(e=new Ws,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){o=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){s=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m},this.getSession=function(){return f},this.setSession=(e=E(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(f=e)){t.next=24;break}if(f.addEventListener("select",b),f.addEventListener("selectstart",b),f.addEventListener("selectend",b),f.addEventListener("squeeze",b),f.addEventListener("squeezestart",b),f.addEventListener("squeezeend",b),f.addEventListener("end",_),f.addEventListener("inputsourceschange",A),!0!==(r=i.getContextAttributes()).xrCompatible)return t.next=14,i.makeXRCompatible();t.next=14;break;case 14:return n={antialias:r.antialias,alpha:r.alpha,depth:r.depth,stencil:r.stencil,framebufferScaleFactor:o},n=new XRWebGLLayer(f,i,n),f.updateRenderState({baseLayer:n}),t.next=19,f.requestReferenceSpace(s);case 19:m=t.sent,S.setContext(f),S.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 24:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)});var w=new Tr,M=new Tr;function C(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.getCamera=function(t){x.near=c.near=l.near=t.near,x.far=c.far=l.far=t.far,h===x.near&&d===x.far||(f.updateRenderState({depthNear:x.near,depthFar:x.far}),h=x.near,d=x.far);var e=t.parent,r=x.cameras;C(x,e);for(var n=0;n<r.length;n++)C(r[n],e);t.matrixWorld.copy(x.matrixWorld),t.matrix.copy(x.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);for(var i=t.children,a=0,o=i.length;a<o;a++)i[a].updateMatrixWorld(!0);return 2===r.length?function(t,e,r){w.setFromMatrixPosition(e.matrixWorld),M.setFromMatrixPosition(r.matrixWorld);var n=w.distanceTo(M),i=e.projectionMatrix.elements,a=r.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],r=(a[8]+1)/a[0],i=o*c,a=o*r,c=(r=n/(r-c))*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(c),t.translateZ(r),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert(),o+=r,i-=c,a=n-c+a,l=l*s/(r=s+r)*o,s=u*s/r*o,t.projectionMatrix.makePerspective(i,a,l,s,o,r)}(x,l,c):x.projectionMatrix.copy(l.projectionMatrix),x};var T=null;var S=new Ea;S.setAnimationLoop(function(t,e){if(null!==(g=e.getViewerPose(m))){var r=g.views,n=f.renderState.baseLayer;p.setFramebuffer(n.framebuffer);var i=!1;r.length!==x.cameras.length&&(i=!(x.cameras.length=0));for(var a=0;a<r.length;a++){var o=r[a],s=n.getViewport(o),l=y[a];l.matrix.fromArray(o.transform.matrix),l.projectionMatrix.fromArray(o.projectionMatrix),l.viewport.set(s.x,s.y,s.width,s.height),0===a&&x.matrix.copy(l.matrix),!0===i&&x.cameras.push(l)}}for(var u=f.inputSources,c=0;c<v.length;c++){var h=v[c],d=u[c];h.update(d,e,m)}T&&T(t,e)}),this.setAnimationLoop=function(t){T=t},this.dispose=function(){}}function Xs(i){function g(t,e){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r=i.get(e).envMap;r&&(t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,void 0!==(n=i.get(r).__maxMipLevel)&&(t.maxMipLevel.value=n)),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n=void 0;e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap?n=e.emissiveMap:e.clearcoatMap?n=e.clearcoatMap:e.clearcoatNormalMap?n=e.clearcoatNormalMap:e.clearcoatRoughnessMap&&(n=e.clearcoatRoughnessMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix));n=void 0;e.aoMap?n=e.aoMap:e.lightMap&&(n=e.lightMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),t.uv2Transform.value.copy(n.matrix))}function v(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===j&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===j&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),i.get(e).envMap&&(t.envMapIntensity.value=e.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,e,r,n){var i,a,o,s,l,u,c,h,d,p,f,m;e.isMeshBasicMaterial?g(t,e):e.isMeshLambertMaterial?(g(t,e),f=t,(m=e).emissiveMap&&(f.emissiveMap.value=m.emissiveMap)):e.isMeshToonMaterial?(g(t,e),d=t,(p=e).gradientMap&&(d.gradientMap.value=p.gradientMap),p.emissiveMap&&(d.emissiveMap.value=p.emissiveMap),p.bumpMap&&(d.bumpMap.value=p.bumpMap,d.bumpScale.value=p.bumpScale,p.side===j&&(d.bumpScale.value*=-1)),p.normalMap&&(d.normalMap.value=p.normalMap,d.normalScale.value.copy(p.normalScale),p.side===j&&d.normalScale.value.negate()),p.displacementMap&&(d.displacementMap.value=p.displacementMap,d.displacementScale.value=p.displacementScale,d.displacementBias.value=p.displacementBias)):e.isMeshPhongMaterial?(g(t,e),d=e,(p=t).specular.value.copy(d.specular),p.shininess.value=Math.max(d.shininess,1e-4),d.emissiveMap&&(p.emissiveMap.value=d.emissiveMap),d.bumpMap&&(p.bumpMap.value=d.bumpMap,p.bumpScale.value=d.bumpScale,d.side===j&&(p.bumpScale.value*=-1)),d.normalMap&&(p.normalMap.value=d.normalMap,p.normalScale.value.copy(d.normalScale),d.side===j&&p.normalScale.value.negate()),d.displacementMap&&(p.displacementMap.value=d.displacementMap,p.displacementScale.value=d.displacementScale,p.displacementBias.value=d.displacementBias)):e.isMeshStandardMaterial?(g(t,e),e.isMeshPhysicalMaterial?(v(c=t,h=e),c.reflectivity.value=h.reflectivity,c.clearcoat.value=h.clearcoat,c.clearcoatRoughness.value=h.clearcoatRoughness,h.sheen&&c.sheen.value.copy(h.sheen),h.clearcoatMap&&(c.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(c.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(c.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),c.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===j&&c.clearcoatNormalScale.value.negate()),c.transmission.value=h.transmission,h.transmissionMap&&(c.transmissionMap.value=h.transmissionMap)):v(t,e)):e.isMeshMatcapMaterial?(g(t,e),c=t,(h=e).matcap&&(c.matcap.value=h.matcap),h.bumpMap&&(c.bumpMap.value=h.bumpMap,c.bumpScale.value=h.bumpScale,h.side===j&&(c.bumpScale.value*=-1)),h.normalMap&&(c.normalMap.value=h.normalMap,c.normalScale.value.copy(h.normalScale),h.side===j&&c.normalScale.value.negate()),h.displacementMap&&(c.displacementMap.value=h.displacementMap,c.displacementScale.value=h.displacementScale,c.displacementBias.value=h.displacementBias)):e.isMeshDepthMaterial?(g(t,e),l=t,(u=e).displacementMap&&(l.displacementMap.value=u.displacementMap,l.displacementScale.value=u.displacementScale,l.displacementBias.value=u.displacementBias)):e.isMeshDistanceMaterial?(g(t,e),l=t,(u=e).displacementMap&&(l.displacementMap.value=u.displacementMap,l.displacementScale.value=u.displacementScale,l.displacementBias.value=u.displacementBias),l.referencePosition.value.copy(u.referencePosition),l.nearDistance.value=u.nearDistance,l.farDistance.value=u.farDistance):e.isMeshNormalMaterial?(g(t,e),o=t,(s=e).bumpMap&&(o.bumpMap.value=s.bumpMap,o.bumpScale.value=s.bumpScale,s.side===j&&(o.bumpScale.value*=-1)),s.normalMap&&(o.normalMap.value=s.normalMap,o.normalScale.value.copy(s.normalScale),s.side===j&&o.normalScale.value.negate()),s.displacementMap&&(o.displacementMap.value=s.displacementMap,o.displacementScale.value=s.displacementScale,o.displacementBias.value=s.displacementBias)):e.isLineBasicMaterial?(o=e,(s=t).diffuse.value.copy(o.color),s.opacity.value=o.opacity,e.isLineDashedMaterial&&(a=e,(i=t).dashSize.value=a.dashSize,i.totalSize.value=a.dashSize+a.gapSize,i.scale.value=a.scale)):e.isPointsMaterial?(i=e,a=r,r=n,(n=t).diffuse.value.copy(i.color),n.opacity.value=i.opacity,n.size.value=i.size*a,n.scale.value=.5*r,i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),r=void 0,i.map?r=i.map:i.alphaMap&&(r=i.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),n.uvTransform.value.copy(r.matrix))):e.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap);var r=void 0;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,e):e.isShadowMaterial?(t.color.value.copy(e.color),t.opacity.value=e.opacity):e.isShaderMaterial&&(e.uniformsNeedUpdate=!1)}}}function qs(t){var e,i=void 0!==(t=t||{}).canvas?t.canvas:((e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",e),e=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,n=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",c=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,v=null,y=null,h=[],d=[];this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=ze,this.physicallyCorrectLights=!1,this.toneMapping=Tt,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m=this,p=!1,f=null,g=0,x=0,b=null,_=null,A=-1,w=null,M=new vr,C=new vr,T=null,S=i.width,E=i.height,I=1,L=null,R=null,P=new vr(0,0,S,E),D=new vr(0,0,S,E),O=!1,F=new Ta,B=!1,N=!1,z=new an,U=new Tr,k={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function H(){return null===b?I:1}var G=e;function V(t,e){for(var r=0;r<t.length;r++){var n=t[r],n=i.getContext(n,e);if(null!==n)return n}return null}try{var W={alpha:r,depth:n,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if(i.addEventListener("webglcontextlost",gt,!1),i.addEventListener("webglcontextrestored",vt,!1),null===G){var j=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&j.shift(),null===(G=V(j,W)))throw V(j)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===G.getShaderPrecisionFormat&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}var X=void 0,q=void 0,Y=void 0,Z=void 0,J=void 0,K=void 0,Q=void 0,$=void 0,tt=void 0,et=void 0,rt=void 0,nt=void 0,it=void 0,at=void 0,ot=void 0,st=void 0,lt=void 0,ut=void 0,ct=void 0,ht=void 0,dt=void 0;function pt(){X=new Ga(G),q=new Ua(G,X,t),X.init(q),ht=new zs(0,X,q),(Y=new Bs(G,X,q)).scissor(C.copy(D).multiplyScalar(I).floor()),Y.viewport(M.copy(P).multiplyScalar(I).floor()),Z=new ja,J=new gs,K=new Ns(G,X,Y,J,q,ht,Z),Q=new Ha(m),$=new Ia(G,q),dt=new Na(G,X,$,q),tt=new Va(0,$,Z,dt),et=new Za(0,tt,$,Z),lt=new Ya(G),ot=new ka(J),rt=new ms(m,Q,X,q,dt,ot),nt=new Xs(J),it=new bs(J),at=new Ts(X,q),st=new Ba(m,Q,Y,et,s),ut=new za(G,X,Z,q),ct=new Wa(G,X,Z,q),Z.programs=rt.programs,m.capabilities=q,m.extensions=X,m.properties=J,m.renderLists=it,m.state=Y,m.info=Z}pt();var ft=new js(m,G);this.xr=ft;var mt=new Fs(m,et,q.maxTextureSize);function gt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,pt()}function yt(t){t=t.target;t.removeEventListener("dispose",yt),xt(t=t),J.remove(t)}function xt(t){t=J.get(t).program;void 0!==t&&rt.releaseProgram(t)}this.shadowMap=mt,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){var t=X.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=X.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(t){void 0!==t&&(I=t,this.setSize(S,E,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new or),t.set(S,E)},this.setSize=function(t,e,r){ft.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=t,E=e,i.width=Math.floor(t*I),i.height=Math.floor(e*I),!1!==r&&(i.style.width=t+"px",i.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new or),t.set(S*I,E*I).floor()},this.setDrawingBufferSize=function(t,e,r){S=t,E=e,I=r,i.width=Math.floor(t*r),i.height=Math.floor(e*r),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new vr),t.copy(M)},this.getViewport=function(t){return t.copy(P)},this.setViewport=function(t,e,r,n){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,r,n),Y.viewport(M.copy(P).multiplyScalar(I).floor())},this.getScissor=function(t){return t.copy(D)},this.setScissor=function(t,e,r,n){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,r,n),Y.scissor(C.copy(D).multiplyScalar(I).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(t){Y.setScissorTest(O=t)},this.setOpaqueSort=function(t){L=t},this.setTransparentSort=function(t){R=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new ai),t.copy(st.getClearColor())},this.setClearColor=function(){st.setClearColor.apply(st,arguments)},this.getClearAlpha=function(){return st.getClearAlpha()},this.setClearAlpha=function(){st.setClearAlpha.apply(st,arguments)},this.clear=function(t,e,r){var n=0;void 0!==t&&!t||(n|=16384),void 0!==e&&!e||(n|=256),void 0!==r&&!r||(n|=1024),G.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",gt,!1),i.removeEventListener("webglcontextrestored",vt,!1),it.dispose(),at.dispose(),J.dispose(),Q.dispose(),et.dispose(),dt.dispose(),ft.dispose(),_t.stop()},this.renderBufferImmediate=function(t,e){dt.initAttributes();var r=J.get(t);t.hasPositions&&!r.position&&(r.position=G.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=G.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=G.createBuffer()),t.hasColors&&!r.color&&(r.color=G.createBuffer());e=e.getAttributes();t.hasPositions&&(G.bindBuffer(34962,r.position),G.bufferData(34962,t.positionArray,35048),dt.enableAttribute(e.position),G.vertexAttribPointer(e.position,3,5126,!1,0,0)),t.hasNormals&&(G.bindBuffer(34962,r.normal),G.bufferData(34962,t.normalArray,35048),dt.enableAttribute(e.normal),G.vertexAttribPointer(e.normal,3,5126,!1,0,0)),t.hasUvs&&(G.bindBuffer(34962,r.uv),G.bufferData(34962,t.uvArray,35048),dt.enableAttribute(e.uv),G.vertexAttribPointer(e.uv,2,5126,!1,0,0)),t.hasColors&&(G.bindBuffer(34962,r.color),G.bufferData(34962,t.colorArray,35048),dt.enableAttribute(e.color),G.vertexAttribPointer(e.color,3,5126,!1,0,0)),dt.disableUnusedAttributes(),G.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,r,n,i,a){null===e&&(e=k);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Ct(t,e,n,i);Y.setMaterial(n,o);var l=r.index,u=r.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;t=1;!0===n.wireframe&&(l=tt.getWireframeAttribute(r),t=2),(n.morphTargets||n.morphNormals)&&lt.update(i,r,n,s),dt.setup(i,n,s,r,l);e=void 0,o=ut;null!==l&&(e=$.get(l),(o=ct).setIndex(e));s=(null!==l?l:u).count,e=r.drawRange.start*t,l=r.drawRange.count*t,u=null!==a?a.start*t:0,a=null!==a?a.count*t:1/0,t=Math.max(e,u),a=Math.min(s,e+l,u+a)-1,a=Math.max(0,a-t+1);0!==a&&(i.isMesh?!0===n.wireframe?(Y.setLineWidth(n.wireframeLinewidth*H()),o.setMode(1)):o.setMode(4):i.isLine?(void 0===(n=n.linewidth)&&(n=1),Y.setLineWidth(n*H()),i.isLineSegments?o.setMode(1):i.isLineLoop?o.setMode(2):o.setMode(3)):i.isPoints?o.setMode(0):i.isSprite&&o.setMode(4),i.isInstancedMesh?o.renderInstances(t,a,i.count):r.isInstancedBufferGeometry?(r=Math.min(r.instanceCount,r._maxInstanceCount),o.renderInstances(t,a,r)):o.render(t,a))},this.compile=function(i,e){(y=at.get(i)).init(),i.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(y.pushLight(t),t.castShadow&&y.pushShadow(t))}),y.setupLights();var a=new WeakMap;i.traverse(function(t){var e=t.material;if(e)if(Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];!1===a.has(n)&&(Mt(n,i,t),a.set(n))}else!1===a.has(e)&&(Mt(e,i,t),a.set(e))})};var bt=null;var _t=new Ea;function At(t,e,r){for(var n=!0===e.isScene?e.overrideMaterial:null,i=0,a=t.length;i<a;i++){var o=t[i],s=o.object,l=o.geometry,u=null===n?o.material:n,c=o.group;if(r.isArrayCamera)for(var h=r.cameras,d=0,p=h.length;d<p;d++){var f=h[d];s.layers.test(f.layers)&&(Y.viewport(M.copy(f.viewport)),y.setupLightsView(f),wt(s,e,f,l,u,c))}else wt(s,e,r,l,u,c)}}function wt(t,e,r,n,i,a){var o,s;t.onBeforeRender(m,e,r,n,i,a),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(o=Ct(r,e,i,t),Y.setMaterial(i),dt.reset(),s=o,t.render(function(t){m.renderBufferImmediate(t,s)})):m.renderBufferDirect(r,e,n,i,t,a),t.onAfterRender(m,e,r,n,i,a)}function Mt(t,e,r){!0!==e.isScene&&(e=k);var n=J.get(t),i=y.state.lights,a=y.state.shadowsArray,o=i.state.version,s=rt.getParameters(t,i.state,a,e,r),l=rt.getProgramCacheKey(s),a=n.program,r=!0;if(n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=Q.get(t.envMap||n.environment),void 0===a)t.addEventListener("dispose",yt);else if(a.cacheKey!==l)xt(t);else if(n.lightsStateVersion!==o)r=!1;else{if(void 0!==s.shaderID)return;r=!1}r&&(s.uniforms=rt.getUniforms(t),t.onBeforeCompile(s,m),a=rt.acquireProgram(s,l),n.program=a,n.uniforms=s.uniforms,n.outputEncoding=s.outputEncoding);s=n.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=ot.numPlanes,n.numIntersection=ot.numIntersection,s.clippingPlanes=ot.uniform),n.needsLights=(t=t).isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights,n.lightsStateVersion=o,n.needsLights&&(s.ambientLightColor.value=i.state.ambient,s.lightProbe.value=i.state.probe,s.directionalLights.value=i.state.directional,s.directionalLightShadows.value=i.state.directionalShadow,s.spotLights.value=i.state.spot,s.spotLightShadows.value=i.state.spotShadow,s.rectAreaLights.value=i.state.rectArea,s.ltc_1.value=i.state.rectAreaLTC1,s.ltc_2.value=i.state.rectAreaLTC2,s.pointLights.value=i.state.point,s.pointLightShadows.value=i.state.pointShadow,s.hemisphereLights.value=i.state.hemi,s.directionalShadowMap.value=i.state.directionalShadowMap,s.directionalShadowMatrix.value=i.state.directionalShadowMatrix,s.spotShadowMap.value=i.state.spotShadowMap,s.spotShadowMatrix.value=i.state.spotShadowMatrix,s.pointShadowMap.value=i.state.pointShadowMap,s.pointShadowMatrix.value=i.state.pointShadowMatrix);i=n.program.getUniforms(),s=Jo.seqWithValue(i.seq,s);n.uniformsList=s}function Ct(t,e,r,n){!0!==e.isScene&&(e=k),K.resetTextureUnits();var i=e.fog,a=r.isMeshStandardMaterial?e.environment:null,o=null===b?m.outputEncoding:b.texture.encoding,s=Q.get(r.envMap||a),l=J.get(r),u=y.state.lights;!0===B&&(!0!==N&&t===w||(d=t===w&&r.id===A,ot.setState(r,t,d))),r.version===l.__version?(r.fog&&l.fog!==i||l.environment!==a||l.needsLights&&l.lightsStateVersion!==u.state.version||void 0!==l.numClippingPlanes&&(l.numClippingPlanes!==ot.numPlanes||l.numIntersection!==ot.numIntersection)||l.outputEncoding!==o||l.envMap!==s)&&Mt(r,e,n):(Mt(r,e,n),l.__version=r.version);var c,h=!1,d=!1,a=!1,u=l.program,o=u.getUniforms(),s=l.uniforms;return Y.useProgram(u.program)&&(a=d=h=!0),r.id!==A&&(A=r.id,d=!0),!h&&w===t||(o.setValue(G,"projectionMatrix",t.projectionMatrix),q.logarithmicDepthBuffer&&o.setValue(G,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),w!==t&&(w=t,a=d=!0),!(r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap)||void 0!==(c=o.map.cameraPosition)&&c.setValue(G,U.setFromMatrixPosition(t.matrixWorld)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&o.setValue(G,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||r.skinning)&&o.setValue(G,"viewMatrix",t.matrixWorldInverse)),r.skinning&&(o.setOptional(G,n,"bindMatrix"),o.setOptional(G,n,"bindMatrixInverse"),(e=n.skeleton)&&(h=e.bones,q.floatVertexTextures?(null===e.boneTexture&&(c=Math.sqrt(4*h.length),c=ar.ceilPowerOfTwo(c),c=Math.max(c,4),(t=new Float32Array(c*c*4)).set(e.boneMatrices),h=new Aa(t,c,c,zt,Ot),e.boneMatrices=t,e.boneTexture=h,e.boneTextureSize=c),o.setValue(G,"boneTexture",e.boneTexture,K),o.setValue(G,"boneTextureSize",e.boneTextureSize)):o.setOptional(G,e,"boneMatrices"))),!d&&l.receiveShadow===n.receiveShadow||(l.receiveShadow=n.receiveShadow,o.setValue(G,"receiveShadow",n.receiveShadow)),d&&(o.setValue(G,"toneMappingExposure",m.toneMappingExposure),l.needsLights&&(d=a,(a=s).ambientLightColor.needsUpdate=d,a.lightProbe.needsUpdate=d,a.directionalLights.needsUpdate=d,a.directionalLightShadows.needsUpdate=d,a.pointLights.needsUpdate=d,a.pointLightShadows.needsUpdate=d,a.spotLights.needsUpdate=d,a.spotLightShadows.needsUpdate=d,a.rectAreaLights.needsUpdate=d,a.hemisphereLights.needsUpdate=d),i&&r.fog&&nt.refreshFogUniforms(s,i),nt.refreshMaterialUniforms(s,r,I,E),Jo.upload(G,l.uniformsList,s,K)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Jo.upload(G,l.uniformsList,s,K),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&o.setValue(G,"center",n.center),o.setValue(G,"modelViewMatrix",n.modelViewMatrix),o.setValue(G,"normalMatrix",n.normalMatrix),o.setValue(G,"modelMatrix",n.matrixWorld),u}_t.setAnimationLoop(function(t){ft.isPresenting||bt&&bt(t)}),"undefined"!=typeof window&&_t.setContext(window),this.setAnimationLoop=function(t){bt=t,ft.setAnimationLoop(t),null===t?_t.stop():_t.start()},this.render=function(t,e){var r,n=void 0,i=void 0;void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),void 0===e||!0===e.isCamera?!0!==p&&(dt.resetDefaultState(),A=-1,!(w=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===ft.enabled&&!0===ft.isPresenting&&(e=ft.getCamera(e)),!0===t.isScene&&t.onBeforeRender(m,t,e,n||b),(y=at.get(t,d.length)).init(),d.push(y),z.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),F.setFromProjectionMatrix(z),N=this.localClippingEnabled,B=ot.init(this.clippingPlanes,N,e),(v=it.get(t,h.length)).init(),h.push(v),function t(e,r,n,i){if(!1===e.visible)return;var a=e.layers.test(r.layers);if(a)if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(r);else if(e.isLight)y.pushLight(e),e.castShadow&&y.pushShadow(e);else if(e.isSprite){var o;e.frustumCulled&&!F.intersectsSprite(e)||(i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z),o=et.update(e),(a=e.material).visible&&v.push(e,o,a,n,U.z,null))}else if(e.isImmediateRenderObject)i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z),v.push(e,null,e.material,n,U.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Z.render.frame&&(e.skeleton.update(),e.skeleton.frame=Z.render.frame),!e.frustumCulled||F.intersectsObject(e))){i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);var s=et.update(e),l=e.material;if(Array.isArray(l))for(var u=s.groups,c=0,h=u.length;c<h;c++){var d=u[c],p=l[d.materialIndex];p&&p.visible&&v.push(e,s,p,n,U.z,d)}else l.visible&&v.push(e,s,l,n,U.z,null)}var f=e.children;for(var m=0,g=f.length;m<g;m++)t(f[m],r,n,i)}(t,e,0,m.sortObjects),v.finish(),!0===m.sortObjects&&v.sort(L,R),!0===B&&ot.beginShadows(),r=y.state.shadowsArray,mt.render(r,t,e),y.setupLights(),y.setupLightsView(e),!0===B&&ot.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),st.render(v,t,e,i),n=v.opaque,i=v.transparent,0<n.length&&At(n,t,e),0<i.length&&At(i,t,e),!0===t.isScene&&t.onAfterRender(m,t,e),null!==b&&(K.updateRenderTargetMipmap(b),K.updateMultisampleRenderTarget(b)),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),d.pop(),y=0<d.length?d[d.length-1]:null,h.pop(),v=0<h.length?h[h.length-1]:null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){f!==t&&null===b&&G.bindFramebuffer(36160,t),f=t},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return b},this.setRenderTarget=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;g=e,x=r,(b=t)&&void 0===J.get(t).__webglFramebuffer&&K.setupRenderTarget(t);var n,i=f,a=!1,o=!1;T=t?(((n=t.texture).isDataTexture3D||n.isDataTexture2DArray)&&(o=!0),n=J.get(t).__webglFramebuffer,t.isWebGLCubeRenderTarget?(i=n[e],a=!0):i=t.isWebGLMultisampleRenderTarget?J.get(t).__webglMultisampledFramebuffer:n,M.copy(t.viewport),C.copy(t.scissor),t.scissorTest):(M.copy(P).multiplyScalar(I).floor(),C.copy(D).multiplyScalar(I).floor(),O),_!==i&&(G.bindFramebuffer(36160,i),_=i),Y.viewport(M),Y.scissor(C),Y.setScissorTest(T),a?(a=J.get(t.texture),G.framebufferTexture2D(36160,36064,34069+e,a.__webglTexture,r)):o&&(t=J.get(t.texture),e=e||0,G.framebufferTextureLayer(36160,36064,t.__webglTexture,r||0,e))},this.readRenderTargetPixels=function(t,e,r,n,i,a,o){if(t&&t.isWebGLRenderTarget){var s=J.get(t).__webglFramebuffer;if(s=t.isWebGLCubeRenderTarget&&void 0!==o?s[o]:s){o=!1;s!==_&&(G.bindFramebuffer(36160,s),o=!0);try{var l=t.texture,u=l.format,c=l.type;if(u!==zt&&ht.convert(u)!==G.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");l=c===Ft&&(X.has("EXT_color_buffer_half_float")||q.isWebGL2&&X.has("EXT_color_buffer_float"));if(!(c===Rt||ht.convert(c)===G.getParameter(35738)||c===Ot&&(q.isWebGL2||X.has("OES_texture_float")||X.has("WEBGL_color_buffer_float"))||l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===G.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=r&&r<=t.height-i&&G.readPixels(e,r,n,i,ht.convert(u),ht.convert(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{o&&G.bindFramebuffer(36160,_)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=Math.pow(2,-r),i=Math.floor(e.image.width*n),a=Math.floor(e.image.height*n),n=ht.convert(e.format);K.setTexture2D(e,0),G.copyTexImage2D(3553,r,n,t.x,t.y,i,a,0),Y.unbindTexture()},this.copyTextureToTexture=function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=e.image.width,a=e.image.height,o=ht.convert(r.format),s=ht.convert(r.type);K.setTexture2D(r,0),G.pixelStorei(37440,r.flipY),G.pixelStorei(37441,r.premultiplyAlpha),G.pixelStorei(3317,r.unpackAlignment),e.isDataTexture?G.texSubImage2D(3553,n,t.x,t.y,i,a,o,s,e.image.data):e.isCompressedTexture?G.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):G.texSubImage2D(3553,n,t.x,t.y,o,s,e.image),0===n&&r.generateMipmaps&&G.generateMipmap(3553),Y.unbindTexture()},this.copyTextureToTexture3D=function(t,e,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a=r.image,o=a.width,s=a.height,l=a.data,u=ht.convert(n.format),c=ht.convert(n.type),h=void 0;if(n.isDataTexture3D)K.setTexture3D(n,0),h=32879;else{if(!n.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");K.setTexture2DArray(n,0),h=35866}G.pixelStorei(37440,n.flipY),G.pixelStorei(37441,n.premultiplyAlpha),G.pixelStorei(3317,n.unpackAlignment);var d=G.getParameter(3314),p=G.getParameter(32878),f=G.getParameter(3316),r=G.getParameter(3315),a=G.getParameter(32877);G.pixelStorei(3314,o),G.pixelStorei(32878,s),G.pixelStorei(3316,t.min.x),G.pixelStorei(3315,t.min.y),G.pixelStorei(32877,t.min.z),G.texSubImage3D(h,i,e.x,e.y,e.z,t.max.x-t.min.x+1,t.max.y-t.min.y+1,t.max.z-t.min.z+1,u,c,l),G.pixelStorei(3314,d),G.pixelStorei(32878,p),G.pixelStorei(3316,f),G.pixelStorei(3315,r),G.pixelStorei(32877,a),0===i&&n.generateMipmaps&&G.generateMipmap(h),Y.unbindTexture()}},this.initTexture=function(t){K.setTexture2D(t,0),Y.unbindTexture()},this.resetState=function(){Y.reset(),dt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ys(){return U(this,Ys),z(this,Hs.apply(this,arguments))}Gs.prototype.isGroup=!0,Object.assign(Ws.prototype,{constructor:Ws,getHandSpace:function(){return null===this._hand&&(this._hand=new Gs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Gs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Gs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,r){var n=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(l&&t.hand){for(var u,a=!0,c=t.hand.values(),h=Array.isArray(c),d=0,c=h?c:c[Symbol.iterator]();;){if(h){if(d>=c.length)break;u=c[d++]}else{if((d=c.next()).done)break;u=d.value}var p,f=u,m=e.getJointPose(f,r);void 0===l.joints[f.jointName]&&((p=new Gs).matrixAutoUpdate=!1,p.visible=!1,l.joints[f.jointName]=p,l.add(p));f=l.joints[f.jointName];null!==m&&(f.matrix.fromArray(m.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.jointRadius=m.radius),f.visible=null!==m}var g=l.joints["index-finger-tip"],v=l.joints["thumb-tip"],v=g.position.distanceTo(v.position);l.inputState.pinching&&.025<v?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&v<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&null!==(n=e.getPose(t.targetRaySpace,r))&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),null!==s&&t.gripSpace&&null!==(i=e.getPose(t.gripSpace,r))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==o&&(o.visible=null!==n),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}}),Object.assign(js.prototype,er.prototype),(a(Ys,Hs=qs),Ys).prototype.isWebGL1Renderer=!0;var Zs=(Js.prototype.clone=function(){return new Js(this.color,this.density)},Js.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Js);function Js(t,e){U(this,Js),this.name="",this.color=new ai(t),this.density=void 0!==e?e:25e-5}Zs.prototype.isFogExp2=!0;var Ks=(Qs.prototype.clone=function(){return new Qs(this.color,this.near,this.far)},Qs.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Qs);function Qs(t,e,r){U(this,Qs),this.name="",this.color=new ai(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3}Ks.prototype.isFog=!0;var $s,tl=(a(el,$s=Dn),el.prototype.copy=function(t,e){return $s.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},el.prototype.toJSON=function(t){var e=$s.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},el);function el(){U(this,el);var t=z(this,$s.call(this));return t.type="Scene",t.background=null,t.environment=null,t.fog=null,t.overrideMaterial=null,t.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:t})),t}function rl(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Qe,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ar.generateUUID()}tl.prototype.isScene=!0,Object.defineProperty(rl.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(rl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},set:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ar.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);t=new rl(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ar.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var nl=new Tr;function il(t,e,r,n){this.name="",this.data=t,this.itemSize=e,this.offset=r,this.normalized=!0===n}Object.defineProperties(il.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(il.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,r=this.data.count;e<r;e++)nl.x=this.getX(e),nl.y=this.getY(e),nl.z=this.getZ(e),nl.applyMatrix4(t),this.setXYZ(e,nl.x,nl.y,nl.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this},clone:function(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new il(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,i=0;i<this.itemSize;i++)e.push(this.data.array[n+i]);return new di(new this.array.constructor(e),this.itemSize,this.normalized)},toJSON:function(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,i=0;i<this.itemSize;i++)e.push(this.data.array[n+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}});var al,ol=(a(sl,al=Qn),sl.prototype.copy=function(t){return al.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this},sl);function sl(t){U(this,sl);var e=z(this,al.call(this));return e.type="SpriteMaterial",e.color=new ai(16777215),e.map=null,e.alphaMap=null,e.rotation=0,e.sizeAttenuation=!0,e.transparent=!0,e.setValues(t),e}ol.prototype.isSpriteMaterial=!0;var ll,ul=void 0,cl=new Tr,hl=new Tr,dl=new Tr,pl=new or,fl=new or,ml=new an,gl=new Tr,vl=new Tr,yl=new Tr,xl=new or,bl=new or,_l=new or,Al=(a(wl,ll=Dn),wl.prototype.raycast=function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hl.setFromMatrixScale(this.matrixWorld),ml.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),dl.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&hl.multiplyScalar(-dl.z);var r=this.material.rotation,n=void 0,i=void 0;0!==r&&(i=Math.cos(r),n=Math.sin(r));var a=this.center;Ml(gl.set(-.5,-.5,0),dl,a,hl,n,i),Ml(vl.set(.5,-.5,0),dl,a,hl,n,i),Ml(yl.set(.5,.5,0),dl,a,hl,n,i),xl.set(0,0),bl.set(1,0),_l.set(1,1);r=t.ray.intersectTriangle(gl,vl,yl,!1,cl);null===r&&(Ml(vl.set(-.5,.5,0),dl,a,hl,n,i),bl.set(0,1),null===(r=t.ray.intersectTriangle(gl,yl,vl,!1,cl)))||((r=t.ray.origin.distanceTo(cl))<t.near||r>t.far||e.push({distance:r,point:cl.clone(),uv:Zn.getUV(cl,gl,vl,yl,xl,bl,_l,new or),face:null,object:this}))},wl.prototype.copy=function(t){return ll.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this},wl);function wl(t){U(this,wl);var e,r=z(this,ll.call(this));return r.type="Sprite",void 0===ul&&(ul=new Di,e=new rl(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),ul.setIndex([0,1,2,0,2,3]),ul.setAttribute("position",new il(e,3,0,!1)),ul.setAttribute("uv",new il(e,2,3,!1))),r.geometry=ul,r.material=void 0!==t?t:new ol,r.center=new or(.5,.5),r}function Ml(t,e,r,n,i,a){pl.subVectors(t,r).addScalar(.5).multiply(n),void 0!==i?(fl.x=a*pl.x-i*pl.y,fl.y=i*pl.x+a*pl.y):fl.copy(pl),t.copy(e),t.x+=fl.x,t.y+=fl.y,t.applyMatrix4(ml)}Al.prototype.isSprite=!0;var Cl,Tl=new Tr,Sl=new Tr,El=(a(Il,Cl=Dn),Il.prototype.copy=function(t){Cl.prototype.copy.call(this,t,!1);for(var e=t.levels,r=0,n=e.length;r<n;r++){var i=e[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},Il.prototype.addLevel=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=Math.abs(e),r=this.levels,n=void 0,n=0;n<r.length&&!(e<r[n].distance);n++);return r.splice(n,0,{distance:e,object:t}),this.add(t),this},Il.prototype.getCurrentLevel=function(){return this._currentLevel},Il.prototype.getObjectForDistance=function(t){var e=this.levels;if(0<e.length){for(var r=void 0,r=1,n=e.length;r<n&&!(t<e[r].distance);r++);return e[r-1].object}return null},Il.prototype.raycast=function(t,e){var r;0<this.levels.length&&(Tl.setFromMatrixPosition(this.matrixWorld),r=t.ray.origin.distanceTo(Tl),this.getObjectForDistance(r).raycast(t,e))},Il.prototype.update=function(t){var e=this.levels;if(1<e.length){Tl.setFromMatrixPosition(t.matrixWorld),Sl.setFromMatrixPosition(this.matrixWorld);var r=Tl.distanceTo(Sl)/t.zoom;e[0].object.visible=!0;for(var n=void 0,n=1,i=e.length;n<i&&r>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(this._currentLevel=n-1;n<i;n++)e[n].object.visible=!1}},Il.prototype.toJSON=function(t){var e=Cl.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var a=r[n];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e},Il);function Il(){U(this,Il);var t=z(this,Cl.call(this));return t._currentLevel=0,t.type="LOD",Object.defineProperties(t,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),t.autoUpdate=!0,t}var Ll=new Tr,Rl=new vr,Pl=new vr,Dl=new Tr,Ol=new an;function Fl(t,e){Ki.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new an,this.bindMatrixInverse=new an}function Bl(){Dn.call(this),this.type="Bone"}Fl.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Fl,isSkinnedMesh:!0,copy:function(t){return Ki.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new vr,e=this.geometry.attributes.skinWeight,r=0,n=e.count;r<n;r++){t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.w=e.getW(r);var i=1/t.manhattanLength();i!=1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Ki.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,e){var r=this.skeleton,n=this.geometry;Rl.fromBufferAttribute(n.attributes.skinIndex,t),Pl.fromBufferAttribute(n.attributes.skinWeight,t),Ll.fromBufferAttribute(n.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(var i=0;i<4;i++){var a,o=Pl.getComponent(i);0!==o&&(a=Rl.getComponent(i),Ol.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),e.addScaledVector(Dl.copy(Ll).applyMatrix4(Ol),o))}return e.applyMatrix4(this.bindMatrixInverse)}}),Bl.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Bl,isBone:!0});var Nl=new an,zl=new an,Ul=(kl.prototype.init=function(){var t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new an)}},kl.prototype.calculateInverses=function(){for(var t=this.boneInverses.length=0,e=this.bones.length;t<e;t++){var r=new an;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}},kl.prototype.pose=function(){for(var t=0,e=this.bones.length;t<e;t++){var r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(var n=0,i=this.bones.length;n<i;n++){var a=this.bones[n];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}},kl.prototype.update=function(){for(var t=this.bones,e=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,i=0,a=t.length;i<a;i++){var o=t[i]?t[i].matrixWorld:zl;Nl.multiplyMatrices(o,e[i]),Nl.toArray(r,16*i)}null!==n&&(n.needsUpdate=!0)},kl.prototype.clone=function(){return new kl(this.bones,this.boneInverses)},kl.prototype.getBoneByName=function(t){for(var e=0,r=this.bones.length;e<r;e++){var n=this.bones[e];if(n.name===t)return n}},kl.prototype.dispose=function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},kl.prototype.fromJSON=function(t,e){this.uuid=t.uuid;for(var r=0,n=t.bones.length;r<n;r++){var i=t.bones[r],a=e[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new Bl),this.bones.push(a),this.boneInverses.push((new an).fromArray(t.boneInverses[r]))}return this.init(),this},kl.prototype.toJSON=function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var e=this.bones,r=this.boneInverses,n=0,i=e.length;n<i;n++){var a=e[n];t.bones.push(a.uuid);a=r[n];t.boneInverses.push(a.toArray())}return t},kl);function kl(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];U(this,kl),this.uuid=ar.generateUUID(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}var Hl=new an,Gl=new an,Vl=[],Wl=new Ki;function jl(t,e,r){Ki.call(this,t,e),this.instanceMatrix=new di(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}jl.prototype=Object.assign(Object.create(Ki.prototype),{constructor:jl,isInstancedMesh:!0,copy:function(t){return Ki.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,e){e.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var r=this.matrixWorld,n=this.count;if(Wl.geometry=this.geometry,Wl.material=this.material,void 0!==Wl.material)for(var i=0;i<n;i++){this.getMatrixAt(i,Hl),Gl.multiplyMatrices(r,Hl),Wl.matrixWorld=Gl,Wl.raycast(t,Vl);for(var a=0,o=Vl.length;a<o;a++){var s=Vl[a];s.instanceId=i,s.object=this,e.push(s)}Vl.length=0}},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new di(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Xl,ql=(a(Yl,Xl=Qn),Yl.prototype.copy=function(t){return Xl.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this},Yl);function Yl(t){U(this,Yl);var e=z(this,Xl.call(this));return e.type="LineBasicMaterial",e.color=new ai(16777215),e.linewidth=1,e.linecap="round",e.linejoin="round",e.morphTargets=!1,e.setValues(t),e}ql.prototype.isLineBasicMaterial=!0;var Zl=new Tr,Jl=new Tr,Kl=new an,Ql=new rn,$l=new qr;function tu(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Di,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new ql;Dn.call(this),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}tu.prototype=Object.assign(Object.create(Dn.prototype),{constructor:tu,isLine:!0,copy:function(t){return Dn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[0],n=1,i=e.count;n<i;n++)Zl.fromBufferAttribute(e,n-1),Jl.fromBufferAttribute(e,n),r[n]=r[n-1],r[n]+=Zl.distanceTo(Jl);t.setAttribute("lineDistance",new _i(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),$l.copy(r.boundingSphere),$l.applyMatrix4(n),$l.radius+=i,!1!==t.ray.intersectsSphere($l)){Kl.copy(n).invert(),Ql.copy(t.ray).applyMatrix4(Kl);var i=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i,o=new Tr,s=new Tr,l=new Tr,u=new Tr,c=this.isLineSegments?2:1;if(r.isBufferGeometry){var i=r.index,h=r.attributes.position;if(null!==i)for(var d=i.array,p=0,f=d.length-1;p<f;p+=c){var m=d[p],g=d[p+1];o.fromBufferAttribute(h,m),s.fromBufferAttribute(h,g),a<Ql.distanceSqToSegment(o,s,u,l)||(u.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(u))<t.near||g>t.far||e.push({distance:g,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(var v,y=0,x=h.count-1;y<x;y+=c)o.fromBufferAttribute(h,y),s.fromBufferAttribute(h,y+1),a<Ql.distanceSqToSegment(o,s,u,l)||(u.applyMatrix4(this.matrixWorld),(v=t.ray.origin.distanceTo(u))<t.near||v>t.far||e.push({distance:v,point:l.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this}))}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,r=Object.keys(e);if(0<r.length){var n=e[r[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=n.length;i<a;i++){var o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{t=t.morphTargets;void 0!==t&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var eu=new Tr,ru=new Tr;function nu(t,e){tu.call(this,t,e),this.type="LineSegments"}nu.prototype=Object.assign(Object.create(tu.prototype),{constructor:nu,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[],n=0,i=e.count;n<i;n+=2)eu.fromBufferAttribute(e,n),ru.fromBufferAttribute(e,n+1),r[n]=0===n?0:r[n-1],r[n+1]=r[n]+eu.distanceTo(ru);t.setAttribute("lineDistance",new _i(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var iu,au=(a(ou,iu=tu),ou);function ou(t,e){U(this,ou);e=z(this,iu.call(this,t,e));return e.type="LineLoop",e}au.prototype.isLineLoop=!0;var su,lu=(a(uu,su=Qn),uu.prototype.copy=function(t){return su.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},uu);function uu(t){U(this,uu);var e=z(this,su.call(this));return e.type="PointsMaterial",e.color=new ai(16777215),e.map=null,e.alphaMap=null,e.size=1,e.sizeAttenuation=!0,e.morphTargets=!1,e.setValues(t),e}lu.prototype.isPointsMaterial=!0;var cu,hu=new an,du=new rn,pu=new qr,fu=new Tr;function mu(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Di,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new lu;Dn.call(this),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}function gu(t,e,r,n,i,a,o){var s=du.distanceSqToPoint(t);s<r&&(r=new Tr,du.closestPointToPoint(t,r),r.applyMatrix4(n),(n=i.ray.origin.distanceTo(r))<i.near||n>i.far||a.push({distance:n,distanceToRay:Math.sqrt(s),point:r,index:e,face:null,object:o}))}function vu(e,t,r,n,i,a,o,s,l){U(this,vu);l=z(this,cu.call(this,e,t,r,n,i,a,o,s,l));l.format=void 0!==o?o:Nt,l.minFilter=void 0!==a?a:Et,l.magFilter=void 0!==i?i:Et,l.generateMipmaps=!1;var u=l;return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){u.needsUpdate=!0,e.requestVideoFrameCallback(t)}),l}mu.prototype=Object.assign(Object.create(Dn.prototype),{constructor:mu,isPoints:!0,copy:function(t){return Dn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),pu.copy(r.boundingSphere),pu.applyMatrix4(n),pu.radius+=i,!1!==t.ray.intersectsSphere(pu)){hu.copy(n).invert(),du.copy(t.ray).applyMatrix4(hu);var i=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i;if(r.isBufferGeometry){var i=r.index,o=r.attributes.position;if(null!==i)for(var s=i.array,l=0,u=s.length;l<u;l++){var c=s[l];fu.fromBufferAttribute(o,c),gu(fu,c,a,n,t,e,this)}else for(var h=0,d=o.count;h<d;h++)fu.fromBufferAttribute(o,h),gu(fu,h,a,n,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,r=Object.keys(e);if(0<r.length){var n=e[r[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=n.length;i<a;i++){var o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{t=t.morphTargets;void 0!==t&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),(a(vu,cu=fr),vu.prototype.clone=function(){return new this.constructor(this.image).copy(this)},vu.prototype.update=function(){var t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)},vu).prototype.isVideoTexture=!0;var yu,xu=(a(bu,yu=fr),bu);function bu(t,e,r,n,i,a,o,s,l,u,c,h){U(this,bu);h=z(this,yu.call(this,null,a,o,s,l,u,n,i,c,h));return h.image={width:e,height:r},h.mipmaps=t,h.flipY=!1,h.generateMipmaps=!1,h}xu.prototype.isCompressedTexture=!0;var _u,Au,wu=(a(Mu,_u=fr),Mu);function Mu(t,e,r,n,i,a,o,s,l){U(this,Mu);l=z(this,_u.call(this,t,e,r,n,i,a,o,s,l));return l.needsUpdate=!0,l}function Cu(t,e,r,n,i,a,o,s,l,u){if(U(this,Cu),(u=void 0!==u?u:Ut)!==Ut&&u!==kt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===(r=void 0===r&&u===Ut?Pt:r)&&u===kt&&(r=Bt);l=z(this,Au.call(this,null,n,i,a,o,s,u,r,l));return l.image={width:t,height:e},l.magFilter=void 0!==o?o:Mt,l.minFilter=void 0!==s?s:Mt,l.flipY=!1,l.generateMipmaps=!1,l}wu.prototype.isCanvasTexture=!0,(a(Cu,Au=fr),Cu).prototype.isDepthTexture=!0;var Tu,Su=(a(Eu,Tu=Di),Eu);function Eu(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2*Math.PI;U(this,Eu);var i=z(this,Tu.call(this));i.type="CircleGeometry",i.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n};var e=Math.max(3,e),a=[],o=[],s=[],l=[],u=new Tr,c=new or;o.push(0,0,0),s.push(0,0,1),l.push(.5,.5);for(var h=0,d=3;h<=e;h++,d+=3){var p=r+h/e*n;u.x=t*Math.cos(p),u.y=t*Math.sin(p),o.push(u.x,u.y,u.z),s.push(0,0,1),c.x=(o[d]/t+1)/2,c.y=(o[d+1]/t+1)/2,l.push(c.x,c.y)}for(var f=1;f<=e;f++)a.push(f,f+1,0);return i.setIndex(a),i.setAttribute("position",new _i(o,3)),i.setAttribute("normal",new _i(s,3)),i.setAttribute("uv",new _i(l,2)),i}var Iu,Lu=(a(Ru,Iu=Di),Ru);function Ru(){var y=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,_=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,A=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,t=5<arguments.length&&void 0!==arguments[5]&&arguments[5],w=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,M=7<arguments.length&&void 0!==arguments[7]?arguments[7]:2*Math.PI;U(this,Ru);var e=z(this,Iu.call(this));e.type="CylinderGeometry",e.parameters={radiusTop:y,radiusBottom:x,height:b,radialSegments:_,heightSegments:A,openEnded:t,thetaStart:w,thetaLength:M};var C=e,_=Math.floor(_),A=Math.floor(A),T=[],S=[],E=[],I=[],L=0,R=[],P=b/2,D=0;function r(t){for(var e=L,r=new or,n=new Tr,i=0,a=!0===t?y:x,o=!0===t?1:-1,s=1;s<=_;s++)S.push(0,P*o,0),E.push(0,o,0),I.push(.5,.5),L++;for(var l=L,u=0;u<=_;u++){var c=u/_*M+w,h=Math.cos(c),c=Math.sin(c);n.x=a*c,n.y=P*o,n.z=a*h,S.push(n.x,n.y,n.z),E.push(0,o,0),r.x=.5*h+.5,r.y=.5*c*o+.5,I.push(r.x,r.y),L++}for(var d=0;d<_;d++){var p=e+d,f=l+d;!0===t?T.push(f,f+1,p):T.push(f+1,f,p),i+=3}C.addGroup(D,i,!0===t?1:2),D+=i}return function(){for(var t=new Tr,e=new Tr,r=0,n=(x-y)/b,i=0;i<=A;i++){for(var a=[],o=i/A,s=o*(x-y)+y,l=0;l<=_;l++){var u=l/_,c=u*M+w,h=Math.sin(c),c=Math.cos(c);e.x=s*h,e.y=-o*b+P,e.z=s*c,S.push(e.x,e.y,e.z),t.set(h,n,c).normalize(),E.push(t.x,t.y,t.z),I.push(u,1-o),a.push(L++)}R.push(a)}for(var d=0;d<_;d++)for(var p=0;p<A;p++){var f=R[p][d],m=R[p+1][d],g=R[p+1][d+1],v=R[p][d+1];T.push(f,m,v),T.push(m,g,v),r+=6}C.addGroup(D,r,0),D+=r}(),!1===t&&(0<y&&r(!0),0<x&&r(!1)),e.setIndex(T),e.setAttribute("position",new _i(S,3)),e.setAttribute("normal",new _i(E,3)),e.setAttribute("uv",new _i(I,2)),e}var Pu,Du=(a(Ou,Pu=Lu),Ou);function Ou(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2*Math.PI;U(this,Ou);var s=z(this,Pu.call(this,0,t,e,r,n,i,a,o));return s.type="ConeGeometry",s.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o},s}var Fu,Bu=(a(Nu,Fu=Di),Nu);function Nu(r,i){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;U(this,Nu);var n=z(this,Fu.call(this));n.type="PolyhedronGeometry",n.parameters={vertices:r,indices:i,radius:t,detail:e};var c=[],h=[];function f(t){c.push(t.x,t.y,t.z)}function a(t,e){t*=3;e.x=r[0+t],e.y=r[1+t],e.z=r[2+t]}function d(t,e,r,n){n<0&&1===t.x&&(h[e]=t.x-1),0===r.x&&0===r.z&&(h[e]=n/2/Math.PI+.5)}function p(t){return Math.atan2(t.z,-t.x)}return function(p){for(var t=new Tr,e=new Tr,r=new Tr,n=0;n<i.length;n+=3)a(i[n+0],t),a(i[n+1],e),a(i[n+2],r),function(t,e,r){for(var n=p+1,i=[],a=0;a<=n;a++){i[a]=[];for(var o=t.clone().lerp(r,a/n),s=e.clone().lerp(r,a/n),l=n-a,u=0;u<=l;u++)i[a][u]=0===u&&a===n?o:o.clone().lerp(s,u/l)}for(var c=0;c<n;c++)for(var h=0;h<2*(n-c)-1;h++){var d=Math.floor(h/2);h%2==0?(f(i[c][d+1]),f(i[c+1][d]),f(i[c][d])):(f(i[c][d+1]),f(i[c+1][d+1]),f(i[c+1][d]))}}(t,e,r)}(e),function(t){for(var e=new Tr,r=0;r<c.length;r+=3)e.x=c[r+0],e.y=c[r+1],e.z=c[r+2],e.normalize().multiplyScalar(t),c[r+0]=e.x,c[r+1]=e.y,c[r+2]=e.z}(t),function(){for(var t=new Tr,e=0;e<c.length;e+=3){t.x=c[e+0],t.y=c[e+1],t.z=c[e+2];var r=p(t)/2/Math.PI+.5,n=function(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}(t)/Math.PI+.5;h.push(r,1-n)}(function(){for(var t=new Tr,e=new Tr,r=new Tr,n=new Tr,i=new or,a=new or,o=new or,s=0,l=0;s<c.length;s+=9,l+=6){t.set(c[s+0],c[s+1],c[s+2]),e.set(c[s+3],c[s+4],c[s+5]),r.set(c[s+6],c[s+7],c[s+8]),i.set(h[l+0],h[l+1]),a.set(h[l+2],h[l+3]),o.set(h[l+4],h[l+5]),n.copy(t).add(e).add(r).divideScalar(3);var u=p(n);d(i,l+0,t,u),d(a,l+2,e,u),d(o,l+4,r,u)}})(),function(){for(var t=0;t<h.length;t+=6){var e=h[t+0],r=h[t+2],n=h[t+4],i=Math.max(e,r,n),a=Math.min(e,r,n);.9<i&&a<.1&&(e<.2&&(h[t+0]+=1),r<.2&&(h[t+2]+=1),n<.2&&(h[t+4]+=1))}}()}(),n.setAttribute("position",new _i(c,3)),n.setAttribute("normal",new _i(c.slice(),3)),n.setAttribute("uv",new _i(h,2)),0===e?n.computeVertexNormals():n.normalizeNormals(),n}var zu,Uu=(a(ku,zu=Bu),ku);function ku(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,ku);var r=(1+Math.sqrt(5))/2,n=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],n=z(this,zu.call(this,n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e));return n.type="DodecahedronGeometry",n.parameters={radius:t,detail:e},n}var Hu,Gu=new Tr,Vu=new Tr,Wu=new Tr,ju=new Zn,Xu=(a(qu,Hu=Di),qu);function qu(t,e){U(this,qu);var r=z(this,Hu.call(this));if(r.type="EdgesGeometry",r.parameters={thresholdAngle:e},e=void 0!==e?e:1,!0===t.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),z(r);for(var n,i,a,o=Math.pow(10,4),s=Math.cos(ar.DEG2RAD*e),l=t.getIndex(),u=t.getAttribute("position"),c=(l||u).count,h=[0,0,0],d=["a","b","c"],p=new Array(3),f={},m=[],g=0;g<c;g+=3){l?(h[0]=l.getX(g),h[1]=l.getX(g+1),h[2]=l.getX(g+2)):(h[0]=g,h[1]=g+1,h[2]=g+2);var v=ju.a,y=ju.b,x=ju.c;if(v.fromBufferAttribute(u,h[0]),y.fromBufferAttribute(u,h[1]),x.fromBufferAttribute(u,h[2]),ju.getNormal(Wu),p[0]=Math.round(v.x*o)+","+Math.round(v.y*o)+","+Math.round(v.z*o),p[1]=Math.round(y.x*o)+","+Math.round(y.y*o)+","+Math.round(y.z*o),p[2]=Math.round(x.x*o)+","+Math.round(x.y*o)+","+Math.round(x.z*o),p[0]!==p[1]&&p[1]!==p[2]&&p[2]!==p[0])for(var b=0;b<3;b++){var _=(b+1)%3,A=p[b],w=p[_],M=ju[d[b]],C=ju[d[_]],T=A+"_"+w,A=w+"_"+A;A in f&&f[A]?(Wu.dot(f[A].normal)<=s&&(m.push(M.x,M.y,M.z),m.push(C.x,C.y,C.z)),f[A]=null):T in f||(f[T]={index0:h[b],index1:h[_],normal:Wu.clone()})}}for(n in f)f[n]&&(i=(a=f[n]).index0,a=a.index1,Gu.fromBufferAttribute(u,i),Vu.fromBufferAttribute(u,a),m.push(Gu.x,Gu.y,Gu.z),m.push(Vu.x,Vu.y,Vu.z));return r.setAttribute("position",new _i(m,3)),r}var Yu=function(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,a=Zu(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;var s,l,u=void 0,c=void 0,h=void 0,d=void 0,p=void 0;if(n&&(a=function(t,e,r,n){var i=[],a=void 0,o=void 0,s=void 0,l=void 0,u=void 0;for(a=0,o=e.length;a<o;a++)s=e[a]*n,l=a<o-1?e[a+1]*n:t.length,(u=Zu(t,s,l,n,!1))===u.next&&(u.steiner=!0),i.push(function(t){var e=t,r=t;for(;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next,e!==t;);return r}(u));for(i.sort(Qu),a=0;a<i.length;a++)!function(t,e){(e=function(t,e){var r=e,n=t.x,i=t.y,a=-1/0,o=void 0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&a<s){if((a=s)===n){if(i===r.y)return r;if(i===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}}while(r=r.next,r!==e);if(!o)return null;if(n===a)return o;var l=o,u=o.x,c=o.y,h=1/0,d=void 0;r=o;for(;n>=r.x&&r.x>=u&&n!==r.x&&tc(i<c?n:a,i,u,c,i<c?a:n,i,r.x,r.y)&&(d=Math.abs(i-r.y)/(n-r.x),oc(r,t)&&(d<h||d===h&&(r.x>o.x||r.x===o.x&&function(t,e){return ec(t.prev,t,e.prev)<0&&ec(e.next,t,t.next)<0}(o,r)))&&(o=r,h=d)),r=r.next,r!==l;);return o}(t,e))&&(t=sc(e,t),Ju(e,e.next),Ju(t,t.next))}(i[a],r),r=Ju(r,r.next);return r}(t,e,a,r)),t.length>80*r){for(var u=h=t[0],c=d=t[1],f=r;f<i;f+=r)(s=t[f])<u&&(u=s),(l=t[f+1])<c&&(c=l),h<s&&(h=s),d<l&&(d=l);p=0!==(p=Math.max(h-u,d-c))?1/p:0}return Ku(a,o,r,u,c,p),o};function Zu(t,e,r,n,i){var a=void 0,o=void 0;if(i===0<function(t,e,r,n){for(var i=0,a=e,o=r-n;a<r;a+=n)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}(t,e,r,n))for(a=e;a<r;a+=n)o=lc(a,t[a],t[a+1],o);else for(a=r-n;e<=a;a-=n)o=lc(a,t[a],t[a+1],o);return o&&rc(o,o.next)&&(uc(o),o=o.next),o}function Ju(t,e){if(!t)return t;e=e||t;var r=t,n=void 0;do{if(n=!1,r.steiner||!rc(r,r.next)&&0!==ec(r.prev,r,r.next))r=r.next;else{if(uc(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ku(t,e,r,n,i,a,o){if(t){!o&&a&&function(t,e,r,n){for(var i=t;null===i.z&&(i.z=$u(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==t;);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e=void 0,r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=1;do{for(r=t,a=t=null,o=0;r;){for(o++,n=r,e=s=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;0<s||0<l&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(r=(i=r).nextZ,s--):(n=(i=n).nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=n}}while(a.nextZ=null,u*=2,1<o)}(i)}(t,n,i,a);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?function(t,e,r,n){var i=t.prev,a=t,o=t.next;if(0<=ec(i,a,o))return!1;var s=(i.x<a.x?i.x<o.x?i:o:a.x<o.x?a:o).x,l=(i.y<a.y?i.y<o.y?i:o:a.y<o.y?a:o).y,u=(i.x>a.x?i.x>o.x?i:o:a.x>o.x?a:o).x,c=(i.y>a.y?i.y>o.y?i:o:a.y>o.y?a:o).y,h=$u(s,l,e,r,n),d=$u(u,c,e,r,n),p=t.prevZ,f=t.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&tc(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=ec(p.prev,p,p.next))return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&tc(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=ec(f.prev,f,f.next))return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&tc(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=ec(p.prev,p,p.next))return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&tc(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=ec(f.prev,f,f.next))return!1;f=f.nextZ}return!0}(t,n,i,a):function(t){var e=t.prev,r=t,n=t.next;if(0<=ec(e,r,n))return!1;var i=t.next.next;for(;i!==t.prev;){if(tc(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&0<=ec(i.prev,i,i.next))return!1;i=i.next}return!0}(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),uc(t),t=l.next,u=l.next;else if((t=l)===u){o?1===o?Ku(t=function(t,e,r){var n=t;do{var i=n.prev,a=n.next.next}while(!rc(i,a)&&nc(i,n,n.next,a)&&oc(i,a)&&oc(a,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(a.i/r),uc(n),uc(n.next),n=t=a),n=n.next,n!==t);return Ju(n)}(Ju(t),e,r),e,r,n,i,a,2):2===o&&function(t,e,r,n,i,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&nc(r,r.next,t,e))return!0}while(r=r.next,r!==t);return!1}(t,e)&&(oc(t,e)&&oc(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;for(;r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next,r!==t;);return n}(t,e)&&(ec(t.prev,t,e.prev)||ec(t,e.prev,e))||rc(t,e)&&0<ec(t.prev,t,t.next)&&0<ec(e.prev,e,e.next))}(o,s)){var l=sc(o,s);return o=Ju(o,o.next),l=Ju(l,l.next),Ku(o,e,r,n,i,a),Ku(l,e,r,n,i,a)}s=s.next}}while((o=o.next)!==t)}(t,e,r,n,i,a):Ku(Ju(t),e,r,n,i,a,1);break}}}function Qu(t,e){return t.x-e.x}function $u(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function tc(t,e,r,n,i,a,o,s){return 0<=(i-o)*(e-s)-(t-o)*(a-s)&&0<=(t-o)*(n-s)-(r-o)*(e-s)&&0<=(r-o)*(a-s)-(i-o)*(n-s)}function ec(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function rc(t,e){return t.x===e.x&&t.y===e.y}function nc(t,e,r,n){var i=ac(ec(t,e,r)),a=ac(ec(t,e,n)),o=ac(ec(r,n,t)),s=ac(ec(r,n,e));return i!==a&&o!==s||(0===i&&ic(t,r,e)||(0===a&&ic(t,n,e)||(0===o&&ic(r,t,n)||!(0!==s||!ic(r,e,n)))))}function ic(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function ac(t){return 0<t?1:t<0?-1:0}function oc(t,e){return ec(t.prev,t,t.next)<0?0<=ec(t,e,t.next)&&0<=ec(t,t.prev,e):ec(t,e,t.prev)<0||ec(t,t.next,e)<0}function sc(t,e){var r=new cc(t.i,t.x,t.y),n=new cc(e.i,e.x,e.y),i=t.next,a=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(a.next=n).prev=a,n}function lc(t,e,r,n){r=new cc(t,e,r);return n?(r.next=n.next,(r.prev=n).next.prev=r,n.next=r):(r.prev=r).next=r,r}function uc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function cc(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var hc={area:function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},isClockWise:function(t){return hc.area(t)<0},triangulateShape:function(t,e){var r=[],n=[],i=[];dc(t),pc(r,t);var a=t.length;e.forEach(dc);for(var o=0;o<e.length;o++)n.push(a),a+=e[o].length,pc(r,e[o]);for(var s=Yu(r,n),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}};function dc(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function pc(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}var fc,mc=(a(gc,fc=Di),gc.prototype.toJSON=function(){var t=Di.prototype.toJSON.call(this);return function(t,e,r){if(r.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++){var a=t[n];r.shapes.push(a.uuid)}else r.shapes.push(t.uuid);void 0!==e.extrudePath&&(r.options.extrudePath=e.extrudePath.toJSON());return r}(this.parameters.shapes,this.parameters.options,t)},gc);function gc(t,Lt){U(this,gc);var e=z(this,fc.call(this));e.type="ExtrudeGeometry",e.parameters={shapes:t,options:Lt},t=Array.isArray(t)?t:[t];for(var Rt=e,Pt=[],Dt=[],r=0,n=t.length;r<n;r++)!function(t){var n=[],e=void 0!==Lt.curveSegments?Lt.curveSegments:12,h=void 0!==Lt.steps?Lt.steps:1,r=void 0!==Lt.depth?Lt.depth:100,c=void 0===Lt.bevelEnabled||Lt.bevelEnabled,i=void 0!==Lt.bevelThickness?Lt.bevelThickness:6,a=void 0!==Lt.bevelSize?Lt.bevelSize:i-2,o=void 0!==Lt.bevelOffset?Lt.bevelOffset:0,d=void 0!==Lt.bevelSegments?Lt.bevelSegments:3,s=Lt.extrudePath,p=void 0!==Lt.UVGenerator?Lt.UVGenerator:vc;void 0!==Lt.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),r=Lt.amount);var l=void 0,u=!1,f=void 0,m=void 0,g=void 0,v=void 0;s&&(l=s.getSpacedPoints(h),c=!(u=!0),f=s.computeFrenetFrames(h,!1),m=new Tr,g=new Tr,v=new Tr),c||(o=a=i=d=0);var y=(e=t.extractPoints(e)).shape,x=e.holes;if(!hc.isClockWise(y)){y=y.reverse();for(var b=0,_=x.length;b<_;b++){var A=x[b];hc.isClockWise(A)&&(x[b]=A.reverse())}}for(var w=hc.triangulateShape(y,x),M=y,C=0,T=x.length;C<T;C++){var S=x[C];y=y.concat(S)}function E(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}var I=y.length,L=w.length;function R(t,e,r){var n=void 0,i=void 0,a=void 0,o=t.x-e.x,s=t.y-e.y,l=r.x-t.x,u=r.y-t.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),p=Math.sqrt(l*l+u*u),h=e.x-s/d,d=e.y+o/d,p=((r.x-u/p-h)*u-(r.y+l/p-d)*l)/(o*u-s*l),p=(n=h+o*p-t.x)*n+(i=d+s*p-t.y)*i;if(p<=2)return new or(n,i);a=Math.sqrt(p/2)}else{p=!1;o>Number.EPSILON?l>Number.EPSILON&&(p=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(p=!0):Math.sign(s)===Math.sign(u)&&(p=!0),a=p?(n=-s,i=o,Math.sqrt(c)):(n=o,i=s,Math.sqrt(c/2))}return new or(n/a,i/a)}for(var P=[],D=0,O=M.length,F=O-1,B=D+1;D<O;D++,F++,B++)F===O&&(F=0),B===O&&(B=0),P[D]=R(M[D],M[F],M[B]);for(var N=[],z=void 0,U=P.concat(),k=0,H=x.length;k<H;k++){var G=x[k];z=[];for(var V=0,W=G.length,j=W-1,X=V+1;V<W;V++,j++,X++)j===W&&(j=0),X===W&&(X=0),z[V]=R(G[V],G[j],G[X]);N.push(z),U=U.concat(z)}for(var q=0;q<d;q++){for(var Y=q/d,Z=i*Math.cos(Y*Math.PI/2),J=a*Math.sin(Y*Math.PI/2)+o,K=0,Q=M.length;K<Q;K++){var $=E(M[K],P[K],J);Tt($.x,$.y,-Z)}for(var tt=0,et=x.length;tt<et;tt++){var rt=x[tt];z=N[tt];for(var nt=0,it=rt.length;nt<it;nt++){var at=E(rt[nt],z[nt],J);Tt(at.x,at.y,-Z)}}}for(var ot=a+o,st=0;st<I;st++){var lt=c?E(y[st],U[st],ot):y[st];u?(g.copy(f.normals[0]).multiplyScalar(lt.x),m.copy(f.binormals[0]).multiplyScalar(lt.y),v.copy(l[0]).add(g).add(m),Tt(v.x,v.y,v.z)):Tt(lt.x,lt.y,0)}for(var ut=1;ut<=h;ut++)for(var ct=0;ct<I;ct++){var ht=c?E(y[ct],U[ct],ot):y[ct];u?(g.copy(f.normals[ut]).multiplyScalar(ht.x),m.copy(f.binormals[ut]).multiplyScalar(ht.y),v.copy(l[ut]).add(g).add(m),Tt(v.x,v.y,v.z)):Tt(ht.x,ht.y,r/h*ut)}for(var dt=d-1;0<=dt;dt--){for(var pt=dt/d,ft=i*Math.cos(pt*Math.PI/2),mt=a*Math.sin(pt*Math.PI/2)+o,gt=0,vt=M.length;gt<vt;gt++){var yt=E(M[gt],P[gt],mt);Tt(yt.x,yt.y,r+ft)}for(var xt=0,bt=x.length;xt<bt;xt++){var _t=x[xt];z=N[xt];for(var At=0,wt=_t.length;At<wt;At++){var Mt=E(_t[At],z[At],mt);u?Tt(Mt.x,Mt.y+l[h-1].y,l[h-1].x+ft):Tt(Mt.x,Mt.y,r+ft)}}}function Ct(t,e){for(var r,n=t.length;0<=--n;){var i=n,a=n-1;a<0&&(a=t.length-1);for(var o=0,s=h+2*d;o<s;o++){var l=I*o,u=I*(o+1),c=e+i+l;r=e+a+l,l=e+a+u,u=e+i+u,Et(c),Et(r),Et(u),Et(r),Et(l),Et(u),u=Pt.length/3,It((u=p.generateSideWallUV(Rt,Pt,u-6,u-3,u-2,u-1))[0]),It(u[1]),It(u[3]),It(u[1]),It(u[2]),!void It(u[3])}}}function Tt(t,e,r){n.push(t),n.push(e),n.push(r)}function St(t,e,r){Et(t),Et(e),Et(r);r=Pt.length/3,r=p.generateTopUV(Rt,Pt,r-3,r-2,r-1);It(r[0]),It(r[1]),It(r[2])}function Et(t){Pt.push(n[3*t+0]),Pt.push(n[3*t+1]),Pt.push(n[3*t+2])}function It(t){Dt.push(t.x),Dt.push(t.y)}(function(){var t=Pt.length/3;if(c){for(var e=0*I,r=0;r<L;r++){var n=w[r];St(n[2]+e,n[1]+e,n[0]+e)}for(var e=I*(h+2*d),i=0;i<L;i++){var a=w[i];St(a[0]+e,a[1]+e,a[2]+e)}}else{for(var o=0;o<L;o++){var s=w[o];St(s[2],s[1],s[0])}for(var l=0;l<L;l++){var u=w[l];St(u[0]+I*h,u[1]+I*h,u[2]+I*h)}}Rt.addGroup(t,Pt.length/3-t,0)})(),function(){var t=Pt.length/3,e=0;Ct(M,e),e+=M.length;for(var r=0,n=x.length;r<n;r++){var i=x[r];Ct(i,e),e+=i.length}Rt.addGroup(t,Pt.length/3-t,1)}()}(t[r]);return e.setAttribute("position",new _i(Pt,3)),e.setAttribute("uv",new _i(Dt,2)),e.computeVertexNormals(),e}var vc={generateTopUV:function(t,e,r,n,i){var a=e[3*r],o=e[3*r+1],s=e[3*n],r=e[3*n+1],n=e[3*i],i=e[3*i+1];return[new or(a,o),new or(s,r),new or(n,i)]},generateSideWallUV:function(t,e,r,n,i,a){var o=e[3*r],s=e[3*r+1],l=e[3*r+2],u=e[3*n],c=e[3*n+1],h=e[3*n+2],d=e[3*i],p=e[3*i+1],r=e[3*i+2],n=e[3*a],i=e[3*a+1],a=e[3*a+2];return Math.abs(s-c)<.01?[new or(o,1-l),new or(u,1-h),new or(d,1-r),new or(n,1-a)]:[new or(s,1-l),new or(c,1-h),new or(p,1-r),new or(i,1-a)]}};var yc,xc=(a(bc,yc=Bu),bc);function bc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,bc);var r=(1+Math.sqrt(5))/2,r=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],r=z(this,yc.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e));return r.type="IcosahedronGeometry",r.parameters={radius:t,detail:e},r}var _c,Ac=(a(wc,_c=Di),wc);function wc(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2*Math.PI;U(this,wc);var i=z(this,_c.call(this));i.type="LatheGeometry",i.parameters={points:t,segments:e,phiStart:r,phiLength:n};for(var e=Math.floor(e),n=ar.clamp(n,0,2*Math.PI),a=[],o=[],s=[],l=1/e,u=new Tr,c=new or,h=0;h<=e;h++)for(var d=r+h*l*n,p=Math.sin(d),f=Math.cos(d),m=0;m<=t.length-1;m++)u.x=t[m].x*p,u.y=t[m].y,u.z=t[m].x*f,o.push(u.x,u.y,u.z),c.x=h/e,c.y=m/(t.length-1),s.push(c.x,c.y);for(var g=0;g<e;g++)for(var v=0;v<t.length-1;v++){var y=v+g*t.length,x=y+t.length,b=y+t.length+1,_=y+1;a.push(y,x,_),a.push(x,b,_)}if(i.setIndex(a),i.setAttribute("position",new _i(o,3)),i.setAttribute("uv",new _i(s,2)),i.computeVertexNormals(),n===2*Math.PI)for(var A=i.attributes.normal.array,w=new Tr,M=new Tr,C=new Tr,T=e*t.length*3,S=0,E=0;S<t.length;S++,E+=3)w.x=A[E+0],w.y=A[E+1],w.z=A[E+2],M.x=A[T+E+0],M.y=A[T+E+1],M.z=A[T+E+2],C.addVectors(w,M).normalize(),A[E+0]=A[T+E+0]=C.x,A[E+1]=A[T+E+1]=C.y,A[E+2]=A[T+E+2]=C.z;return i}var Mc,Cc=(a(Tc,Mc=Bu),Tc);function Tc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,Tc);var r=z(this,Mc.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e));return r.type="OctahedronGeometry",r.parameters={radius:t,detail:e},r}function Sc(t,e,r){Di.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r};var n=[],i=[],a=[],o=[],s=new Tr,l=new Tr,u=new Tr,c=new Tr,h=new Tr;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=e+1,p=0;p<=r;p++)for(var f=p/r,m=0;m<=e;m++){var g=m/e;t(g,f,l),i.push(l.x,l.y,l.z),0<=g-1e-5?(t(g-1e-5,f,u),c.subVectors(l,u)):(t(1e-5+g,f,u),c.subVectors(u,l)),0<=f-1e-5?(t(g,f-1e-5,u),h.subVectors(l,u)):(t(g,1e-5+f,u),h.subVectors(u,l)),s.crossVectors(c,h).normalize(),a.push(s.x,s.y,s.z),o.push(g,f)}for(var v=0;v<r;v++)for(var y=0;y<e;y++){var x=v*d+y,b=v*d+y+1,_=(v+1)*d+y+1,A=(v+1)*d+y;n.push(x,b,A),n.push(b,_,A)}this.setIndex(n),this.setAttribute("position",new _i(i,3)),this.setAttribute("normal",new _i(a,3)),this.setAttribute("uv",new _i(o,2))}(Sc.prototype=Object.create(Di.prototype)).constructor=Sc;var Ec,Ic=(a(Lc,Ec=Di),Lc);function Lc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2*Math.PI;U(this,Lc);var o=z(this,Ec.call(this));o.type="RingGeometry",o.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a};for(var r=Math.max(3,r),s=[],l=[],u=[],c=[],h=t,d=(e-t)/(n=Math.max(1,n)),p=new Tr,f=new or,m=0;m<=n;m++){for(var g=0;g<=r;g++){var v=i+g/r*a;p.x=h*Math.cos(v),p.y=h*Math.sin(v),l.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,c.push(f.x,f.y)}h+=d}for(var y=0;y<n;y++)for(var x=y*(r+1),b=0;b<r;b++){var _=b+x,A=_+r+1,w=_+r+2,M=_+1;s.push(_,A,M),s.push(A,w,M)}return o.setIndex(s),o.setAttribute("position",new _i(l,3)),o.setAttribute("normal",new _i(u,3)),o.setAttribute("uv",new _i(c,2)),o}var Rc,Pc=(a(Dc,Rc=Di),Dc.prototype.toJSON=function(){var t=Di.prototype.toJSON.call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(var r=0,n=t.length;r<n;r++){var i=t[r];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)},Dc);function Dc(t){var x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12;U(this,Dc);var e=z(this,Rc.call(this));e.type="ShapeGeometry",e.parameters={shapes:t,curveSegments:x};var b=[],_=[],A=[],w=[],r=0,M=0;if(!1===Array.isArray(t))i(t);else for(var n=0;n<t.length;n++)i(t[n]),e.addGroup(r,M,n),r+=M,M=0;function i(t){var e=_.length/3,t=t.extractPoints(x),r=t.shape,n=t.holes;!1===hc.isClockWise(r)&&(r=r.reverse());for(var i=0,a=n.length;i<a;i++){var o=n[i];!0===hc.isClockWise(o)&&(n[i]=o.reverse())}for(var s=hc.triangulateShape(r,n),l=0,u=n.length;l<u;l++)var c=n[l],r=r.concat(c);for(var h=0,d=r.length;h<d;h++){var p=r[h];_.push(p.x,p.y,0),A.push(0,0,1),w.push(p.x,p.y)}for(var f=0,m=s.length;f<m;f++){var g=s[f],v=g[0]+e,y=g[1]+e,g=g[2]+e;b.push(v,y,g),M+=3}}return e.setIndex(b),e.setAttribute("position",new _i(_,3)),e.setAttribute("normal",new _i(A,3)),e.setAttribute("uv",new _i(w,2)),e}var Oc,Fc=(a(Bc,Oc=Di),Bc);function Bc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:6,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:Math.PI;U(this,Bc);var s=z(this,Oc.call(this));s.type="SphereGeometry",s.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o};for(var e=Math.max(3,Math.floor(e)),r=Math.max(2,Math.floor(r)),l=Math.min(a+o,Math.PI),u=0,c=[],h=new Tr,d=new Tr,p=[],f=[],m=[],g=[],v=0;v<=r;v++){var y=[],x=v/r,b=0;0==v&&0==a?b=.5/e:v==r&&l==Math.PI&&(b=-.5/e);for(var _=0;_<=e;_++){var A=_/e;h.x=-t*Math.cos(n+A*i)*Math.sin(a+x*o),h.y=t*Math.cos(a+x*o),h.z=t*Math.sin(n+A*i)*Math.sin(a+x*o),f.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(A+b,1-x),y.push(u++)}c.push(y)}for(var w=0;w<r;w++)for(var M=0;M<e;M++){var C=c[w][M+1],T=c[w][M],S=c[w+1][M],E=c[w+1][M+1];(0!==w||0<a)&&p.push(C,T,E),(w!==r-1||l<Math.PI)&&p.push(T,S,E)}return s.setIndex(p),s.setAttribute("position",new _i(f,3)),s.setAttribute("normal",new _i(m,3)),s.setAttribute("uv",new _i(g,2)),s}var Nc,zc=(a(Uc,Nc=Bu),Uc);function Uc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;U(this,Uc);var r=z(this,Nc.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e));return r.type="TetrahedronGeometry",r.parameters={radius:t,detail:e},r}var kc,r=(a(Hc,kc=mc),Hc);function Hc(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};U(this,Hc);var r=e.font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),z(n,new Di);t=r.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1);var n=z(this,kc.call(this,t,e));return n.type="TextGeometry",n}var Gc,e=(a(Vc,Gc=Di),Vc);function Vc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.4,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:6,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2*Math.PI;U(this,Vc);var a=z(this,Gc.call(this));a.type="TorusGeometry",a.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i};for(var r=Math.floor(r),n=Math.floor(n),o=[],s=[],l=[],u=[],c=new Tr,h=new Tr,d=new Tr,p=0;p<=r;p++)for(var f=0;f<=n;f++){var m=f/n*i,g=p/r*Math.PI*2;h.x=(t+e*Math.cos(g))*Math.cos(m),h.y=(t+e*Math.cos(g))*Math.sin(m),h.z=e*Math.sin(g),s.push(h.x,h.y,h.z),c.x=t*Math.cos(m),c.y=t*Math.sin(m),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(f/n),u.push(p/r)}for(var v=1;v<=r;v++)for(var y=1;y<=n;y++){var x=(n+1)*v+y-1,b=(n+1)*(v-1)+y-1,_=(n+1)*(v-1)+y,A=(n+1)*v+y;o.push(x,b,A),o.push(b,_,A)}return a.setIndex(o),a.setAttribute("position",new _i(s,3)),a.setAttribute("normal",new _i(l,3)),a.setAttribute("uv",new _i(u,2)),a}var Wc,Ka=(a(jc,Wc=Di),jc);function jc(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.4,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:64,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:3;U(this,jc);var o=z(this,Wc.call(this));o.type="TorusKnotGeometry",o.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a};for(var r=Math.floor(r),n=Math.floor(n),s=[],l=[],u=[],c=[],h=new Tr,d=new Tr,p=new Tr,f=new Tr,m=new Tr,g=new Tr,v=new Tr,y=0;y<=r;++y){var x=y/r*i*Math.PI*2;I(x,i,a,t,p),I(.01+x,i,a,t,f),g.subVectors(f,p),v.addVectors(f,p),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize();for(var b=0;b<=n;++b){var _=b/n*Math.PI*2,A=-e*Math.cos(_),_=e*Math.sin(_);h.x=p.x+(A*v.x+_*m.x),h.y=p.y+(A*v.y+_*m.y),h.z=p.z+(A*v.z+_*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),u.push(d.x,d.y,d.z),c.push(y/r),c.push(b/n)}}for(var w=1;w<=r;w++)for(var M=1;M<=n;M++){var C=(n+1)*(w-1)+(M-1),T=(n+1)*w+(M-1),S=(n+1)*w+M,E=(n+1)*(w-1)+M;s.push(C,T,E),s.push(T,S,E)}function I(t,e,r,n,i){var a=Math.cos(t),o=Math.sin(t),e=r/e*t,t=Math.cos(e);i.x=n*(2+t)*.5*a,i.y=n*(2+t)*o*.5,i.z=n*Math.sin(e)*.5}return o.setIndex(s),o.setAttribute("position",new _i(l,3)),o.setAttribute("normal",new _i(u,3)),o.setAttribute("uv",new _i(c,2)),o}var Xc,to=(a(qc,Xc=Di),qc.prototype.toJSON=function(){var t=Di.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},qc);function qc(o){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:64,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,e=4<arguments.length&&void 0!==arguments[4]&&arguments[4];U(this,qc);var t=z(this,Xc.call(this));t.type="TubeGeometry",t.parameters={path:o,tubularSegments:s,radius:l,radialSegments:u,closed:e};var c=o.computeFrenetFrames(s,e);t.tangents=c.tangents,t.normals=c.normals,t.binormals=c.binormals;var h=new Tr,d=new Tr,r=new or,p=new Tr,f=[],m=[],n=[],g=[];function i(t){p=o.getPointAt(t/s,p);for(var e=c.normals[t],r=c.binormals[t],n=0;n<=u;n++){var i=n/u*Math.PI*2,a=Math.sin(i),i=-Math.cos(i);d.x=i*e.x+a*r.x,d.y=i*e.y+a*r.y,d.z=i*e.z+a*r.z,d.normalize(),m.push(d.x,d.y,d.z),h.x=p.x+l*d.x,h.y=p.y+l*d.y,h.z=p.z+l*d.z,f.push(h.x,h.y,h.z)}}return function(){for(var t=0;t<s;t++)i(t);i(!1===e?s:0),function(){for(var t=0;t<=s;t++)for(var e=0;e<=u;e++)r.x=t/s,r.y=e/u,n.push(r.x,r.y)}(),function(){for(var t=1;t<=s;t++)for(var e=1;e<=u;e++){var r=(u+1)*(t-1)+(e-1),n=(u+1)*t+(e-1),i=(u+1)*t+e,a=(u+1)*(t-1)+e;g.push(r,n,a),g.push(n,i,a)}}()}(),t.setIndex(g),t.setAttribute("position",new _i(f,3)),t.setAttribute("normal",new _i(m,3)),t.setAttribute("uv",new _i(n,2)),t}var Yc,Zc=(a(Jc,Yc=Di),Jc);function Jc(t){U(this,Jc);var e=z(this,Yc.call(this));if(e.type="WireframeGeometry",!0===t.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),z(e);var r=[],n=[0,0],i={},a=new Tr;if(null!==t.index){for(var o,s=t.attributes.position,l=t.index,u=t.groups,c=0,h=(u=0===u.length?[{start:0,count:l.count,materialIndex:0}]:u).length;c<h;++c)for(var d=u[c],p=d.start,f=p,m=p+d.count;f<m;f+=3)for(var g=0;g<3;g++){var v=l.getX(f+g),y=l.getX(f+(g+1)%3);n[0]=Math.min(v,y),n[1]=Math.max(v,y);y=n[0]+","+n[1];void 0===i[y]&&(i[y]={index1:n[0],index2:n[1]})}for(o in i){var x=i[o];a.fromBufferAttribute(s,x.index1),r.push(a.x,a.y,a.z),a.fromBufferAttribute(s,x.index2),r.push(a.x,a.y,a.z)}}else for(var b=t.attributes.position,_=0,A=b.count/3;_<A;_++)for(var w=0;w<3;w++){var M=3*_+w;a.fromBufferAttribute(b,M),r.push(a.x,a.y,a.z);M=3*_+(w+1)%3;a.fromBufferAttribute(b,M),r.push(a.x,a.y,a.z)}return e.setAttribute("position",new _i(r,3)),e}var Kc,Qc=Object.freeze({__proto__:null,BoxGeometry:ta,BoxBufferGeometry:ta,CircleGeometry:Su,CircleBufferGeometry:Su,ConeGeometry:Du,ConeBufferGeometry:Du,CylinderGeometry:Lu,CylinderBufferGeometry:Lu,DodecahedronGeometry:Uu,DodecahedronBufferGeometry:Uu,EdgesGeometry:Xu,ExtrudeGeometry:mc,ExtrudeBufferGeometry:mc,IcosahedronGeometry:xc,IcosahedronBufferGeometry:xc,LatheGeometry:Ac,LatheBufferGeometry:Ac,OctahedronGeometry:Cc,OctahedronBufferGeometry:Cc,ParametricGeometry:Sc,ParametricBufferGeometry:Sc,PlaneGeometry:Ra,PlaneBufferGeometry:Ra,PolyhedronGeometry:Bu,PolyhedronBufferGeometry:Bu,RingGeometry:Ic,RingBufferGeometry:Ic,ShapeGeometry:Pc,ShapeBufferGeometry:Pc,SphereGeometry:Fc,SphereBufferGeometry:Fc,TetrahedronGeometry:zc,TetrahedronBufferGeometry:zc,TextGeometry:r,TextBufferGeometry:r,TorusGeometry:e,TorusBufferGeometry:e,TorusKnotGeometry:Ka,TorusKnotBufferGeometry:Ka,TubeGeometry:to,TubeBufferGeometry:to,WireframeGeometry:Zc}),xc=(a($c,Kc=Qn),$c.prototype.copy=function(t){return Kc.prototype.copy.call(this,t),this.color.copy(t.color),this},$c);function $c(t){U(this,$c);var e=z(this,Kc.call(this));return e.type="ShadowMaterial",e.color=new ai(0),e.transparent=!0,e.setValues(t),e}xc.prototype.isShadowMaterial=!0;var th,eh=(a(rh,th=sa),rh);function rh(t){U(this,rh);t=z(this,th.call(this,t));return t.type="RawShaderMaterial",t}function nh(t){Qn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ai(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ai(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ye,this.normalScale=new or(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}function ih(t){nh.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new or(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=ar.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}eh.prototype.isRawShaderMaterial=!0,((nh.prototype=Object.create(Qn.prototype)).constructor=nh).prototype.isMeshStandardMaterial=!0,nh.prototype.copy=function(t){return Qn.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this},((ih.prototype=Object.create(nh.prototype)).constructor=ih).prototype.isMeshPhysicalMaterial=!0,ih.prototype.copy=function(t){return nh.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new ai).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this};var ah,Ac=(a(oh,ah=Qn),oh.prototype.copy=function(t){return ah.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},oh);function oh(t){U(this,oh);var e=z(this,ah.call(this));return e.type="MeshPhongMaterial",e.color=new ai(16777215),e.specular=new ai(1118481),e.shininess=30,e.map=null,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=null,e.aoMapIntensity=1,e.emissive=new ai(0),e.emissiveIntensity=1,e.emissiveMap=null,e.bumpMap=null,e.bumpScale=1,e.normalMap=null,e.normalMapType=Ye,e.normalScale=new or(1,1),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=null,e.alphaMap=null,e.envMap=null,e.combine=w,e.reflectivity=1,e.refractionRatio=.98,e.wireframe=!1,e.wireframeLinewidth=1,e.wireframeLinecap="round",e.wireframeLinejoin="round",e.skinning=!1,e.morphTargets=!1,e.morphNormals=!1,e.flatShading=!1,e.setValues(t),e}Ac.prototype.isMeshPhongMaterial=!0;var sh,Bu=(a(lh,sh=Qn),lh.prototype.copy=function(t){return sh.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},lh);function lh(t){U(this,lh);var e=z(this,sh.call(this));return e.defines={TOON:""},e.type="MeshToonMaterial",e.color=new ai(16777215),e.map=null,e.gradientMap=null,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=null,e.aoMapIntensity=1,e.emissive=new ai(0),e.emissiveIntensity=1,e.emissiveMap=null,e.bumpMap=null,e.bumpScale=1,e.normalMap=null,e.normalMapType=Ye,e.normalScale=new or(1,1),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.alphaMap=null,e.wireframe=!1,e.wireframeLinewidth=1,e.wireframeLinecap="round",e.wireframeLinejoin="round",e.skinning=!1,e.morphTargets=!1,e.morphNormals=!1,e.setValues(t),e}Bu.prototype.isMeshToonMaterial=!0;var uh,Ic=(a(ch,uh=Qn),ch.prototype.copy=function(t){return uh.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},ch);function ch(t){U(this,ch);var e=z(this,uh.call(this));return e.type="MeshNormalMaterial",e.bumpMap=null,e.bumpScale=1,e.normalMap=null,e.normalMapType=Ye,e.normalScale=new or(1,1),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.wireframe=!1,e.wireframeLinewidth=1,e.fog=!1,e.skinning=!1,e.morphTargets=!1,e.morphNormals=!1,e.flatShading=!1,e.setValues(t),e}Ic.prototype.isMeshNormalMaterial=!0;var hh,zc=(a(dh,hh=Qn),dh.prototype.copy=function(t){return hh.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dh);function dh(t){U(this,dh);var e=z(this,hh.call(this));return e.type="MeshLambertMaterial",e.color=new ai(16777215),e.map=null,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=null,e.aoMapIntensity=1,e.emissive=new ai(0),e.emissiveIntensity=1,e.emissiveMap=null,e.specularMap=null,e.alphaMap=null,e.envMap=null,e.combine=w,e.reflectivity=1,e.refractionRatio=.98,e.wireframe=!1,e.wireframeLinewidth=1,e.wireframeLinecap="round",e.wireframeLinejoin="round",e.skinning=!1,e.morphTargets=!1,e.morphNormals=!1,e.setValues(t),e}zc.prototype.isMeshLambertMaterial=!0;var ph,r=(a(fh,ph=Qn),fh.prototype.copy=function(t){return ph.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},fh);function fh(t){U(this,fh);var e=z(this,ph.call(this));return e.defines={MATCAP:""},e.type="MeshMatcapMaterial",e.color=new ai(16777215),e.matcap=null,e.map=null,e.bumpMap=null,e.bumpScale=1,e.normalMap=null,e.normalMapType=Ye,e.normalScale=new or(1,1),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.alphaMap=null,e.skinning=!1,e.morphTargets=!1,e.morphNormals=!1,e.flatShading=!1,e.setValues(t),e}r.prototype.isMeshMatcapMaterial=!0;var mh,e=(a(gh,mh=ql),gh.prototype.copy=function(t){return mh.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},gh);function gh(t){U(this,gh);var e=z(this,mh.call(this));return e.type="LineDashedMaterial",e.scale=1,e.dashSize=3,e.gapSize=1,e.setValues(t),e}e.prototype.isLineDashedMaterial=!0;var vh=Object.freeze({__proto__:null,ShadowMaterial:xc,SpriteMaterial:ol,RawShaderMaterial:eh,ShaderMaterial:sa,PointsMaterial:lu,MeshPhysicalMaterial:ih,MeshStandardMaterial:nh,MeshPhongMaterial:Ac,MeshToonMaterial:Bu,MeshNormalMaterial:Ic,MeshLambertMaterial:zc,MeshDepthMaterial:Es,MeshDistanceMaterial:Rs,MeshBasicMaterial:li,MeshMatcapMaterial:r,LineDashedMaterial:e,LineBasicMaterial:ql,Material:Qn}),yh={arraySlice:function(t,e,r){return yh.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(r){for(var t=r.length,e=new Array(t),n=0;n!==t;++n)e[n]=n;return e.sort(function(t,e){return r[t]-r[e]}),e},sortedArray:function(t,e,r){for(var n=t.length,i=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=r[a]*e,l=0;l!==e;++l)i[o++]=t[s+l];return i},flattenJSON:function(t,e,r,n){for(var i=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[i++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))for(;void 0!==(o=a[n])&&(e.push(a.time),r.push.apply(r,o)),a=t[i++],void 0!==a;);else if(void 0!==o.toArray)for(;void 0!==(o=a[n])&&(e.push(a.time),o.toArray(r,r.length)),a=t[i++],void 0!==a;);else for(;void 0!==(o=a[n])&&(e.push(a.time),r.push(o)),a=t[i++],void 0!==a;);}},subclip:function(t,e,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:30,a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var p=l.times[d]*i;if(!(p<r||n<=p)){c.push(l.times[d]);for(var f=0;f<u;++f)h.push(l.values[d*u+f])}}0!==c.length&&(l.times=yh.convertArray(c,l.times.constructor),l.values=yh.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;for(var m=1/0,g=0;g<a.tracks.length;++g)m>a.tracks[g].times[0]&&(m=a.tracks[g].times[0]);for(var v=0;v<a.tracks.length;++v)a.tracks[v].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(g){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,v=2<arguments.length&&void 0!==arguments[2]?arguments[2]:g,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:30;e<=0&&(e=30);for(var r=v.tracks.length,y=t/e,n=0;n<r;++n)(function(t){var e=v.tracks[t],r=e.ValueTypeName;if("bool"===r||"string"===r)return;var n=g.tracks.find(function(t){return t.name===e.name&&t.ValueTypeName===r});if(void 0===n)return;var i=0,a=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(i=a/3);var o=0,s=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=s/3);var l,u=e.times.length-1,c=void 0;c=y<=e.times[0]?(t=a-i,yh.arraySlice(e.values,i,t)):y>=e.times[u]?(l=(u=u*a+i)+a-i,yh.arraySlice(e.values,u,l)):(a=a-(l=i),(i=e.createInterpolant()).evaluate(y),yh.arraySlice(i.resultBuffer,l,a)),"quaternion"===r&&(new Mr).fromArray(c).normalize().conjugate().toArray(c);for(var h=n.times.length,d=0;d<h;++d){var p=d*s+o;if("quaternion"===r)Mr.multiplyQuaternionsFlat(n.values,p,c,0,n.values,p);else for(var f=s-2*o,m=0;m<f;++m)n.values[p+m]-=c[m]}})(n);return g.blendMode=2501,g}};function xh(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function bh(t,e,r,n){xh.call(this,t,e,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function _h(t,e,r,n){xh.call(this,t,e,r,n)}function Ah(t,e,r,n){xh.call(this,t,e,r,n)}Object.assign(xh.prototype,{evaluate:function(t){var e=this.parameterPositions,r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{var a=void 0;r:{n:if(!(t<n)){for(var o=r+2;;){if(void 0===n){if(t<i)break n;return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,t,i)}if(r===o)break;if(i=n,t<(n=e[++r]))break e}a=e.length;break r}if(i<=t)break t;var s=e[1];t<s&&(r=2,i=s);for(var l=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===l)break;if(n=i,(i=e[--r-1])<=t)break e}a=r,r=0}for(;r<a;){var u=r+a>>>1;t<e[u]?a=u:r=1+u}if(n=e[r],void 0===(i=e[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,i,t)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=t*n,a=0;a!==n;++a)e[a]=r[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(xh.prototype,{beforeStart_:xh.prototype.copySampleValue_,afterEnd_:xh.prototype.copySampleValue_}),bh.prototype=Object.assign(Object.create(xh.prototype),{constructor:bh,DefaultSettings_:{endingStart:De,endingEnd:De},intervalChanged_:function(t,e,r){var n=this.parameterPositions,i=t-2,a=t+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case Oe:i=t,o=2*e-r;break;case 2402:o=e+n[i=n.length-2]-n[i+1];break;default:i=t,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case Oe:a=t,s=2*r-e;break;case 2402:s=r+n[a=1]-n[0];break;default:a=t-1,s=e}var l=.5*(r-e),u=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-r),this._offsetPrev=i*u,this._offsetNext=a*u},interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,t=this._weightNext,r=(r-e)/(n-e),n=r*r,e=n*r,d=-h*e+2*h*n-h*r,p=(1+h)*e+(-1.5-2*h)*n+(-.5+h)*r+1,f=(-1-t)*e+(1.5+t)*n+.5*r,m=t*e-t*n,g=0;g!==o;++g)i[g]=d*a[u+g]+p*a[l+g]+f*a[s+g]+m*a[c+g];return i}}),_h.prototype=Object.assign(Object.create(xh.prototype),{constructor:_h,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=(r-e)/(n-e),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}),Ah.prototype=Object.assign(Object.create(xh.prototype),{constructor:Ah,interpolate_:function(t){return this.copySampleValue_(t-1)}});var wh=(Mh.toJSON=function(t){var e=t.constructor,r=void 0;return e.toJSON!==this.toJSON?r=e.toJSON(t):(r={name:t.name,times:yh.convertArray(t.times,Array),values:yh.convertArray(t.values,Array)},(e=t.getInterpolation())!==t.DefaultInterpolation&&(r.interpolation=e)),r.type=t.ValueTypeName,r},Mh.prototype.InterpolantFactoryMethodDiscrete=function(t){return new Ah(this.times,this.values,this.getValueSize(),t)},Mh.prototype.InterpolantFactoryMethodLinear=function(t){return new _h(this.times,this.values,this.getValueSize(),t)},Mh.prototype.InterpolantFactoryMethodSmooth=function(t){return new bh(this.times,this.values,this.getValueSize(),t)},Mh.prototype.setInterpolation=function(t){var e=void 0;switch(t){case Re:e=this.InterpolantFactoryMethodDiscrete;break;case Pe:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)return this.createInterpolant=e,this;var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this},Mh.prototype.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Re;case this.InterpolantFactoryMethodLinear:return Pe;case this.InterpolantFactoryMethodSmooth:return 2302}},Mh.prototype.getValueSize=function(){return this.values.length/this.times.length},Mh.prototype.shift=function(t){if(0!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]+=t;return this},Mh.prototype.scale=function(t){if(1!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]*=t;return this},Mh.prototype.trim=function(t,e){for(var r,n=this.times,i=n.length,a=0,o=i-1;a!==i&&n[a]<t;)++a;for(;-1!==o&&n[o]>e;)--o;return++o,0===a&&o===i||(o<=a&&(a=(o=Math.max(o,1))-1),r=this.getValueSize(),this.times=yh.arraySlice(n,a,o),this.values=yh.arraySlice(this.values,a*r,o*r)),this},Mh.prototype.validate=function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==i;o++){var s=r[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&s<a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&yh.isTypedArray(n))for(var l=0,u=n.length;l!==u;++l){var c=n[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),t=!1;break}}return t},Mh.prototype.optimize=function(){for(var t=yh.arraySlice(this.times),e=yh.arraySlice(this.values),r=this.getValueSize(),n=2302===this.getInterpolation(),i=t.length-1,a=1,o=1;o<i;++o){var s=!1,l=t[o];if(l!==t[o+1]&&(1!==o||l!==t[0]))if(n)s=!0;else for(var u=o*r,c=u-r,h=u+r,d=0;d!==r;++d){var p=e[u+d];if(p!==e[c+d]||p!==e[h+d]){s=!0;break}}if(s){if(o!==a){t[a]=t[o];for(var f=o*r,m=a*r,g=0;g!==r;++g)e[m+g]=e[f+g]}++a}}if(0<i){t[a]=t[i];for(var v=i*r,y=a*r,x=0;x!==r;++x)e[y+x]=e[v+x];++a}return a!==t.length?(this.times=yh.arraySlice(t,0,a),this.values=yh.arraySlice(e,0,a*r)):(this.times=t,this.values=e),this},Mh.prototype.clone=function(){var t=yh.arraySlice(this.times,0),e=yh.arraySlice(this.values,0),e=new this.constructor(this.name,t,e);return e.createInterpolant=this.createInterpolant,e},Mh);function Mh(t,e,r,n){if(U(this,Mh),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=yh.convertArray(e,this.TimeBufferType),this.values=yh.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}wh.prototype.TimeBufferType=Float32Array,wh.prototype.ValueBufferType=Float32Array,wh.prototype.DefaultInterpolation=Pe;var Ch,Th=(a(Sh,Ch=wh),Sh);function Sh(){return U(this,Sh),z(this,Ch.apply(this,arguments))}Th.prototype.ValueTypeName="bool",Th.prototype.ValueBufferType=Array,Th.prototype.DefaultInterpolation=Re,Th.prototype.InterpolantFactoryMethodLinear=void 0,Th.prototype.InterpolantFactoryMethodSmooth=void 0;var Eh,Ih=(a(Lh,Eh=wh),Lh);function Lh(){return U(this,Lh),z(this,Eh.apply(this,arguments))}Ih.prototype.ValueTypeName="color";var Rh,Ph=(a(Dh,Rh=wh),Dh);function Dh(){return U(this,Dh),z(this,Rh.apply(this,arguments))}function Oh(t,e,r,n){xh.call(this,t,e,r,n)}Ph.prototype.ValueTypeName="number",Oh.prototype=Object.assign(Object.create(xh.prototype),{constructor:Oh,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(r-e)/(n-e),l=t*o,u=l+o;l!==u;l+=4)Mr.slerpFlat(i,0,a,l-o,a,l,s);return i}});var Fh,Bh=(a(Nh,Fh=wh),Nh.prototype.InterpolantFactoryMethodLinear=function(t){return new Oh(this.times,this.values,this.getValueSize(),t)},Nh);function Nh(){return U(this,Nh),z(this,Fh.apply(this,arguments))}Bh.prototype.ValueTypeName="quaternion",Bh.prototype.DefaultInterpolation=Pe,Bh.prototype.InterpolantFactoryMethodSmooth=void 0;var zh,Uh=(a(kh,zh=wh),kh);function kh(){return U(this,kh),z(this,zh.apply(this,arguments))}Uh.prototype.ValueTypeName="string",Uh.prototype.ValueBufferType=Array,Uh.prototype.DefaultInterpolation=Re,Uh.prototype.InterpolantFactoryMethodLinear=void 0,Uh.prototype.InterpolantFactoryMethodSmooth=void 0;var Hh,Gh=(a(Vh,Hh=wh),Vh);function Vh(){return U(this,Vh),z(this,Hh.apply(this,arguments))}Gh.prototype.ValueTypeName="vector";var Wh=(jh.parse=function(t){for(var e=[],r=t.tracks,n=1/(t.fps||1),i=0,a=r.length;i!==a;++i)e.push(function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ph;case"vector":case"vector2":case"vector3":case"vector4":return Gh;case"color":return Ih;case"quaternion":return Bh;case"bool":case"boolean":return Th;case"string":return Uh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);{var r,n;void 0===t.times&&(r=[],n=[],yh.flattenJSON(t.keys,r,n,"value"),t.times=r,t.values=n)}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}(r[i]).scale(n));var o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o},jh.toJSON=function(t){for(var e=[],r=t.tracks,t={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode},n=0,i=r.length;n!==i;++n)e.push(wh.toJSON(r[n]));return t},jh.CreateFromMorphTargetSequence=function(t,e,r,n){for(var i=e.length,a=[],o=0;o<i;o++){var s=[];(u=[]).push((o+i-1)%i,o,(o+1)%i),s.push(0,1,0);var l=yh.getKeyframeOrder(u),u=yh.sortedArray(u,1,l),s=yh.sortedArray(s,1,l);n||0!==u[0]||(u.push(i),s.push(s[0])),a.push(new Ph(".morphTargetInfluences["+e[o].name+"]",u,s).scale(1/r))}return new this(t,-1,a)},jh.findByName=function(t,e){var r=t;Array.isArray(t)||(r=t.geometry&&t.geometry.animations||t.animations);for(var n=0;n<r.length;n++)if(r[n].name===e)return r[n];return null},jh.CreateClipsFromMorphTargetSequences=function(t,e,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s,l=t[a],u=l.name.match(i);u&&1<u.length&&((u=n[s=u[1]])||(n[s]=u=[]),u.push(l))}var c,h=[];for(c in n)h.push(this.CreateFromMorphTargetSequence(c,n[c],e,r));return h},jh.parseAnimation=function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(t,e,r,n,i){var a,o;0!==r.length&&(a=[],o=[],yh.flattenJSON(r,a,o,n),0!==a.length&&i.push(new t(e,a,o)))},n=[],i=t.name||"default",a=t.fps||30,o=t.blendMode,s=t.length||-1,l=t.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h,d={},p=void 0,p=0;p<c.length;p++)if(c[p].morphTargets)for(var f=0;f<c[p].morphTargets.length;f++)d[c[p].morphTargets[f]]=-1;for(h in d){for(var m=[],g=[],v=0;v!==c[p].morphTargets.length;++v){var y=c[p];m.push(y.time),g.push(y.morphTarget===h?1:0)}n.push(new Ph(".morphTargetInfluence["+h+"]",m,g))}s=d.length*(a||1)}else{var x=".bones["+e[u].name+"]";r(Gh,x+".position",c,"pos",n),r(Bh,x+".quaternion",c,"rot",n),r(Gh,x+".scale",c,"scl",n)}}return 0===n.length?null:new this(i,s,n,o)},jh.prototype.resetDuration=function(){for(var t=0,e=0,r=this.tracks.length;e!==r;++e)var n=this.tracks[e],t=Math.max(t,n.times[n.times.length-1]);return this.duration=t,this},jh.prototype.trim=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},jh.prototype.validate=function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},jh.prototype.optimize=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},jh.prototype.clone=function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)},jh.prototype.toJSON=function(){return this.constructor.toJSON(this)},jh);function jh(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,r=arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Fe;U(this,jh),this.name=t,this.tracks=r,this.duration=e,this.blendMode=n,this.uuid=ar.generateUUID(),this.duration<0&&this.resetDuration()}var Xh={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function qh(t,e,r){var n=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){o++,!1===i&&void 0!==n.onStart&&n.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){t=l.indexOf(t);return-1!==t&&l.splice(t,2),this},this.getHandler=function(t){for(var e=0,r=l.length;e<r;e+=2){var n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}var Yh=new qh;function Zh(t){this.manager=void 0!==t?t:Yh,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Zh.prototype,{load:function(){},loadAsync:function(r,n){var i=this;return new Promise(function(t,e){i.load(r,t,n,e)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Jh={};function Kh(t){Zh.call(this,t)}Kh.prototype=Object.assign(Object.create(Zh.prototype),{constructor:Kh,load:function(u,t,e,r){void 0===u&&(u=""),void 0!==this.path&&(u=this.path+u),u=this.manager.resolveURL(u);var c=this,n=Xh.get(u);if(void 0!==n)return c.manager.itemStart(u),setTimeout(function(){t&&t(n),c.manager.itemEnd(u)},0),n;if(void 0===Jh[u]){var i=u.match(/^data:(.*?)(;base64)?,(.*)$/),a=void 0;if(i){var o=i[1],s=!!i[2],l=i[3],l=decodeURIComponent(l);s&&(l=atob(l));try{var h=void 0,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(l.length),f=0;f<l.length;f++)p[f]=l.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:o}):p.buffer;break;case"document":h=(new DOMParser).parseFromString(l,o);break;case"json":h=JSON.parse(l);break;default:h=l}setTimeout(function(){t&&t(h),c.manager.itemEnd(u)},0)}catch(t){setTimeout(function(){r&&r(t),c.manager.itemError(u),c.manager.itemEnd(u)},0)}}else{for(var m in Jh[u]=[],Jh[u].push({onLoad:t,onProgress:e,onError:r}),(a=new XMLHttpRequest).open("GET",u,!0),a.addEventListener("load",function(t){var e=this.response,r=Jh[u];if(delete Jh[u],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Xh.add(u,e);for(var n=0,i=r.length;n<i;n++){var a=r[n];a.onLoad&&a.onLoad(e)}c.manager.itemEnd(u)}else{for(var o=0,s=r.length;o<s;o++){var l=r[o];l.onError&&l.onError(t)}c.manager.itemError(u),c.manager.itemEnd(u)}},!1),a.addEventListener("progress",function(t){for(var e=Jh[u],r=0,n=e.length;r<n;r++){var i=e[r];i.onProgress&&i.onProgress(t)}},!1),a.addEventListener("error",function(t){var e=Jh[u];delete Jh[u];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}c.manager.itemError(u),c.manager.itemEnd(u)},!1),a.addEventListener("abort",function(t){var e=Jh[u];delete Jh[u];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}c.manager.itemError(u),c.manager.itemEnd(u)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(m,this.requestHeader[m]);a.send(null)}return c.manager.itemStart(u),a}Jh[u].push({onLoad:t,onProgress:e,onError:r})},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}});var Qh;a($h,Qh=Zh),$h.prototype.load=function(e,r,t,n){var i=this,a=new Kh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},$h.prototype.parse=function(t){for(var e=[],r=0;r<t.length;r++){var n=Wh.parse(t[r]);e.push(n)}return e};function $h(t){return U(this,$h),z(this,Qh.call(this,t))}function td(t){Zh.call(this,t)}td.prototype=Object.assign(Object.create(Zh.prototype),{constructor:td,load:function(t,a,r,n){var o=this,s=[],l=new xu,i=new Kh(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(o.withCredentials);var u=0;if(Array.isArray(t))for(var e=0,c=t.length;e<c;++e)!function(e){i.load(t[e],function(t){t=o.parse(t,!0);s[e]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(u+=1)&&(1===t.mipmapCount&&(l.minFilter=Et),l.image=s,l.format=t.format,l.needsUpdate=!0,a&&a(l))},r,n)}(e);else i.load(t,function(t){var e=o.parse(t,!0);if(e.isCubemap){for(var r=e.mipmaps.length/e.mipmapCount,n=0;n<r;n++){s[n]={mipmaps:[]};for(var i=0;i<e.mipmapCount;i++)s[n].mipmaps.push(e.mipmaps[n*e.mipmapCount+i]),s[n].format=e.format,s[n].width=e.width,s[n].height=e.height}l.image=s}else l.image.width=e.width,l.image.height=e.height,l.mipmaps=e.mipmaps;1===e.mipmapCount&&(l.minFilter=Et),l.format=e.format,l.needsUpdate=!0,a&&a(l)},r,n);return l}});var ed,rd=(a(nd,ed=Zh),nd.prototype.load=function(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Xh.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Xh.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o},nd);function nd(t){return U(this,nd),z(this,ed.call(this,t))}var id,ad=(a(od,id=Zh),od.prototype.load=function(t,r,e,n){var i=new ga,a=new rd(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;for(var s=0;s<t.length;++s)!function(e){a.load(t[e],function(t){i.images[e]=t,6===++o&&(i.needsUpdate=!0,r&&r(i))},void 0,n)}(s);return i},od);function od(t){return U(this,od),z(this,id.call(this,t))}function sd(t){Zh.call(this,t)}function ld(t){Zh.call(this,t)}function ud(){this.type="Curve",this.arcLengthDivisions=200}sd.prototype=Object.assign(Object.create(Zh.prototype),{constructor:sd,load:function(t,e,r,n){var i=this,a=new Aa,o=new Kh(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(t,function(t){t=i.parse(t);t&&(void 0!==t.image?a.image=t.image:void 0!==t.data&&(a.image.width=t.width,a.image.height=t.height,a.image.data=t.data),a.wrapS=void 0!==t.wrapS?t.wrapS:H,a.wrapT=void 0!==t.wrapT?t.wrapT:H,a.magFilter=void 0!==t.magFilter?t.magFilter:Et,a.minFilter=void 0!==t.minFilter?t.minFilter:Et,a.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.encoding&&(a.encoding=t.encoding),void 0!==t.flipY&&(a.flipY=t.flipY),void 0!==t.format&&(a.format=t.format),void 0!==t.type&&(a.type=t.type),void 0!==t.mipmaps&&(a.mipmaps=t.mipmaps,a.minFilter=Lt),1===t.mipmapCount&&(a.minFilter=Et),a.needsUpdate=!0,e&&e(a,t))},r,n),a}}),ld.prototype=Object.assign(Object.create(Zh.prototype),{constructor:ld,load:function(e,r,t,n){var i=new fr,a=new rd(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(t){i.image=t;t=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/);i.format=t?Nt:zt,i.needsUpdate=!0,void 0!==r&&r(i)},t,n),i}}),Object.assign(ud.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){t=this.getUtoTmapping(t);return this.getPoint(t,e)},getPoints:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},getSpacedPoints:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e=[],r=void 0,n=this.getPoint(0),i=0;e.push(0);for(var a=1;a<=t;a++)i+=(r=this.getPoint(a/t)).distanceTo(n),e.push(i),n=r;return this.cacheArcLengths=e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){for(var r,n=this.getLengths(),i=0,a=n.length,o=void 0,o=e||t*n[a-1],s=0,l=a-1;s<=l;)if((r=n[i=Math.floor(s+(l-s)/2)]-o)<0)s=i+1;else{if(!(0<r)){l=i;break}l=i-1}if(n[i=l]===o)return i/(a-1);t=n[i];return(i+(o-t)/(n[i+1]-t))/(a-1)},getTangent:function(t,e){var r=t-1e-4,t=t+1e-4;r<0&&(r=0),1<t&&(t=1);r=this.getPoint(r),t=this.getPoint(t),e=e||new(r.isVector2?or:Tr);return e.copy(t).sub(r).normalize(),e},getTangentAt:function(t,e){t=this.getUtoTmapping(t);return this.getTangent(t,e)},computeFrenetFrames:function(t,e){for(var r=new Tr,n=[],i=[],a=[],o=new Tr,s=new an,l=0;l<=t;l++){var u=l/t;n[l]=this.getTangentAt(u,new Tr),n[l].normalize()}i[0]=new Tr,a[0]=new Tr;var c=Number.MAX_VALUE,h=Math.abs(n[0].x),d=Math.abs(n[0].y),p=Math.abs(n[0].z);h<=c&&(c=h,r.set(1,0,0)),d<=c&&(c=d,r.set(0,1,0)),p<=c&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),a[0].crossVectors(n[0],i[0]);for(var f,m=1;m<=t;m++)i[m]=i[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(n[m-1],n[m]),o.length()>Number.EPSILON&&(o.normalize(),f=Math.acos(ar.clamp(n[m-1].dot(n[m]),-1,1)),i[m].applyMatrix4(s.makeRotationAxis(o,f))),a[m].crossVectors(n[m],i[m]);if(!0===e){var g=Math.acos(ar.clamp(i[0].dot(i[t]),-1,1));g/=t,0<n[0].dot(o.crossVectors(i[0],i[t]))&&(g=-g);for(var v=1;v<=t;v++)i[v].applyMatrix4(s.makeRotationAxis(n[v],g*v)),a[v].crossVectors(n[v],i[v])}return{tangents:n,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});var cd,hd=(a(dd,cd=ud),dd.prototype.getPoint=function(t,e){for(var r=e||new or,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;n<i;)i-=n;i<Number.EPSILON&&(i=a?0:n),!0!==this.aClockwise||a||(i===n?i=-n:i-=n);var o=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);return 0!==this.aRotation&&(e=Math.cos(this.aRotation),a=Math.sin(this.aRotation),s=(t=s-this.aX)*e-(o=l-this.aY)*a+this.aX,l=t*a+o*e+this.aY),r.set(s,l)},dd.prototype.copy=function(t){return cd.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},dd.prototype.toJSON=function(){var t=cd.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},dd.prototype.fromJSON=function(t){return cd.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},dd);function dd(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=6<arguments.length&&void 0!==arguments[6]&&arguments[6],s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0;U(this,dd);var l=z(this,cd.call(this));return l.type="EllipseCurve",l.aX=t,l.aY=e,l.xRadius=r,l.yRadius=n,l.aStartAngle=i,l.aEndAngle=a,l.aClockwise=o,l.aRotation=s,l}hd.prototype.isEllipseCurve=!0;var pd,Ka=(a(fd,pd=hd),fd);function fd(t,e,r,n,i,a){U(this,fd);a=z(this,pd.call(this,t,e,r,r,n,i,a));return a.type="ArcCurve",a}function md(){var i=0,a=0,o=0,s=0;function l(t,e,r,n){o=-3*(i=t)+3*e-2*(a=r)-n,s=2*t-2*e+r+n}return{initCatmullRom:function(t,e,r,n,i){l(e,r,i*(r-t),i*(n-e))},initNonuniformCatmullRom:function(t,e,r,n,i,a,o){i=(e-t)/i-(r-t)/(i+a)+(r-e)/a,o=(r-e)/a-(n-e)/(a+o)+(n-r)/o;l(e,r,i*=a,o*=a)},calc:function(t){var e=t*t;return i+a*t+o*e+s*(e*t)}}}Ka.prototype.isArcCurve=!0;var gd,vd=new Tr,yd=new md,xd=new md,bd=new md,to=(a(_d,gd=ud),_d.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=this.points,n=r.length,i=(n-(this.closed?0:1))*t,a=Math.floor(i),o=i-a;this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/n)+1)*n:0===o&&a===n-1&&(a=n-2,o=1);var s=void 0,l=void 0,s=this.closed||0<a?r[(a-1)%n]:(vd.subVectors(r[0],r[1]).add(r[0]),vd),t=r[a%n],i=r[(a+1)%n],l=this.closed||a+2<n?r[(a+2)%n]:(vd.subVectors(r[n-1],r[n-2]).add(r[n-1]),vd);return"centripetal"===this.curveType||"chordal"===this.curveType?(a="chordal"===this.curveType?.5:.25,r=Math.pow(s.distanceToSquared(t),a),(n=Math.pow(t.distanceToSquared(i),a))<1e-4&&(n=1),r<1e-4&&(r=n),(a=Math.pow(i.distanceToSquared(l),a))<1e-4&&(a=n),yd.initNonuniformCatmullRom(s.x,t.x,i.x,l.x,r,n,a),xd.initNonuniformCatmullRom(s.y,t.y,i.y,l.y,r,n,a),bd.initNonuniformCatmullRom(s.z,t.z,i.z,l.z,r,n,a)):"catmullrom"===this.curveType&&(yd.initCatmullRom(s.x,t.x,i.x,l.x,this.tension),xd.initCatmullRom(s.y,t.y,i.y,l.y,this.tension),bd.initCatmullRom(s.z,t.z,i.z,l.z,this.tension)),e.set(yd.calc(o),xd.calc(o),bd.calc(o)),e},_d.prototype.copy=function(t){gd.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},_d.prototype.toJSON=function(){var t=gd.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},_d.prototype.fromJSON=function(t){gd.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Tr).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},_d);function _d(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"centripetal",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5;U(this,_d);var i=z(this,gd.call(this));return i.type="CatmullRomCurve3",i.points=t,i.closed=e,i.curveType=r,i.tension=n,i}function Ad(t,e,r,n,i){var a=.5*(n-e),e=.5*(i-r),i=t*t;return(2*r-2*n+a+e)*(t*i)+(-3*r+3*n-2*a-e)*i+a*t+r}function wd(t,e,r,n){return(i=1-(i=t))*i*e+2*(1-(e=t))*e*r+(t=t)*t*n;var i}function Md(t,e,r,n,i){return(a=1-(a=t))*a*a*e+3*(e=1-(a=t))*e*a*r+3*(1-(r=t))*r*r*n+(t=t)*t*t*i;var a}to.prototype.isCatmullRomCurve3=!0;var Cd,Td=(a(Sd,Cd=ud),Sd.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or,r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set(Md(t,r.x,n.x,i.x,a.x),Md(t,r.y,n.y,i.y,a.y)),e},Sd.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Sd.prototype.toJSON=function(){var t=Cd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Sd.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Sd);function Sd(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new or,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new or,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new or;U(this,Sd);var i=z(this,Cd.call(this));return i.type="CubicBezierCurve",i.v0=t,i.v1=e,i.v2=r,i.v3=n,i}Td.prototype.isCubicBezierCurve=!0;var Ed,xc=(a(Id,Ed=ud),Id.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set(Md(t,r.x,n.x,i.x,a.x),Md(t,r.y,n.y,i.y,a.y),Md(t,r.z,n.z,i.z,a.z)),e},Id.prototype.copy=function(t){return Ed.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Id.prototype.toJSON=function(){var t=Ed.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Id.prototype.fromJSON=function(t){return Ed.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Id);function Id(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Tr,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Tr;U(this,Id);var i=z(this,Ed.call(this));return i.type="CubicBezierCurve3",i.v0=t,i.v1=e,i.v2=r,i.v3=n,i}xc.prototype.isCubicBezierCurve3=!0;var Ld,Rd=(a(Pd,Ld=ud),Pd.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Pd.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Pd.prototype.getTangent=function(t,e){e=e||new or;return e.copy(this.v2).sub(this.v1).normalize(),e},Pd.prototype.copy=function(t){return Ld.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Pd.prototype.toJSON=function(){var t=Ld.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Pd.prototype.fromJSON=function(t){return Ld.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Pd);function Pd(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new or,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or;U(this,Pd);var r=z(this,Ld.call(this));return r.type="LineCurve",r.v1=t,r.v2=e,r}Rd.prototype.isLineCurve=!0;var Dd,Bu=(a(Od,Dd=ud),Od.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Od.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Od.prototype.copy=function(t){return Dd.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Od.prototype.toJSON=function(){var t=Dd.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Od.prototype.fromJSON=function(t){return Dd.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Od);function Od(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr;U(this,Od);var r=z(this,Dd.call(this));return r.type="LineCurve3",r.isLineCurve3=!0,r.v1=t,r.v2=e,r}var Fd,Bd=(a(Nd,Fd=ud),Nd.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or,r=this.v0,n=this.v1,i=this.v2;return e.set(wd(t,r.x,n.x,i.x),wd(t,r.y,n.y,i.y)),e},Nd.prototype.copy=function(t){return Fd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Nd.prototype.toJSON=function(){var t=Fd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Nd.prototype.fromJSON=function(t){return Fd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Nd);function Nd(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new or,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new or;U(this,Nd);var n=z(this,Fd.call(this));return n.type="QuadraticBezierCurve",n.v0=t,n.v1=e,n.v2=r,n}Bd.prototype.isQuadraticBezierCurve=!0;var zd,Ic=(a(Ud,zd=ud),Ud.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=this.v0,n=this.v1,i=this.v2;return e.set(wd(t,r.x,n.x,i.x),wd(t,r.y,n.y,i.y),wd(t,r.z,n.z,i.z)),e},Ud.prototype.copy=function(t){return zd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ud.prototype.toJSON=function(){var t=zd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ud.prototype.fromJSON=function(t){return zd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ud);function Ud(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Tr;U(this,Ud);var n=z(this,zd.call(this));return n.type="QuadraticBezierCurve3",n.v0=t,n.v1=e,n.v2=r,n}Ic.prototype.isQuadraticBezierCurve3=!0;var kd,Hd=(a(Gd,kd=ud),Gd.prototype.getPoint=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or,r=this.points,n=(r.length-1)*t,i=Math.floor(n),a=n-i,o=r[0===i?i:i-1],t=r[i],n=r[i>r.length-2?r.length-1:i+1],i=r[i>r.length-3?r.length-1:i+2];return e.set(Ad(a,o.x,t.x,n.x,i.x),Ad(a,o.y,t.y,n.y,i.y)),e},Gd.prototype.copy=function(t){kd.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this},Gd.prototype.toJSON=function(){var t=kd.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t},Gd.prototype.fromJSON=function(t){kd.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new or).fromArray(n))}return this},Gd);function Gd(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];U(this,Gd);var e=z(this,kd.call(this));return e.type="SplineCurve",e.points=t,e}Hd.prototype.isSplineCurve=!0;var Vd,Wd=Object.freeze({__proto__:null,ArcCurve:Ka,CatmullRomCurve3:to,CubicBezierCurve:Td,CubicBezierCurve3:xc,EllipseCurve:hd,LineCurve:Rd,LineCurve3:Bu,QuadraticBezierCurve:Bd,QuadraticBezierCurve3:Ic,SplineCurve:Hd}),zc=(a(jd,Vd=ud),jd.prototype.add=function(t){this.curves.push(t)},jd.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Rd(e,t))},jd.prototype.getPoint=function(t){for(var e=t*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=e){var i=r[n]-e,a=this.curves[n],o=a.getLength(),o=0===o?0:1-i/o;return a.getPointAt(o)}n++}return null},jd.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},jd.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},jd.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t},jd.prototype.getSpacedPoints=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:40,e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},jd.prototype.getPoints=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:12,e=[],r=void 0,n=0,i=this.curves;n<i.length;n++)for(var a=i[n],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];r&&r.equals(u)||(e.push(u),r=u)}return this.autoClose&&1<e.length&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},jd.prototype.copy=function(t){Vd.prototype.copy.call(this,t),this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},jd.prototype.toJSON=function(){var t=Vd.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,r=this.curves.length;e<r;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},jd.prototype.fromJSON=function(t){Vd.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push((new Wd[n.type]).fromJSON(n))}return this},jd);function jd(){U(this,jd);var t=z(this,Vd.call(this));return t.type="CurvePath",t.curves=[],t.autoClose=!1,t}var Xd,qd=(a(Yd,Xd=zc),Yd.prototype.setFromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this},Yd.prototype.moveTo=function(t,e){return this.currentPoint.set(t,e),this},Yd.prototype.lineTo=function(t,e){var r=new Rd(this.currentPoint.clone(),new or(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this},Yd.prototype.quadraticCurveTo=function(t,e,r,n){e=new Bd(this.currentPoint.clone(),new or(t,e),new or(r,n));return this.curves.push(e),this.currentPoint.set(r,n),this},Yd.prototype.bezierCurveTo=function(t,e,r,n,i,a){n=new Td(this.currentPoint.clone(),new or(t,e),new or(r,n),new or(i,a));return this.curves.push(n),this.currentPoint.set(i,a),this},Yd.prototype.splineThru=function(t){var e=[this.currentPoint.clone()].concat(t),e=new Hd(e);return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},Yd.prototype.arc=function(t,e,r,n,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,r,n,i,a),this},Yd.prototype.absarc=function(t,e,r,n,i,a){return this.absellipse(t,e,r,r,n,i,a),this},Yd.prototype.ellipse=function(t,e,r,n,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,r,n,i,a,o,s),this},Yd.prototype.absellipse=function(t,e,r,n,i,a,o,s){o=new hd(t,e,r,n,i,a,o,s);0<this.curves.length&&((s=o.getPoint(0)).equals(this.currentPoint)||this.lineTo(s.x,s.y)),this.curves.push(o);o=o.getPoint(1);return this.currentPoint.copy(o),this},Yd.prototype.copy=function(t){return Xd.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},Yd.prototype.toJSON=function(){var t=Xd.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},Yd.prototype.fromJSON=function(t){return Xd.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this},Yd);function Yd(t){U(this,Yd);var e=z(this,Xd.call(this));return e.type="Path",e.currentPoint=new or,t&&e.setFromPoints(t),e}var Zd,Jd=(a(Kd,Zd=qd),Kd.prototype.getPointsHoles=function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},Kd.prototype.extractPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},Kd.prototype.copy=function(t){Zd.prototype.copy.call(this,t),this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},Kd.prototype.toJSON=function(){var t=Zd.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,r=this.holes.length;e<r;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},Kd.prototype.fromJSON=function(t){Zd.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push((new qd).fromJSON(n))}return this},Kd);function Kd(t){U(this,Kd);t=z(this,Zd.call(this,t));return t.uuid=ar.generateUUID(),t.type="Shape",t.holes=[],t}var Qd,$d=(a(tp,Qd=Dn),tp.prototype.copy=function(t){return Qd.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},tp.prototype.toJSON=function(t){t=Qd.prototype.toJSON.call(this,t);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t},tp);function tp(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;U(this,tp);var r=z(this,Qd.call(this));return r.type="Light",r.color=new ai(t),r.intensity=e,r}$d.prototype.isLight=!0;var ep,rp=(a(np,ep=$d),np.prototype.copy=function(t){return $d.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this},np);function np(t,e,r){U(this,np);r=z(this,ep.call(this,t,r));return r.type="HemisphereLight",r.position.copy(Dn.DefaultUp),r.updateMatrix(),r.groundColor=new ai(e),r}rp.prototype.isHemisphereLight=!0;var ip=new an,ap=new Tr,op=new Tr,r=(sp.prototype.getViewportCount=function(){return this._viewportCount},sp.prototype.getFrustum=function(){return this._frustum},sp.prototype.updateMatrices=function(t){var e=this.camera,r=this.matrix;ap.setFromMatrixPosition(t.matrixWorld),e.position.copy(ap),op.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(op),e.updateMatrixWorld(),ip.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ip),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(e.projectionMatrix),r.multiply(e.matrixWorldInverse)},sp.prototype.getViewport=function(t){return this._viewports[t]},sp.prototype.getFrameExtents=function(){return this._frameExtents},sp.prototype.copy=function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},sp.prototype.clone=function(){return(new this.constructor).copy(this)},sp.prototype.toJSON=function(){var t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t},sp);function sp(t){U(this,sp),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new or(512,512),this.map=null,this.mapPass=null,this.matrix=new an,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ta,this._frameExtents=new or(1,1),this._viewportCount=1,this._viewports=[new vr(0,0,1,1)]}var lp,up=(a(cp,lp=r),cp.prototype.updateMatrices=function(t){var e=this.camera,r=2*ar.RAD2DEG*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix()),lp.prototype.updateMatrices.call(this,t)},cp);function cp(){U(this,cp);var t=z(this,lp.call(this,new ua(50,1,.5,500)));return t.focus=1,t}up.prototype.isSpotLightShadow=!0;var hp,dp=(a(pp,hp=$d),pp.prototype.copy=function(t){return hp.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},n(pp,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}]),pp);function pp(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1;U(this,pp);e=z(this,hp.call(this,t,e));return e.type="SpotLight",e.position.copy(Dn.DefaultUp),e.updateMatrix(),e.target=new Dn,e.distance=r,e.angle=n,e.penumbra=i,e.decay=a,e.shadow=new up,e}dp.prototype.isSpotLight=!0;var fp,mp=new an,gp=new Tr,vp=new Tr,yp=(a(xp,fp=r),xp.prototype.updateMatrices=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.camera,n=this.matrix;gp.setFromMatrixPosition(t.matrixWorld),r.position.copy(gp),vp.copy(r.position),vp.add(this._cubeDirections[e]),r.up.copy(this._cubeUps[e]),r.lookAt(vp),r.updateMatrixWorld(),n.makeTranslation(-gp.x,-gp.y,-gp.z),mp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mp)},xp);function xp(){U(this,xp);var t=z(this,fp.call(this,new ua(90,1,.5,500)));return t._frameExtents=new or(4,2),t._viewportCount=6,t._viewports=[new vr(2,1,1,1),new vr(0,1,1,1),new vr(3,1,1,1),new vr(1,1,1,1),new vr(3,0,1,1),new vr(1,0,1,1)],t._cubeDirections=[new Tr(1,0,0),new Tr(-1,0,0),new Tr(0,0,1),new Tr(0,0,-1),new Tr(0,1,0),new Tr(0,-1,0)],t._cubeUps=[new Tr(0,1,0),new Tr(0,1,0),new Tr(0,1,0),new Tr(0,1,0),new Tr(0,0,1),new Tr(0,0,-1)],t}yp.prototype.isPointLightShadow=!0;var bp,_p=(a(Ap,bp=$d),Ap.prototype.copy=function(t){return bp.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},n(Ap,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}]),Ap);function Ap(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;U(this,Ap);e=z(this,bp.call(this,t,e));return e.type="PointLight",e.distance=r,e.decay=n,e.shadow=new yp,e}_p.prototype.isPointLight=!0;var wp,Mp=(a(Cp,wp=la),Cp.prototype.copy=function(t,e){return wp.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},Cp.prototype.setViewOffset=function(t,e,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},Cp.prototype.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},Cp.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t,a=r+t,r=n+e,t=n-e;null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,a=(i+=n*this.view.offsetX)+n*this.view.width,t=(r-=e*this.view.offsetY)-e*this.view.height),this.projectionMatrix.makeOrthographic(i,a,r,t,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},Cp.prototype.toJSON=function(t){t=Dn.prototype.toJSON.call(this,t);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t},Cp);function Cp(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:.1,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2e3;U(this,Cp);var o=z(this,wp.call(this));return o.type="OrthographicCamera",o.zoom=1,o.view=null,o.left=t,o.right=e,o.top=r,o.bottom=n,o.near=i,o.far=a,o.updateProjectionMatrix(),o}Mp.prototype.isOrthographicCamera=!0;var Tp,Sp=(a(Ep,Tp=r),Ep);function Ep(){return U(this,Ep),z(this,Tp.call(this,new Mp(-5,5,5,-5,.5,500)))}Sp.prototype.isDirectionalLightShadow=!0;var Ip,Lp=(a(Rp,Ip=$d),Rp.prototype.copy=function(t){return Ip.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},Rp);function Rp(t,e){U(this,Rp);e=z(this,Ip.call(this,t,e));return e.type="DirectionalLight",e.position.copy(Dn.DefaultUp),e.updateMatrix(),e.target=new Dn,e.shadow=new Sp,e}Lp.prototype.isDirectionalLight=!0;var Pp,Dp=(a(Op,Pp=$d),Op);function Op(t,e){U(this,Op);e=z(this,Pp.call(this,t,e));return e.type="AmbientLight",e}Dp.prototype.isAmbientLight=!0;var Fp,Bp=(a(Np,Fp=$d),Np.prototype.copy=function(t){return Fp.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},Np.prototype.toJSON=function(t){t=Fp.prototype.toJSON.call(this,t);return t.object.width=this.width,t.object.height=this.height,t},Np);function Np(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;U(this,Np);e=z(this,Fp.call(this,t,e));return e.type="RectAreaLight",e.width=r,e.height=n,e}Bp.prototype.isRectAreaLight=!0;var zp=(Up.prototype.set=function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},Up.prototype.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},Up.prototype.getAt=function(t,e){var r=t.x,n=t.y,i=t.z,t=this.coefficients;return e.copy(t[0]).multiplyScalar(.282095),e.addScaledVector(t[1],.488603*n),e.addScaledVector(t[2],.488603*i),e.addScaledVector(t[3],.488603*r),e.addScaledVector(t[4],r*n*1.092548),e.addScaledVector(t[5],n*i*1.092548),e.addScaledVector(t[6],.315392*(3*i*i-1)),e.addScaledVector(t[7],r*i*1.092548),e.addScaledVector(t[8],.546274*(r*r-n*n)),e},Up.prototype.getIrradianceAt=function(t,e){var r=t.x,n=t.y,i=t.z,t=this.coefficients;return e.copy(t[0]).multiplyScalar(.886227),e.addScaledVector(t[1],1.023328*n),e.addScaledVector(t[2],1.023328*i),e.addScaledVector(t[3],1.023328*r),e.addScaledVector(t[4],.858086*r*n),e.addScaledVector(t[5],.858086*n*i),e.addScaledVector(t[6],.743125*i*i-.247708),e.addScaledVector(t[7],.858086*r*i),e.addScaledVector(t[8],.429043*(r*r-n*n)),e},Up.prototype.add=function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},Up.prototype.addScaledSH=function(t,e){for(var r=0;r<9;r++)this.coefficients[r].addScaledVector(t.coefficients[r],e);return this},Up.prototype.scale=function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},Up.prototype.lerp=function(t,e){for(var r=0;r<9;r++)this.coefficients[r].lerp(t.coefficients[r],e);return this},Up.prototype.equals=function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},Up.prototype.copy=function(t){return this.set(t.coefficients)},Up.prototype.clone=function(){return(new this.constructor).copy(this)},Up.prototype.fromArray=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients,n=0;n<9;n++)r[n].fromArray(t,e+3*n);return this},Up.prototype.toArray=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients,n=0;n<9;n++)r[n].toArray(t,e+3*n);return t},Up.getBasisAt=function(t,e){var r=t.x,n=t.y,t=t.z;e[0]=.282095,e[1]=.488603*n,e[2]=.488603*t,e[3]=.488603*r,e[4]=1.092548*r*n,e[5]=1.092548*n*t,e[6]=.315392*(3*t*t-1),e[7]=1.092548*r*t,e[8]=.546274*(r*r-n*n)},Up);function Up(){U(this,Up),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Tr)}zp.prototype.isSphericalHarmonics3=!0;var kp,Hp=(a(Gp,kp=$d),Gp.prototype.copy=function(t){return kp.prototype.copy.call(this,t),this.sh.copy(t.sh),this},Gp.prototype.fromJSON=function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},Gp.prototype.toJSON=function(t){t=kp.prototype.toJSON.call(this,t);return t.object.sh=this.sh.toArray(),t},Gp);function Gp(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new zp,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;U(this,Gp);e=z(this,kp.call(this,void 0,e));return e.sh=t,e}Hp.prototype.isLightProbe=!0;var Vp,Wp=(a(jp,Vp=Zh),jp.prototype.load=function(e,r,t,n){var i=this,a=new Kh(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},jp.prototype.parse=function(t){var e=this.textures;function r(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n,i=new vh[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&void 0!==i.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=(new ai).setHex(t.sheen)),void 0!==t.emissive&&void 0!==i.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==i.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),1!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(i.morphNormals=t.morphNormals),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.vertexTangents&&(i.vertexTangents=t.vertexTangents),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?i.vertexColors=0<t.vertexColors:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var a in t.uniforms){var o=t.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=r(o.value);break;case"c":i.uniforms[a].value=(new ai).setHex(o.value);break;case"v2":i.uniforms[a].value=(new or).fromArray(o.value);break;case"v3":i.uniforms[a].value=(new Tr).fromArray(o.value);break;case"v4":i.uniforms[a].value=(new vr).fromArray(o.value);break;case"m3":i.uniforms[a].value=(new lr).fromArray(o.value);break;case"m4":i.uniforms[a].value=(new an).fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var s in t.extensions)i.extensions[s]=t.extensions[s];return void 0!==t.shading&&(i.flatShading=1===t.shading),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=r(t.map)),void 0!==t.matcap&&(i.matcap=r(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=r(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=r(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=r(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale&&(n=t.normalScale,!1===Array.isArray(n)&&(n=[n,n]),i.normalScale=(new or).fromArray(n)),void 0!==t.displacementMap&&(i.displacementMap=r(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=r(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=r(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=r(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=r(t.specularMap)),void 0!==t.envMap&&(i.envMap=r(t.envMap)),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=r(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=r(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=r(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=r(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=r(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=(new or).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(i.transmission=t.transmission),void 0!==t.transmissionMap&&(i.transmissionMap=r(t.transmissionMap)),i},jp.prototype.setTextures=function(t){return this.textures=t,this},jp);function jp(t){U(this,jp);t=z(this,Vp.call(this,t));return t.textures={},t}var Xp={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",r=0,n=t.length;r<n;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function qp(){Di.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Yp(t,e,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),di.call(this,t,e,r),this.meshPerAttribute=n||1}qp.prototype=Object.assign(Object.create(Di.prototype),{constructor:qp,isInstancedBufferGeometry:!0,copy:function(t){return Di.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Di.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Yp.prototype=Object.assign(Object.create(di.prototype),{constructor:Yp,isInstancedBufferAttribute:!0,copy:function(t){return di.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=di.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});var Zp,Jp=(a(Kp,Zp=Zh),Kp.prototype.load=function(e,r,t,n){var i=this,a=new Kh(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},Kp.prototype.parse=function(t){var n={},i={};function e(t,e){if(void 0!==n[e])return n[e];var r=t.interleavedBuffers[e],t=function(t,e){if(void 0!==i[e])return i[e];t=t.arrayBuffers[e],t=new Uint32Array(t).buffer;return i[e]=t}(t,r.buffer),t=new rl(Ci(r.type,t),r.stride);return t.uuid=r.uuid,n[e]=t}var r=new(t.isInstancedBufferGeometry?qp:Di),a=t.data.index;void 0!==a&&(w=Ci(a.type,a.array),r.setIndex(new di(w,1)));var o,s=t.data.attributes;for(o in s){var l,u=s[o],c=void 0;c=u.isInterleavedBufferAttribute?new il(e(t.data,u.data),u.itemSize,u.offset,u.normalized):(l=Ci(u.type,u.array),new(u.isInstancedBufferAttribute?Yp:di)(l,u.itemSize,u.normalized)),void 0!==u.name&&(c.name=u.name),r.setAttribute(o,c)}var h=t.data.morphAttributes;if(h)for(var d in h){for(var p=h[d],f=[],m=0,g=p.length;m<g;m++){var v=p[m],y=void 0;y=v.isInterleavedBufferAttribute?new il(e(t.data,v.data),v.itemSize,v.offset,v.normalized):new di(Ci(v.type,v.array),v.itemSize,v.normalized),void 0!==v.name&&(y.name=v.name),f.push(y)}r.morphAttributes[d]=f}t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);var x=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==x)for(var b=0,_=x.length;b!==_;++b){var A=x[b];r.addGroup(A.start,A.count,A.materialIndex)}var w,a=t.data.boundingSphere;return void 0!==a&&(w=new Tr,void 0!==a.center&&w.fromArray(a.center),r.boundingSphere=new qr(w,a.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r},Kp);function Kp(t){return U(this,Kp),z(this,Zp.call(this,t))}var Qp;a($p,Qp=Zh),$p.prototype.load=function(n,i,t,a){var o=this,e=""===this.path?Xp.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||e;e=new Kh(this.manager);e.setPath(this.path),e.setRequestHeader(this.requestHeader),e.setWithCredentials(this.withCredentials),e.load(n,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==a&&a(t),void console.error("THREE:ObjectLoader: Can't parse "+n+".",t.message)}var r=e.metadata;void 0!==r&&void 0!==r.type&&"geometry"!==r.type.toLowerCase()?o.parse(e,i):console.error("THREE.ObjectLoader: Can't load "+n)},t,a)},$p.prototype.parse=function(t,e){var r=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,n),a=this.parseImages(t.images,function(){void 0!==e&&e(o)}),n=this.parseTextures(t.textures,a),n=this.parseMaterials(t.materials,n),o=this.parseObject(t.object,i,n,r),t=this.parseSkeletons(t.skeletons,o);if(this.bindSkeletons(o,t),void 0!==e){var s,l=!1;for(s in a)if(a[s]instanceof HTMLImageElement){l=!0;break}!1===l&&e(o)}return o},$p.prototype.parseShapes=function(t){var e={};if(void 0!==t)for(var r=0,n=t.length;r<n;r++){var i=(new Jd).fromJSON(t[r]);e[i.uuid]=i}return e},$p.prototype.parseSkeletons=function(t,e){var r={},n={};if(e.traverse(function(t){t.isBone&&(n[t.uuid]=t)}),void 0!==t)for(var i=0,a=t.length;i<a;i++){var o=(new Ul).fromJSON(t[i],n);r[o.uuid]=o}return r},$p.prototype.parseGeometries=function(t,e){var r={},n=void 0;if(void 0!==t)for(var i=new Jp,a=0,o=t.length;a<o;a++){var s=void 0,l=t[a];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Qc[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new Qc[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Qc[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Qc[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Qc[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Qc[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Qc[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Qc[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Qc[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Qc[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Qc[l.type]((new Wd[l.path.type]).fromJSON(l.path),l.tubularSegments,l.radius,l.radialSegments,l.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Qc[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Qc[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var n=[],u=0,c=l.shapes.length;u<c;u++){var h=e[l.shapes[u]];n.push(h)}s=new Qc[l.type](n,l.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var d=0,p=l.shapes.length;d<p;d++){var f=e[l.shapes[d]];n.push(f)}var m=l.options.extrudePath;void 0!==m&&(l.options.extrudePath=(new Wd[m.type]).fromJSON(m)),s=new Qc[l.type](n,l.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(l);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),!0===s.isBufferGeometry&&void 0!==l.userData&&(s.userData=l.userData),r[l.uuid]=s}return r},$p.prototype.parseMaterials=function(t,e){var r={},n={};if(void 0!==t){var i=new Wp;i.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===r[c.uuid]&&(r[c.uuid]=i.parse(c)),l.push(r[c.uuid])}n[s.uuid]=l}else void 0===r[s.uuid]&&(r[s.uuid]=i.parse(s)),n[s.uuid]=r[s.uuid]}}return n},$p.prototype.parseAnimations=function(t){var e={};if(void 0!==t)for(var r=0;r<t.length;r++){var n=t[r],n=Wh.parse(n);e[n.uuid]=n}return e},$p.prototype.parseImages=function(t,e){var r=this,n={},i=void 0;function a(t){if("string"!=typeof t)return t.data?{data:Ci(t.type,t.data),width:t.width,height:t.height}:null;var e,t=t,t=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t;return e=t,r.manager.itemStart(e),i.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemError(e),r.manager.itemEnd(e)})}if(void 0!==t&&0<t.length){e=new qh(e);(i=new rd(e)).setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var l=t[o],u=l.url;if(Array.isArray(u)){n[l.uuid]=[];for(var c=0,h=u.length;c<h;c++){var d=a(u[c]);null!==d&&(d instanceof HTMLImageElement?n[l.uuid].push(d):n[l.uuid].push(new Aa(d.data,d.width,d.height)))}}else{var p=a(l.url);null!==p&&(n[l.uuid]=p)}}}return n},$p.prototype.parseTextures=function(t,e){function r(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o=t[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,l=e[o.image];Array.isArray(l)?(s=new ga(l),6===l.length&&(s.needsUpdate=!0)):(s=l&&l.data?new Aa(l.data,l.width,l.height):new fr(l),l&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=r(o.mapping,tf)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=r(o.wrap[0],ef),s.wrapT=r(o.wrap[1],ef)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=r(o.minFilter,rf)),void 0!==o.magFilter&&(s.magFilter=r(o.magFilter,rf)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),n[o.uuid]=s}return n},$p.prototype.parseObject=function(t,e,a,r){var n=void 0;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];void 0===a[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(a[i])}return e}return void 0===a[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),a[t]}}var s=void 0,l=void 0;switch(t.type){case"Scene":n=new tl,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new ai(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new Ks(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new Zs(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new ua(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new Mp(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"AmbientLight":n=new Dp(t.color,t.intensity);break;case"DirectionalLight":n=new Lp(t.color,t.intensity);break;case"PointLight":n=new _p(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new Bp(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new dp(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new rp(t.color,t.groundColor,t.intensity);break;case"LightProbe":n=(new Hp).fromJSON(t);break;case"SkinnedMesh":n=new Fl(s=i(t.geometry),l=o(t.material)),void 0!==t.bindMode&&(n.bindMode=t.bindMode),void 0!==t.bindMatrix&&n.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(n.skeleton=t.skeleton);break;case"Mesh":n=new Ki(s=i(t.geometry),l=o(t.material));break;case"InstancedMesh":var s=i(t.geometry),l=o(t.material),u=t.count,c=t.instanceMatrix;(n=new jl(s,l,u)).instanceMatrix=new di(new Float32Array(c.array),16);break;case"LOD":n=new El;break;case"Line":n=new tu(i(t.geometry),o(t.material));break;case"LineLoop":n=new au(i(t.geometry),o(t.material));break;case"LineSegments":n=new nu(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":n=new mu(i(t.geometry),o(t.material));break;case"Sprite":n=new Al(o(t.material));break;case"Group":n=new Gs;break;case"Bone":n=new Bl;break;default:n=new Dn}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(n.matrixAutoUpdate=t.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(n.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.frustumCulled&&(n.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(n.renderOrder=t.renderOrder),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.layers&&(n.layers.mask=t.layers),void 0!==t.children)for(var h=t.children,d=0;d<h.length;d++)n.add(this.parseObject(h[d],e,a,r));if(void 0!==t.animations)for(var p=t.animations,f=0;f<p.length;f++){var m=p[f];n.animations.push(r[m])}if("LOD"===t.type){void 0!==t.autoUpdate&&(n.autoUpdate=t.autoUpdate);for(var g=t.levels,v=0;v<g.length;v++){var y=g[v],x=n.getObjectByProperty("uuid",y.object);void 0!==x&&n.addLevel(x,y.distance)}}return n},$p.prototype.bindSkeletons=function(t,r){0!==Object.keys(r).length&&t.traverse(function(t){var e;!0===t.isSkinnedMesh&&void 0!==t.skeleton&&(void 0===(e=r[t.skeleton])?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(e,t.bindMatrix))})},$p.prototype.setTexturePath=function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)};function $p(t){return U(this,$p),z(this,Qp.call(this,t))}var tf={UVMapping:300,CubeReflectionMapping:O,CubeRefractionMapping:F,EquirectangularReflectionMapping:s,EquirectangularRefractionMapping:l,CubeUVReflectionMapping:B,CubeUVRefractionMapping:N},ef={RepeatWrapping:k,ClampToEdgeWrapping:H,MirroredRepeatWrapping:wt},rf={NearestFilter:Mt,NearestMipmapNearestFilter:Ct,NearestMipmapLinearFilter:St,LinearFilter:Et,LinearMipmapNearestFilter:It,LinearMipmapLinearFilter:Lt};function nf(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Zh.call(this,t),this.options={premultiplyAlpha:"none"}}nf.prototype=Object.assign(Object.create(Zh.prototype),{constructor:nf,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(e,r,t,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Xh.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){r&&r(a),i.manager.itemEnd(e)},0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(t){Xh.add(e,t),r&&r(t),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}});var af=(of.prototype.moveTo=function(t,e){return this.currentPath=new qd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},of.prototype.lineTo=function(t,e){return this.currentPath.lineTo(t,e),this},of.prototype.quadraticCurveTo=function(t,e,r,n){return this.currentPath.quadraticCurveTo(t,e,r,n),this},of.prototype.bezierCurveTo=function(t,e,r,n,i,a){return this.currentPath.bezierCurveTo(t,e,r,n,i,a),this},of.prototype.splineThru=function(t){return this.currentPath.splineThru(t),this},of.prototype.toShapes=function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],a=new Jd;a.curves=i.curves,e.push(a)}return e}var n=hc.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===e)return r(i);var a=void 0,o=void 0,s=void 0,l=[];if(1===i.length)return o=i[0],(s=new Jd).curves=o.curves,l.push(s),l;var u,c=!n(i[0].getPoints()),c=t?!c:c,h=[],d=[],p=[],f=0;d[f]=void 0,p[f]=[];for(var m=0,g=i.length;m<g;m++)a=n(u=(o=i[m]).getPoints()),(a=t?!a:a)?(!c&&d[f]&&f++,d[f]={s:new Jd,p:u},d[f].s.curves=o.curves,c&&f++,p[f]=[]):p[f].push({h:o,p:u[0]});if(!d[0])return r(i);if(1<d.length){for(var v=!1,y=[],x=0,b=d.length;x<b;x++)h[x]=[];for(var _=0,A=d.length;_<A;_++)for(var w=p[_],M=0;M<w.length;M++){for(var C=w[M],T=!0,S=0;S<d.length;S++)!function(t,e){for(var r=e.length,n=!1,i=r-1,a=0;a<r;i=a++){var o=e[i],s=e[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=e[a],l=-l,s=e[i],u=-u),!(t.y<o.y||t.y>s.y))if(t.y===o.y){if(t.x===o.x)return 1}else{l=u*(t.x-o.x)-l*(t.y-o.y);if(0==l)return 1;l<0||(n=!n)}}else if(t.y===o.y&&(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x))return 1}return n}(C.p,d[S].p)||(_!==S&&y.push({froms:_,tos:S,hole:M}),T?(T=!1,h[S].push(C)):v=!0);T&&h[_].push(C)}0<y.length&&(v||(p=h))}for(var E=void 0,I=0,L=d.length;I<L;I++){s=d[I].s,l.push(s);for(var R=0,P=(E=p[I]).length;R<P;R++)s.holes.push(E[R].h)}return l},of);function of(){U(this,of),this.type="ShapePath",this.color=new ai,this.subPaths=[],this.currentPath=null}var sf=(lf.prototype.generateShapes=function(t){for(var e=[],r=function(t,e,r){for(var n=Array.from(t),i=e/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,o=[],s=0,l=0,u=0;u<n.length;u++){var c=n[u];"\n"===c?(s=0,l-=a):(c=function(t,e,r,n,i){var a=i.glyphs[t]||i.glyphs["?"];if(!a)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".");var o=new af,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,p=void 0,f=void 0;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;)switch(m[g++]){case"m":s=m[g++]*e+r,l=m[g++]*e+n,o.moveTo(s,l);break;case"l":s=m[g++]*e+r,l=m[g++]*e+n,o.lineTo(s,l);break;case"q":u=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,d=m[g++]*e+n,o.quadraticCurveTo(h,d,u,c);break;case"b":u=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,d=m[g++]*e+n,p=m[g++]*e+r,f=m[g++]*e+n,o.bezierCurveTo(h,d,p,f,u,c)}return{offsetX:a.ha*e,path:o}}(c,i,s,l,r),s+=c.offsetX,o.push(c.path))}return o}(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,this.data),n=0,i=r.length;n<i;n++)Array.prototype.push.apply(e,r[n].toShapes());return e},lf);function lf(t){U(this,lf),this.type="Font",this.data=t}sf.prototype.isFont=!0;var uf;a(cf,uf=Zh),cf.prototype.load=function(t,n,e,r){var i=this,a=new Kh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials),a.load(t,function(e){var r=void 0;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var t=i.parse(r);n&&n(t)},e,r)},cf.prototype.parse=function(t){return new sf(t)};function cf(t){return U(this,cf),z(this,uf.call(this,t))}var hf,df,pf,ff=void 0,mf={getContext:function(){return ff=void 0===ff?new(window.AudioContext||window.webkitAudioContext):ff},setContext:function(t){ff=t}},gf=(a(vf,hf=Zh),vf.prototype.load=function(r,n,t,i){var a=this,e=new Kh(this.manager);e.setResponseType("arraybuffer"),e.setPath(this.path),e.setRequestHeader(this.requestHeader),e.setWithCredentials(this.withCredentials),e.load(r,function(t){try{var e=t.slice(0);mf.getContext().decodeAudioData(e,function(t){n(t)})}catch(t){i?i(t):console.error(t),a.manager.itemError(r)}},t,i)},vf);function vf(t){return U(this,vf),z(this,hf.call(this,t))}function yf(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;U(this,yf);var n=z(this,df.call(this,void 0,r)),i=(new ai).set(t),r=(new ai).set(e),t=new Tr(i.r,i.g,i.b),e=new Tr(r.r,r.g,r.b),i=Math.sqrt(Math.PI),r=i*Math.sqrt(.75);return n.sh.coefficients[0].copy(t).add(e).multiplyScalar(i),n.sh.coefficients[1].copy(t).sub(e).multiplyScalar(r),n}function xf(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;U(this,xf);e=z(this,pf.call(this,void 0,e)),t=(new ai).set(t);return e.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI)),e}(a(yf,df=Hp),yf).prototype.isHemisphereLightProbe=!0,(a(xf,pf=Hp),xf).prototype.isAmbientLightProbe=!0;var bf=new an,_f=new an;Af.prototype.update=function(t){var e,r,n,i,a,o,s=this._cache;s.focus===t.focus&&s.fov===t.fov&&s.aspect===t.aspect*this.aspect&&s.near===t.near&&s.far===t.far&&s.zoom===t.zoom&&s.eyeSep===this.eyeSep||(s.focus=t.focus,s.fov=t.fov,s.aspect=t.aspect*this.aspect,s.near=t.near,s.far=t.far,s.zoom=t.zoom,s.eyeSep=this.eyeSep,e=t.projectionMatrix.clone(),n=(r=s.eyeSep/2)*s.near/s.focus,i=s.near*Math.tan(ar.DEG2RAD*s.fov*.5)/s.zoom,o=a=void 0,_f.elements[12]=-r,bf.elements[12]=r,a=-i*s.aspect+n,o=i*s.aspect+n,e.elements[0]=2*s.near/(o-a),e.elements[8]=(o+a)/(o-a),this.cameraL.projectionMatrix.copy(e),a=-i*s.aspect-n,o=i*s.aspect-n,e.elements[0]=2*s.near/(o-a),e.elements[8]=(o+a)/(o-a),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(_f),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(bf)};function Af(){U(this,Af),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ua,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ua,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}var wf=(Mf.prototype.start=function(){this.startTime=Cf(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},Mf.prototype.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},Mf.prototype.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},Mf.prototype.getDelta=function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=Cf())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)},Mf);function Mf(t){U(this,Mf),this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Cf(){return("undefined"==typeof performance?Date:performance).now()}var Tf,Sf=new Tr,Ef=new Mr,If=new Tr,Lf=new Tr;a(Rf,Tf=Dn),Rf.prototype.getInput=function(){return this.gain},Rf.prototype.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},Rf.prototype.getFilter=function(){return this.filter},Rf.prototype.setFilter=function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},Rf.prototype.getMasterVolume=function(){return this.gain.gain.value},Rf.prototype.setMasterVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},Rf.prototype.updateMatrixWorld=function(t){Tf.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,r=this.up;this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sf,Ef,If),Lf.set(0,0,-1).applyQuaternion(Ef),e.positionX?(t=this.context.currentTime+this.timeDelta,e.positionX.linearRampToValueAtTime(Sf.x,t),e.positionY.linearRampToValueAtTime(Sf.y,t),e.positionZ.linearRampToValueAtTime(Sf.z,t),e.forwardX.linearRampToValueAtTime(Lf.x,t),e.forwardY.linearRampToValueAtTime(Lf.y,t),e.forwardZ.linearRampToValueAtTime(Lf.z,t),e.upX.linearRampToValueAtTime(r.x,t),e.upY.linearRampToValueAtTime(r.y,t),e.upZ.linearRampToValueAtTime(r.z,t)):(e.setPosition(Sf.x,Sf.y,Sf.z),e.setOrientation(Lf.x,Lf.y,Lf.z,r.x,r.y,r.z))};function Rf(){U(this,Rf);var t=z(this,Tf.call(this));return t.type="AudioListener",t.context=mf.getContext(),t.gain=t.context.createGain(),t.gain.connect(t.context.destination),t.filter=null,t.timeDelta=0,t._clock=new wf,t}var Pf,e=(a(Df,Pf=Dn),Df.prototype.getOutput=function(){return this.gain},Df.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},Df.prototype.setMediaElementSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},Df.prototype.setMediaStreamSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},Df.prototype.setBuffer=function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},Df.prototype.play=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},Df.prototype.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},Df.prototype.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},Df.prototype.connect=function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},Df.prototype.disconnect=function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},Df.prototype.getFilters=function(){return this.filters},Df.prototype.setFilters=function(t){return t=t||[],!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this},Df.prototype.setDetune=function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},Df.prototype.getDetune=function(){return this.detune},Df.prototype.getFilter=function(){return this.getFilters()[0]},Df.prototype.setFilter=function(t){return this.setFilters(t?[t]:[])},Df.prototype.setPlaybackRate=function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},Df.prototype.getPlaybackRate=function(){return this.playbackRate},Df.prototype.onEnded=function(){this.isPlaying=!1},Df.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},Df.prototype.setLoop=function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},Df.prototype.setLoopStart=function(t){return this.loopStart=t,this},Df.prototype.setLoopEnd=function(t){return this.loopEnd=t,this},Df.prototype.getVolume=function(){return this.gain.gain.value},Df.prototype.setVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},Df);function Df(t){U(this,Df);var e=z(this,Pf.call(this));return e.type="Audio",e.listener=t,e.context=t.context,e.gain=e.context.createGain(),e.gain.connect(t.getInput()),e.autoplay=!1,e.buffer=null,e.detune=0,e.loop=!1,e.loopStart=0,e.loopEnd=0,e.offset=0,e.duration=void 0,e.playbackRate=1,e.isPlaying=!1,e.hasPlaybackControl=!0,e.source=null,e.sourceType="empty",e._startedAt=0,e._progress=0,e._connected=!1,e.filters=[],e}var Of,Ff=new Tr,Bf=new Mr,Nf=new Tr,zf=new Tr;a(Uf,Of=e),Uf.prototype.getOutput=function(){return this.panner},Uf.prototype.getRefDistance=function(){return this.panner.refDistance},Uf.prototype.setRefDistance=function(t){return this.panner.refDistance=t,this},Uf.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},Uf.prototype.setRolloffFactor=function(t){return this.panner.rolloffFactor=t,this},Uf.prototype.getDistanceModel=function(){return this.panner.distanceModel},Uf.prototype.setDistanceModel=function(t){return this.panner.distanceModel=t,this},Uf.prototype.getMaxDistance=function(){return this.panner.maxDistance},Uf.prototype.setMaxDistance=function(t){return this.panner.maxDistance=t,this},Uf.prototype.setDirectionalCone=function(t,e,r){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=r,this},Uf.prototype.updateMatrixWorld=function(t){var e;Of.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(Ff,Bf,Nf),zf.set(0,0,1).applyQuaternion(Bf),(e=this.panner).positionX?(t=this.context.currentTime+this.listener.timeDelta,e.positionX.linearRampToValueAtTime(Ff.x,t),e.positionY.linearRampToValueAtTime(Ff.y,t),e.positionZ.linearRampToValueAtTime(Ff.z,t),e.orientationX.linearRampToValueAtTime(zf.x,t),e.orientationY.linearRampToValueAtTime(zf.y,t),e.orientationZ.linearRampToValueAtTime(zf.z,t)):(e.setPosition(Ff.x,Ff.y,Ff.z),e.setOrientation(zf.x,zf.y,zf.z)))};function Uf(t){U(this,Uf);t=z(this,Of.call(this,t));return t.panner=t.context.createPanner(),t.panner.panningModel="HRTF",t.panner.connect(t.gain),t}kf.prototype.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},kf.prototype.getAverageFrequency=function(){for(var t=0,e=this.getFrequencyData(),r=0;r<e.length;r++)t+=e[r];return t/e.length},Ka=kf;function kf(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2048;U(this,kf),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var Hf=(Gf.prototype.accumulate=function(t,e){var r=this.buffer,n=this.valueSize,i=t*n+n,t=this.cumulativeWeight;if(0===t){for(var a=0;a!==n;++a)r[i+a]=r[a];t=e}else{e=e/(t+=e);this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=t},Gf.prototype.accumulateAdditive=function(t){var e=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,r),this.cumulativeWeightAdditive+=t},Gf.prototype.apply=function(t){var e=this.valueSize,r=this.buffer,n=t*e+e,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1&&(t=e*this._origIndex,this._mixBufferRegion(r,n,t,1-i,e)),0<a&&this._mixBufferRegionAdditive(r,n,this._addIndex*e,1,e);for(var s=e,l=e+e;s!==l;++s)if(r[s]!==r[s+e]){o.setValue(r,n);break}},Gf.prototype.saveOriginalState=function(){var t=this.binding,e=this.buffer,r=this.valueSize,n=r*this._origIndex;t.getValue(e,n);for(var i=r,a=n;i!==a;++i)e[i]=e[n+i%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},Gf.prototype.restoreOriginalState=function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},Gf.prototype._setAdditiveIdentityNumeric=function(){for(var t=this._addIndex*this.valueSize,e=t+this.valueSize,r=t;r<e;r++)this.buffer[r]=0},Gf.prototype._setAdditiveIdentityQuaternion=function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},Gf.prototype._setAdditiveIdentityOther=function(){for(var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[e+r]=this.buffer[t+r]},Gf.prototype._select=function(t,e,r,n,i){if(.5<=n)for(var a=0;a!==i;++a)t[e+a]=t[r+a]},Gf.prototype._slerp=function(t,e,r,n){Mr.slerpFlat(t,e,t,e,t,r,n)},Gf.prototype._slerpAdditive=function(t,e,r,n,i){i=this._workIndex*i;Mr.multiplyQuaternionsFlat(t,i,t,e,t,r),Mr.slerpFlat(t,e,t,e,t,i,n)},Gf.prototype._lerp=function(t,e,r,n,i){for(var a=1-n,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[r+o]*n}},Gf.prototype._lerpAdditive=function(t,e,r,n,i){for(var a=0;a!==i;++a){var o=e+a;t[o]=t[o]+t[r+a]*n}},Gf);function Gf(t,e,r){U(this,Gf),this.binding=t,this.valueSize=r;var n=void 0,i=void 0,a=void 0;switch(e){case"quaternion":n=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}var to="\\[\\]\\.:\\/",Vf=new RegExp("["+to+"]","g"),xc="[^"+to+"]",Bu="[^"+to.replace("\\.","")+"]",Ic=/((?:WC+[\/:])*)/.source.replace("WC",xc),zc=/(WCOD+)?/.source.replace("WCOD",Bu),n=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",xc),r=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",xc),Wf=new RegExp("^"+Ic+zc+n+r+"$"),jf=["material","materials","bones"];function Xf(t,e,r){r=r||qf.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function qf(t,e,r){this.path=e,this.parsedPath=r||qf.parseTrackName(e),this.node=qf.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Yf(){U(this,Yf),this.uuid=ar.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,r=arguments.length;e!==r;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}Object.assign(Xf.prototype,{getValue:function(t,e){this.bind();var r=this._targetGroup.nCachedObjects_,r=this._bindings[r];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Object.assign(qf,{Composite:Xf,create:function(t,e,r){return new(t&&t.isAnimationObjectGroup?qf.Composite:qf)(t,e,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Vf,"")},parseTrackName:function(t){var e=Wf.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n&&(e=r.nodeName.substring(n+1),-1!==jf.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)),null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,i){if(!i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(i);if(void 0!==e)return e}if(t.children){t=function t(e){for(var r=0;r<e.length;r++){var n=e[r];if(n.name===i||n.uuid===i)return n;n=t(n.children);if(n)return n}return null}(t.children);if(t)return t}return null}}),Object.assign(qf.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,r=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(t=qf.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var a=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(var t=t.skeleton.bones,o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[n];if(void 0!==s){var l=this.Versioning.None;void 0!==(this.targetObject=t).needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{e=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+e+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(qf.prototype,{_getValue_unbound:qf.prototype.getValue,_setValue_unbound:qf.prototype.setValue}),(Yf.prototype.add=function(){for(var t=this._objects,e=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=t.length,l=this.nCachedObjects_,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,p=e[d];if(void 0===p){p=s++,e[d]=p,t.push(h);for(var f=0,m=a;f!==m;++f)i[f].push(new qf(h,r[f],n[f]))}else if(p<l){var o=t[p],g=--l,v=t[g];t[e[v.uuid]=p]=v,t[e[d]=g]=h;for(var y=0,x=a;y!==x;++y){var b=i[y],_=b[g],A=b[p];b[p]=_,void 0===A&&(A=new qf(h,r[y],n[y])),b[g]=A}}else t[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},Yf.prototype.remove=function(){for(var t=this._objects,e=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=e[l];if(void 0!==u&&i<=u){var c=i++,h=t[c];t[e[h.uuid]=u]=h,t[e[l]=c]=s;for(var d=0,p=n;d!==p;++d){var f=r[d],m=f[c],g=f[u];f[u]=m,f[c]=g}}}this.nCachedObjects_=i},Yf.prototype.uncache=function(){for(var t=this._objects,e=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_,a=t.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,u=e[l];if(void 0!==u)if(delete e[l],u<i){var c=--i,l=t[c],h=--a,d=t[h];t[e[l.uuid]=u]=l,t[e[d.uuid]=c]=d,t.pop();for(var p=0,f=n;p!==f;++p){var m=r[p],g=m[c],v=m[h];m[u]=g,m[c]=v,m.pop()}}else{var y=--a,d=t[y];0<y&&(e[d.uuid]=u),t[u]=d,t.pop();for(var x=0,b=n;x!==b;++x){var _=r[x];_[u]=_[y],_.pop()}}}this.nCachedObjects_=i},Yf.prototype.subscribe_=function(t,e){var r=this._bindingsIndicesByPath,n=r[t],i=this._bindings;if(void 0!==n)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l),n=i.length;r[t]=n,a.push(t),o.push(e),i.push(c);for(var h=u,d=s.length;h!==d;++h){var p=s[h];c[h]=new qf(p,t,e)}return c},Yf.prototype.unsubscribe_=function(t){var e,r,n,i,a,o=this._bindingsIndicesByPath,s=o[t];void 0!==s&&(e=this._paths,r=this._parsedPaths,a=(n=this._bindings)[i=n.length-1],n[o[t[i]]=s]=a,n.pop(),r[s]=r[i],r.pop(),e[s]=e[i],e.pop())},Yf).prototype.isAnimationObjectGroup=!0;var Zf,Jf=(Kf.prototype.play=function(){return this._mixer._activateAction(this),this},Kf.prototype.stop=function(){return this._mixer._deactivateAction(this),this.reset()},Kf.prototype.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},Kf.prototype.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},Kf.prototype.isScheduled=function(){return this._mixer._isActiveAction(this)},Kf.prototype.startAt=function(t){return this._startTime=t,this},Kf.prototype.setLoop=function(t,e){return this.loop=t,this.repetitions=e,this},Kf.prototype.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},Kf.prototype.getEffectiveWeight=function(){return this._effectiveWeight},Kf.prototype.fadeIn=function(t){return this._scheduleFading(t,0,1)},Kf.prototype.fadeOut=function(t){return this._scheduleFading(t,1,0)},Kf.prototype.crossFadeFrom=function(t,e,r){var n,i;return t.fadeOut(e),this.fadeIn(e),r&&(n=this._clip.duration,r=(i=t._clip.duration)/n,i=n/i,t.warp(1,r,e),this.warp(i,1,e)),this},Kf.prototype.crossFadeTo=function(t,e,r){return t.crossFadeFrom(this,e,r)},Kf.prototype.stopFading=function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},Kf.prototype.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},Kf.prototype.getEffectiveTimeScale=function(){return this._effectiveTimeScale},Kf.prototype.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},Kf.prototype.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},Kf.prototype.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},Kf.prototype.warp=function(t,e,r){var n=this._mixer,i=n.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);n=o.parameterPositions,o=o.sampleValues;return n[0]=i,n[1]=i+r,o[0]=t/a,o[1]=e/a,this},Kf.prototype.stopWarping=function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},Kf.prototype.getMixer=function(){return this._mixer},Kf.prototype.getClip=function(){return this._clip},Kf.prototype.getRoot=function(){return this._localRoot||this._mixer._root},Kf.prototype._update=function(t,e,r,n){if(this.enabled){var i=this._startTime;if(null!==i){i=(t-i)*r;if(i<0||0===r)return;this._startTime=null,e=r*i}e*=this._updateTimeScale(t);var a=this._updateTime(e),o=this._updateWeight(t);if(0<o){var s=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case 2501:for(var u=0,c=s.length;u!==c;++u)s[u].evaluate(a),l[u].accumulateAdditive(o);break;case Fe:default:for(var h=0,d=s.length;h!==d;++h)s[h].evaluate(a),l[h].accumulate(n,o)}}}else this._updateWeight(t)},Kf.prototype._updateWeight=function(t){var e,r,n=0;return this.enabled&&(n=this.weight,null!==(e=this._weightInterpolant)&&(n*=r=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1)))),this._effectiveWeight=n},Kf.prototype._updateTimeScale=function(t){var e,r=0;return this.paused||(r=this.timeScale,null!==(e=this._timeScaleInterpolant)&&(r*=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopWarping(),0===r?this.paused=!0:this.timeScale=r))),this._effectiveTimeScale=r},Kf.prototype._updateTime=function(t){var e,r=this._clip.duration,n=this.loop,i=this.time+t,a=this._loopCount,o=2202===n;if(0===t)return-1!==a&&o&&1==(1&a)?r-i:i;if(2200===n){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r<=i)i=r;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else if(-1===a&&(0<=t?(a=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r<=i||i<0?(i-=r*(e=Math.floor(i/r)),a+=Math.abs(e),(n=this.repetitions-a)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=0<t?r:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1==n?(n=t<0,this._setEndings(n,!n,o)):this._setEndings(!1,!1,o),this._loopCount=a,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:e}))):this.time=i,o&&1==(1&a))return r-i;return i},Kf.prototype._setEndings=function(t,e,r){var n=this._interpolantSettings;r?(n.endingStart=Oe,n.endingEnd=Oe):(n.endingStart=t?this.zeroSlopeAtStart?Oe:De:2402,n.endingEnd=e?this.zeroSlopeAtEnd?Oe:De:2402)},Kf.prototype._scheduleFading=function(t,e,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);n=a.parameterPositions,a=a.sampleValues;return n[0]=i,a[0]=e,n[1]=i+t,a[1]=r,this},Kf);function Kf(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e.blendMode;U(this,Kf),this._mixer=t,this._clip=e,this._localRoot=r,this.blendMode=n;for(var i=e.tracks,a=i.length,o=new Array(a),s={endingStart:De,endingEnd:De},l=0;l!==a;++l){var u=i[l].createInterpolant(null);(o[l]=u).settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Le,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Qf(t){U(this,Qf);var e=z(this,Zf.call(this));return e._root=t,e._initMemoryManager(),e._accuIndex=0,e.time=0,e.timeScale=1,e}(a(Qf,Zf=er),Qf.prototype._bindAction=function(t,e){var r=t._localRoot||this._root,n=t._clip.tracks,i=n.length,a=t._propertyBindings,o=t._interpolants,s=r.uuid,t=this._bindingsByRootAndName,l=t[s];void 0===l&&(l={},t[s]=l);for(var u=0;u!==i;++u){var c=n[u],h=c.name;if(void 0!==(d=l[h]))a[u]=d;else{if(void 0!==(d=a[u])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,h));continue}var d,p=e&&e._propertyBindings[u].binding.parsedPath;++(d=new Hf(qf.create(r,h,p),c.ValueTypeName,c.getValueSize())).referenceCount,this._addInactiveBinding(d,s,h),a[u]=d}o[u].resultBuffer=d.buffer}},Qf.prototype._activateAction=function(t){if(!this._isActiveAction(t)){var e,r,n;null===t._cacheIndex&&(e=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r],this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,e));for(var i=t._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},Qf.prototype._deactivateAction=function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},Qf.prototype._initMemoryManager=function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},Qf.prototype._isActiveAction=function(t){t=t._cacheIndex;return null!==t&&t<this._nActiveActions},Qf.prototype._addInactiveAction=function(t,e,r){var n=this._actions,i=this._actionsByClip,a=i[e];void 0===a?(a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a):(e=a.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),a.actionByRoot[r]=t},Qf.prototype._removeInactiveAction=function(t){var e=this._actions,r=e[e.length-1],n=t._cacheIndex;e[r._cacheIndex=n]=r,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,o=a[i],n=o.knownActions,r=n[n.length-1],e=t._byClipCacheIndex;n[r._byClipCacheIndex=e]=r,n.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===n.length&&delete a[i],this._removeInactiveBindingsForAction(t)},Qf.prototype._removeInactiveBindingsForAction=function(t){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},Qf.prototype._lendAction=function(t){var e=this._actions,r=t._cacheIndex,n=this._nActiveActions++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},Qf.prototype._takeBackAction=function(t){var e=this._actions,r=t._cacheIndex,n=--this._nActiveActions,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},Qf.prototype._addInactiveBinding=function(t,e,r){var n=this._bindingsByRootAndName,i=this._bindings,a=n[e];void 0===a&&(a={},n[e]=a),(a[r]=t)._cacheIndex=i.length,i.push(t)},Qf.prototype._removeInactiveBinding=function(t){var e=this._bindings,r=t.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,o=a[n],r=e[e.length-1],t=t._cacheIndex;e[r._cacheIndex=t]=r,e.pop(),delete o[i],0===Object.keys(o).length&&delete a[n]},Qf.prototype._lendBinding=function(t){var e=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},Qf.prototype._takeBackBinding=function(t){var e=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},Qf.prototype._lendControlInterpolant=function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&(t[(r=new _h(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=r),r},Qf.prototype._takeBackControlInterpolant=function(t){var e=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];e[t.__cacheIndex=n]=t,e[i.__cacheIndex=r]=i},Qf.prototype.clipAction=function(t,e,r){var n=e||this._root,i=n.uuid,a="string"==typeof t?Wh.findByName(n,t):t,o=null!==a?a.uuid:t,s=this._actionsByClip[o],n=null;if(void 0===r&&(r=null!==a?a.blendMode:Fe),void 0!==s){t=s.actionByRoot[i];if(void 0!==t&&t.blendMode===r)return t;n=s.knownActions[0],null===a&&(a=n._clip)}if(null===a)return null;r=new Jf(this,a,e,r);return this._bindAction(r,n),this._addInactiveAction(r,o,i),r},Qf.prototype.existingAction=function(t,e){var r=e||this._root,e=r.uuid,r="string"==typeof t?Wh.findByName(r,t):t,t=r?r.uuid:t,t=this._actionsByClip[t];return void 0!==t&&t.actionByRoot[e]||null},Qf.prototype.stopAllAction=function(){for(var t=this._actions,e=this._nActiveActions-1;0<=e;--e)t[e].stop();return this},Qf.prototype.update=function(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,n=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,o=0;o!==r;++o)e[o]._update(n,t,i,a);for(var s=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)s[u].apply(a);return this},Qf.prototype.setTime=function(t){for(var e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},Qf.prototype.getRoot=function(){return this._root},Qf.prototype.uncacheClip=function(t){var e=this._actions,r=t.uuid,n=this._actionsByClip,t=n[r];if(void 0!==t){for(var i=t.knownActions,a=0,o=i.length;a!==o;++a){var s=i[a];this._deactivateAction(s);var l=s._cacheIndex,u=e[e.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,e[u._cacheIndex=l]=u,e.pop(),this._removeInactiveBindingsForAction(s)}delete n[r]}},Qf.prototype.uncacheRoot=function(t){var e,r=t.uuid,n=this._actionsByClip;for(e in n){var i=n[e].actionByRoot[r];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[r];if(void 0!==a)for(var o in a){o=a[o];o.restoreOriginalState(),this._removeInactiveBinding(o)}},Qf.prototype.uncacheAction=function(t,e){e=this.existingAction(t,e);null!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))},Qf).prototype._controlInterpolantsResultBuffer=new Float32Array(1);$f.prototype.clone=function(){return new $f(void 0===this.value.clone?this.value:this.value.clone())},to=$f;function $f(t){U(this,$f),"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function tm(t,e,r){rl.call(this,t,e),this.meshPerAttribute=r||1}function em(t,e,r,n,i){this.buffer=t,this.type=e,this.itemSize=r,this.elementSize=n,this.count=i,this.version=0}function rm(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new rn(t,e),this.near=r,this.far=n,this.camera=null,this.layers=new yn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function nm(t,e){return t.distance-e.distance}function im(t,e,r,n){if(t.layers.test(e.layers)&&t.raycast(e,r),!0===n)for(var i=t.children,a=0,o=i.length;a<o;a++)im(i[a],e,r,!0)}tm.prototype=Object.assign(Object.create(rl.prototype),{constructor:tm,isInstancedInterleavedBuffer:!0,copy:function(t){return rl.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){t=rl.prototype.clone.call(this,t);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(t){t=rl.prototype.toJSON.call(this,t);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(em.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(em.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(rm.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)},intersectObject:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return im(t,this,r,e),r.sort(nm),r},intersectObjects:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=0,i=t.length;n<i;n++)im(t[n],this,r,e);return r.sort(nm),r}});am.prototype.set=function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},am.prototype.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},am.prototype.makeSafe=function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},am.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},am.prototype.setFromCartesianCoords=function(t,e,r){return this.radius=Math.sqrt(t*t+e*e+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,r),this.phi=Math.acos(ar.clamp(e/this.radius,-1,1))),this},am.prototype.clone=function(){return(new this.constructor).copy(this)};function am(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return U(this,am),this.radius=t,this.phi=e,this.theta=r,this}om.prototype.set=function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},om.prototype.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},om.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},om.prototype.setFromCartesianCoords=function(t,e,r){return this.radius=Math.sqrt(t*t+r*r),this.theta=Math.atan2(t,r),this.y=e,this},om.prototype.clone=function(){return(new this.constructor).copy(this)};function om(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return U(this,om),this.radius=t,this.theta=e,this.y=r,this}var sm=new or,Bu=(lm.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},lm.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},lm.prototype.setFromCenterAndSize=function(t,e){e=sm.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this},lm.prototype.clone=function(){return(new this.constructor).copy(this)},lm.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},lm.prototype.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},lm.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},lm.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new or),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},lm.prototype.getSize=function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new or),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},lm.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},lm.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},lm.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},lm.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},lm.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},lm.prototype.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new or),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},lm.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},lm.prototype.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new or),e.copy(t).clamp(this.min,this.max)},lm.prototype.distanceToPoint=function(t){return sm.copy(t).clamp(this.min,this.max).sub(t).length()},lm.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},lm.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},lm.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},lm.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},lm);function lm(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new or(1/0,1/0),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new or(-1/0,-1/0);U(this,lm),this.min=t,this.max=e}Bu.prototype.isBox2=!0;var um=new Tr,cm=new Tr,xc=(hm.prototype.set=function(t,e){return this.start.copy(t),this.end.copy(e),this},hm.prototype.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},hm.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Tr),t.addVectors(this.start,this.end).multiplyScalar(.5)},hm.prototype.delta=function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Tr),t.subVectors(this.end,this.start)},hm.prototype.distanceSq=function(){return this.start.distanceToSquared(this.end)},hm.prototype.distance=function(){return this.start.distanceTo(this.end)},hm.prototype.at=function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Tr),this.delta(e).multiplyScalar(t).add(this.start)},hm.prototype.closestPointToPointParameter=function(t,e){um.subVectors(t,this.start),cm.subVectors(this.end,this.start);t=cm.dot(cm),t=cm.dot(um)/t;return t=e?ar.clamp(t,0,1):t},hm.prototype.closestPointToPoint=function(t,e,r){e=this.closestPointToPointParameter(t,e);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Tr),this.delta(r).multiplyScalar(e).add(this.start)},hm.prototype.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},hm.prototype.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},hm.prototype.clone=function(){return(new this.constructor).copy(this)},hm);function hm(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr;U(this,hm),this.start=t,this.end=e}function dm(t){Dn.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}((dm.prototype=Object.create(Dn.prototype)).constructor=dm).prototype.isImmediateRenderObject=!0;var pm,fm=new Tr;a(mm,pm=Dn),mm.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},mm.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance||1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),fm.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(fm),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};function mm(t,e){U(this,mm);var r=z(this,pm.call(this));r.light=t,r.light.updateMatrixWorld(),r.matrix=t.matrixWorld,r.matrixAutoUpdate=!1,r.color=e;for(var t=new Di,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}t.setAttribute("position",new _i(n,3));e=new ql({fog:!1,toneMapped:!1});return r.cone=new nu(t,e),r.add(r.cone),r.update(),r}var gm,vm=new Tr,ym=new an,xm=new an,Ic=(a(bm,gm=nu),bm.prototype.updateMatrixWorld=function(t){var e=this.bones,r=this.geometry,n=r.getAttribute("position");xm.copy(this.root.matrixWorld).invert();for(var i=0,a=0;i<e.length;i++){var o=e[i];o.parent&&o.parent.isBone&&(ym.multiplyMatrices(xm,o.matrixWorld),vm.setFromMatrixPosition(ym),n.setXYZ(a,vm.x,vm.y,vm.z),ym.multiplyMatrices(xm,o.parent.matrixWorld),vm.setFromMatrixPosition(ym),n.setXYZ(a+1,vm.x,vm.y,vm.z),a+=2)}r.getAttribute("position").needsUpdate=!0,gm.prototype.updateMatrixWorld.call(this,t)},bm);function bm(t){U(this,bm);for(var e=function t(e){var r=[];e&&e.isBone&&r.push(e);for(var n=0;n<e.children.length;n++)r.push.apply(r,t(e.children[n]));return r}(t),r=new Di,n=[],i=[],a=new ai(0,0,1),o=new ai(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}r.setAttribute("position",new _i(n,3)),r.setAttribute("color",new _i(i,3));var u=new ql({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),u=z(this,gm.call(this,r,u));return u.type="SkeletonHelper",u.isSkeletonHelper=!0,u.root=t,u.bones=e,u.matrix=t.matrixWorld,u.matrixAutoUpdate=!1,u}var _m;a(Am,_m=Ki),Am.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Am.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};function Am(t,e,r){U(this,Am);var n=new Fc(e,4,2),e=new li({wireframe:!0,fog:!1,toneMapped:!1}),e=z(this,_m.call(this,n,e));return e.light=t,e.light.updateMatrixWorld(),e.color=r,e.type="PointLightHelper",e.matrix=e.light.matrixWorld,e.matrixAutoUpdate=!1,e.update(),e}var wm,Mm=new Tr,Cm=new ai,Tm=new ai;a(Sm,wm=Dn),Sm.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Sm.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Cm.copy(this.light.color),Tm.copy(this.light.groundColor);for(var r=0,n=e.count;r<n;r++){var i=r<n/2?Cm:Tm;e.setXYZ(r,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Mm.setFromMatrixPosition(this.light.matrixWorld).negate())};function Sm(t,e,r){U(this,Sm);var n=z(this,wm.call(this));n.light=t,n.light.updateMatrixWorld(),n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n.color=r;r=new Cc(e);r.rotateY(.5*Math.PI),n.material=new li({wireframe:!0,fog:!1,toneMapped:!1}),void 0===n.color&&(n.material.vertexColors=!0);e=r.getAttribute("position"),e=new Float32Array(3*e.count);return r.setAttribute("color",new di(e,3)),n.add(new Ki(r,n.material)),n.update(),n}var Em,zc=(a(Im,Em=nu),Im);function Im(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4473924,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8947848;U(this,Im);for(var r=new ai(r),n=new ai(n),i=e/2,a=t/e,o=t/2,s=[],l=[],u=0,c=0,h=-o;u<=e;u++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=u===i?r:n;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var p=new Di;p.setAttribute("position",new _i(s,3)),p.setAttribute("color",new _i(l,3));t=new ql({vertexColors:!0,toneMapped:!1}),t=z(this,Em.call(this,p,t));return t.type="GridHelper",t}var Lm;a(Rm,Lm=nu);function Rm(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:64,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4473924,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:8947848;U(this,Rm);for(var i=new ai(i),a=new ai(a),o=[],s=[],l=0;l<=e;l++){var u=l/e*(2*Math.PI),c=Math.sin(u)*t,u=Math.cos(u)*t;o.push(0,0,0),o.push(c,0,u);u=1&l?i:a;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(var h=0;h<=r;h++)for(var d=1&h?i:a,p=t-t/r*h,f=0;f<n;f++){var m=f/n*(2*Math.PI),g=Math.sin(m)*p,v=Math.cos(m)*p;o.push(g,0,v),s.push(d.r,d.g,d.b),m=(f+1)/n*(2*Math.PI),g=Math.sin(m)*p,v=Math.cos(m)*p,o.push(g,0,v),s.push(d.r,d.g,d.b)}var y=new Di;y.setAttribute("position",new _i(o,3)),y.setAttribute("color",new _i(s,3));var x=new ql({vertexColors:!0,toneMapped:!1}),x=z(this,Lm.call(this,y,x));return x.type="PolarGridHelper",x}var Pm,Dm=new Tr,Om=new Tr,Fm=new Tr;a(Bm,Pm=Dn),Bm.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Bm.prototype.update=function(){Dm.setFromMatrixPosition(this.light.matrixWorld),Om.setFromMatrixPosition(this.light.target.matrixWorld),Fm.subVectors(Om,Dm),this.lightPlane.lookAt(Om),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Om),this.targetLine.scale.z=Fm.length()};function Bm(t,e,r){U(this,Bm);var n=z(this,Pm.call(this));n.light=t,n.light.updateMatrixWorld(),n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n.color=r,void 0===e&&(e=1);r=new Di;r.setAttribute("position",new _i([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));e=new ql({fog:!1,toneMapped:!1});return n.lightPlane=new tu(r,e),n.add(n.lightPlane),(r=new Di).setAttribute("position",new _i([0,0,0,0,0,1],3)),n.targetLine=new tu(r,e),n.add(n.targetLine),n.update(),n}var Nm,zm=new Tr,Um=new la;a(km,Nm=nu),km.prototype.update=function(){var t=this.geometry,e=this.pointMap;Um.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Hm("c",e,t,Um,0,0,-1),Hm("t",e,t,Um,0,0,1),Hm("n1",e,t,Um,-1,-1,-1),Hm("n2",e,t,Um,1,-1,-1),Hm("n3",e,t,Um,-1,1,-1),Hm("n4",e,t,Um,1,1,-1),Hm("f1",e,t,Um,-1,-1,1),Hm("f2",e,t,Um,1,-1,1),Hm("f3",e,t,Um,-1,1,1),Hm("f4",e,t,Um,1,1,1),Hm("u1",e,t,Um,.7,1.1,-1),Hm("u2",e,t,Um,-.7,1.1,-1),Hm("u3",e,t,Um,0,2,-1),Hm("cf1",e,t,Um,-1,0,1),Hm("cf2",e,t,Um,1,0,1),Hm("cf3",e,t,Um,0,-1,1),Hm("cf4",e,t,Um,0,1,1),Hm("cn1",e,t,Um,-1,0,-1),Hm("cn2",e,t,Um,1,0,-1),Hm("cn3",e,t,Um,0,-1,-1),Hm("cn4",e,t,Um,0,1,-1),t.getAttribute("position").needsUpdate=!0};function km(t){U(this,km);var e=new Di,r=new ql({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],a={},o=new ai(16755200),s=new ai(16711680),l=new ai(43775),u=new ai(16777215),c=new ai(3355443);function h(t,e,r){d(t,r),d(e,r)}function d(t,e){n.push(0,0,0),i.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.setAttribute("position",new _i(n,3)),e.setAttribute("color",new _i(i,3));r=z(this,Nm.call(this,e,r));return r.type="CameraHelper",r.camera=t,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=t.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=a,r.update(),r}function Hm(t,e,r,n,i,a,o){zm.set(i,a,o).unproject(n);var s=e[t];if(void 0!==s)for(var l=r.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],zm.x,zm.y,zm.z)}var Gm,Vm=new Lr;a(Wm,Gm=nu),Wm.prototype.update=function(t){var e,r,n;void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Vm.setFromObject(this.object),Vm.isEmpty()||(e=Vm.min,r=Vm.max,(t=(n=this.geometry.attributes.position).array)[0]=r.x,t[1]=r.y,t[2]=r.z,t[3]=e.x,t[4]=r.y,t[5]=r.z,t[6]=e.x,t[7]=e.y,t[8]=r.z,t[9]=r.x,t[10]=e.y,t[11]=r.z,t[12]=r.x,t[13]=r.y,t[14]=e.z,t[15]=e.x,t[16]=r.y,t[17]=e.z,t[18]=e.x,t[19]=e.y,t[20]=e.z,t[21]=r.x,t[22]=e.y,t[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere())},Wm.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Wm.prototype.copy=function(t){return nu.prototype.copy.call(this,t),this.object=t.object,this};function Wm(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16776960;U(this,Wm);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new Di;i.setIndex(new di(r,1)),i.setAttribute("position",new di(n,3));e=z(this,Gm.call(this,i,new ql({color:e,toneMapped:!1})));return e.object=t,e.type="BoxHelper",e.matrixAutoUpdate=!1,e.update(),e}var jm;a(Xm,jm=nu),Xm.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),jm.prototype.updateMatrixWorld.call(this,t))};function Xm(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16776960;U(this,Xm);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Di;n.setIndex(new di(r,1)),n.setAttribute("position",new _i([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));e=z(this,jm.call(this,n,new ql({color:e,toneMapped:!1})));return e.box=t,e.type="Box3Helper",e.geometry.computeBoundingSphere(),e}var qm;a(Ym,qm=tu),Ym.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?j:g,this.lookAt(this.plane.normal),qm.prototype.updateMatrixWorld.call(this,t)};function Ym(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16776960;U(this,Ym);var n=r,r=new Di;r.setAttribute("position",new _i([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere();r=z(this,qm.call(this,r,new ql({color:n,toneMapped:!1})));r.type="PlaneHelper",r.plane=t,r.size=e;e=new Di;return e.setAttribute("position",new _i([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),r.add(new Ki(e,new li({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}var Zm,Jm=new Tr,Km=void 0,Qm=void 0;a($m,Zm=Dn),$m.prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(Jm.set(t.z,0,-t.x).normalize(),t=Math.acos(t.y),this.quaternion.setFromAxisAngle(Jm,t))},$m.prototype.setLength=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2*t,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.2*e;this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},$m.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},$m.prototype.copy=function(t){return Zm.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this};function $m(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Tr(0,0,1),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Tr(0,0,0),r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:16776960,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:.2*r,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:.2*i;U(this,$m);var o=z(this,Zm.call(this));return o.type="ArrowHelper",void 0===Km&&((Km=new Di).setAttribute("position",new _i([0,0,0,0,1,0],3)),(Qm=new Lu(0,.5,1,5,1)).translate(0,-.5,0)),o.position.copy(e),o.line=new tu(Km,new ql({color:n,toneMapped:!1})),o.line.matrixAutoUpdate=!1,o.add(o.line),o.cone=new Ki(Qm,new li({color:n,toneMapped:!1})),o.cone.matrixAutoUpdate=!1,o.add(o.cone),o.setDirection(t),o.setLength(r,i,a),o}var tg,eg=(a(rg,tg=nu),rg);function rg(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;U(this,rg);var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],t=new Di;t.setAttribute("position",new _i(e,3)),t.setAttribute("color",new _i([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));e=new ql({vertexColors:!0,toneMapped:!1}),e=z(this,tg.call(this,t,e));return e.type="AxesHelper",e}var ng=new Float32Array(1),ig=new Int32Array(ng.buffer),ag={toHalfFloat:function(t){ng[0]=t;var e=ig[0],r=e>>16&32768,n=e>>12&2047,t=e>>23&255;return t<103?r:142<t?(r|=31744,r|=(255==t?0:1)&&8388607&e):t<113?r|=((n|=2048)>>114-t)+(n>>113-t&1):(r|=t-112<<10|n>>1,r+=1&n)}},og=Math.pow(2,8),sg=[.125,.215,.35,.446,.526,.582],lg=5+sg.length,ug=20,cg=((n={})[ze]=0,n[Ue]=1,n[He]=2,n[Ve]=3,n[We]=4,n[je]=5,n[ke]=6,n),hg=new li({side:j,depthWrite:!1,depthTest:!1}),dg=new Ki(new ta,hg),pg=new Mp,r=function(){for(var t=[],e=[],r=[],n=8,i=0;i<lg;i++){var a=Math.pow(2,n);e.push(a);var o=1/a;4<i?o=sg[i-8+4-1]:0==i&&(o=0),r.push(o);for(var o=1/(a-1),a=-o/2,o=1+o/2,s=[a,a,o,a,o,o,a,a,o,o,a,o],l=new Float32Array(108),u=new Float32Array(72),c=new Float32Array(36),h=0;h<6;h++){var d=h%3*2/3-1,p=2<h?0:-1,p=[d,p,0,d+2/3,p,0,d+2/3,1+p,0,d,p,0,d+2/3,1+p,0,d,1+p,0];l.set(p,18*h),u.set(s,12*h);p=[h,h,h,h,h,h];c.set(p,6*h)}o=new Di;o.setAttribute("position",new di(l,3)),o.setAttribute("uv",new di(u,2)),o.setAttribute("faceIndex",new di(c,1)),t.push(o),4<n&&n--}return{_lodPlanes:t,_sizeLods:e,_sigmas:r}}(),fg=r._lodPlanes,mg=r._sizeLods,gg=r._sigmas,vg=new ai,yg=null,n=(1+Math.sqrt(5))/2,r=1/n,xg=[new Tr(1,1,1),new Tr(-1,1,1),new Tr(1,1,-1),new Tr(-1,1,-1),new Tr(0,n,r),new Tr(0,n,-r),new Tr(r,0,n),new Tr(-r,0,n),new Tr(n,r,0),new Tr(-n,r,0)];function bg(t){var e=Math.max(t.r,t.g,t.b),e=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);return t.multiplyScalar(Math.pow(2,-e)),(e+128)/255}_g.prototype.fromScene=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100;yg=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(t,r,n,i),0<e&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},_g.prototype.fromEquirectangular=function(t){return this._fromTexture(t)},_g.prototype.fromCubemap=function(t){return this._fromTexture(t)},_g.prototype.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=Cg(),this._compileMaterial(this._cubemapShader))},_g.prototype.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=Mg(),this._compileMaterial(this._equirectShader))},_g.prototype.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<fg.length;t++)fg[t].dispose()},_g.prototype._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(yg),t.scissorTest=!1,wg(t,0,0,t.width,t.height)},_g.prototype._fromTexture=function(t){yg=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},_g.prototype._allocateTargets=function(t){var e={magFilter:Mt,minFilter:Mt,generateMipmaps:!1,type:Rt,format:y,encoding:void 0===(r=t)||r.type!==Rt||r.encoding!==ze&&r.encoding!==Ue&&r.encoding!==ke?He:t.encoding,depthBuffer:!1},r=Ag(e);return r.depthBuffer=!t,this._pingPongRenderTarget=Ag(e),r},_g.prototype._compileMaterial=function(t){t=new Ki(fg[0],t);this._renderer.compile(t,pg)},_g.prototype._sceneToCubeUV=function(t,e,r,n){var i=new ua(90,1,e,r),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,u=s.outputEncoding,e=s.toneMapping;s.getClearColor(vg),s.toneMapping=Tt,s.outputEncoding=ze;var c,h=s.autoClear=!1,r=t.background;r?r.isColor&&(hg.color.copy(r).convertSRGBToLinear(),t.background=null,c=bg(hg.color),hg.opacity=c,h=!0):(hg.color.copy(vg).convertSRGBToLinear(),c=bg(hg.color),hg.opacity=c,h=!0);for(var d=0;d<6;d++){var p=d%3;0==p?(i.up.set(0,a[d],0),i.lookAt(o[d],0,0)):1==p?(i.up.set(0,0,a[d]),i.lookAt(0,o[d],0)):(i.up.set(0,a[d],0),i.lookAt(0,0,o[d])),wg(n,p*og,2<d?og:0,og,og),s.setRenderTarget(n),h&&s.render(dg,i),s.render(t,i)}s.toneMapping=e,s.outputEncoding=u,s.autoClear=l},_g.prototype._textureToCubeUV=function(t,e){var r=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Cg()):null==this._equirectShader&&(this._equirectShader=Mg());var n=t.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Ki(fg[0],n),n=n.uniforms;(n.envMap.value=t).isCubeTexture||n.texelSize.value.set(1/t.image.width,1/t.image.height),n.inputEncoding.value=cg[t.encoding],n.outputEncoding.value=cg[e.texture.encoding],wg(e,0,0,3*og,2*og),r.setRenderTarget(e),r.render(i,pg)},_g.prototype._applyPMREM=function(t){var e=this._renderer,r=e.autoClear;e.autoClear=!1;for(var n=1;n<lg;n++){var i=Math.sqrt(gg[n]*gg[n]-gg[n-1]*gg[n-1]),a=xg[(n-1)%xg.length];this._blur(t,n-1,n,i,a)}e.autoClear=r},_g.prototype._blur=function(t,e,r,n,i){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,r,n,"latitudinal",i),this._halfBlur(a,t,r,r,n,"longitudinal",i)},_g.prototype._halfBlur=function(t,e,r,n,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Ki(fg[n],l),c=l.uniforms,l=mg[r]-1,l=isFinite(i)?Math.PI/(2*l):2*Math.PI/(2*ug-1),h=i/l,d=isFinite(i)?1+Math.floor(3*h):ug;ug<d&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+d+" samples when the maximum is set to "+ug);for(var p=[],f=0,m=0;m<ug;++m){var g=m/h,g=Math.exp(-g*g/2);p.push(g),0==m?f+=g:m<d&&(f+=2*g)}for(var v=0;v<p.length;v++)p[v]=p[v]/f;c.envMap.value=t.texture,c.samples.value=d,c.weights.value=p,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=l,c.mipInt.value=8-r,c.inputEncoding.value=cg[t.texture.encoding],c.outputEncoding.value=cg[t.texture.encoding];t=mg[n];wg(e,3*Math.max(0,og-2*t),(0===n?0:2*og)+2*t*(4<n?n-8+4:0),3*t,2*t),s.setRenderTarget(e),s.render(u,pg)};function _g(t){var e,r;U(this,_g),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(e=ug,r=new Float32Array(e),t=new Tr(0,1,0),new eh({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:cg[ze]},outputEncoding:{value:cg[ze]}},vertexShader:Tg(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t"+Sg()+"\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function Ag(t){t=new _r(3*og,3*og,t);return t.texture.mapping=B,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function wg(t,e,r,n,i){t.viewport.set(e,r,n,i),t.scissor.set(e,r,n,i)}function Mg(){var t=new or(1,1);return new eh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:cg[ze]},outputEncoding:{value:cg[ze]}},vertexShader:Tg(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t"+Sg()+"\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function Cg(){return new eh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:cg[ze]},outputEncoding:{value:cg[ze]}},vertexShader:Tg(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t"+Sg()+"\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function Tg(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Sg(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}ud.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(ud.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},qd.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},zc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ic.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Zh.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Xp.extractUrlBase(t)},Zh.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Bu.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},Bu.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Bu.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Bu.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},Lr.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Lr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Lr.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Lr.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Lr.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},qr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ta.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},xc.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ar.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},ar.nearestPowerOfTwo=function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ar.floorPowerOfTwo(t)},ar.nextPowerOfTwo=function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ar.ceilPowerOfTwo(t)},lr.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},lr.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},lr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},lr.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},lr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},lr.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},an.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},an.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},an.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Tr).setFromMatrixColumn(this,3)},an.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},an.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},an.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},an.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},an.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},an.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},an.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},an.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},an.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},an.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},an.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},an.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},an.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},an.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},an.prototype.makeFrustum=function(t,e,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,r,i,a)},an.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Nn.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Mr.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Mr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},rn.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},rn.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},rn.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Zn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Zn.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},Zn.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},Zn.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},Zn.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},Zn.barycoordFromPoint=function(t,e,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Zn.getBarycoord(t,e,r,n,i)},Zn.normal=function(t,e,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Zn.getNormal(t,e,r,n)},Jd.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Jd.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new mc(this,t)},Jd.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Pc(this,t)},or.prototype.fromAttribute=function(t,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},or.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},or.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Tr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Tr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Tr.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},Tr.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},Tr.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},Tr.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},Tr.prototype.fromAttribute=function(t,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},Tr.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Tr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},vr.prototype.fromAttribute=function(t,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},vr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Dn.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},Dn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Dn.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},Dn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Dn.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Dn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ki.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ki.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(El.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ul.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Fl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(ud.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),ua.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties($d.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(di.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===$e},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage($e)}}}),di.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?$e:Qe),this},di.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},di.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Di.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},Di.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new di(e,arguments[2])))},Di.prototype.addDrawCall=function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},Di.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Di.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Di.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},Di.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Di.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(qp.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(rm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(rl.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===$e},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),rl.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?$e:Qe),this},rl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},mc.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},mc.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},mc.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},tl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(to.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Qn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ai}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Ac.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ih.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(sa.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),qs.prototype.clearTarget=function(t,e,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,r,n)},qs.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},qs.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},qs.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},qs.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},qs.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},qs.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},qs.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},qs.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},qs.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},qs.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},qs.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},qs.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},qs.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},qs.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},qs.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},qs.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},qs.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},qs.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},qs.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},qs.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},qs.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},qs.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},qs.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},qs.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(qs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?Ue:ze}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Fs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(_r.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(e.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new gf).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Ka.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},pa.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},pa.prototype.clear=function(t,e,r,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,r,n)},dr.crossOrigin=void 0,dr.loadTexture=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new ld;i.setCrossOrigin(this.crossOrigin);n=i.load(t,r,void 0,n);return e&&(n.mapping=e),n},dr.loadTextureCube=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new ad;i.setCrossOrigin(this.crossOrigin);n=i.load(t,r,void 0,n);return e&&(n.mapping=e),n},dr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},dr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"126"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="126")},function(t,e,r){"use strict";function n(t,e,r,n,i,a,o,s){var l,u,c="function"==typeof t?t.options:t;return e&&(c.render=e,c.staticRenderFns=r,c._compiled=!0),n&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):i&&(l=s?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l&&(c.functional?(c._injectStyles=l,u=c.render,c.render=function(t,e){return l.call(e),u(t,e)}):(s=c.beforeCreate,c.beforeCreate=s?[].concat(s,l):[l])),{exports:t,options:c}}r.d(e,"a",function(){return n})},function(t,e,r){!function(mc){!function(t){function e(t){this.options=t||{},this.paneName=this.options.paneName||"labelPane",this.zIndex=this.options.zIndex||1,this._map=t.map,this._lastDrawTime=null,this.show()}function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}function i(e){function t(t){return null==t?t:(1<arguments.length&&(t=Array.prototype.slice.call(arguments)),e(t))}return"conversion"in e&&(t.conversion=e.conversion),t}function a(i){function t(t){if(null==t)return t;1<arguments.length&&(t=Array.prototype.slice.call(arguments));var e=i(t);if("object"===(void 0===e?"undefined":xn(e)))for(var r=e.length,n=0;n<r;n++)e[n]=Math.round(e[n]);return e}return"conversion"in i&&(t.conversion=i.conversion),t}function c(t,e){if(!(this instanceof c))return new c(t,e);if((e=e&&e in gi?null:e)&&!(e in fi))throw Error("Unknown model: "+e);if(void 0===t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof c)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){if(null===(e=hi.get(t)))throw Error("Unable to parse color from string: "+t);this.model=e.model;var r=fi[this.model].channels;this.color=e.value.slice(0,r),this.valpha="number"==typeof e.value[r]?e.value[r]:1}else if(t.length)this.model=e||"rgb",r=fi[this.model].channels,e=mi.call(t,0,r),this.color=l(e,r),this.valpha="number"==typeof t[r]?t[r]:1;else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{if(this.valpha=1,e=ke(t),"alpha"in t&&(e.splice(e.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0),!((e=e.sort().join(""))in vi))throw Error("Unable to parse color from object: "+ri(t));this.model=vi[e];var r=fi[this.model].labels,n=[];for(e=0;e<r.length;e++)n.push(t[r[e]]);this.color=l(n)}if(yi[this.model])for(r=fi[this.model].channels,e=0;e<r;e++)(t=yi[this.model][e])&&(this.color[e]=t(this.color[e]));this.valpha=Math.max(0,Math.min(1,this.valpha)),ti&&ti(this)}function o(r,n,i){return(r=Array.isArray(r)?r:[r]).forEach(function(t){(yi[t]||(yi[t]=[]))[n]=i}),r=r[0],function(t){if(arguments.length){i&&(t=i(t));var e=this[r]();return e.color[n]=t,e}return e=this[r]().color[n],e=i?i(e):e}}function s(e){return function(t){return Math.max(0,Math.min(e,t))}}function l(t,e){for(var r=0;r<e;r++)"number"!=typeof t[r]&&(t[r]=0);return t}function u(t){return t*Math.PI/180}function h(t){return t/Math.PI*180}function m(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function d(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function p(t,e){return Math.abs(t-e)<1e-8}function f(){}function g(t,e){for(var r in e)t[r]=e[r]}function v(t,e){this.lng=t,this.lat=e}function y(t,e){this.x=t,this.y=e}function x(t,e){var r=document.createElement("canvas");return t&&(r.width=t),e&&(r.height=e),r}function b(t){t=t||{},this.gradient=t.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=void 0===t.maxSize?35:t.maxSize,this.minSize=t.minSize||0,this.max=t.max||100,this.min=t.min||0,this.initPalette()}function _(t){this.options=t||{},this._initialize()}function A(t,e,r,n,i){var a=1-t,o=1-t;return a*a*a*e+3*o*o*t*r+3*(1-t)*t*t*n+t*t*t*i}function w(t){this.WORLD_SIZE_MC_HALF=20037726.372307256,this.WORLD_SIZE_MC=2*this.WORLD_SIZE_MC_HALF,this.options=t||{},this._initialize()}function M(t,e){return t&&e?Math.round(Math.sqrt(Math.pow(t.lng-e.lng,2)+Math.pow(t.lat-e.lat,2))):0}function C(t){return(t=t.split("|"))[0]=t[0].split(","),{lng:parseFloat(t[0][0]),lat:parseFloat(t[0][1])}}function T(t){for(var e=t.length;0<=--e;)t[e]=0}function S(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function E(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function I(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.wrap=this.pending=this.pending_out=this.pending_buf_size=0,this.gzhead=null,this.gzindex=0,this.method=Da,this.last_flush=-1,this.w_mask=this.w_bits=this.w_size=0,this.window=null,this.window_size=0,this.head=this.prev=null,this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),$i(this.dyn_ltree),$i(this.dyn_dtree),$i(this.bl_tree),this.bl_desc=this.d_desc=this.l_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),$i(this.heap),this.heap_max=this.heap_len=0,this.depth=new Uint16Array(573),$i(this.depth),this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function R(t){(t=this.options=za.assign({level:Ka,method:$a,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qa},t||{})).raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Va,this.strm.avail_out=0;var e=Na.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Za)throw Error(ma[e]);if(t.header&&Na.deflateSetHeader(this.strm,t.header),t.dictionary){if(t="string"==typeof t.dictionary?Ga.string2buf(t.dictionary):"[object ArrayBuffer]"===Wa.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(e=Na.deflateSetDictionary(this.strm,t))!==Za)throw Error(ma[e]);this._dict_set=!0}}function P(t,e){if((e=new R(e)).push(t,!0),e.err)throw e.msg||ma[e.err];return e.result}function D(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.total=this.check=this.dmax=this.flags=0,this.head=null,this.wnext=this.whave=this.wsize=this.wbits=0,this.window=null,this.extra=this.offset=this.length=this.bits=this.hold=0,this.distcode=this.lencode=null,this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.distdyn=this.lendyn=null,this.was=this.back=this.sane=0}function O(t){var e=this.options=za.assign({chunkSize:65536,windowBits:15,to:""},t||{});if(e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Va,this.strm.avail_out=0,(t=To.inflateInit2(this.strm,e.windowBits))!==Ro)throw Error(ma[t]);if(this.header=new So,To.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Ga.string2buf(e.dictionary):"[object ArrayBuffer]"===Eo.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=To.inflateSetDictionary(this.strm,e.dictionary))!==Ro))throw Error(ma[t])}function F(t,e){if((e=new O(e)).push(t),e.err)throw e.msg||ma[e.err];return e.result}function B(t,e){for(var r=["webgl2","experimental-webgl2","webgl","experimental-webgl"],n=void 0,i=0;i<r.length;i++)try{if(n=t.getContext(r[i],{alpha:!0,premultipliedAlpha:!1,antialias:e.antialias||!0,preserveDrawingBuffer:e.preserveDrawingBuffer||!1}))break}catch(t){}return n}function N(t,e,r){r=Xe({TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"REPEAT",TEXTURE_WRAP_T:"REPEAT"},r);var n,i=t.createTexture();for(n in t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),r)t.texParameteri(t.TEXTURE_2D,t[n],t[r[n]]);return t.bindTexture(t.TEXTURE_2D,null),i}function z(n,t,i,a){var o;"object"===(void 0===t?"undefined":xn(t))?(t=N(n,t,a),i(t,null)):((o=new Image).crossOrigin="anonymous",o.onload=function(){var t=d(o.width),e=d(o.height),r=document.createElement("canvas");r.width=t,r.height=e,r.getContext("2d").drawImage(o,0,0,t,e),t=N(n,o=r,a),i(t,o)},o.src=t)}function U(t,e,r){r=r||2;var n,i=(l=e&&e.length)?e[0]*r:t.length,a=k(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;if(l){for(var s=r,l=[],u=0,c=e.length;u<c;u++){var h=e[u]*s;(h=k(t,h,u<c-1?e[u+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),l.push(function(t){var e=t,r=t;for(;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next,e!==t;);return r}(h))}for(l.sort(V),u=0;u<l.length;u++)(e=function(t,e){var r=e,n=t.x,i=t.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&a<o){if((a=o)===n){if(i===r.y)return r;if(i===r.next.y)return r.next}var s=r.x<r.next.x?r:r.next}}}while(r=r.next,r!==e);if(!s)return null;if(n===a)return s;o=(e=s).x;var l,u=s.y,c=1/0;r=s;do{var h,d}while(n>=r.x&&r.x>=o&&n!==r.x&&j(i<u?n:a,i,o,u,i<u?a:n,i,r.x,r.y)&&(h=Math.abs(i-r.y)/(n-r.x),(l=K(r,t))&&!(l=h<c)&&(l=h===c)&&!(l=r.x>s.x)&&(l=r.x===s.x)&&(d=r,l=X((l=s).prev,l,d.prev)<0&&X(d.next,l,l.next)<0),l&&(s=r,c=h)),r=r.next,r!==e);return s}(s=l[u],e=a))&&(s=Q(e,s),H(e,e.next),H(s,s.next)),a=H(a,a.next)}if(t.length>80*r){for(var d=n=t[0],p=l=t[1],s=r;s<i;s+=r)(u=t[s])<d&&(d=u),(e=t[s+1])<p&&(p=e),n<u&&(n=u),l<e&&(l=e);n=0!==(n=Math.max(n-d,l-p))?1/n:0}return function t(e,r,n,i,a,o,s){if(e){if(!s&&o){for(var l=e,u=l;null===u.z&&(u.z=W(u.x,u.y,i,a,o)),u.prevZ=u.prev,u=u.nextZ=u.next,u!==l;);u.prevZ.nextZ=null,u.prevZ=null,l=u;var c,h,d,p,f=1;do{u=l;var m=l=null;for(h=0;u;){h++;var g=u;for(c=d=0;c<f&&(d++,g=g.nextZ);c++);for(p=f;0<d||0<p&&g;)0!==d&&(0===p||!g||u.z<=g.z)?(u=(c=u).nextZ,d--):(g=(c=g).nextZ,p--),m?m.nextZ=c:l=c,c.prevZ=m,m=c;u=g}}while(m.nextZ=null,f*=2,1<h)}for(l=e;e.prev!==e.next;){if(u=e.prev,g=e.next,o)m=G(e,i,a,o);else t:if(m=e,h=m.prev,d=m,f=m.next,0<=X(h,d,f))m=!1;else{for(c=m.next.next;c!==m.prev;){if(j(h.x,h.y,d.x,d.y,f.x,f.y,c.x,c.y)&&0<=X(c.prev,c,c.next)){m=!1;break t}c=c.next}m=!0}if(m)r.push(u.i/n),r.push(e.i/n),r.push(g.i/n),tt(e),l=e=g.next;else if((e=g)===l){if(s){if(1===s){for(e=H(e),s=r,l=n,u=e;g=u.prev,m=u.next.next,!q(g,m)&&Y(g,u,u.next,m)&&K(g,m)&&K(m,g)&&(s.push(g.i/l),s.push(u.i/l),s.push(m.i/l),tt(u),tt(u.next),u=e=m),u=u.next,u!==e;);e=H(u),t(e,r,n,i,a,o,2)}else if(2===s)t:{s=e;do{for(l=s.next.next;l!==s.prev;){if(u=s.i!==l.i){if(g=l,m=(u=s).next.i!==g.i&&u.prev.i!==g.i){e:{m=u;do{if(m.i!==u.i&&m.next.i!==u.i&&m.i!==g.i&&m.next.i!==g.i&&Y(m,m.next,u,g)){m=!0;break e}}while((m=m.next)!==u);m=!1}m=!m}if(m){if(m=K(u,g)&&K(g,u)){for(m=u,h=!1,d=(u.x+g.x)/2,f=(u.y+g.y)/2;m.y>f!=m.next.y>f&&m.next.y!==m.y&&d<(m.next.x-m.x)*(f-m.y)/(m.next.y-m.y)+m.x&&(h=!h),m=m.next,m!==u;);m=h}m=m&&(X(u.prev,u,g.prev)||X(u,g.prev,g))||q(u,g)&&0<X(u.prev,u,u.next)&&0<X(g.prev,g,g.next)}u=m}if(u){e=Q(s,l),s=H(s,s.next),e=H(e,e.next),t(s,r,n,i,a,o),t(e,r,n,i,a,o);break t}l=l.next}}while((s=s.next)!==e)}}else t(H(e),r,n,i,a,o,1);break}}}}(a,o,r,d,p,n),o}function k(t,e,r,n,i){if(i===0<rt(t,e,r,n))for(i=e;i<r;i+=n)var a=$(i,t[i],t[i+1],a);else for(i=r-n;e<=i;i-=n)a=$(i,t[i],t[i+1],a);return a&&q(a,a.next)&&(tt(a),a=a.next),a}function H(t,e){if(!t)return t;e=e||t;do{var r=!1;if(t.steiner||!q(t,t.next)&&0!==X(t.prev,t,t.next))t=t.next;else{if(tt(t),(t=e=t.prev)===t.next)break;r=!0}}while(r||t!==e);return e}function G(t,e,r,n){var i=t.prev,a=t.next;if(0<=X(i,t,a))return!1;var o=(i.x>t.x?i.x>a.x?i:a:t.x>a.x?t:a).x,s=(i.y>t.y?i.y>a.y?i:a:t.y>a.y?t:a).y,l=W((i.x<t.x?i.x<a.x?i:a:t.x<a.x?t:a).x,(i.y<t.y?i.y<a.y?i:a:t.y<a.y?t:a).y,e,r,n);for(e=W(o,s,e,r,n),r=t.prevZ,n=t.nextZ;r&&r.z>=l&&n&&n.z<=e;){if(r!==t.prev&&r!==t.next&&j(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=X(r.prev,r,r.next))return!1;if(r=r.prevZ,n!==t.prev&&n!==t.next&&j(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=X(n.prev,n,n.next))return!1;n=n.nextZ}for(;r&&r.z>=l;){if(r!==t.prev&&r!==t.next&&j(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=X(r.prev,r,r.next))return!1;r=r.prevZ}for(;n&&n.z<=e;){if(n!==t.prev&&n!==t.next&&j(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=X(n.prev,n,n.next))return!1;n=n.nextZ}return!0}function V(t,e){return t.x-e.x}function W(t,e,r,n,i){return 1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1)|(1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function j(t,e,r,n,i,a,o,s){return 0<=(i-o)*(e-s)-(t-o)*(a-s)&&0<=(t-o)*(n-s)-(r-o)*(e-s)&&0<=(r-o)*(a-s)-(i-o)*(n-s)}function X(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function q(t,e){return t.x===e.x&&t.y===e.y}function Y(t,e,r,n){var i=J(X(t,e,r)),a=J(X(t,e,n)),o=J(X(r,n,t)),s=J(X(r,n,e));return!!(i!==a&&o!==s||0===i&&Z(t,r,e)||0===a&&Z(t,n,e)||0===o&&Z(r,t,n)||0===s&&Z(r,e,n))}function Z(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function J(t){return 0<t?1:t<0?-1:0}function K(t,e){return X(t.prev,t,t.next)<0?0<=X(t,e,t.next)&&0<=X(t,t.prev,e):X(t,e,t.prev)<0||X(t,t.next,e)<0}function Q(t,e){var r=new et(t.i,t.x,t.y),n=new et(e.i,e.x,e.y),i=t.next,a=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(a.next=n).prev=a,n}function $(t,e,r,n){return t=new et(t,e,r),n?(t.next=n.next,(t.prev=n).next.prev=t,n.next=t):(t.prev=t).next=t,t}function tt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function et(t,e,r){this.i=t,this.x=e,this.y=r,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function rt(t,e,r,n){for(var i=0,a=r-n;e<r;e+=n)i+=(t[a]-t[e])*(t[e+1]+t[a+1]),a=e;return i}function nt(e){try{return Us.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(t){var r=new zs;return r.append(e),Us.createObjectURL(r.getBlob(type))}}function it(t,e){this.shapeLayer=t,this.gl=e,this.initData()}function at(t,e,r,n){var i=[];return n=n*Math.PI/180,i[0]=(t-r[0])*Math.cos(n)-(e-r[1])*Math.sin(n)+r[0],i[1]=(t-r[0])*Math.sin(n)+(e-r[1])*Math.cos(n)+r[1],i}function ot(t){var e=0,r=0,n=!0,i=!1,a=void 0;try{for(var o,s=kn(t);!(n=(o=s.next()).done);n=!0){var l=o.value;e+=l.w*l.h,r=Math.max(r,l.w)}}catch(t){i=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}t.sort(function(t,e){return e.h-t.h}),r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=!(a=!(i=n=0)),o=void 0;try{for(var u,c=kn(t);!(a=(u=c.next()).done);a=!0)for(var h=u.value,d=r.length-1;0<=d;d--){var p,f=r[d];if(!(h.w>f.w||h.h>f.h)){h.x=f.x,h.y=f.y,i=Math.max(i,h.y+h.h),n=Math.max(n,h.x+h.w),h.w===f.w&&h.h===f.h?(p=r.pop(),d<r.length&&(r[d]=p)):h.h===f.h?(f.x+=h.w,f.w-=h.w):(h.w!==f.w&&r.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}catch(t){s=!0,o=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw o}}return{w:n,h:i,fill:e/(n*i)||0}}function st(){al=!0;for(var t=0;t<64;++t)rl[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],nl["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;nl[45]=62,nl[95]=63}function lt(t){al||st();for(var e=t.length,r=e%3,n="",i=[],a=0,o=e-r;a<o;a+=16383)i.push(function(t,e,r){for(var n=[],i=e;i<r;i+=3)e=(t[i]<<16)+(t[i+1]<<8)+t[i+2],n.push(rl[e>>18&63]+rl[e>>12&63]+rl[e>>6&63]+rl[63&e]);return n.join("")}(t,a,o<a+16383?o:a+16383));return 1==r?(t=t[e-1],n+=rl[t>>2],n+=rl[t<<4&63],n+="=="):2==r&&(t=(t[e-2]<<8)+t[e-1],n+=rl[t>>10],n+=rl[t>>4&63],n+=rl[t<<2&63],n+="="),i.push(n),i.join("")}function ut(t,e,r,n,i){var a=8*i-n-1,o=(1<<a)-1,s=o>>1,l=-7,u=r?-1:1,c=t[e+(i=r?i-1:0)];for(i+=u,r=c&(1<<-l)-1,c>>=-l,l+=a;0<l;r=256*r+t[e+i],i+=u,l-=8);for(a=r&(1<<-l)-1,r>>=-l,l+=n;0<l;a=256*a+t[e+i],i+=u,l-=8);if(0===r)r=1-s;else{if(r===o)return a?NaN:1/0*(c?-1:1);a+=Math.pow(2,n),r-=s}return(c?-1:1)*a*Math.pow(2,r-n)}function ct(t,e,r,n,i,a){var o,s=8*a-i-1,l=(1<<s)-1,u=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;a=n?0:a-1;var h=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(e=isNaN(e)?1:0,n=l):(n=Math.floor(Math.log(e)/Math.LN2),e*(o=Math.pow(2,-n))<1&&(n--,o*=2),2<=(e=1<=n+u?e+c/o:e+c*Math.pow(2,1-u))*o&&(n++,o/=2),l<=n+u?(e=0,n=l):1<=n+u?(e=(e*o-1)*Math.pow(2,i),n+=u):(e=e*Math.pow(2,u-1)*Math.pow(2,i),n=0));8<=i;t[r+a]=255&e,a+=h,e/=256,i-=8);for(n=n<<i|e,s+=i;0<s;t[r+a]=255&n,a+=h,n/=256,s-=8);t[r+a-h]|=128*d}function ht(t,e){if((dt.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<e)throw new RangeError("Invalid typed array length");return dt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=dt.prototype:(t=null===t?new dt(e):t).length=e,t}function dt(t,e,r){if(!(dt.TYPED_ARRAY_SUPPORT||this instanceof dt))return new dt(t,e,r);if("number"!=typeof t)return pt(this,t,e,r);if("string"==typeof e)throw Error("If encoding is specified then the first argument must be a string");return mt(this,t)}function pt(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),dt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=dt.prototype:t=gt(t,e),t}if("string"!=typeof e)return function(t,e){if(yt(e)){var r=0|vt(e.length);return 0===(t=ht(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return(r=!(r="number"!=typeof e.length)?(r=e.length)!=r:r)?ht(t,0):gt(t,e);if("Buffer"===e.type&&sl(e.data))return gt(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e);if(n=t,!dt.isEncoding(t="string"!=typeof(t=r)||""===t?"utf8":t))throw new TypeError('"encoding" must be a valid string encoding');return n=(e=(n=ht(n,r=0|xt(e,t))).write(e,t))!==r?n.slice(0,e):n}function ft(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function mt(t,e){if(ft(e),t=ht(t,e<0?0:0|vt(e)),!dt.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function gt(t,e){var r=e.length<0?0:0|vt(e.length);t=ht(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function vt(t){if((dt.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(dt.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return 0|t}function yt(t){return null!=t&&t._isBuffer}function xt(t,e){if(yt(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var r=(t="string"!=typeof t?""+t:t).length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Rt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Dt(t).length;default:if(n)return Rt(t).length;e=(""+e).toLowerCase(),n=!0}}function bt(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function _t(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,(r=(r=isNaN(r)?i?0:t.length-1:r)<0?t.length+r:r)>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if(yt(e="string"==typeof e?dt.from(e,n):e))return 0===e.length?-1:At(t,e,r,n,i);if("number"==typeof e)return e&=255,dt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,r):At(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function At(t,e,r,n,i){function a(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s/=o=2,l/=2,r/=2}if(i)for(n=-1;r<s;r++)if(a(t,r)===a(e,-1===n?0:r-n)){if(r-(n=-1===n?r:n)+1===l)return n*o}else-1!==n&&(r-=r-n),n=-1;else for(s<r+l&&(r=s-l);0<=r;r--){for(s=!0,n=0;n<l;n++)if(a(t,r+n)!==a(e,n)){s=!1;break}if(s)return r}return-1}function wt(t,e,r){r=Math.min(t.length,r);for(var n=[];e<r;){var i=t[e],a=null,o=239<i?4:223<i?3:191<i?2:1;if(e+o<=r)switch(o){case 1:i<128&&(a=i);break;case 2:var s=t[e+1];128==(192&s)&&(127<(i=(31&i)<<6|63&s)&&(a=i));break;case 3:var s=t[e+1],l=t[e+2];128==(192&s)&&128==(192&l)&&(2047<(i=(15&i)<<12|(63&s)<<6|63&l)&&(i<55296||57343<i)&&(a=i));break;case 4:s=t[e+1];var l=t[e+2],u=t[e+3];128==(192&s)&&128==(192&l)&&128==(192&u)&&(65535<(i=(15&i)<<18|(63&s)<<12|(63&l)<<6|63&u)&&i<1114112&&(a=i))}null===a?(a=65533,o=1):65535<a&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),e+=o}if((t=n.length)<=ll)n=String.fromCharCode.apply(String,n);else{for(r="",e=0;e<t;)r+=String.fromCharCode.apply(String,n.slice(e,e+=ll));n=r}return n}function Mt(t,e,r){if(0!=t%1||t<0)throw new RangeError("offset is not uint");if(r<t+e)throw new RangeError("Trying to access beyond buffer length")}function Ct(t,e,r,n,i,a){if(!yt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<a)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Tt(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-r,2);i<a;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function St(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-r,4);i<a;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Et(t,e,r,n){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function It(t,e,r,n,i){return i||Et(t,0,r,4),ct(t,e,r,n,23,4),r+4}function Lt(t,e,r,n,i){return i||Et(t,0,r,8),ct(t,e,r,n,52,8),r+8}function Rt(t,e){e=e||1/0;for(var r,n=t.length,i=null,a=[],o=0;o<n;++o){if(55295<(r=t.charCodeAt(o))&&r<57344){if(!i){if(56319<r){-1<(e-=3)&&a.push(239,191,189);continue}if(o+1===n){-1<(e-=3)&&a.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(e-=3)&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(e-=3)&&a.push(239,191,189);if(i=null,r<128){if(--e<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function Pt(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function Dt(t){if((t=(t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(pl,"")).length<2)t="";else for(;0!=t.length%4;)t+="=";if(al||st(),0<(a=t.length)%4)throw Error("Invalid string. Length must be a multiple of 4");for(var e="="===t[a-2]?2:"="===t[a-1]?1:0,r=new il(3*a/4-e),n=0<e?a-4:a,i=0,a=0;a<n;a+=4){var o=nl[t.charCodeAt(a)]<<18|nl[t.charCodeAt(a+1)]<<12|nl[t.charCodeAt(a+2)]<<6|nl[t.charCodeAt(a+3)];r[i++]=o>>16&255,r[i++]=o>>8&255,r[i++]=255&o}return 2==e?(o=nl[t.charCodeAt(a)]<<2|nl[t.charCodeAt(a+1)]>>4,r[i++]=255&o):1==e&&(o=nl[t.charCodeAt(a)]<<10|nl[t.charCodeAt(a+1)]<<4|nl[t.charCodeAt(a+2)]>>2,r[i++]=o>>8&255,r[i++]=255&o),r}function Ot(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Ft(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function Bt(t,e){var r=[];return t.forEach(function(t){r.push(e?-t:t,t)}),r}function Nt(t,e){for(var r=1<arguments.length&&void 0!==e?e:0,n=[],i=0;i<t-1;i++){var a=2*(i+r);n.push(a,1+a,2+a),n.push(2+a,1+a,3+a)}return n}function zt(n){return function(t,e,r){return t=e+n,r[0<(e=r.length-1)?t<0?0:e<t?e:t:t<e?e:0<t?0:t]}}function Ut(t){if(!t[0]||!t[0].length)return t;for(var e=t[0].length,r=[],n=0,i=0;i<t.length;i++)for(var a=0;a<e;a++)r[n++]=t[i][a];return r}function kt(t){for(var e=0<arguments.length&&void 0!==t?t:[],r=[],n=0,i=0;i<e.length;i++){var a,o=e[i];0<i&&(a=e[i-1],n+=Math.sqrt(Math.pow(o[0]-a[0],2)+Math.pow(o[1]-a[1],2))),r.push(n)}return{arr:r,total:n}}function Ht(){var t=document.createElement("canvas");t.width=t.height=32;var e=t.getContext("2d");return{canvas:t,ctx:e}}function Gt(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).color,e=Ht(),r=e.canvas;return(e=e.ctx).save(),e.moveTo(0,0),e.lineTo(20,0),e.lineTo(32,16),e.lineTo(20,32),e.lineTo(0,32),e.lineTo(10,16),e.fillStyle=t||"#fff",e.fill(),e.restore(),r}function Vt(t,e){return $o.set(t,-e[1],e[0])}function Wt(t,e,r){return $o.sub(t,e,r),$o.normalize(t,t),t}function jt(t){var r,n;this.promise=new t(function(t,e){if(void 0!==r||void 0!==n)throw TypeError("Bad Promise constructor");r=t,n=e}),this.resolve=ie(r),this.reject=ie(n)}function Xt(t){return function(t,e,r,n){switch(n){case 5122:return new Int16Array(t,e,r);case 5123:return new Uint16Array(t,e,r);case 5124:return new Int32Array(t,e,r);case 5125:return new Uint32Array(t,e,r);case 5126:return new Float32Array(t,e,r);default:return null}}(t.bufferView.data,t.byteOffset,t.count*sc[t.type],t.componentType)}function qt(t){function a(t,e){c.uniform1i(t,e.index),c.activeTexture(c.TEXTURE0+e.index),t=A.glTF.textures[e.index],c.bindTexture(c.TEXTURE_2D,t.texture),c.bindSampler(e.index,t.sampler?t.sampler.sampler:r)}var c=t.gl,h=0,d=[];t=c.canvas;function p(t,e,r){for(this.glTFScene=t,this.glTF=e,this.id=r,this.rootTransform=rs.create(),this.nodeMatrix=Array(e.nodes.length),t=0,e=this.nodeMatrix.length;t<e;t++)this.nodeMatrix[t]=rs.create()}var r=c.createSampler();c.samplerParameteri(r,c.TEXTURE_MIN_FILTER,c.NEAREST_MIPMAP_LINEAR),c.samplerParameteri(r,c.TEXTURE_MAG_FILTER,c.LINEAR),c.samplerParameteri(r,c.TEXTURE_WRAP_S,c.REPEAT),c.samplerParameteri(r,c.TEXTURE_WRAP_T,c.REPEAT),c.bindVertexArray(null),c.bindVertexArray(null);function f(){this.flags=0,this.programObject=null}var n={HAS_SKIN:1,SKIN_VEC8:2,HAS_BASECOLORMAP:4,HAS_NORMALMAP:8,HAS_METALROUGHNESSMAP:16,HAS_OCCLUSIONMAP:32,HAS_EMISSIVEMAP:64},i={};f.prototype.hasSkin=function(){return this.flags&n.HAS_SKIN},f.prototype.hasBaseColorMap=function(){return this.flags&n.HAS_BASECOLORMAP},f.prototype.hasNormalMap=function(){return this.flags&n.HAS_NORMALMAP},f.prototype.hasMetalRoughnessMap=function(){return this.flags&n.HAS_METALROUGHNESSMAP},f.prototype.hasOcclusionMap=function(){return this.flags&n.HAS_OCCLUSIONMAP},f.prototype.hasEmissiveMap=function(){return this.flags&n.HAS_EMISSIVEMAP},f.prototype.defineMacro=function(t){void 0!==n[t]&&(this.flags|=n[t])},f.prototype.compile=function(){var t,e=i[this.flags];e?this.programObject=e:(t=e="",this.flags&n.HAS_SKIN&&(e+="#define HAS_SKIN\n"),this.flags&n.SKIN_VEC8&&(e+="#define SKIN_VEC8\n"),this.flags&n.HAS_BASECOLORMAP&&(t+="#define HAS_BASECOLORMAP\n"),this.flags&n.HAS_NORMALMAP&&(t+="#define HAS_NORMALMAP\n"),this.flags&n.HAS_METALROUGHNESSMAP&&(t+="#define HAS_METALROUGHNESSMAP\n"),this.flags&n.HAS_OCCLUSIONMAP&&(t+="#define HAS_OCCLUSIONMAP\n"),this.flags&n.HAS_EMISSIVEMAP&&(t+="#define HAS_EMISSIVEMAP\n"),e=uc.createProgram(c,"#version 300 es\n"+e+"#define POSITION_LOCATION 0\n#define NORMAL_LOCATION 1\n#define TEXCOORD_0_LOCATION 2\n#define JOINTS_0_LOCATION 3\n#define JOINTS_1_LOCATION 5\n#define WEIGHTS_0_LOCATION 4\n#define WEIGHTS_1_LOCATION 6\n#define TANGENT_LOCATION 7\nprecision highp float;precision highp int;uniform mat4 u_MVP;uniform mat4 u_MV;uniform mat4 u_MVNormal;\n#ifdef HAS_SKIN\nuniform JointMatrix{mat4 matrix[65];}u_jointMatrix;\n#endif\nlayout(location=POSITION_LOCATION)in vec3 position;layout(location=NORMAL_LOCATION)in vec3 normal;layout(location=TEXCOORD_0_LOCATION)in vec2 uv;\n#ifdef HAS_SKIN\nlayout(location=JOINTS_0_LOCATION)in vec4 joint0;layout(location=WEIGHTS_0_LOCATION)in vec4 weight0;\n#ifdef SKIN_VEC8\nlayout(location=JOINTS_1_LOCATION)in vec4 joint1;layout(location=WEIGHTS_1_LOCATION)in vec4 weight1;\n#endif\n#endif\nout vec3 v_position;out vec3 v_normal;out vec2 v_uv;void main(){\n#ifdef HAS_SKIN\nmat4 skinMatrix=weight0.x*u_jointMatrix.matrix[int(joint0.x)]+weight0.y*u_jointMatrix.matrix[int(joint0.y)]+weight0.z*u_jointMatrix.matrix[int(joint0.z)]+weight0.w*u_jointMatrix.matrix[int(joint0.w)];\n#ifdef SKIN_VEC8\nskinMatrix+=weight1.x*u_jointMatrix.matrix[int(joint1.x)]+weight1.y*u_jointMatrix.matrix[int(joint1.y)]+weight1.z*u_jointMatrix.matrix[int(joint1.z)]+weight1.w*u_jointMatrix.matrix[int(joint1.w)];\n#endif\n#endif\nv_uv=uv;\n#ifdef HAS_SKIN\nv_normal=normalize((u_MVNormal*transpose(inverse(skinMatrix))*vec4(normal,0)).xyz);vec4 pos=u_MV*skinMatrix*vec4(position,1.0);gl_Position=u_MVP*skinMatrix*vec4(position,1.0);\n#else\nv_normal=normalize((u_MVNormal*vec4(normal,0)).xyz);vec4 pos=u_MV*vec4(position,1.0);gl_Position=u_MVP*vec4(position,1.0);\n#endif\nv_position=vec3(pos.xyz)/pos.w;}","#version 300 es\n"+t+"#define FRAG_COLOR_LOCATION 0\nprecision highp float;precision highp int;uniform sampler2D u_brdfLUT;uniform vec4 u_baseColorFactor;\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_baseColorTexture;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_normalTexture;uniform float u_normalTextureScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_emissiveTexture;uniform vec3 u_emissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\nuniform float u_metallicFactor;uniform float u_roughnessFactor;\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_occlusionTexture;uniform float u_occlusionStrength;\n#endif\nin vec3 v_position;in vec3 v_normal;in vec2 v_uv;layout(location=FRAG_COLOR_LOCATION)out vec4 frag_color;struct PBRInfo{float NdotL;float NdotV;float NdotH;float LdotH;float VdotH;float perceptualRoughness;float metalness;vec3 reflectance0;vec3 reflectance90;float alphaRoughness;vec3 diffuseColor;vec3 specularColor;};const float M_PI=3.141592653589793;const float c_MinRoughness=0.04;vec3 getNormal(){vec3 pos_dx=dFdx(v_position);vec3 pos_dy=dFdy(v_position);vec3 tex_dx=dFdx(vec3(v_uv,0.0));vec3 tex_dy=dFdy(vec3(v_uv,0.0));vec3 t=(tex_dy.t*pos_dx-tex_dx.t*pos_dy)/(tex_dx.s*tex_dy.t-tex_dy.s*tex_dx.t);vec3 ng=v_normal;t=normalize(t-ng*dot(ng,t));vec3 b=normalize(cross(ng,t));mat3 tbn=mat3(t,b,ng);\n#ifdef HAS_NORMALMAP\nvec3 n=texture(u_normalTexture,v_uv).rgb;n=normalize(tbn*((2.0*n-1.0)*vec3(u_normalTextureScale,u_normalTextureScale,1.0)));\n#else\nvec3 n=tbn[2].xyz;\n#endif\nreturn n;}vec3 getIBLContribution(PBRInfo pbrInputs,vec3 n,vec3 reflection){float mipCount=10.0;float lod=(pbrInputs.perceptualRoughness*mipCount);vec3 brdf=texture(u_brdfLUT,vec2(pbrInputs.NdotV,1.0-pbrInputs.perceptualRoughness)).rgb;vec3 diffuseLight=vec3(0.6,0.6,0.6);vec3 specularLight=vec3(0.6,0.6,0.6);vec3 diffuse=diffuseLight*pbrInputs.diffuseColor;vec3 specular=specularLight*(pbrInputs.specularColor*brdf.x+brdf.y);return diffuse+specular;}vec3 diffuse(PBRInfo pbrInputs){return pbrInputs.diffuseColor/M_PI;}vec3 specularReflection(PBRInfo pbrInputs){return pbrInputs.reflectance0+(pbrInputs.reflectance90-pbrInputs.reflectance0)*pow(clamp(1.0-pbrInputs.VdotH,0.0,1.0),5.0);}float geometricOcclusion(PBRInfo pbrInputs){float NdotL=pbrInputs.NdotL;float NdotV=pbrInputs.NdotV;float r=pbrInputs.alphaRoughness;float attenuationL=2.0*NdotL/(NdotL+sqrt(r*r+(1.0-r*r)*(NdotL*NdotL)));float attenuationV=2.0*NdotV/(NdotV+sqrt(r*r+(1.0-r*r)*(NdotV*NdotV)));return attenuationL*attenuationV;}float microfacetDistribution(PBRInfo pbrInputs){float roughnessSq=pbrInputs.alphaRoughness*pbrInputs.alphaRoughness;float f=(pbrInputs.NdotH*roughnessSq-pbrInputs.NdotH)*pbrInputs.NdotH+1.0;return roughnessSq/(M_PI*f*f);}void main(){float perceptualRoughness=u_roughnessFactor;float metallic=u_metallicFactor;\n#ifdef HAS_METALROUGHNESSMAP\nvec4 mrSample=texture(u_metallicRoughnessTexture,v_uv);perceptualRoughness=mrSample.g*perceptualRoughness;metallic=mrSample.b*metallic;\n#endif\nperceptualRoughness=clamp(perceptualRoughness,c_MinRoughness,1.0);metallic=clamp(metallic,0.0,1.0);float alphaRoughness=perceptualRoughness*perceptualRoughness;\n#ifdef HAS_BASECOLORMAP\nvec4 baseColor=texture(u_baseColorTexture,v_uv)*u_baseColorFactor;\n#else\nvec4 baseColor=u_baseColorFactor;\n#endif\nvec3 f0=vec3(0.04);vec3 diffuseColor=baseColor.rgb*(vec3(1.0)-f0);diffuseColor*=1.0-metallic;vec3 specularColor=mix(f0,baseColor.rgb,metallic);float reflectance=max(max(specularColor.r,specularColor.g),specularColor.b);float reflectance90=clamp(reflectance*25.0,0.0,1.0);vec3 specularEnvironmentR0=specularColor.rgb;vec3 specularEnvironmentR90=vec3(1.0,1.0,1.0)*reflectance90;vec3 n=getNormal();vec3 v=normalize(-v_position);vec3 l=normalize(vec3(1.0,1.0,1.0));vec3 h=normalize(l+v);vec3 reflection=-normalize(reflect(v,n));float NdotL=clamp(dot(n,l),0.001,1.0);float NdotV=abs(dot(n,v))+0.001;float NdotH=clamp(dot(n,h),0.0,1.0);float LdotH=clamp(dot(l,h),0.0,1.0);float VdotH=clamp(dot(v,h),0.0,1.0);PBRInfo pbrInputs=PBRInfo(NdotL,NdotV,NdotH,LdotH,VdotH,perceptualRoughness,metallic,specularEnvironmentR0,specularEnvironmentR90,alphaRoughness,diffuseColor,specularColor);vec3 F=specularReflection(pbrInputs);float G=geometricOcclusion(pbrInputs);float D=microfacetDistribution(pbrInputs);vec3 diffuseContrib=(1.0-F)*diffuse(pbrInputs);vec3 specContrib=max(vec3(0.0),F*G*D/(4.0*NdotL*NdotV));vec3 color=NdotL*(diffuseContrib+specContrib);color+=getIBLContribution(pbrInputs,n,reflection);\n#ifdef HAS_OCCLUSIONMAP\nfloat ao=texture(u_occlusionTexture,v_uv).r;color=mix(color,color*ao,u_occlusionStrength);\n#endif\n#ifdef HAS_EMISSIVEMAP\nvec3 emissive=texture(u_emissiveTexture,v_uv).rgb*u_emissiveFactor;color+=emissive;\n#endif\nfrag_color=vec4(color,baseColor.a);}"),this.programObject={program:e,uniformLocations:{},uniformBlockIndices:{}},this.flags&n.HAS_SKIN&&(this.programObject.uniformBlockIndices.JointMatrix=c.getUniformBlockIndex(e,"JointMatrix")),(t=this.programObject.uniformLocations).MVP=c.getUniformLocation(e,"u_MVP"),t.MVNormal=c.getUniformLocation(e,"u_MVNormal"),t.MV=c.getUniformLocation(e,"u_MV"),t.baseColorFactor=c.getUniformLocation(e,"u_baseColorFactor"),t.metallicFactor=c.getUniformLocation(e,"u_metallicFactor"),t.roughnessFactor=c.getUniformLocation(e,"u_roughnessFactor"),this.flags&n.HAS_BASECOLORMAP&&(t.baseColorTexture=c.getUniformLocation(e,"u_baseColorTexture")),this.flags&n.HAS_NORMALMAP&&(t.normalTexture=c.getUniformLocation(e,"u_normalTexture"),t.normalTextureScale=c.getUniformLocation(e,"u_normalTextureScale")),this.flags&n.HAS_METALROUGHNESSMAP&&(t.metallicRoughnessTexture=c.getUniformLocation(e,"u_metallicRoughnessTexture")),this.flags&n.HAS_OCCLUSIONMAP&&(t.occlusionTexture=c.getUniformLocation(e,"u_occlusionTexture"),t.occlusionStrength=c.getUniformLocation(e,"u_occlusionStrength")),this.flags&n.HAS_EMISSIVEMAP&&(t.emissiveTexture=c.getUniformLocation(e,"u_emissiveTexture"),t.emissiveFactor=c.getUniformLocation(e,"u_emissiveFactor")),c.useProgram(null),i[this.flags]=this.programObject)};var m,g=Qo.create(),v=rs.create();es.create();var y=[];c.enable(c.CULL_FACE),c.cullFace(c.BACK),c.frontFace(c.CCW);var o=!0;c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL);var e=e||{},s=null;Qo.create();var l=rs.create();rs.perspective(l,.785,t.width/t.height,.01,100),rs.create();var u=rs.create(),x=rs.create(),b=rs.create();rs.create();var _,A,w,M=[1,1,1,1],C=e.drawPrimitive=function(t,e){var r,n,i;w&&(x=u=w.matrix,rs.invert(b,u),rs.transpose(b,b),e=M,r=t.shader,null!==(n=t.material)&&(e=(i=n.pbrMetallicRoughness).baseColorFactor,t.material.doubleSided===o&&((o=!t.material.doubleSided)?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE))),s!=t.shader.programObject&&(s=t.shader.programObject,c.useProgram(s.program)),n&&(r.hasBaseColorMap()&&a(s.uniformLocations.baseColorTexture,i.baseColorTexture),r.hasNormalMap()&&(a(s.uniformLocations.normalTexture,n.normalTexture),c.uniform1f(s.uniformLocations.normalTextureScale,n.normalTexture.scale)),r.hasMetalRoughnessMap()&&a(s.uniformLocations.metallicRoughnessTexture,i.metallicRoughnessTexture),c.uniform1f(s.uniformLocations.metallicFactor,i.metallicFactor),c.uniform1f(s.uniformLocations.roughnessFactor,i.roughnessFactor),r.hasOcclusionMap()&&(a(s.uniformLocations.occlusionTexture,n.occlusionTexture),c.uniform1f(s.uniformLocations.occlusionStrength,n.occlusionTexture.strength)),r.hasEmissiveMap()&&(a(s.uniformLocations.emissiveTexture,n.emissiveTexture),c.uniform3fv(s.uniformLocations.emissiveFactor,n.emissiveFactor))),r.hasSkin()&&c.uniformBlockBinding(s.program,s.uniformBlockIndices.JointMatrix,_),c.activeTexture(c.TEXTURE0+29),c.bindTexture(c.TEXTURE_2D,null),c.uniform4fv(s.uniformLocations.baseColorFactor,e),c.uniformMatrix4fv(s.uniformLocations.MV,!1,u),c.uniformMatrix4fv(s.uniformLocations.MVP,!1,x),c.uniformMatrix4fv(s.uniformLocations.MVNormal,!1,b),c.bindVertexArray(t.vertexArray),null!==t.indices?c.drawElements(t.mode,t.indicesLength,t.indicesComponentType,t.indicesOffset):c.drawArrays(t.mode,t.drawArraysOffset,t.drawArraysCount),c.bindVertexArray(null))},T=rs.create(),S=rs.create(),E=e.drawNode=function(t,e,r,n){if(e=r[e],void 0!==n?rs.mul(e,n,t.matrix):rs.copy(e,t.matrix),null!==t.skin){var i=t.skin;_=i.uniformBlockID;var a=t.skin.joints;for(rs.invert(S,e),n=0,s=a.length;n<s;n++){var o=a[n];rs.mul(T,r[o.nodeID],i.inverseBindMatrix[n]),rs.mul(T,S,T),i.jointMatrixUnidormBufferData.set(T,16*n)}c.bindBuffer(c.UNIFORM_BUFFER,i.jointMatrixUniformBuffer),c.bufferSubData(c.UNIFORM_BUFFER,0,i.jointMatrixUnidormBufferData,0,i.jointMatrixUnidormBufferData.length)}var s;if(null!==t.mesh)for(n=0,s=(i=t.mesh).primitives.length;n<s;n++)C(i.primitives[n],e);for(null!==t.skin&&c.bindBuffer(c.UNIFORM_BUFFER,null),n=0,s=t.children.length;n<s;n++)E(t.children[n],t.children[n].nodeID,r,e)},I=e.drawScene=function(t){var e=t.glTF;if(e.animations){for(var r=e.animations[h],n=0,i=r.samplers.length;n<i;n++)r.samplers[n].getValue(R);for(n=0,i=r.channels.length;n<i;n++){var a=r.channels[n],o=a.sampler,s=e.nodes[a.target.nodeID];switch(a.target.path){case"rotation":Ko.copy(s.rotation,o.curValue);break;case"translation":Qo.copy(s.translation,o.curValue);break;case"scale":Qo.copy(s.scale,o.curValue)}s.updateMatrixFromTRS()}}for(r=0,e=t.glTFScene.nodes.length;r<e;r++)E(t.glTFScene.nodes[r],t.glTFScene.nodes[r].nodeID,t.nodeMatrix,t.rootTransform)},L=performance.now(),R=0;return{setupScene:function(t,e){function r(t,e){if(void 0!==t){var r=t.bufferView;return null===r.target?(c.bindBuffer(c.ARRAY_BUFFER,r.buffer),c.bufferData(c.ARRAY_BUFFER,r.data,c.STATIC_DRAW)):c.bindBuffer(r.target,r.buffer),t.prepareVertexAttrib(e,c),1}}if(t.animations)for(var n=0,i=t.animations.length;n<i;n++)d.add(t.animations[n].name||n);for(h=0,n=t.scenes[t.defaultScene],Qo.fromValues(1.2*n.boundingBox.transform[0],0,0),Qo.create(),e?e=y[e.id]=new p(n,t,e.id):(e=new p(n,t,y.length),y.push(e)),1===y.length&&(rs.identity(v),m=1/Math.max(n.boundingBox.transform[0],Math.max(n.boundingBox.transform[5],n.boundingBox.transform[10])),rs.getTranslation(g,n.boundingBox.transform),Qo.scale(g,g,-1),g[0]+=-.5*n.boundingBox.transform[0],g[1]+=-.5*n.boundingBox.transform[5],g[2]+=-.5*n.boundingBox.transform[10],m*=.5,v[0]=m,v[5]=m,v[10]=m,rs.translate(v,v,g),Qo.set(g,0,0,-1.5)),n=0,i=t.bufferViews.length;n<i;n++){var a=t.bufferViews[n];a.createBuffer(c),a.bindData(c)}if(t.textures)for(n=0,i=t.textures.length;n<i;n++){var o=t.textures[n];o.createTexture(c)}if(t.samplers)for(n=0,i=t.samplers.length;n<i;n++)(o=t.samplers[n]).createSampler(c);if(t.skins)for(n=0,i=t.skins.length;n<i;n++)(o=t.skins[n]).jointMatrixUniformBuffer=c.createBuffer(),c.bindBufferBase(c.UNIFORM_BUFFER,o.uniformBlockID,o.jointMatrixUniformBuffer),c.bindBuffer(c.UNIFORM_BUFFER,o.jointMatrixUniformBuffer),c.bufferData(c.UNIFORM_BUFFER,o.jointMatrixUnidormBufferData,c.DYNAMIC_DRAW),c.bufferSubData(c.UNIFORM_BUFFER,0,o.jointMatrixUnidormBufferData),c.bindBuffer(c.UNIFORM_BUFFER,null);for(var s=0,l=t.meshes.length;s<l;s++)for(n=0,i=(o=t.meshes[s]).primitives.length;n<i;++n){var u=o.primitives[n];u.shader=new f,u.vertexArray=a=c.createVertexArray(),c.bindVertexArray(a),r(u.attributes.POSITION,0),r(u.attributes.NORMAL,1),r(u.attributes.TEXCOORD_0,2),r(u.attributes.JOINTS_0,3)&&r(u.attributes.WEIGHTS_0,4)&&u.shader.defineMacro("HAS_SKIN"),r(u.attributes.JOINTS_1,5)&&r(u.attributes.WEIGHTS_1,6)&&u.shader.defineMacro("SKIN_VEC8"),null!==u.indices&&(null===(a=(a=t.accessors[u.indices]).bufferView).target?(c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,a.data,c.STATIC_DRAW)):c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a.buffer)),c.bindVertexArray(null),c.bindBuffer(c.ARRAY_BUFFER,null),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),(a=u.material)&&(a.pbrMetallicRoughness.baseColorTexture&&u.shader.defineMacro("HAS_BASECOLORMAP"),a.pbrMetallicRoughness.metallicRoughnessTexture&&u.shader.defineMacro("HAS_METALROUGHNESSMAP"),a.normalTexture&&u.shader.defineMacro("HAS_NORMALMAP"),a.occlusionTexture&&u.shader.defineMacro("HAS_OCCLUSIONMAP"),a.emissiveTexture&&u.shader.defineMacro("HAS_EMISSIVEMAP")),u.shader.compile()}return e},render:e.render=function(t){w=t,t=(new Date).getTime();for(var e=0,r=y.length;e<r;e++)A=y[e],I(y[e]);s=null,R=.001*(t-L)}}}function Yt(t){this.options=t=t||{},t.colors=t.colors||["rgba(0,192,73,0.99609375)","rgba(242,48,48,0.99609375)","rgba(255,159,25,0.99609375)"];var e=t.colors;this.drawTogether=!0,this.parseColors(e),this.tileSize=256,this.ratio=window.devicePixelRatio,this.cache={},t.getTileUrl&&(this.getTileUrl=t.getTileUrl),this._loadCount={}}var Zt=window.BMapGL||window.BMap;function Jt(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}function Kt(t,e){return de.call(t,e)}function Qt(t){return pe.call(t).slice(8,-1)}function $t(t){return fe(Jt(t))}function te(t){return isNaN(t=+t)?0:(0<t?ge:me)(t)}function ee(t){return 0<t?ve(te(t),9007199254740991):0}function re(t){return"Symbol(".concat(void 0===t?"":t,")_",(++we+Me).toString(36))}function ne(t,e){var r,n=0,i=[];for(r in t=$t(t))r!=Se&&Kt(t,r)&&i.push(r);for(;e.length>n;)Kt(t,r=e[n++])&&(~Te(i,r)||i.push(r));return i}function ie(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}function ae(n,i,t){if(ie(n),void 0===i)return n;switch(t){case 1:return function(t){return n.call(i,t)};case 2:return function(t,e){return n.call(i,t,e)};case 3:return function(t,e,r){return n.call(i,t,e,r)}}return function(){return n.apply(i,arguments)}}function oe(t){return"object"==typeof t?null!==t:"function"==typeof t}function se(t){if(!oe(t))throw TypeError(t+" is not an object!");return t}function le(t){try{return!!t()}catch(t){return!0}}function ue(t,e){if(!oe(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!oe(n=r.call(t))||"function"==typeof(r=t.valueOf)&&!oe(n=r.call(t))||!e&&"function"==typeof(r=t.toString)&&!oe(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}function ce(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}(e.prototype=Zt&&Zt.Overlay?new Zt.Overlay:e.prototype).initialize=function(t){this._map=t;var e=this.canvas=document.createElement("canvas"),r=this.ctx=this.canvas.getContext("2d");e.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";",this.adjustSize(),this.adjustRatio(r),t.getContainer().appendChild(e);var n=this;return t.addEventListener("resize",function(){n.adjustSize(),n._draw()}),this.canvas},e.prototype.adjustSize=function(){var t=this._map.getSize(),e=this.canvas;e.width=t.width,e.height=t.height,e.style.width=e.width+"px",e.style.height=e.height+"px"},e.prototype.adjustRatio=function(t){var e=(window.devicePixelRatio||1)/(t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),r=t.canvas.width,n=t.canvas.height;t.canvas.width=r*e,t.canvas.height=n*e,t.canvas.style.width=r+"px",t.canvas.style.height=n+"px",t.scale(e,e)},e.prototype.draw=function(){this._draw.apply(this,arguments)},e.prototype._draw=function(){this.dispatchEvent("draw"),this.options.update&&this.options.update.apply(this,arguments)},e.prototype.getContainer=function(){return this.canvas},e.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},e.prototype.hide=function(){this.canvas.style.display="none"},e.prototype.setZIndex=function(t){this.canvas.style.zIndex=t},e.prototype.getZIndex=function(){return this.zIndex};var he=r(n(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),de={}.hasOwnProperty,pe={}.toString,fe=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Qt(t)?t.split(""):Object(t)},me=Math.ceil,ge=Math.floor,ve=Math.min,ye=Math.max,xe=Math.min,be=n(function(t){t=t.exports={version:"2.6.5"},"number"==typeof __e&&(__e=t)}),_e=n(function(t){t=t.exports="undefined"!=typeof window&&Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=t)}),Ae=n(function(t){var r=_e["__core-js_shared__"]||(_e["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:be.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),we=0,Me=Math.random(),Ce=Ae("keys"),Te=function(t,e,r){t=$t(t);var n=ee(t.length);for(r=(r=te(r))<0?ye(r+n,0):xe(r,n),0;r<n;r++)if(r in t&&t[r]===e)return r||0;return-1},Se=(cc=function(t){return Ce[t]||(Ce[t]=re(t))})("IE_PROTO"),Ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ie=Object.keys||function(t){return ne(t,Ee)},Le=!le(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Re=_e.document,Pe=oe(Re)&&oe(Re.createElement),De=!Le&&!le(function(){return 7!=Object.defineProperty(Pe?Re.createElement("div"):{},"a",{get:function(){return 7}}).a}),Oe=Object.defineProperty,Fe={f:Le?Object.defineProperty:function(t,e,r){if(se(t),e=ue(e,!0),se(r),De)try{return Oe(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},Be=Le?function(t,e,r){return Fe.f(t,e,ce(1,r))}:function(t,e,r){return t[e]=r,t},Ne=function(t,e,r){var n,i,a=t&Ne.F,o=t&Ne.G,s=t&Ne.S,l=t&Ne.P,u=t&Ne.B,c=t&Ne.W,h=o?be:be[e]||(be[e]={}),d=h.prototype,s=o?_e:s?_e[e]:(_e[e]||{}).prototype;for(n in r=o?e:r)(e=!a&&s&&void 0!==s[n])&&Kt(h,n)||(i=(e?s:r)[n],h[n]=o&&"function"!=typeof s[n]?r[n]:u&&e?ae(i,_e):c&&s[n]==i?function(n){function t(t,e,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(t);case 2:return new n(t,e)}return new n(t,e,r)}return n.apply(this,arguments)}return t.prototype=n.prototype,t}(i):l&&"function"==typeof i?ae(Function.call,i):i,l&&((h.virtual||(h.virtual={}))[n]=i,t&Ne.R&&d&&!d[n]&&Be(d,n,i)))};Ne.F=1,Ne.G=2,Ne.S=4,Ne.P=8,Ne.B=16,Ne.W=32,Ne.U=64,Ne.R=128;var ze=Ne;(Tu=function(t,e){var r=(be.Object||{})[t]||Object[t],n={};n[t]=e(r),ze(ze.S+ze.F*le(function(){r(1)}),"Object",n)})("keys",function(){return function(t){return Ie(Object(Jt(t)))}});var Ue=be.Object.keys,ke=r(n(function(t){t.exports={default:Ue,__esModule:!0}})),He=Object.getOwnPropertySymbols,Ge={}.propertyIsEnumerable,Ve=Object.assign,We=!Ve||le(function(){var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=Ve({},t)[r]||"abcdefghijklmnopqrst"!=Object.keys(Ve({},e)).join("")})?function(t,e){for(var r=Object(Jt(t)),n=arguments.length,i=1,a=He,o=Ge;i<n;)for(var s,l=fe(arguments[i++]),u=a?Ie(l).concat(a(l)):Ie(l),c=u.length,h=0;h<c;)o.call(l,s=u[h++])&&(r[s]=l[s]);return r}:Ve;ze(ze.S+ze.F,"Object",{assign:We});var je=be.Object.assign,Xe=r(n(function(t){t.exports={default:je,__esModule:!0}})),qe=cc("IE_PROTO"),Ye=Object.prototype,Ze=Object.getPrototypeOf||function(t){return t=Object(Jt(t)),Kt(t,qe)?t[qe]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ye:null};Tu("getPrototypeOf",function(){return function(t){return Ze(Object(Jt(t)))}});var Je=be.Object.getPrototypeOf,Ke=n(function(t){t.exports={default:Je,__esModule:!0}}),Qe=r(Ke);function $e(t,e,r){return rr.defineProperty(t,e,r)}function tr(){}function er(t,e,r){t&&!Kt(t=r?t:t.prototype,fr)&&pr(t,fr,{configurable:!0,value:e})}ze(ze.S+ze.F*!Le,"Object",{defineProperty:Fe.f});var rr=be.Object,nr=n(function(t){t.exports={default:$e,__esModule:!0}}),ir=r(nr),ar=r(n(function(t,e){e.__esModule=!0;var i=nr&&nr.__esModule?nr:{default:nr};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(t,n.key,n)}}e.default=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}})),or={},sr=Le?Object.defineProperties:function(t,e){se(t);for(var r,n=Ie(e),i=n.length,a=0;a<i;)Fe.f(t,r=n[a++],e[r]);return t},lr=(hc=_e.document)&&hc.documentElement,ur=cc("IE_PROTO"),cr=function(){var t=Pe?Re.createElement("iframe"):{},e=Ee.length;for(t.style.display="none",lr.appendChild(t),t.src="javascript:",(t=t.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),cr=t.F;e--;)delete cr.prototype[Ee[e]];return cr()},hr=Object.create||function(t,e){var r;return null!==t?(tr.prototype=se(t),r=new tr,tr.prototype=null,r[ur]=t):r=cr(),void 0===e?r:sr(r,e)},dr=n(function(t){var e=Ae("wks"),r=_e.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:re)("Symbol."+t))}).store=e}),pr=Fe.f,fr=dr("toStringTag"),mr={};function gr(){return this}function vr(t,e,r,n,i,a,o){m=e,p=n,(f=r).prototype=hr(mr,{next:ce(1,p)}),er(f,m+" Iterator");var s,l=e+" Iterator",u="values"==i,c=!(n=function(t){return!xr&&t in h?h[t]:function(){return new r(this,t)}}),h=t.prototype,d=h[yr]||h["@@iterator"]||i&&h[i],p=d||n(i),f=i?u?n("entries"):p:void 0,m="Array"==e&&h.entries||d;if(m&&((t=Ze(m.call(new t)))!==Object.prototype&&t.next&&er(t,l,!0)),u&&d&&"values"!==d.name&&(c=!0,p=function(){return d.call(this)}),o&&(xr||c||!h[yr])&&Be(h,yr,p),or[e]=p,or[l]=gr,i){var g={values:u?p:n("values"),keys:a?p:n("keys"),entries:f};if(o)for(s in g)s in h||Be(h,s,g[s]);else ze(ze.P+ze.F*(xr||c),e,g)}return g}Be(mr,dr("iterator"),function(){return this});var yr=dr("iterator"),xr=!([].keys&&"next"in[].keys()),br=function(t,e){t=String(Jt(t)),e=te(e);var r,n=t.length;if(e<0||n<=e)return"";var i=t.charCodeAt(e);return i<55296||56319<i||e+1===n||(r=t.charCodeAt(e+1))<56320||57343<r?t.charAt(e):t.slice(e,e+2)};function _r(t,e){return{value:e,done:!!t}}vr(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,e=this._i;return e>=t.length?{value:void 0,done:!0}:(t=br(t,e),this._i+=t.length,{value:t,done:!1})}),vr(Array,"Array",function(t,e){this._t=$t(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,_r(1)):_r(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),or.Arguments=or.Array;for(var Ar=dr("toStringTag"),wr="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),Mr=0;Mr<wr.length;Mr++){var Cr=wr[Mr],Tr=_e[Cr],Tr=Tr&&Tr.prototype;Tr&&!Tr[Ar]&&Be(Tr,Ar,Cr),or[Cr]=or.Array}var Sr={f:dr},Er=Sr.f("iterator"),Ir=n(function(t){t.exports={default:Er,__esModule:!0}});function Lr(t){var e=be.Symbol||(be.Symbol={});"_"==t.charAt(0)||t in e||Or(e,t,{value:Sr.f(t)})}function Rr(t){var e=$r[t]=hr(Xr.prototype);return e._k=t,e}function Pr(t,e){se(t);var r,n=e=$t(e),i=Ie(n);if(o=He)for(var a,o=o(n),s=Ge,l=0;o.length>l;)s.call(n,a=o[l++])&&i.push(a);for(n=0,a=i.length;n<a;)sn(t,r=i[n++],e[r]);return t}r(Ir);var Dr=n(function(t){function r(t){e(t,n,{value:{i:"O"+ ++i,w:{}}})}var n=re("meta"),e=Fe.f,i=0,a=Object.isExtensible||function(){return!0},o=!le(function(){return a(Object.preventExtensions({}))}),s=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!oe(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!Kt(t,n)){if(!a(t))return"F";if(!e)return"E";r(t)}return t[n].i},getWeak:function(t,e){if(!Kt(t,n)){if(!a(t))return!0;if(!e)return!1;r(t)}return t[n].w},onFreeze:function(t){return o&&s.NEED&&a(t)&&!Kt(t,n)&&r(t),t}}}),Or=Fe.f,Fr=Array.isArray||function(t){return"Array"==Qt(t)},Br=Ee.concat("length","prototype"),Nr=Object.getOwnPropertyNames||function(t){return ne(t,Br)},zr={}.toString,Ur="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],kr=Object.getOwnPropertyDescriptor,Hr={f:Le?kr:function(t,e){if(t=$t(t),e=ue(e,!0),De)try{return kr(t,e)}catch(t){}if(Kt(t,e))return ce(!Ge.call(t,e),t[e])}},Gr=Dr.KEY,Vr=Hr.f,Wr=Fe.f,jr=function(t){if(Ur&&"[object Window]"==zr.call(t))try{var e=Nr(t)}catch(t){e=Ur.slice()}else e=Nr($t(t));return e},Xr=_e.Symbol,qr=_e.JSON,Yr=qr&&qr.stringify,Zr=dr("_hidden"),Jr=dr("toPrimitive"),Kr={}.propertyIsEnumerable,Qr=Ae("symbol-registry"),$r=Ae("symbols"),tn=Ae("op-symbols"),en=Object.prototype,rn="function"==typeof Xr,nn=!(dc=_e.QObject)||!dc.prototype||!dc.prototype.findChild,an=Le&&le(function(){return 7!=hr(Wr({},"a",{get:function(){return Wr(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=Vr(en,e);n&&delete en[e],Wr(t,e,r),n&&t!==en&&Wr(en,e,n)}:Wr,on=rn&&"symbol"==typeof Xr.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Xr},sn=function(t,e,r){return t===en&&sn(tn,e,r),se(t),e=ue(e,!0),se(r),Kt($r,e)?(r.enumerable?(Kt(t,Zr)&&t[Zr][e]&&(t[Zr][e]=!1),r=hr(r,{enumerable:ce(0,!1)})):(Kt(t,Zr)||Wr(t,Zr,ce(1,{})),t[Zr][e]=!0),an(t,e,r)):Wr(t,e,r)},ln=function(t,e){if(t=$t(t),e=ue(e,!0),t!==en||!Kt($r,e)||Kt(tn,e)){var r=Vr(t,e);return!r||!Kt($r,e)||Kt(t,Zr)&&t[Zr][e]||(r.enumerable=!0),r}},un=function(t){t=jr($t(t));for(var e,r=[],n=0;t.length>n;)Kt($r,e=t[n++])||e==Zr||e==Gr||r.push(e);return r},cn=function(t){var e=t===en;t=jr(e?tn:$t(t));for(var r,n=[],i=0;t.length>i;)!Kt($r,r=t[i++])||e&&!Kt(en,r)||n.push($r[r]);return n};rn||(Be((Xr=function(){if(this instanceof Xr)throw TypeError("Symbol is not a constructor!");var e=re(0<arguments.length?arguments[0]:void 0),r=function(t){this===en&&r.call(tn,t),Kt(this,Zr)&&Kt(this[Zr],e)&&(this[Zr][e]=!1),an(this,e,ce(1,t))};return Le&&nn&&an(en,e,{configurable:!0,set:r}),Rr(e)}).prototype,"toString",function(){return this._k}),Hr.f=ln,Fe.f=sn,Ge=function(t){var e=Kr.call(this,t=ue(t,!0));return!(this===en&&Kt($r,t)&&!Kt(tn,t))&&(!(e||!Kt(this,t)||!Kt($r,t)||Kt(this,Zr)&&this[Zr][t])||e)},He=cn,Sr.f=function(t){return Rr(dr(t))}),ze(ze.G+ze.W+ze.F*!rn,{Symbol:Xr});for(var hn="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),dn=0;hn.length>dn;)dr(hn[dn++]);for(var pn=Ie(dr.store),fn=0;pn.length>fn;)Lr(pn[fn++]);ze(ze.S+ze.F*!rn,"Symbol",{for:function(t){return Kt(Qr,t+="")?Qr[t]:Qr[t]=Xr(t)},keyFor:function(t){if(!on(t))throw TypeError(t+" is not a symbol!");for(var e in Qr)if(Qr[e]===t)return e},useSetter:function(){nn=!0},useSimple:function(){nn=!1}}),ze(ze.S+ze.F*!rn,"Object",{create:function(t,e){return void 0===e?hr(t):Pr(hr(t),e)},defineProperty:sn,defineProperties:Pr,getOwnPropertyDescriptor:ln,getOwnPropertyNames:un,getOwnPropertySymbols:cn}),qr&&ze(ze.S+ze.F*(!rn||le(function(){var t=Xr();return"[null]"!=Yr([t])||"{}"!=Yr({a:t})||"{}"!=Yr(Object(t))})),"JSON",{stringify:function(t){for(var r,e=[t],n=1;n<arguments.length;)e.push(arguments[n++]);if(r=n=e[1],(oe(n)||void 0!==t)&&!on(t))return Fr(n)||(n=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!on(e))return e}),e[1]=n,Yr.apply(qr,e)}}),Xr.prototype[Jr]||Be(Xr.prototype,Jr,Xr.prototype.valueOf),er(Xr,"Symbol"),er(Math,"Math",!0),er(_e.JSON,"JSON",!0),Lr("asyncIterator"),Lr("observable");var mn=be.Symbol,gn=n(function(t){t.exports={default:mn,__esModule:!0}}),vn=r(gn),yn=n(function(t,e){e.__esModule=!0,t=Ir&&Ir.__esModule?Ir:{default:Ir};var r=gn&&gn.__esModule?gn:{default:gn},n="function"==typeof r.default&&"symbol"==typeof t.default?function(t){return typeof t}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":typeof t};e.default="function"==typeof r.default&&"symbol"===n(t.default)?function(t){return void 0===t?"undefined":n(t)}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":void 0===t?"undefined":n(t)}}),xn=r(yn),bn=r(n(function(t,e){e.__esModule=!0;var r=yn&&yn.__esModule?yn:{default:yn};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}})),_n=Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{(n=ae(Function.call,Hr.f(Object.prototype,"__proto__").set,2))(t,[]),r=!(t instanceof Array)}catch(t){r=!0}return function(t,e){if(se(t),!oe(e)&&null!==e)throw TypeError(e+": can't set as prototype!");return r?t.__proto__=e:n(t,e),t}}({},!1):void 0);ze(ze.S,"Object",{setPrototypeOf:_n});var An=be.Object.setPrototypeOf,wn=n(function(t){t.exports={default:An,__esModule:!0}});function Mn(t,e){return Tn.create(t,e)}function Cn(t){var e;if(void 0===t)var r="Undefined";else{if(null===t)var n="Null";else{t:{var i=t=Object(t);try{n=i[Ln];break t}catch(t){}n=void 0}n="string"==typeof(r=n)?r:Rn?Qt(t):"Object"==(e=Qt(t))&&"function"==typeof t.callee?"Arguments":e}r=n}return r}r(wn),ze(ze.S,"Object",{create:hr});var Tn=be.Object,Sn=n(function(t){t.exports={default:Mn,__esModule:!0}}),En=r(Sn),In=r(n(function(t,e){function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var n=r(wn),i=r(Sn),a=r(yn);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,a.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}})),Ln=dr("toStringTag"),Rn="Arguments"==Qt(function(){return arguments}()),Pn=dr("iterator"),Dn=be.isIterable=function(t){return void 0!==(t=Object(t))[Pn]||"@@iterator"in t||or.hasOwnProperty(Cn(t))},On=n(function(t){t.exports={default:Dn,__esModule:!0}});function Fn(e,r,t,n){try{return n?r(se(t)[0],t[1]):r(t)}catch(t){throw void 0!==(r=e.return)&&se(r.call(e)),t}}r(On);var Bn=dr("iterator"),Nn=be.getIteratorMethod=function(t){if(null!=t)return t[Bn]||t["@@iterator"]||or[Cn(t)]},zn=be.getIterator=function(t){var e=Nn(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return se(e.call(t))},Un=n(function(t){t.exports={default:zn,__esModule:!0}}),kn=r(Un),Hn=r(n(function(t,e){e.__esModule=!0;var l=On&&On.__esModule?On:{default:On},u=Un&&Un.__esModule?Un:{default:Un};e.default=function(t,e){if(Array.isArray(t))return t;if((0,l.default)(Object(t))){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=(0,u.default)(t);!(n=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")}})),Gn=dr("iterator"),Vn=Array.prototype,Wn=dr("iterator"),jn=!1;try{[7][Wn]().return=function(){jn=!0}}catch(t){}var Xn=function(t,e){if(!e&&!jn)return!1;var r=!1;try{var n=(e=[7])[Wn]();n.next=function(){return{done:r=!0}},e[Wn]=function(){return n},t(e)}catch(t){}return r};ze(ze.S+ze.F*!Xn(function(t){}),"Array",{from:function(t){var e=Object(Jt(t)),r="function"==typeof this?this:Array,n=arguments.length,i=1<n?arguments[1]:void 0,a=void 0!==i,o=0,s=Nn(e);if(a&&(i=ae(i,2<n?arguments[2]:void 0,2)),null!=s&&(r!=Array||void 0===s||or.Array!==s&&Vn[Gn]!==s))for(e=s.call(e),r=new r;!(l=e.next()).done;o++)n=r,s=o,l=a?Fn(e,i,[l.value,o],!0):l.value,s in n?Fe.f(n,s,ce(0,l)):n[s]=l;else for(r=new r(n=ee(e.length));o<n;o++){var s=r,l=o,u=a?i(e[o],o):e[o];l in s?Fe.f(s,l,ce(0,u)):s[l]=u}return r.length=o,r}});var qn=be.Array.from,Yn=n(function(t){t.exports={default:qn,__esModule:!0}}),Zn=r(Yn),Jn=r(n(function(t,e){e.__esModule=!0;var n=Yn&&Yn.__esModule?Yn:{default:Yn};e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}})),Kn=Dr.onFreeze;function Qn(t){return ei.stringify.apply(ei,arguments)}Tu("freeze",function(e){return function(t){return e&&oe(t)?e(Kn(t)):t}});var $n=be.Object.freeze,ti=r(n(function(t){t.exports={default:$n,__esModule:!0}})),ei=be.JSON||(be.JSON={stringify:JSON.stringify}),ri=r(n(function(t){t.exports={default:Qn,__esModule:!0}})),ni={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ii=Hr.f;function ai(t,e){return si.getOwnPropertyDescriptor(t,e)}function oi(t){for(var e={},r=ke(di),n=r.length,i=0;i<n;i++)e[r[i]]={distance:-1,parent:null};for(r=[t],e[t].distance=0;r.length;){t=r.pop();for(var i=(n=ke(di[t])).length,a=0;a<i;a++){var o=n[a],s=e[o];-1===s.distance&&(s.distance=e[t].distance+1,s.parent=t,r.unshift(o))}}for(r={},n=(t=ke(e)).length,i=0;i<n;i++)if(null!==e[u=t[i]].parent){for(var a=u,s=[(o=e)[u].parent,u],l=di[o[u].parent][u],u=o[u].parent;o[u].parent;)s.unshift(o[u].parent),l=function(e,r){return function(t){return r(e(t))}}(di[o[u].parent][u],l),u=o[u].parent;l.conversion=s,r[a]=l}return r}Tu("getOwnPropertyDescriptor",function(){return function(t,e){return ii($t(t),e)}});var si=be.Object,li=n(function(t){t.exports={default:ai,__esModule:!0}}),ui=r(li),ci=n(function(t){var o=Array.prototype.concat,s=Array.prototype.slice,e=t.exports=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],a=!(!(a=i)||"string"==typeof a)&&(a instanceof Array||Array.isArray(a)||0<=a.length&&(a.splice instanceof Function||ui(a,a.length-1)&&"String"!==a.constructor.name));a?e=o.call(e,s.call(i)):e.push(i)}return e};e.wrap=function(t){return function(){return t(e(arguments))}}}),hi=n(function(t){function a(t,e,r){return Math.min(Math.max(e,t),r)}function e(t){return(t=t.toString(16).toUpperCase()).length<2?"0"+t:t}var r,n={};for(r in ni)ni.hasOwnProperty(r)&&(n[ni[r]]=r);var i=t.exports={to:{},get:{}};i.get=function(t){switch(t.substring(0,3).toLowerCase()){case"hsl":t=i.get.hsl(t);var e="hsl";break;case"hwb":t=i.get.hwb(t),e="hwb";break;default:t=i.get.rgb(t),e="rgb"}return t?{model:e,value:t}:null},i.get.rgb=function(t){if(!t)return null;var e,r=/^#([a-f0-9]{3,4})$/i,n=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,i=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],t=0;t<3;t++)n=2*t,i[t]=parseInt(e.slice(n,n+2),16);r&&(i[3]=Math.round(parseInt(r,16)/255*100)/100)}else if(e=t.match(r)){for(r=(e=e[1])[3],t=0;t<3;t++)i[t]=parseInt(e[t]+e[t],16);r&&(i[3]=Math.round(parseInt(r+r,16)/255*100)/100)}else if(e=t.match(n)){for(t=0;t<3;t++)i[t]=parseInt(e[t+1],0);e[4]&&(i[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(e=t.match(/(\D+)/))?"transparent"===e[1]?[0,0,0,0]:(i=ni[e[1]])?(i[3]=1,i):null:null;for(t=0;t<3;t++)i[t]=Math.round(2.55*parseFloat(e[t+1]));e[4]&&(i[3]=parseFloat(e[4]))}for(t=0;t<3;t++)i[t]=a(i[t],0,255);return i[3]=a(i[3],0,1),i},i.get.hsl=function(t){if(!t)return null;if(e=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){var e,r=parseFloat(e[4]);return[t=(parseFloat(e[1])+360)%360,a(parseFloat(e[2]),0,100),e=a(parseFloat(e[3]),0,100),r=a(isNaN(r)?1:r,0,1)]}return null},i.get.hwb=function(t){if(!t)return null;if(e=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){var e,r=parseFloat(e[4]);return[t=(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),e=a(parseFloat(e[3]),0,100),r=a(isNaN(r)?1:r,0,1)]}return null},i.to.hex=function(){var t=ci(arguments);return"#"+e(t[0])+e(t[1])+e(t[2])+(t[3]<1?e(Math.round(255*t[3])):"")},i.to.rgb=function(){var t=ci(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},i.to.rgb.percent=function(){var t=ci(arguments),e=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+r+"%, "+n+"%)":"rgba("+e+"%, "+r+"%, "+n+"%, "+t[3]+")"},i.to.hsl=function(){var t=ci(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},i.to.hwb=function(){var t=ci(arguments),e="";return 4<=t.length&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},i.to.keyword=function(t){return n[t.slice(0,3)]}}),di=n(function(t){var a={};for(r in ni)ni.hasOwnProperty(r)&&(a[ni[r]]=r);var e,o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(e in o)if(o.hasOwnProperty(e)){if(!("channels"in o[e]))throw Error("missing channels property: "+e);if(!("labels"in o[e]))throw Error("missing channel labels property: "+e);if(o[e].labels.length!==o[e].channels)throw Error("channel and label counts mismatch: "+e);t=o[e].channels;var r=o[e].labels;delete o[e].channels,delete o[e].labels,Object.defineProperty(o[e],"channels",{value:t}),Object.defineProperty(o[e],"labels",{value:r})}o.rgb.hsl=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255;t=Math.min(e,r,n);var i,a=Math.max(e,r,n),o=a-t;return a===t?i=0:e===a?i=(r-n)/o:r===a?i=2+(n-e)/o:n===a&&(i=4+(e-r)/o),(i=Math.min(60*i,360))<0&&(i+=360),e=(t+a)/2,[i,100*(a===t?0:e<=.5?o/(a+t):o/(2-a-t)),100*e]},o.rgb.hsv=function(t){var e,r,n,i=t[0]/255,a=t[1]/255,o=t[2]/255,s=Math.max(i,a,o),l=s-Math.min(i,a,o);return 0==l?r=e=0:(e=l/s,t=(s-i)/6/l+.5,n=(s-a)/6/l+.5,l=(s-o)/6/l+.5,i===s?r=l-n:a===s?r=1/3+t-l:o===s&&(r=2/3+n-t),r<0?r+=1:1<r&&--r),[360*r,100*e,100*s]},o.rgb.hwb=function(t){var e=t[0],r=t[1],n=t[2];return[t=o.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(r,n))),100*(n=1-1/255*Math.max(e,Math.max(r,n)))]},o.rgb.cmyk=function(t){var e=t[0]/255,r=t[1]/255;t=t[2]/255;var n=Math.min(1-e,1-r,1-t);return[100*((1-e-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-t-n)/(1-n)||0),100*n]},o.rgb.keyword=function(t){var e,r,n,i=a[t];if(i)return i;for(e in i=1/0,ni)ni.hasOwnProperty(e)&&(n=ni[e],(n=Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2)+Math.pow(t[2]-n[2],2))<i&&(i=n,r=e));return r},o.keyword.rgb=function(t){return ni[t]},o.rgb.xyz=function(t){var e=t[0]/255,r=t[1]/255;return t=t[2]/255,[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)),100*(.2126*e+.7152*r+.0722*t),100*(.0193*e+.1192*r+.9505*t)]},o.rgb.lab=function(t){t=(r=o.rgb.xyz(t))[0];var e=r[1],r=r[2];return e/=100,r/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116))]},o.hsl.rgb=function(t){var e=t[0]/360,r=t[1]/100;if(t=t[2]/100,0===r){var n=255*t;return[n,n,n]}t=2*t-(r=t<.5?t*(1+r):t+r-t*r);for(var i=[0,0,0],a=0;a<3;a++)(n=e+1/3*-(a-1))<0&&n++,1<n&&n--,n=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,i[a]=255*n;return i},o.hsl.hsv=function(t){var e=t[0],r=t[1]/100;t=t[2]/100;var n=r,i=Math.max(t,.01);return r*=(t*=2)<=1?t:2-t,n*=i<=1?i:2-i,[e,100*(0===t?2*n/(i+n):2*r/(t+r)),(t+r)/2*100]},o.hsv.rgb=function(t){var e=t[0]/60,r=t[1]/100;t=t[2]/100;var n=Math.floor(e)%6,i=e-Math.floor(e),e=255*t*(1-r),a=255*t*(1-r*i),r=255*t*(1-r*(1-i));switch(t*=255,n){case 0:return[t,r,e];case 1:return[a,t,e];case 2:return[e,t,r];case 3:return[e,a,t];case 4:return[r,e,t];case 5:return[t,e,a]}},o.hsv.hsl=function(t){var e=t[0],r=t[1]/100;t=t[2]/100;var n=Math.max(t,.01),i=(2-r)*n;return[e,100*(n=r*n/(i<=1?i:2-i)||0),(2-r)*t/2*100]},o.hwb.rgb=function(t){var e=t[0]/360,r=t[1]/100;switch(1<(n=r+(t=t[2]/100))&&(r/=n,t/=n),e=6*e-(n=Math.floor(6*e)),e=r+(e=0!=(1&n)?1-e:e)*((t=1-t)-r),n){default:case 6:case 0:var n=t,i=e;break;case 1:n=e,i=t;break;case 2:n=r,i=t,r=e;break;case 3:n=r,i=e,r=t;break;case 4:n=e,i=r,r=t;break;case 5:n=t,i=r,r=e}return[255*n,255*i,255*r]},o.cmyk.rgb=function(t){var e=t[3]/100;return[255*(1-Math.min(1,t[0]/100*(1-e)+e)),255*(1-Math.min(1,t[1]/100*(1-e)+e)),255*(1-Math.min(1,t[2]/100*(1-e)+e))]},o.xyz.rgb=function(t){var e=t[0]/100,r=t[1]/100,n=t[2]/100;t=3.2406*e+-1.5372*r+-.4986*n;var i=-.9689*e+1.8758*r+.0415*n,e=.0557*e+-.204*r+1.057*n;return t=.0031308<t?1.055*Math.pow(t,1/2.4)-.055:12.92*t,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,e=.0031308<e?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(t=Math.min(Math.max(0,t),1)),255*(i=Math.min(Math.max(0,i),1)),255*(e=Math.min(Math.max(0,e),1))]},o.xyz.lab=function(t){var e=t[0],r=t[1];return t=t[2],r/=100,t/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(e-r),200*(r-(t=.008856<t?Math.pow(t,1/3):7.787*t+16/116))]},o.lab.xyz=function(t){var e=t[1],r=t[2],e=e/500+(t=(t[0]+16)/116),r=t-r/200,n=Math.pow(t,3),i=Math.pow(e,3),a=Math.pow(r,3);return[95.047*(.008856<i?i:(e-16/116)/7.787),100*(.008856<n?n:(t-16/116)/7.787),108.883*(.008856<a?a:(r-16/116)/7.787)]},o.lab.lch=function(t){var e=t[0],r=t[1];t=t[2];var n=360*Math.atan2(t,r)/2/Math.PI;return n<0&&(n+=360),[e,Math.sqrt(r*r+t*t),n]},o.lch.lab=function(t){var e=t[0],r=t[1];return t=t[2]/360*2*Math.PI,[e,r*Math.cos(t),r*Math.sin(t)]},o.rgb.ansi16=function(t){var e=t[0],r=t[1],n=t[2],i=1 in arguments?arguments[1]:o.rgb.hsv(t)[2];return 0===(i=Math.round(i/50))?30:(e=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(e/255)),2===i&&(e+=60),e)},o.hsv.ansi16=function(t){return o.rgb.ansi16(o.hsv.rgb(t),t[2])},o.rgb.ansi256=function(t){var e=t[0],r=t[1];return t=t[2],e===r&&r===t?e<8?16:248<e?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(t/255*5)},o.ansi16.rgb=function(t){var e=t%10;return 0===e||7===e?(50<t&&(e+=3.5),[e=e/10.5*255,e,e]):[(1&e)*(t=.5*(1+~~(50<t)))*255,(e>>1&1)*t*255,(e>>2&1)*t*255]},o.ansi256.rgb=function(t){if(232<=t){var e=10*(t-232)+8;return[e,e,e]}return t-=16,[e=Math.floor(t/36)/5*255,Math.floor((t%=36)/6)/5*255,t%6/5*255]},o.rgb.hex=function(t){return t=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase(),"000000".substring(t.length)+t},o.hex.rgb=function(t){if(!(t=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i)))return[0,0,0];var e=t[0];return 3===t[0].length&&(e=e.split("").map(function(t){return t+t}).join("")),[(t=parseInt(e,16))>>16&255,t>>8&255,255&t]},o.rgb.hcg=function(t){var e=t[0]/255,r=t[1]/255;t=t[2]/255;var n=Math.max(Math.max(e,r),t),i=Math.min(Math.min(e,r),t),a=n-i;return[(a<=0?0:n===e?(r-t)/a%6:n===r?2+(t-e)/a:(e-r)/a+8)/6%1*360,100*a,100*(a<1?i/(1-a):0)]},o.hsl.hcg=function(t){var e=t[1]/100,r=t[2]/100,n=0;return(e=r<.5?2*e*r:2*e*(1-r))<1&&(n=(r-.5*e)/(1-e)),[t[0],100*e,100*n]},o.hsv.hcg=function(t){var e=t[2]/100,r=t[1]/100*e,e=r<1?(e-r)/(1-r):0;return[t[0],100*r,100*e]},o.hcg.rgb=function(t){var e=t[1]/100,r=t[2]/100;if(0==e)return[255*r,255*r,255*r];var n=[0,0,0],i=(t=t[0]/360%1*6)%1,a=1-i;switch(Math.floor(t)){case 0:n[0]=1,n[1]=i,n[2]=0;break;case 1:n[0]=a,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=i;break;case 3:n[0]=0,n[1]=a,n[2]=1;break;case 4:n[0]=i,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=a}return r*=1-e,[255*(e*n[0]+r),255*(e*n[1]+r),255*(e*n[2]+r)]},o.hcg.hsv=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e),e=0<r?e/r:0;return[t[0],100*e,100*r]},o.hcg.hsl=function(t){var e=t[1]/100,r=t[2]/100*(1-e)+.5*e,n=0;return 0<r&&r<.5?n=e/(2*r):.5<=r&&r<1&&(n=e/(2*(1-r))),[t[0],100*n,100*r]},o.hcg.hwb=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},o.hwb.hcg=function(t){var e=1-t[2]/100,r=e-t[1]/100,e=r<1?(e-r)/(1-r):0;return[t[0],100*r,100*e]},o.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},o.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},o.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},o.gray.hsl=o.gray.hsv=function(t){return[0,0,t[0]]},o.gray.hwb=function(t){return[0,100,t[0]]},o.gray.cmyk=function(t){return[0,0,0,t[0]]},o.gray.lab=function(t){return[t[0],0,0]},o.gray.hex=function(t){return t=(((t=255&Math.round(t[0]/100*255))<<16)+(t<<8)+t).toString(16).toUpperCase(),"000000".substring(t.length)+t},o.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}),pi={};ke(di).forEach(function(r){pi[r]={},Object.defineProperty(pi[r],"channels",{value:di[r].channels}),Object.defineProperty(pi[r],"labels",{value:di[r].labels});var n=oi(r);ke(n).forEach(function(t){var e=n[t];pi[r][t]=a(e),pi[r][t].raw=i(e)})});var fi=pi,mi=[].slice,gi=["keyword","gray","hex"],vi={};ke(fi).forEach(function(t){vi[mi.call(fi[t].labels).sort().join("")]=t});var yi={};c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in hi.to?this:this.rgb();return t=1===(e=e.round("number"==typeof t?t:1)).valpha?e.color:e.color.concat(this.valpha),hi.to[e.model](t)},percentString:function(t){return t=1===(t=this.rgb().round("number"==typeof t?t:1)).valpha?t.color:t.color.concat(this.valpha),hi.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=fi[this.model].channels,r=fi[this.model].labels,n=0;n<e;n++)t[r[n]]=this.color[n];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new c(this.color.map((e=t,function(t){return Number(t.toFixed(e))})).concat(this.valpha),this.model);var e},alpha:function(t){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:o("rgb",0,s(255)),green:o("rgb",1,s(255)),blue:o("rgb",2,s(255)),hue:o(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:o("hsl",1,s(100)),lightness:o("hsl",2,s(100)),saturationv:o("hsv",1,s(100)),value:o("hsv",2,s(100)),chroma:o("hcg",1,s(100)),gray:o("hcg",2,s(100)),white:o("hwb",1,s(100)),wblack:o("hwb",2,s(100)),cyan:o("cmyk",0,s(100)),magenta:o("cmyk",1,s(100)),yellow:o("cmyk",2,s(100)),black:o("cmyk",3,s(100)),x:o("xyz",0,s(100)),y:o("xyz",1,s(100)),z:o("xyz",2,s(100)),l:o("lab",0,s(100)),a:o("lab",1),b:o("lab",2),keyword:function(t){return arguments.length?new c(t):fi[this.model].keyword(this.color)},hex:function(t){return arguments.length?new c(t):hi.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,e=[],r=0;r<t.length;r++){var n=t[r]/255;e[r]=n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity();return(t=t.luminosity())<e?(e+.05)/(t+.05):(t+.05)/(e+.05)},level:function(t){return 7.1<=(t=this.contrast(t))?"AAA":4.5<=t?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=.3*(t=this.rgb().color)[0]+.59*t[1]+.11*t[2];return c.rgb(t,t,t)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),r=((r=e.color[0])+t)%360;return e.color[0]=r<0?360+r:r,e},mix:function(t,e){if(!t||!t.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(void 0===t?"undefined":xn(t)));t=t.rgb();var r=this.rgb(),n=2*(e=void 0===e?.5:e)-1,i=1-(n=((-1==n*(i=t.alpha()-r.alpha())?n:(n+i)/(1+n*i))+1)/2);return c.rgb(n*t.red()+i*r.red(),n*t.green()+i*r.green(),n*t.blue()+i*r.blue(),t.alpha()*e+r.alpha()*(1-e))}},ke(fi).forEach(function(r){var n;-1===gi.indexOf(r)&&(n=fi[r].channels,c.prototype[r]=function(){if(this.model===r)return new c(this);if(arguments.length)return new c(arguments,r);var t="number"==typeof arguments[n]?n:this.valpha,e=fi[this.model][r].raw(this.color);return new c((e=Array.isArray(e)?e:[e]).concat(t),r)},c[r]=function(t){return new c(t="number"==typeof t?l(mi.call(arguments),n):t,r)})}),g(v.prototype,{equals:function(t){return this.lat===t.lat&&this.lng===t.lng},clone:function(){return new v(this.lat,this.lng)},getLngSpan:function(t){return t=180<(t=Math.abs(t-this.lng))?360-t:t},sub:function(t){return new v(this.lat-t.lat,this.lng-t.lng)},toString:function(){return"Point"}}),g(f,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,e){if(!t||!e)return 0;if(!(t=this.convertMC2LL(t)))return 0;var r=this.toRadians(t.lng);if(t=this.toRadians(t.lat),!(e=this.convertMC2LL(e)))return 0;var n=this.toRadians(e.lng);return e=this.toRadians(e.lat),this.getDistance(r,n,t,e)},getDistanceByLL:function(t,e){if(!t||!e)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74);var r=this.toRadians(t.lng),n=this.toRadians(t.lat);return t=this.toRadians(e.lng),e=this.toRadians(e.lat),this.getDistance(r,t,n,e)},convertMC2LL:function(t){if(null==t)return new v(0,0);if(t.lng<180&&-180<t.lng&&t.lat<90&&-90<t.lat)return t;for(var e=new v(Math.abs(t.lng),Math.abs(t.lat)),r=0;r<this.MCBAND.length;r++)if(e.lat>=this.MCBAND[r]){var n=this.MC2LL[r];break}return new v((t=this.convertor(t,n)).lng.toFixed(6),t.lat.toFixed(6))},convertLL2MC:function(t){if(null==t)return new v(0,0);if(180<t.lng||t.lng<-180||90<t.lat||t.lat<-90)return t;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);for(var e=new v(t.lng,t.lat),r=0;r<this.LLBAND.length;r++)if(e.lat>=this.LLBAND[r]){var n=this.LL2MC[r];break}if(!n)for(r=0;r<this.LLBAND.length;r++)if(e.lat<=-this.LLBAND[r]){n=this.LL2MC[r];break}return t=this.convertor(t,n),new v(Number(t.lng.toFixed(2)),Number(t.lat.toFixed(2)))},convertor:function(t,e){if(t&&e){var r=e[0]+e[1]*Math.abs(t.lng),n=Math.abs(t.lat)/e[9];return e=e[2]+e[3]*n+e[4]*n*n+e[5]*n*n*n+e[6]*n*n*n*n+e[7]*n*n*n*n*n+e[8]*n*n*n*n*n*n,new v(r*=t.lng<0?-1:1,e*=t.lat<0?-1:1)}},getDistance:function(t,e,r,n){return this.EARTHRADIUS*Math.acos(Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos(e-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,e,r){return null!=e&&(t=Math.max(t,e)),t=null!=r?Math.min(t,r):t},getLoop:function(t,e,r){for(;r<t;)t-=r-e;for(;t<e;)t+=r-e;return t}}),g(f.prototype,{lngLatToMercator:function(t){return f.convertLL2MC(t)},lngLatToPoint:function(t){return new y((t=f.convertLL2MC(t)).lng,t.lat)},mercatorToLngLat:function(t){return f.convertMC2LL(t)},pointToLngLat:function(t){return t=new v(t.x,t.y),f.convertMC2LL(t)},pointToPixel:function(t,e,r,n,i){if(t)return t=this.lngLatToMercator(t,i),e=this.getZoomUnits(e),new y(Math.round((t.lng-r.lng)/e+n.width/2),Math.round((r.lat-t.lat)/e+n.height/2))},pixelToPoint:function(t,e,r,n,i){if(t)return e=this.getZoomUnits(e),t=new v(r.lng+e*(t.x-n.width/2),r.lat-e*(t.y-n.height/2)),this.mercatorToLngLat(t,i)},getZoomUnits:function(t){return Math.pow(2,18-t)}}),b.prototype.setMax=function(t){this.max=t||100},b.prototype.setMin=function(t){this.min=t||0},b.prototype.setMaxSize=function(t){this.maxSize=t||35},b.prototype.setMinSize=function(t){this.minSize=t||0},b.prototype.initPalette=function(){var e=this.gradient,t=this.paletteCtx=new x(256,1).getContext("2d"),r=t.createLinearGradient(0,0,256,1);ke(e).forEach(function(t){r.addColorStop(parseFloat(t),e[t])}),t.fillStyle=r,t.fillRect(0,0,256,1),t.imageData=t.getImageData(0,0,256,1).data},b.prototype.getColor=function(t){return"rgba("+(t=this.getImageData(t))[0]+", "+t[1]+", "+t[2]+", "+t[3]/256+")"},b.prototype.getImageData=function(t){var e=this.paletteCtx.imageData;if(void 0===t)return e;var r=this.max,n=this.min;return(t=r<t?r:t)<n&&(t=n),[e[t=4*Math.floor((t-n)/(r-n)*255)],e[t+1],e[t+2],e[t+3]]},b.prototype.getSize=function(t){var e=this.max,r=this.min,n=this.maxSize,i=this.minSize;return i+((t=(t=e<t?e:t)<r?r:t)-r)/(e-r)*(n-i)},_.prototype._initialize=function(){this.v0=this._normalizaCoord(this.options.start),this.v3=this._normalizaCoord(this.options.end),this.v1=this._getControlPoint(this.v0,this.v3,4),this.v2=this._getControlPoint(this.v3,this.v0,5),this.v0[2]||(this.v0[2]=0),this.v3[2]||(this.v3[2]=0)},_.prototype.setOptions=function(t){this.options=t||{},this._initialize()},_.prototype.getPoints=function(t){void 0===t&&(t=20);for(var e=[],r=0;r<=t;r++)e.push(this._getPoint(r/t));return e},_.prototype._normalizaCoord=function(t){return t?[(t=f.convertLL2MC({lng:Number(t[0]),lat:Number(t[1])})).lng,t.lat]:[]},_.prototype._getControlPoint=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return[].concat(Jn(this._getQuarter(t,e)),[this._getDistance(t,e)/r])},_.prototype._getQuarter=function(t,e){return[(3*t[0]+e[0])/4,(3*t[1]+e[1])/4]},_.prototype._getDistance=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},_.prototype._getPoint=function(t){var e=[],r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.push(A(t,r[0],n[0],i[0],a[0]),A(t,r[1],n[1],i[1],a[1]),A(t,r[2],n[2],i[2],a[2])),e},w.prototype._initialize=function(){this.points=this.options.points||this.options.point||[],this.greatCirclePoints=[];for(var t=[],e=0;e<this.points.length;e++){var r=this._normalizaCoord(this.points[e]);r&&t.push(r)}this.points=t},w.prototype.setOptions=function(t){this.options=t||{},this._initialize()},w.prototype.getPoints=function(){if(0===this.greatCirclePoints.length)for(var t=0;t<this.points.length-1;t++)this._calcGreatCirclePoints(this.points[t],this.points[t+1]);return this.greatCirclePoints},w.prototype._normalizaCoord=function(t){if(!t)return null;t instanceof Array&&(t={lng:Number(t[0]),lat:Number(t[1])});var e=f.convertLL2MC(t);return t=f.convertMC2LL(t),e.latLng=t,e},w.prototype._calcGreatCirclePoints=function(t,e){var r=t.latLng,n=e.latLng;if((!p(r.lng,n.lng)||!p(r.lat,n.lat))&&!((i=f.getDistance(u(r.lng),u(r.lat),u(n.lng),u(n.lat)))<25e4)){var i=Math.round(i/15e4),a=this._calcAngularDistance(r,n);this.greatCirclePoints.push([t.lng,t.lat]);for(var o=0;o<i;o++){var s=this._calcMiddlePoint(r,n,o/i,a),l=M(s=f.convertLL2MC(s),t);30037726<l&&(s.lng=s.lng<t.lng?s.lng+this.WORLD_SIZE_MC:s.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([s.lng,s.lat]),t=s}30037726<(l=M(e,t))&&(e.lng=e.lng<t.lng?e.lng+this.WORLD_SIZE_MC:e.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([e.lng,e.lat])}},w.prototype._calcAngularDistance=function(t,e){var r=u(t.lat),n=u(e.lat);return t=u(t.lng),e=u(e.lng),Math.acos(Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos(Math.abs(e-t)))},w.prototype._calcMiddlePoint=function(t,e,r,n){var i=e.lat,a=t.lng;e=e.lng,t=u(t.lat);var i=u(i),a=u(a),o=u(e);return e=Math.sin((1-r)*n)/Math.sin(n),n=Math.sin(r*n)/Math.sin(n),r=e*Math.cos(t)*Math.cos(a)+n*Math.cos(i)*Math.cos(o),a=e*Math.cos(t)*Math.sin(a)+n*Math.cos(i)*Math.sin(o),t=Math.atan2(e*Math.sin(t)+n*Math.sin(i),Math.sqrt(Math.pow(r,2)+Math.pow(a,2))),new v(h(Math.atan2(a,r)),h(t))};var xi=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};he(this,e),this.options=t,this._initialize()}return ar(e,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(t){return t?(t instanceof Array&&(t={lng:Number(t[0]),lat:Number(t[1])}),f.convertLL2MC(t)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(t){for(var e=[],r=this.points,n=0;n<r.length-1;n++){var i=this.getCurveByTwoPoints(this._normalizaCoord(r[n]),this._normalizaCoord(r[n+1]),t);i&&0<i.length&&(e=e.concat(i))}return e}},{key:"getCurveByTwoPoints",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:20;if(!t||!e)return null;var n=[],i=0;if(void 0!==(void 0===e?"undefined":xn(e))){var a=parseFloat(t.lat),o=parseFloat(e.lat),s=parseFloat(t.lng),l=parseFloat(e.lng);s<l&&180<parseFloat(l-s)&&s<0&&(s=parseFloat(360+s),l=parseFloat(360+l));var u,c=0,h=o===a?(u=0,s-l):l===s?(u=Math.PI/2,a-o):(u=Math.atan((o-a)/(l-s)),(o-a)/Math.sin(u));for(0===c&&(c=u+Math.PI/5),u=(h/=2)*Math.cos(c)+s,c=h*Math.sin(c)+a,h=0;h<r+1;h++){var d=s*(1-2*i+i*i)+u*(2*i-2*i*i)+l*i*i,p=e.lng;n.push([t.lng<0&&0<p?d-360:d,a*(1-2*i+i*i)+c*(2*i-2*i*i)+o*i*i]),i+=1/r}return n}void 0===n||xn(n)}}]),e}(),bi=[{n:"北京",g:"116.395645,39.929986|12"},{n:"上海",g:"121.487899,31.249162|12"},{n:"天津",g:"117.210813,39.14393|12"},{n:"重庆",g:"106.530635,29.544606|12"}],_i=[{n:"安徽",g:"117.216005,31.859252|8",cities:[{n:"合肥",g:"117.282699,31.866942|12"},{n:"安庆",g:"117.058739,30.537898|13"},{n:"蚌埠",g:"117.35708,32.929499|13"},{n:"亳州",g:"115.787928,33.871211|13"},{n:"巢湖",g:"117.88049,31.608733|13"},{n:"池州",g:"117.494477,30.660019|14"},{n:"滁州",g:"118.32457,32.317351|13"},{n:"阜阳",g:"115.820932,32.901211|13"},{n:"淮北",g:"116.791447,33.960023|13"},{n:"淮南",g:"117.018639,32.642812|13"},{n:"黄山",g:"118.29357,29.734435|13"},{n:"六安",g:"116.505253,31.755558|13"},{n:"马鞍山",g:"118.515882,31.688528|13"},{n:"宿州",g:"116.988692,33.636772|13"},{n:"铜陵",g:"117.819429,30.94093|14"},{n:"芜湖",g:"118.384108,31.36602|12"},{n:"宣城",g:"118.752096,30.951642|13"}]},{n:"福建",g:"117.984943,26.050118|8",cities:[{n:"福州",g:"119.330221,26.047125|12"},{n:"龙岩",g:"117.017997,25.078685|13"},{n:"南平",g:"118.181883,26.643626|13"},{n:"宁德",g:"119.542082,26.656527|14"},{n:"莆田",g:"119.077731,25.44845|13"},{n:"泉州",g:"118.600362,24.901652|12"},{n:"三明",g:"117.642194,26.270835|14"},{n:"厦门",g:"118.103886,24.489231|12"},{n:"漳州",g:"117.676205,24.517065|12"}]},{n:"甘肃",g:"102.457625,38.103267|6",cities:[{n:"兰州",g:"103.823305,36.064226|12"},{n:"白银",g:"104.171241,36.546682|13"},{n:"定西",g:"104.626638,35.586056|13"},{n:"甘南州",g:"102.917442,34.992211|14"},{n:"嘉峪关",g:"98.281635,39.802397|13"},{n:"金昌",g:"102.208126,38.516072|13"},{n:"酒泉",g:"98.508415,39.741474|13"},{n:"临夏州",g:"103.215249,35.598514|13"},{n:"陇南",g:"104.934573,33.39448|14"},{n:"平凉",g:"106.688911,35.55011|13"},{n:"庆阳",g:"107.644227,35.726801|13"},{n:"天水",g:"105.736932,34.584319|13"},{n:"武威",g:"102.640147,37.933172|13"},{n:"张掖",g:"100.459892,38.93932|13"}]},{n:"广东",g:"113.394818,23.408004|8",cities:[{n:"广州",g:"113.30765,23.120049|12"},{n:"潮州",g:"116.630076,23.661812|13"},{n:"东莞",g:"113.763434,23.043024|12"},{n:"佛山",g:"113.134026,23.035095|13"},{n:"河源",g:"114.713721,23.757251|12"},{n:"惠州",g:"114.410658,23.11354|12"},{n:"江门",g:"113.078125,22.575117|13"},{n:"揭阳",g:"116.379501,23.547999|13"},{n:"茂名",g:"110.931245,21.668226|13"},{n:"梅州",g:"116.126403,24.304571|13"},{n:"清远",g:"113.040773,23.698469|13"},{n:"汕头",g:"116.72865,23.383908|13"},{n:"汕尾",g:"115.372924,22.778731|14"},{n:"韶关",g:"113.594461,24.80296|13"},{n:"深圳",g:"114.025974,22.546054|12"},{n:"阳江",g:"111.97701,21.871517|14"},{n:"云浮",g:"112.050946,22.937976|13"},{n:"湛江",g:"110.365067,21.257463|13"},{n:"肇庆",g:"112.479653,23.078663|13"},{n:"中山",g:"113.42206,22.545178|12"},{n:"珠海",g:"113.562447,22.256915|13"}]},{n:"广西",g:"108.924274,23.552255|7",cities:[{n:"南宁",g:"108.297234,22.806493|12"},{n:"百色",g:"106.631821,23.901512|13"},{n:"北海",g:"109.122628,21.472718|13"},{n:"崇左",g:"107.357322,22.415455|14"},{n:"防城港",g:"108.351791,21.617398|15"},{n:"桂林",g:"110.26092,25.262901|12"},{n:"贵港",g:"109.613708,23.103373|13"},{n:"河池",g:"108.069948,24.699521|14"},{n:"贺州",g:"111.552594,24.411054|14"},{n:"来宾",g:"109.231817,23.741166|14"},{n:"柳州",g:"109.422402,24.329053|12"},{n:"钦州",g:"108.638798,21.97335|13"},{n:"梧州",g:"111.305472,23.485395|13"},{n:"玉林",g:"110.151676,22.643974|14"}]},{n:"贵州",g:"106.734996,26.902826|8",cities:[{n:"贵阳",g:"106.709177,26.629907|12"},{n:"安顺",g:"105.92827,26.228595|13"},{n:"毕节地区",g:"105.300492,27.302612|14"},{n:"六盘水",g:"104.852087,26.591866|13"},{n:"铜仁地区",g:"109.196161,27.726271|14"},{n:"遵义",g:"106.93126,27.699961|13"},{n:"黔西南州",g:"104.900558,25.095148|11"},{n:"黔东南州",g:"107.985353,26.583992|11"},{n:"黔南州",g:"107.523205,26.264536|11"}]},{n:"海南",g:"109.733755,19.180501|9",cities:[{n:"海口",g:"110.330802,20.022071|13"},{n:"白沙",g:"109.358586,19.216056|12"},{n:"保亭",g:"109.656113,18.597592|12"},{n:"昌江",g:"109.0113,19.222483|12"},{n:"儋州",g:"109.413973,19.571153|13"},{n:"澄迈",g:"109.996736,19.693135|13"},{n:"东方",g:"108.85101,18.998161|13"},{n:"定安",g:"110.32009,19.490991|13"},{n:"琼海",g:"110.414359,19.21483|13"},{n:"琼中",g:"109.861849,19.039771|12"},{n:"乐东",g:"109.062698,18.658614|12"},{n:"临高",g:"109.724101,19.805922|13"},{n:"陵水",g:"109.948661,18.575985|12"},{n:"三亚",g:"109.522771,18.257776|12"},{n:"屯昌",g:"110.063364,19.347749|13"},{n:"万宁",g:"110.292505,18.839886|13"},{n:"文昌",g:"110.780909,19.750947|13"},{n:"五指山",g:"109.51775,18.831306|13"}]},{n:"河北",g:"115.661434,38.61384|7",cities:[{n:"石家庄",g:"114.522082,38.048958|12"},{n:"保定",g:"115.49481,38.886565|13"},{n:"沧州",g:"116.863806,38.297615|13"},{n:"承德",g:"117.933822,40.992521|14"},{n:"邯郸",g:"114.482694,36.609308|13"},{n:"衡水",g:"115.686229,37.746929|13"},{n:"廊坊",g:"116.703602,39.518611|13"},{n:"秦皇岛",g:"119.604368,39.945462|12"},{n:"唐山",g:"118.183451,39.650531|13"},{n:"邢台",g:"114.520487,37.069531|13"},{n:"张家口",g:"114.893782,40.811188|13"}]},{n:"河南",g:"113.486804,34.157184|7",cities:[{n:"郑州",g:"113.649644,34.75661|12"},{n:"安阳",g:"114.351807,36.110267|12"},{n:"鹤壁",g:"114.29777,35.755426|13"},{n:"焦作",g:"113.211836,35.234608|13"},{n:"开封",g:"114.351642,34.801854|13"},{n:"洛阳",g:"112.447525,34.657368|12"},{n:"漯河",g:"114.046061,33.576279|13"},{n:"南阳",g:"112.542842,33.01142|13"},{n:"平顶山",g:"113.300849,33.745301|13"},{n:"濮阳",g:"115.026627,35.753298|12"},{n:"三门峡",g:"111.181262,34.78332|13"},{n:"商丘",g:"115.641886,34.438589|13"},{n:"新乡",g:"113.91269,35.307258|13"},{n:"信阳",g:"114.085491,32.128582|13"},{n:"许昌",g:"113.835312,34.02674|13"},{n:"周口",g:"114.654102,33.623741|13"},{n:"驻马店",g:"114.049154,32.983158|13"}]},{n:"黑龙江",g:"128.047414,47.356592|6",cities:[{n:"哈尔滨",g:"126.657717,45.773225|12"},{n:"大庆",g:"125.02184,46.596709|12"},{n:"大兴安岭地区",g:"124.196104,51.991789|10"},{n:"鹤岗",g:"130.292472,47.338666|13"},{n:"黑河",g:"127.50083,50.25069|14"},{n:"鸡西",g:"130.941767,45.32154|13"},{n:"佳木斯",g:"130.284735,46.81378|12"},{n:"牡丹江",g:"129.608035,44.588521|13"},{n:"七台河",g:"131.019048,45.775005|14"},{n:"齐齐哈尔",g:"123.987289,47.3477|13"},{n:"双鸭山",g:"131.171402,46.655102|13"},{n:"绥化",g:"126.989095,46.646064|13"},{n:"伊春",g:"128.910766,47.734685|14"}]},{n:"湖北",g:"112.410562,31.209316|8",cities:[{n:"武汉",g:"114.3162,30.581084|12"},{n:"鄂州",g:"114.895594,30.384439|14"},{n:"恩施",g:"109.517433,30.308978|14"},{n:"黄冈",g:"114.906618,30.446109|14"},{n:"黄石",g:"115.050683,30.216127|13"},{n:"荆门",g:"112.21733,31.042611|13"},{n:"荆州",g:"112.241866,30.332591|12"},{n:"潜江",g:"112.768768,30.343116|13"},{n:"神农架林区",g:"110.487231,31.595768|13"},{n:"十堰",g:"110.801229,32.636994|13"},{n:"随州",g:"113.379358,31.717858|13"},{n:"天门",g:"113.12623,30.649047|13"},{n:"仙桃",g:"113.387448,30.293966|13"},{n:"咸宁",g:"114.300061,29.880657|13"},{n:"襄阳",g:"112.176326,32.094934|12"},{n:"孝感",g:"113.935734,30.927955|13"},{n:"宜昌",g:"111.310981,30.732758|13"}]},{n:"湖南",g:"111.720664,27.695864|7",cities:[{n:"长沙",g:"112.979353,28.213478|12"},{n:"常德",g:"111.653718,29.012149|12"},{n:"郴州",g:"113.037704,25.782264|13"},{n:"衡阳",g:"112.583819,26.898164|13"},{n:"怀化",g:"109.986959,27.557483|13"},{n:"娄底",g:"111.996396,27.741073|13"},{n:"邵阳",g:"111.461525,27.236811|13"},{n:"湘潭",g:"112.935556,27.835095|13"},{n:"湘西州",g:"109.745746,28.317951|14"},{n:"益阳",g:"112.366547,28.588088|13"},{n:"永州",g:"111.614648,26.435972|13"},{n:"岳阳",g:"113.146196,29.378007|13"},{n:"张家界",g:"110.48162,29.124889|13"},{n:"株洲",g:"113.131695,27.827433|13"}]},{n:"江苏",g:"119.368489,33.013797|8",cities:[{n:"南京",g:"118.778074,32.057236|12"},{n:"常州",g:"119.981861,31.771397|12"},{n:"淮安",g:"119.030186,33.606513|12"},{n:"连云港",g:"119.173872,34.601549|12"},{n:"南通",g:"120.873801,32.014665|12"},{n:"苏州",g:"120.619907,31.317987|12"},{n:"宿迁",g:"118.296893,33.95205|13"},{n:"泰州",g:"119.919606,32.476053|13"},{n:"无锡",g:"120.305456,31.570037|12"},{n:"徐州",g:"117.188107,34.271553|12"},{n:"盐城",g:"120.148872,33.379862|12"},{n:"扬州",g:"119.427778,32.408505|13"},{n:"镇江",g:"119.455835,32.204409|13"}]},{n:"江西",g:"115.676082,27.757258|7",cities:[{n:"南昌",g:"115.893528,28.689578|12"},{n:"抚州",g:"116.360919,27.954545|13"},{n:"赣州",g:"114.935909,25.845296|13"},{n:"吉安",g:"114.992039,27.113848|13"},{n:"景德镇",g:"117.186523,29.303563|12"},{n:"九江",g:"115.999848,29.71964|13"},{n:"萍乡",g:"113.859917,27.639544|13"},{n:"上饶",g:"117.955464,28.457623|13"},{n:"新余",g:"114.947117,27.822322|13"},{n:"宜春",g:"114.400039,27.81113|13"},{n:"鹰潭",g:"117.03545,28.24131|13"}]},{n:"吉林",g:"126.262876,43.678846|7",cities:[{n:"长春",g:"125.313642,43.898338|12"},{n:"白城",g:"122.840777,45.621086|13"},{n:"白山",g:"126.435798,41.945859|13"},{n:"吉林",g:"126.564544,43.871988|12"},{n:"辽源",g:"125.133686,42.923303|13"},{n:"四平",g:"124.391382,43.175525|12"},{n:"松原",g:"124.832995,45.136049|13"},{n:"通化",g:"125.94265,41.736397|13"},{n:"延边",g:"129.485902,42.896414|13"}]},{n:"辽宁",g:"122.753592,41.6216|8",cities:[{n:"沈阳",g:"123.432791,41.808645|12"},{n:"鞍山",g:"123.007763,41.118744|13"},{n:"本溪",g:"123.778062,41.325838|12"},{n:"朝阳",g:"120.446163,41.571828|13"},{n:"大连",g:"121.593478,38.94871|12"},{n:"丹东",g:"124.338543,40.129023|12"},{n:"抚顺",g:"123.92982,41.877304|12"},{n:"阜新",g:"121.660822,42.01925|14"},{n:"葫芦岛",g:"120.860758,40.74303|13"},{n:"锦州",g:"121.147749,41.130879|13"},{n:"辽阳",g:"123.172451,41.273339|14"},{n:"盘锦",g:"122.073228,41.141248|13"},{n:"铁岭",g:"123.85485,42.299757|13"},{n:"营口",g:"122.233391,40.668651|13"}]},{n:"内蒙古",g:"114.415868,43.468238|5",cities:[{n:"呼和浩特",g:"111.660351,40.828319|12"},{n:"阿拉善盟",g:"105.695683,38.843075|14"},{n:"包头",g:"109.846239,40.647119|12"},{n:"巴彦淖尔",g:"107.423807,40.76918|12"},{n:"赤峰",g:"118.930761,42.297112|12"},{n:"鄂尔多斯",g:"109.993706,39.81649|12"},{n:"呼伦贝尔",g:"119.760822,49.201636|12"},{n:"通辽",g:"122.260363,43.633756|12"},{n:"乌海",g:"106.831999,39.683177|13"},{n:"乌兰察布",g:"113.112846,41.022363|12"},{n:"锡林郭勒盟",g:"116.02734,43.939705|11"},{n:"兴安盟",g:"122.048167,46.083757|11"}]},{n:"宁夏",g:"106.155481,37.321323|8",cities:[{n:"银川",g:"106.206479,38.502621|12"},{n:"固原",g:"106.285268,36.021523|13"},{n:"石嘴山",g:"106.379337,39.020223|13"},{n:"吴忠",g:"106.208254,37.993561|14"},{n:"中卫",g:"105.196754,37.521124|14"}]},{n:"青海",g:"96.202544,35.499761|7",cities:[{n:"西宁",g:"101.767921,36.640739|12"},{n:"果洛州",g:"100.223723,34.480485|11"},{n:"海东地区",g:"102.085207,36.51761|11"},{n:"海北州",g:"100.879802,36.960654|11"},{n:"海南州",g:"100.624066,36.284364|11"},{n:"海西州",g:"97.342625,37.373799|11"},{n:"黄南州",g:"102.0076,35.522852|11"},{n:"玉树州",g:"97.013316,33.00624|14"}]},{n:"山东",g:"118.527663,36.09929|8",cities:[{n:"济南",g:"117.024967,36.682785|12"},{n:"滨州",g:"117.968292,37.405314|12"},{n:"东营",g:"118.583926,37.487121|12"},{n:"德州",g:"116.328161,37.460826|12"},{n:"菏泽",g:"115.46336,35.26244|13"},{n:"济宁",g:"116.600798,35.402122|13"},{n:"莱芜",g:"117.684667,36.233654|13"},{n:"聊城",g:"115.986869,36.455829|12"},{n:"临沂",g:"118.340768,35.072409|12"},{n:"青岛",g:"120.384428,36.105215|12"},{n:"日照",g:"119.50718,35.420225|12"},{n:"泰安",g:"117.089415,36.188078|13"},{n:"威海",g:"122.093958,37.528787|13"},{n:"潍坊",g:"119.142634,36.716115|12"},{n:"烟台",g:"121.309555,37.536562|12"},{n:"枣庄",g:"117.279305,34.807883|13"},{n:"淄博",g:"118.059134,36.804685|12"}]},{n:"山西",g:"112.515496,37.866566|7",cities:[{n:"太原",g:"112.550864,37.890277|12"},{n:"长治",g:"113.120292,36.201664|12"},{n:"大同",g:"113.290509,40.113744|12"},{n:"晋城",g:"112.867333,35.499834|13"},{n:"晋中",g:"112.738514,37.693362|13"},{n:"临汾",g:"111.538788,36.099745|13"},{n:"吕梁",g:"111.143157,37.527316|14"},{n:"朔州",g:"112.479928,39.337672|13"},{n:"忻州",g:"112.727939,38.461031|12"},{n:"阳泉",g:"113.569238,37.869529|13"},{n:"运城",g:"111.006854,35.038859|13"}]},{n:"陕西",g:"109.503789,35.860026|7",cities:[{n:"西安",g:"108.953098,34.2778|12"},{n:"安康",g:"109.038045,32.70437|13"},{n:"宝鸡",g:"107.170645,34.364081|12"},{n:"汉中",g:"107.045478,33.081569|13"},{n:"商洛",g:"109.934208,33.873907|13"},{n:"铜川",g:"108.968067,34.908368|13"},{n:"渭南",g:"109.483933,34.502358|13"},{n:"咸阳",g:"108.707509,34.345373|13"},{n:"延安",g:"109.50051,36.60332|13"},{n:"榆林",g:"109.745926,38.279439|12"}]},{n:"四川",g:"102.89916,30.367481|7",cities:[{n:"成都",g:"104.067923,30.679943|12"},{n:"阿坝州",g:"102.228565,31.905763|15"},{n:"巴中",g:"106.757916,31.869189|14"},{n:"达州",g:"107.494973,31.214199|14"},{n:"德阳",g:"104.402398,31.13114|13"},{n:"甘孜州",g:"101.969232,30.055144|15"},{n:"广安",g:"106.63572,30.463984|13"},{n:"广元",g:"105.819687,32.44104|13"},{n:"乐山",g:"103.760824,29.600958|13"},{n:"凉山州",g:"102.259591,27.892393|14"},{n:"泸州",g:"105.44397,28.89593|14"},{n:"南充",g:"106.105554,30.800965|13"},{n:"眉山",g:"103.84143,30.061115|13"},{n:"绵阳",g:"104.705519,31.504701|12"},{n:"内江",g:"105.073056,29.599462|13"},{n:"攀枝花",g:"101.722423,26.587571|14"},{n:"遂宁",g:"105.564888,30.557491|12"},{n:"雅安",g:"103.009356,29.999716|13"},{n:"宜宾",g:"104.633019,28.769675|13"},{n:"资阳",g:"104.63593,30.132191|13"},{n:"自贡",g:"104.776071,29.359157|13"}]},{n:"西藏",g:"89.137982,31.367315|6",cities:[{n:"拉萨",g:"91.111891,29.662557|13"},{n:"阿里地区",g:"81.107669,30.404557|11"},{n:"昌都地区",g:"97.185582,31.140576|15"},{n:"林芝地区",g:"94.349985,29.666941|11"},{n:"那曲地区",g:"92.067018,31.48068|14"},{n:"日喀则地区",g:"88.891486,29.269023|14"},{n:"山南地区",g:"91.750644,29.229027|11"}]},{n:"新疆",g:"85.614899,42.127001|6",cities:[{n:"乌鲁木齐",g:"87.564988,43.84038|12"},{n:"阿拉尔",g:"81.291737,40.61568|13"},{n:"阿克苏地区",g:"80.269846,41.171731|12"},{n:"阿勒泰地区",g:"88.137915,47.839744|13"},{n:"巴音郭楞",g:"86.121688,41.771362|12"},{n:"博尔塔拉州",g:"82.052436,44.913651|11"},{n:"昌吉州",g:"87.296038,44.007058|13"},{n:"哈密地区",g:"93.528355,42.858596|13"},{n:"和田地区",g:"79.930239,37.116774|13"},{n:"喀什地区",g:"75.992973,39.470627|12"},{n:"克拉玛依",g:"84.88118,45.594331|13"},{n:"克孜勒苏州",g:"76.137564,39.750346|11"},{n:"石河子",g:"86.041865,44.308259|13"},{n:"塔城地区",g:"82.974881,46.758684|12"},{n:"图木舒克",g:"79.198155,39.889223|13"},{n:"吐鲁番地区",g:"89.181595,42.96047|13"},{n:"五家渠",g:"87.565449,44.368899|13"},{n:"伊犁州",g:"81.297854,43.922248|11"}]},{n:"云南",g:"101.592952,24.864213|7",cities:[{n:"昆明",g:"102.714601,25.049153|12"},{n:"保山",g:"99.177996,25.120489|13"},{n:"楚雄州",g:"101.529382,25.066356|13"},{n:"大理州",g:"100.223675,25.5969|14"},{n:"德宏州",g:"98.589434,24.44124|14"},{n:"迪庆州",g:"99.713682,27.831029|14"},{n:"红河州",g:"103.384065,23.367718|11"},{n:"丽江",g:"100.229628,26.875351|13"},{n:"临沧",g:"100.092613,23.887806|14"},{n:"怒江州",g:"98.859932,25.860677|14"},{n:"普洱",g:"100.980058,22.788778|14"},{n:"曲靖",g:"103.782539,25.520758|12"},{n:"昭通",g:"103.725021,27.340633|13"},{n:"文山",g:"104.089112,23.401781|14"},{n:"西双版纳",g:"100.803038,22.009433|13"},{n:"玉溪",g:"102.545068,24.370447|13"}]},{n:"浙江",g:"119.957202,29.159494|8",cities:[{n:"杭州",g:"120.219375,30.259244|12"},{n:"湖州",g:"120.137243,30.877925|12"},{n:"嘉兴",g:"120.760428,30.773992|13"},{n:"金华",g:"119.652576,29.102899|12"},{n:"丽水",g:"119.929576,28.4563|13"},{n:"宁波",g:"121.579006,29.885259|12"},{n:"衢州",g:"118.875842,28.95691|12"},{n:"绍兴",g:"120.592467,30.002365|13"},{n:"台州",g:"121.440613,28.668283|13"},{n:"温州",g:"120.690635,28.002838|12"},{n:"舟山",g:"122.169872,30.03601|13"}]}],Ai=[{n:"香港",g:"114.186124,22.293586|11"},{n:"澳门",g:"113.557519,22.204118|13"},{n:"台湾",g:"120.961454,23.80406|8"}],wi=void 0,Mi=function(){if(void 0!==wi)return wi;var t=navigator.userAgent,e="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");wi=!1;for(var r=0;r<e.length;r++)if(0<t.indexOf(e[r])){wi=!0;break}return wi}(),Ci=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ti=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Si=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ei=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ii=Array(576);T(Ii);var Li=Array(60);T(Li);var Ri=Array(512);T(Ri);var Pi=Array(256);T(Pi);var Di=Array(29);T(Di);var Oi=Array(30);function Fi(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function Bi(t,e,r){t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,Fi(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function Ni(t,e,r){Bi(t,r[2*e],r[2*e+1])}function zi(t,e){for(var r=0;r|=1&t,t>>>=1,r<<=1,0<--e;);return r>>>1}function Ui(t,e,r){for(var n=Array(16),i=0,a=1;a<=15;a++)n[a]=i=i+r[a-1]<<1;for(r=0;r<=e;r++)0!==(i=t[2*r+1])&&(t[2*r]=zi(n[i]++,i))}function ki(t){for(var e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function Hi(t){8<t.bi_valid?Fi(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function Gi(t,e,r,n){var i=2*e,a=2*r;return t[i]<t[a]||t[i]===t[a]&&n[e]<=n[r]}function Vi(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&Gi(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!Gi(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function Wi(t,e,r){var n=0;if(0!==t.last_lit)do{var i,a,o=t.pending_buf[t.d_buf+2*n]<<8|t.pending_buf[t.d_buf+2*n+1],s=t.pending_buf[t.l_buf+n]}while(n++,0===o?Ni(t,s,e):(i=Pi[s],Ni(t,i+256+1,e),0!==(a=Ci[i])&&(s-=Di[i],Bi(t,s,a)),i=--o<256?Ri[o]:Ri[256+(o>>>7)],Ni(t,i,r),0!==(a=Ti[i])&&(o-=Oi[i],Bi(t,o,a))),n<t.last_lit);Ni(t,256,e)}function ji(t,e){var r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.elems,o=-1;for(t.heap_len=0,t.heap_max=573,l=0;l<a;l++)0!==r[2*l]?(t.heap[++t.heap_len]=o=l,t.depth[l]=0):r[2*l+1]=0;for(;t.heap_len<2;){var s=t.heap[++t.heap_len]=o<2?++o:0;r[2*s]=1,t.depth[s]=0,t.opt_len--,i&&(t.static_len-=n[2*s+1])}for(e.max_code=o,l=t.heap_len>>1;1<=l;l--)Vi(t,r,l);for(s=a;l=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Vi(t,r,1),n=t.heap[1],t.heap[--t.heap_max]=l,t.heap[--t.heap_max]=n,r[2*s]=r[2*l]+r[2*n],t.depth[s]=(t.depth[l]>=t.depth[n]?t.depth[l]:t.depth[n])+1,r[2*l+1]=r[2*n+1]=s,t.heap[1]=s++,Vi(t,r,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1];var l=e.dyn_tree,s=e.max_code,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,c=e.stat_desc.max_length,h=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(l[2*t.heap[t.heap_max]+1]=0,e=t.heap_max+1;e<573;e++){var d,p,f,m=t.heap[e];c<(f=l[2*l[2*m+1]+1]+1)&&(f=c,h++),l[2*m+1]=f,s<m||(t.bl_count[f]++,d=0,u<=m&&(d=a[m-u]),p=l[2*m],t.opt_len+=p*(f+d),i&&(t.static_len+=p*(n[2*m+1]+d)))}if(0!==h){do{for(f=c-1;0===t.bl_count[f];)f--}while(t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[c]--,0<(h-=2));for(f=c;0!==f;f--)for(m=t.bl_count[f];0!==m;)s<(n=t.heap[--e])||(l[2*n+1]!==f&&(t.opt_len+=(f-l[2*n+1])*l[2*n],l[2*n+1]=f),m--)}Ui(r,o,t.bl_count)}function Xi(t,e,r){var n,i=-1,a=0,o=7,s=4;for(0===(u=e[1])&&(o=138,s=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++){var l=u,u=e[2*(n+1)+1];++a<o&&l===u||(a<s?t.bl_tree[2*l]+=a:0!==l?(l!==i&&t.bl_tree[2*l]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,i=l,s=(a=0)===u?(o=138,3):l===u?(o=6,3):(o=7,4))}}function qi(t,e,r){var n,i=-1,a=0,o=7,s=4;for(0===(u=e[1])&&(o=138,s=3),n=0;n<=r;n++){var l=u,u=e[2*(n+1)+1];if(!(++a<o&&l===u)){if(a<s)for(;Ni(t,l,t.bl_tree),0!=--a;);else 0!==l?(l!==i&&(Ni(t,l,t.bl_tree),a--),Ni(t,16,t.bl_tree),Bi(t,a-3,2)):a<=10?(Ni(t,17,t.bl_tree),Bi(t,a-3,3)):(Ni(t,18,t.bl_tree),Bi(t,a-11,7));i=l,s=(a=0)===u?(o=138,3):l===u?(o=6,3):(o=7,4)}}}function Yi(t,e,r,n){Bi(t,n?1:0,3),Hi(t),Fi(t,r),Fi(t,~r),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r}function Zi(t,e,r,n){var i,a=65535&t|0;for(t=t>>>16&65535|0;0!==r;){for(i=2e3<r?2e3:r,r-=i;a=a+e[n++]|0,t=t+a|0,--i;);a%=65521,t%=65521}return a|t<<16|0}function Ji(t,e,r,n){for(r=n+r,t^=-1;n<r;n++)t=t>>>8^fa[255&(t^e[n])];return-1^t}function Ki(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(Pi[r]+256+1)]++,t.dyn_dtree[2*(e<256?Ri[e]:Ri[256+(e>>>7)])]++),t.last_lit===t.lit_bufsize-1}function Qi(t,e){return t.msg=ma[e],e}function $i(t){for(var e=t.length;0<=--e;)t[e]=0}function ta(t,e,r){return(e<<t.hash_shift^r)&t.hash_mask}function ea(t){var e=t.state,r=e.pending;0!==(r=r>t.avail_out?t.avail_out:r)&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function ra(t,e){var r=0<=t.block_start?t.block_start:-1,n=t.strstart-t.block_start,i=0;if(0<t.level){for(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,r=0;r<=31;r++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*r])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(r=32;r<256;r++)if(0!==t.dyn_ltree[2*r])return 1;return 0}(t)),ji(t,t.l_desc),ji(t,t.d_desc),Xi(t,t.dyn_ltree,t.l_desc.max_code),Xi(t,t.dyn_dtree,t.d_desc.max_code),ji(t,t.bl_desc),i=18;3<=i&&0===t.bl_tree[2*Ei[i]+1];i--);t.opt_len+=3*(i+1)+14;var a=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3;o<=a&&(a=o)}else a=o=n+5;if(n+4<=a&&-1!==r)Yi(t,r,n,e);else if(4===t.strategy||o===a)Bi(t,2+(e?1:0),3),Wi(t,Ii,Li);else{for(Bi(t,4+(e?1:0),3),r=t.l_desc.max_code+1,n=t.d_desc.max_code+1,i+=1,Bi(t,r-257,5),Bi(t,n-1,5),Bi(t,i-4,4),a=0;a<i;a++)Bi(t,t.bl_tree[2*Ei[a]+1],3);qi(t,t.dyn_ltree,r-1),qi(t,t.dyn_dtree,n-1),Wi(t,t.dyn_ltree,t.dyn_dtree)}ki(t),e&&Hi(t),t.block_start=t.strstart,ea(t.strm)}function na(t,e){t.pending_buf[t.pending++]=e}function ia(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function aa(t,e){var r=t.max_chain_length,n=t.strstart,i=t.prev_length,a=t.nice_match,o=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,s=t.window,l=t.w_mask,u=t.prev,c=t.strstart+258,h=s[n+i-1],d=s[n+i];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{var p=e;if(s[p+i]===d&&s[p+i-1]===h&&s[p]===s[n]&&s[++p]===s[n+1]){for(n+=2,p++;s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&s[++n]===s[++p]&&n<c;);if(p=258-(c-n),n=c-258,i<p){if(t.match_start=e,a<=(i=p))break;h=s[n+i-1],d=s[n+i]}}}while((e=u[e&l])>o&&0!=--r);return i<=t.lookahead?i:t.lookahead}function oa(t){var e=t.w_size;do{var r=t.window_size-t.lookahead-t.strstart;if(t.strstart>=e+(e-262)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e;var n=a=t.hash_size;do{var i=t.head[--n]}while(t.head[n]=e<=i?i-e:0,--a);for(n=a=e;i=t.prev[--n],t.prev[n]=e<=i?i-e:0,--a;);r+=e}if(0===t.strm.avail_in)break;var n=t.strm,a=t.window,i=t.strstart+t.lookahead,o=n.avail_in;if(a=0===(o=r<o?r:o)?0:(n.avail_in-=o,a.set(n.input.subarray(n.next_in,n.next_in+o),i),1===n.state.wrap?n.adler=Zi(n.adler,a,o,i):2===n.state.wrap&&(n.adler=Ji(n.adler,a,o,i)),n.next_in+=o,n.total_in+=o,o),t.lookahead+=a,3<=t.lookahead+t.insert)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=ta(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=ta(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function sa(t){if(!t||!t.state)return Qi(t,wa);t.total_in=t.total_out=0,t.data_type=Pa;var e,r,n,i=t.state;if(i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?42:113,t.adler=2===i.wrap?0:1,i.last_flush=ga,!pa){for(t=Array(16),n=r=0;n<28;n++)for(Di[n]=r,e=0;e<1<<Ci[n];e++)Pi[r++]=n;for(Pi[r-1]=n,n=r=0;n<16;n++)for(Oi[n]=r,e=0;e<1<<Ti[n];e++)Ri[r++]=n;for(r>>=7;n<30;n++)for(Oi[n]=r<<7,e=0;e<1<<Ti[n]-7;e++)Ri[256+r++]=n;for(e=0;e<=15;e++)t[e]=0;for(e=0;e<=143;)Ii[2*e+1]=8,e++,t[8]++;for(;e<=255;)Ii[2*e+1]=9,e++,t[9]++;for(;e<=279;)Ii[2*e+1]=7,e++,t[7]++;for(;e<=287;)Ii[2*e+1]=8,e++,t[8]++;for(Ui(Ii,287,t),e=0;e<30;e++)Li[2*e+1]=5,Li[2*e]=zi(e,5);ca=new S(Ii,Ci,257,286,15),ha=new S(Li,Ti,0,30,15),da=new S([],Si,0,19,7),pa=!0}return i.l_desc=new E(i.dyn_ltree,ca),i.d_desc=new E(i.dyn_dtree,ha),i.bl_desc=new E(i.bl_tree,da),i.bi_buf=0,i.bi_valid=0,ki(i),_a}function la(t){var e=sa(t);return e===_a&&((t=t.state).window_size=2*t.w_size,$i(t.head),t.max_lazy_match=Ba[t.level].max_lazy,t.good_match=Ba[t.level].good_length,t.nice_match=Ba[t.level].nice_length,t.max_chain_length=Ba[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),e}function ua(t,e,r,n,i,a){if(!t)return wa;var o=1;if(e===Ta&&(e=6),n<0?(o=0,n=-n):15<n&&(o=2,n-=16),i<1||9<i||r!==Da||n<8||15<n||e<0||9<e||a<0||La<a)return Qi(t,wa);8===n&&(n=9);var s=new L;return(t.state=s).strm=t,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=e,s.strategy=a,s.method=r,la(t)}T(Oi);var ca=void 0,ha=void 0,da=void 0,pa=!1,fa=new Uint32Array(function(){for(var t=[],e=0;e<256;e++){for(var r=e,n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;t[e]=r}return t}()),ma={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ga=(Eu={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}).Z_NO_FLUSH,va=Eu.Z_PARTIAL_FLUSH,ya=Eu.Z_FULL_FLUSH,xa=Eu.Z_FINISH,ba=Eu.Z_BLOCK,_a=Eu.Z_OK,Aa=Eu.Z_STREAM_END,wa=Eu.Z_STREAM_ERROR,Ma=Eu.Z_DATA_ERROR,Ca=Eu.Z_BUF_ERROR,Ta=Eu.Z_DEFAULT_COMPRESSION,Sa=Eu.Z_FILTERED,Ea=Eu.Z_HUFFMAN_ONLY,Ia=Eu.Z_RLE,La=Eu.Z_FIXED,Ra=Eu.Z_DEFAULT_STRATEGY,Pa=Eu.Z_UNKNOWN,Da=Eu.Z_DEFLATED,Oa=function(t,e){for(var r;;){if(t.lookahead<262){if(oa(t),t.lookahead<262&&e===ga)return 1;if(0===t.lookahead)break}if(r=0,3<=t.lookahead&&(t.ins_h=ta(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-262&&(t.match_length=aa(t,r)),3<=t.match_length)if(r=Ki(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&3<=t.lookahead){for(t.match_length--;t.strstart++,t.ins_h=ta(t,t.ins_h,t.window[t.strstart+3-1]),t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ta(t,t.ins_h,t.window[t.strstart+1]);else r=Ki(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(ra(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===xa?(ra(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ra(t,!1),0===t.strm.avail_out)?1:2},Fa=function(t,e){for(var r,n;;){if(t.lookahead<262){if(oa(t),t.lookahead<262&&e===ga)return 1;if(0===t.lookahead)break}if(r=0,3<=t.lookahead&&(t.ins_h=ta(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-262&&(t.match_length=aa(t,r),t.match_length<=5&&(t.strategy===Sa||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2)),3<=t.prev_length&&t.match_length<=t.prev_length){for(n=t.strstart+t.lookahead-3,r=Ki(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=n&&(t.ins_h=ta(t,t.ins_h,t.window[t.strstart+3-1]),t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(ra(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=Ki(t,0,t.window[t.strstart-1]))&&ra(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(Ki(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===xa?(ra(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ra(t,!1),0===t.strm.avail_out)?1:2},Ba=[new I(0,0,0,0,function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(oa(t),0===t.lookahead&&e===ga)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,ra(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(ra(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===xa?(ra(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&ra(t,!1),1)}),new I(4,4,8,4,Oa),new I(4,5,16,8,Oa),new I(4,6,32,32,Oa),new I(4,4,16,16,Fa),new I(8,16,32,32,Fa),new I(8,16,128,128,Fa),new I(8,32,128,256,Fa),new I(32,128,258,1024,Fa),new I(32,258,258,4096,Fa)],Na={deflateInit:function(t,e){return ua(t,e,Da,15,8,Ra)},deflateInit2:ua,deflateReset:la,deflateResetKeep:sa,deflateSetHeader:function(t,e){return t&&t.state&&2===t.state.wrap?(t.state.gzhead=e,_a):wa},deflate:function(t,e){if(!t||!t.state||ba<e||e<0)return t?Qi(t,wa):wa;var r=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===r.status&&e!==xa)return Qi(t,0===t.avail_out?Ca:wa);r.strm=t;var n,i=r.last_flush;if(r.last_flush=e,42===r.status&&(2===r.wrap?(t.adler=0,na(r,31),na(r,139),na(r,8),r.gzhead?(na(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),na(r,255&r.gzhead.time),na(r,r.gzhead.time>>8&255),na(r,r.gzhead.time>>16&255),na(r,r.gzhead.time>>24&255),na(r,9===r.level?2:r.strategy>=Ea||r.level<2?4:0),na(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(na(r,255&r.gzhead.extra.length),na(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=Ji(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(na(r,0),na(r,0),na(r,0),na(r,0),na(r,0),na(r,9===r.level?2:r.strategy>=Ea||r.level<2?4:0),na(r,3),r.status=113)):(n=Da+(r.w_bits-8<<4)<<8,n|=(r.strategy>=Ea||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(n|=32),r.status=113,ia(r,n+(31-n%31)),0!==r.strstart&&(ia(r,t.adler>>>16),ia(r,65535&t.adler)),t.adler=1)),69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),ea(t),n=r.pending,r.pending!==r.pending_buf_size));)na(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),ea(t),n=r.pending,r.pending===r.pending_buf_size)){var a=1;break}}while(a=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,na(r,a),0!==a);r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),0===a&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),ea(t),n=r.pending,r.pending===r.pending_buf_size)){a=1;break}}while(a=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,na(r,a),0!==a);r.gzhead.hcrc&&r.pending>n&&(t.adler=Ji(t.adler,r.pending_buf,r.pending-n,n)),0===a&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&ea(t),r.pending+2<=r.pending_buf_size&&(na(r,255&t.adler),na(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(ea(t),0===t.avail_out)return r.last_flush=-1,_a}else if(0===t.avail_in&&(e<<1)-(4<e?9:0)<=(i<<1)-(4<i?9:0)&&e!==xa)return Qi(t,Ca);if(666===r.status&&0!==t.avail_in)return Qi(t,Ca);if(0!==t.avail_in||0!==r.lookahead||e!==ga&&666!==r.status){if(3!==(i=r.strategy===Ea?function(t,e){for(var r;;){if(0===t.lookahead&&(oa(t),0===t.lookahead)){if(e===ga)return 1;break}if(t.match_length=0,r=Ki(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(ra(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===xa?(ra(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ra(t,!1),0===t.strm.avail_out)?1:2}(r,e):r.strategy===Ia?function(t,e){for(var r,n,i,a=t.window;;){if(t.lookahead<=258){if(oa(t),t.lookahead<=258&&e===ga)return 1;if(0===t.lookahead)break}if(t.match_length=0,3<=t.lookahead&&0<t.strstart&&((r=a[n=t.strstart-1])===a[++n]&&r===a[++n]&&r===a[++n])){for(i=t.strstart+258;r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&n<i;);t.match_length=258-(i-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(3<=t.match_length?(r=Ki(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Ki(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(ra(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===xa?(ra(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(ra(t,!1),0===t.strm.avail_out)?1:2}(r,e):Ba[r.level].func(r,e))&&4!==i||(r.status=666),1===i||3===i)return 0===t.avail_out&&(r.last_flush=-1),_a;if(2===i&&(e===va?(Bi(r,2,3),Ni(r,256,Ii),16===r.bi_valid?(Fi(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):8<=r.bi_valid&&(r.pending_buf[r.pending++]=255&r.bi_buf,r.bi_buf>>=8,r.bi_valid-=8)):e!==ba&&(Yi(r,0,0,!1),e===ya&&($i(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),ea(t),0===t.avail_out))return r.last_flush=-1,_a}return e!==xa?_a:r.wrap<=0?Aa:(2===r.wrap?(na(r,255&t.adler),na(r,t.adler>>8&255),na(r,t.adler>>16&255),na(r,t.adler>>24&255),na(r,255&t.total_in),na(r,t.total_in>>8&255),na(r,t.total_in>>16&255),na(r,t.total_in>>24&255)):(ia(r,t.adler>>>16),ia(r,65535&t.adler)),ea(t),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?_a:Aa)},deflateEnd:function(t){if(!t||!t.state)return wa;var e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?Qi(t,wa):(t.state=null,113===e?Qi(t,Ma):_a)},deflateSetDictionary:function(t,e){var r=e.length;if(!t||!t.state)return wa;var n=t.state,i=n.wrap;if(2===i||1===i&&42!==n.status||n.lookahead)return wa;1===i&&(t.adler=Zi(t.adler,e,r,0)),n.wrap=0,r>=n.w_size&&(0===i&&($i(n.head),n.strstart=0,n.block_start=0,n.insert=0),(a=new Uint8Array(n.w_size)).set(e.subarray(r-n.w_size,r),0),e=a,r=n.w_size);var a=t.avail_in,o=t.next_in,s=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,oa(n);3<=n.lookahead;){for(e=n.strstart,r=n.lookahead-2;n.ins_h=ta(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++,--r;);n.strstart=e,n.lookahead=2,oa(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=s,t.avail_in=a,n.wrap=i,_a},deflateInfo:"pako deflate (from Nodeca project)"},za={assign:function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!==(void 0===r?"undefined":xn(r)))throw new TypeError(r+"must be non-object");for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}return t},flattenChunks:function(t){for(var e=0,r=0,n=t.length;r<n;r++)e+=t[r].length;for(var e=new Uint8Array(e),n=r=0,i=t.length;r<i;r++){var a=t[r];e.set(a,n),n+=a.length}return e}},Ua=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ua=!1}for(var ka=new Uint8Array(256),Ha=0;Ha<256;Ha++)ka[Ha]=252<=Ha?6:248<=Ha?5:240<=Ha?4:224<=Ha?3:192<=Ha?2:1;ka[254]=ka[254]=1;var Ga={string2buf:function(t){for(var e,r=t.length,n=0,i=0;i<r;i++){var a,o=t.charCodeAt(i);55296==(64512&o)&&i+1<r&&(56320==(64512&(a=t.charCodeAt(i+1)))&&(o=65536+(o-55296<<10)+(a-56320),i++)),n+=o<128?1:o<2048?2:o<65536?3:4}var s=new Uint8Array(n);for(i=e=0;e<n;i++)55296==(64512&(o=t.charCodeAt(i)))&&i+1<r&&(56320==(64512&(a=t.charCodeAt(i+1)))&&(o=65536+(o-55296<<10)+(a-56320),i++)),o<128?s[e++]=o:(o<2048?s[e++]=192|o>>>6:(o<65536?s[e++]=224|o>>>12:(s[e++]=240|o>>>18,s[e++]=128|o>>>12&63),s[e++]=128|o>>>6&63),s[e++]=128|63&o);return s},buf2string:function(t,e){var r,n,i=e||t.length;for(e=Array(2*i),r=n=0;r<i;){var a=t[r++];if(a<128)e[n++]=a;else{var o=ka[a];if(4<o)e[n++]=65533,r+=o-1;else{for(a&=2===o?31:3===o?15:7;1<o&&r<i;)a=a<<6|63&t[r++],o--;1<o?e[n++]=65533:a<65536?e[n++]=a:(a-=65536,e[n++]=55296|a>>10&1023,e[n++]=56320|1023&a)}}}if((t=n)<65534&&e.subarray&&Ua)e=String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));else{for(r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);e=r}return e},utf8border:function(t,e){for(var r=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=r&&128==(192&t[r]);)r--;return!(r<0||0===r)&&r+ka[t[r]]>e?r:e}},Va=function(){this.input=null,this.total_in=this.avail_in=this.next_in=0,this.output=null,this.total_out=this.avail_out=this.next_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Wa=Object.prototype.toString,ja=Eu.Z_NO_FLUSH,Xa=Eu.Z_SYNC_FLUSH,qa=Eu.Z_FULL_FLUSH,Ya=Eu.Z_FINISH,Za=Eu.Z_OK,Ja=Eu.Z_STREAM_END,Ka=Eu.Z_DEFAULT_COMPRESSION,Qa=Eu.Z_DEFAULT_STRATEGY,$a=Eu.Z_DEFLATED;function to(t,e,r,n,i,a,o,s){for(var l,u,c,h,d=s.bits,p=0,f=new Uint16Array(16),m=new Uint16Array(16),g=0,v=0;v<=15;v++)f[v]=0;for(l=0;l<n;l++)f[e[r+l]]++;for(var y,x,b=d,_=15;1<=_&&0===f[_];_--);if(_<b&&(b=_),0===_)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(d=1;d<_&&0===f[d];d++);for(b<d&&(b=d),v=I=1;v<=15;v++)if(I<<=1,(I-=f[v])<0)return-1;if(0<I&&(0===t||1!==_))return-1;for(m[1]=0,v=1;v<15;v++)m[v+1]=m[v]+f[v];for(l=0;l<n;l++)0!==e[r+l]&&(o[m[e[r+l]]++]=l);x=0===t?(y=h=o,19):1===t?(y=so,p-=257,h=lo,g-=257,256):(y=uo,h=co,-1),v=d;var A=a,m=l=u=0,w=-1,M=1<<(n=b),C=M-1;if(1===t&&852<M||2===t&&592<M)return 1;for(;;){for(var T,S=v-m,E=o[l]<x?(T=0,o[l]):o[l]>x?(T=h[g+o[l]],y[p+o[l]]):(T=96,0),I=1<<v-m,d=c=1<<n;c-=I,i[A+(u>>m)+c]=S<<24|T<<16|E|0,0!==c;);for(I=1<<v-1;u&I;)I>>=1;if(0!==I?(u&=I-1,u+=I):u=0,l++,0==--f[v]){if(v===_)break;v=e[r+o[l]]}if(b<v&&(u&C)!==w){for(A+=d,I=1<<(n=v-(m=0===m?b:m));n+m<_&&!((I-=f[n+m])<=0);)n++,I<<=1;if(M+=1<<n,1===t&&852<M||2===t&&592<M)return 1;i[w=u&C]=b<<24|n<<16|A-a|0}}return 0!==u&&(i[A+u]=v-m<<24|4194304),s.bits=b,0}function eo(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function ro(t){if(!t||!t.state)return yo;var e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,mo}function no(t){if(!t||!t.state)return yo;var e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ro(t)}function io(t,e){if(!t||!t.state)return yo;var r,n=t.state;return e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?yo:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,no(t))}function ao(t,e){if(!t)return yo;var r=new D;return(t.state=r).window=null,(e=io(t,e))!==mo&&(t.state=null),e}function oo(t,e,r,n){var i=t.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(n<(t=i.wsize-i.wnext)&&(t=n),i.window.set(e.subarray(r-n,r-n+t),i.wnext),(n-=t)?(i.window.set(e.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=t,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=t))),0}R.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize;if(this.ended)return!1;for(e=e===~~e?e:!0===e?Ya:ja,"string"==typeof t?r.input=Ga.string2buf(t):"[object ArrayBuffer]"===Wa.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(e===Xa||e===qa)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if((t=Na.deflate(r,e))===Ja)return 0<r.next_out&&this.onData(r.output.subarray(0,r.next_out)),t=Na.deflateEnd(this.strm),this.onEnd(t),this.ended=!0,t===Za;if(0===r.avail_out)this.onData(r.output);else if(0<e&&0<r.next_out)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}return!0},R.prototype.onData=function(t){this.chunks.push(t)},R.prototype.onEnd=function(t){t===Za&&(this.result=za.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var so=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lo=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),uo=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),co=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ho=Eu.Z_FINISH,po=Eu.Z_BLOCK,fo=Eu.Z_TREES,mo=Eu.Z_OK,go=Eu.Z_STREAM_END,vo=Eu.Z_NEED_DICT,yo=Eu.Z_STREAM_ERROR,xo=Eu.Z_DATA_ERROR,bo=Eu.Z_MEM_ERROR,_o=Eu.Z_BUF_ERROR,Ao=Eu.Z_DEFLATED,wo=!0,Mo=void 0,Co=void 0,To={inflateReset:no,inflateReset2:io,inflateResetKeep:ro,inflateInit:function(t){return ao(t,15)},inflateInit2:ao,inflate:function(t,e){var r=new Uint8Array(4),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return yo;var i=t.state;12===i.mode&&(i.mode=13);var a=t.next_out,o=t.output,s=t.avail_out,l=t.next_in,u=t.input,c=t.avail_in,h=i.hold,d=i.bits,p=c,f=s,m=mo;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;d<16;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(2&i.wrap&&35615===h){r[i.check=0]=255&h,r[1]=h>>>8&255,i.check=Ji(i.check,r,2,0),d=h=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",i.mode=30;break}if((15&h)!==Ao){t.msg="unknown compression method",i.mode=30;break}d-=4;var g=8+(15&(h>>>=4));if(0===i.wbits)i.wbits=g;else if(g>i.wbits){t.msg="invalid window size",i.mode=30;break}i.dmax=1<<i.wbits,t.adler=i.check=1,i.mode=512&h?10:12,d=h=0;break;case 2:for(;d<16;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(i.flags=h,(255&i.flags)!==Ao){t.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=h>>8&1),512&i.flags&&(r[0]=255&h,r[1]=h>>>8&255,i.check=Ji(i.check,r,2,0)),d=h=0,i.mode=3;case 3:for(;d<32;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.head&&(i.head.time=h),512&i.flags&&(r[0]=255&h,r[1]=h>>>8&255,r[2]=h>>>16&255,r[3]=h>>>24&255,i.check=Ji(i.check,r,4,0)),d=h=0,i.mode=4;case 4:for(;d<16;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.head&&(i.head.xflags=255&h,i.head.os=h>>8),512&i.flags&&(r[0]=255&h,r[1]=h>>>8&255,i.check=Ji(i.check,r,2,0)),d=h=0,i.mode=5;case 5:if(1024&i.flags){for(;d<16;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.length=h,i.head&&(i.head.extra_len=h),512&i.flags&&(r[0]=255&h,r[1]=h>>>8&255,i.check=Ji(i.check,r,2,0)),d=h=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags){var v=i.length;if((v=c<v?c:v)&&(i.head&&(g=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(u.subarray(l,l+v),g)),512&i.flags&&(i.check=Ji(i.check,u,v,l)),c-=v,l+=v,i.length-=v),i.length)break t}i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===c)break t;for(v=0;g=u[l+v++],i.head&&g&&i.length<65536&&(i.head.name+=String.fromCharCode(g)),g&&v<c;);if(512&i.flags&&(i.check=Ji(i.check,u,v,l)),c-=v,l+=v,g)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===c)break t;for(v=0;g=u[l+v++],i.head&&g&&i.length<65536&&(i.head.comment+=String.fromCharCode(g)),g&&v<c;);if(512&i.flags&&(i.check=Ji(i.check,u,v,l)),c-=v,l+=v,g)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;d<16;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(h!==(65535&i.check)){t.msg="header crc mismatch",i.mode=30;break}d=h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=12;break;case 10:for(;d<32;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}t.adler=i.check=eo(h),d=h=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=a,t.avail_out=s,t.next_in=l,t.avail_in=c,i.hold=h,i.bits=d,vo;t.adler=i.check=1,i.mode=12;case 12:if(e===po||e===fo)break t;case 13:if(i.last){h>>>=7&d,d-=7&d,i.mode=27;break}for(;d<3;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}switch(i.last=1&h,--d,3&(h>>>=1)){case 0:i.mode=14;break;case 1:if(v=i,wo){for(Mo=new Int32Array(512),Co=new Int32Array(32),g=0;g<144;)v.lens[g++]=8;for(;g<256;)v.lens[g++]=9;for(;g<280;)v.lens[g++]=7;for(;g<288;)v.lens[g++]=8;for(to(1,v.lens,0,288,Mo,0,v.work,{bits:9}),g=0;g<32;)v.lens[g++]=5;to(2,v.lens,0,32,Co,0,v.work,{bits:5}),wo=!1}if(v.lencode=Mo,v.lenbits=9,v.distcode=Co,v.distbits=5,i.mode=20,e!==fo)break;h>>>=2,d-=2;break t;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=30}h>>>=2,d-=2;break;case 14:for(h>>>=7&d,d-=7&d;d<32;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&h,d=h=0,i.mode=15,e===fo)break t;case 15:i.mode=16;case 16:if(v=i.length){if(0===(v=s<(v=c<v?c:v)?s:v))break t;o.set(u.subarray(l,l+v),a),c-=v,l+=v,s-=v,a+=v,i.length-=v;break}i.mode=12;break;case 17:for(;d<14;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(i.nlen=257+(31&h),h>>>=5,d-=5,i.ndist=1+(31&h),h>>>=5,d-=5,i.ncode=4+(15&h),h>>>=4,d-=4,286<i.nlen||30<i.ndist){t.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;d<3;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.lens[n[i.have++]]=7&h,h>>>=3,d-=3}for(;i.have<19;)i.lens[n[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,v={bits:i.lenbits},m=to(0,i.lens,0,19,i.lencode,0,i.work,v),i.lenbits=v.bits,m){t.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;;){var y=i.lencode[h&(1<<i.lenbits)-1],v=y>>>24;if(y&=65535,v<=d)break;if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(y<16)h>>>=v,d-=v,i.lens[i.have++]=y;else{if(16===y){for(g=v+2;d<g;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(h>>>=v,d-=v,0===i.have){t.msg="invalid bit length repeat",i.mode=30;break}g=i.lens[i.have-1],v=3+(3&h),h>>>=2,d-=2}else if(17===y){for(g=v+3;d<g;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}d-=v,g=0,v=3+(7&(h>>>=v)),h>>>=3,d-=3}else{for(g=v+7;d<g;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}d-=v,g=0,v=11+(127&(h>>>=v)),h>>>=7,d-=7}if(i.have+v>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=30;break}for(;v--;)i.lens[i.have++]=g}}if(30===i.mode)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,v={bits:i.lenbits},m=to(1,i.lens,0,i.nlen,i.lencode,0,i.work,v),i.lenbits=v.bits,m){t.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,v={bits:i.distbits},m=to(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,v),i.distbits=v.bits,m){t.msg="invalid distances set",i.mode=30;break}if(i.mode=20,e===fo)break t;case 20:i.mode=21;case 21:if(6<=c&&258<=s){t.next_out=a,t.avail_out=s,t.next_in=l,t.avail_in=c,i.hold=h,i.bits=d;var x=(u=t).state,o=u.next_in,b=u.input,l=o+(u.avail_in-5),a=u.next_out,_=u.output,c=a-(f-u.avail_out),s=a+(u.avail_out-257),h=x.dmax,d=x.wsize;v=x.whave;var g=x.wnext,A=x.window,w=x.hold,M=x.bits,y=x.lencode,C=x.distcode,T=(1<<x.lenbits)-1,S=(1<<x.distbits)-1;e:do{M<15&&(w+=b[o++]<<M,M+=8,w+=b[o++]<<M,M+=8);var E=y[w&T];r:for(;;){var I=E>>>24;if(w>>>=I,M-=I,0===(I=E>>>16&255))_[a++]=65535&E;else{if(!(16&I)){if(0==(64&I)){E=y[(65535&E)+(w&(1<<I)-1)];continue r}32&I?x.mode=12:(u.msg="invalid literal/length code",x.mode=30);break e}var L=65535&E;(I&=15)&&(M<I&&(w+=b[o++]<<M,M+=8),L+=w&(1<<I)-1,w>>>=I,M-=I),M<15&&(w+=b[o++]<<M,M+=8,w+=b[o++]<<M,M+=8),E=C[w&S];n:for(;;){if(w>>>=I=E>>>24,M-=I,!(16&(I=E>>>16&255))){if(0==(64&I)){E=C[(65535&E)+(w&(1<<I)-1)];continue n}u.msg="invalid distance code",x.mode=30;break e}if(E&=65535,M<(I&=15)&&(w+=b[o++]<<M,(M+=8)<I&&(w+=b[o++]<<M,M+=8)),h<(E+=w&(1<<I)-1)){u.msg="invalid distance too far back",x.mode=30;break e}if(w>>>=I,M-=I,(I=a-c)<E){if(v<(I=E-I)&&x.sane){u.msg="invalid distance too far back",x.mode=30;break e}var R=0,P=A;if(0===g){if(R+=d-I,I<L){for(L-=I;_[a++]=A[R++],--I;);R=a-E,P=_}}else if(g<I){if(R+=d+g-I,(I-=g)<L){for(L-=I;_[a++]=A[R++],--I;);if(R=0,g<L){for(I=g,L-=I;_[a++]=A[R++],--I;);R=a-E,P=_}}}else if(R+=g-I,I<L){for(L-=I;_[a++]=A[R++],--I;);R=a-E,P=_}for(;2<L;)_[a++]=P[R++],_[a++]=P[R++],_[a++]=P[R++],L-=3;L&&(_[a++]=P[R++],1<L&&(_[a++]=P[R++]))}else{for(R=a-E;_[a++]=_[R++],_[a++]=_[R++],_[a++]=_[R++],L-=3,2<L;);L&&(_[a++]=_[R++],1<L&&(_[a++]=_[R++]))}break}}break}}while(o<l&&a<s);o-=L=M>>3,M-=L<<3,u.next_in=o,u.next_out=a,u.avail_in=o<l?l-o+5:5-(o-l),u.avail_out=a<s?s-a+257:257-(a-s),x.hold=w&(1<<M)-1,x.bits=M,a=t.next_out,o=t.output,s=t.avail_out,l=t.next_in,u=t.input,c=t.avail_in,h=i.hold,d=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;v=(y=i.lencode[h&(1<<i.lenbits)-1])>>>24,g=y>>>16&255,y&=65535,!(v<=d);){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(g&&0==(240&g)){for(A=v,w=g,M=y;v=(y=i.lencode[M+((h&(1<<A+w)-1)>>A)])>>>24,g=y>>>16&255,y&=65535,!(A+v<=d);){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}h>>>=A,d-=A,i.back+=A}if(h>>>=v,d-=v,i.back+=v,i.length=y,0===g){i.mode=26;break}if(32&g){i.back=-1,i.mode=12;break}if(64&g){t.msg="invalid literal/length code",i.mode=30;break}i.extra=15&g,i.mode=22;case 22:if(i.extra){for(g=i.extra;d<g;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,d-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;v=(y=i.distcode[h&(1<<i.distbits)-1])>>>24,g=y>>>16&255,y&=65535,!(v<=d);){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(0==(240&g)){for(A=v,w=g,M=y;v=(y=i.distcode[M+((h&(1<<A+w)-1)>>A)])>>>24,g=y>>>16&255,y&=65535,!(A+v<=d);){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}h>>>=A,d-=A,i.back+=A}if(h>>>=v,d-=v,i.back+=v,64&g){t.msg="invalid distance code",i.mode=30;break}i.offset=y,i.extra=15&g,i.mode=24;case 24:if(i.extra){for(g=i.extra;d<g;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,d-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===s)break t;if(v=f-s,i.offset>v){if((v=i.offset-v)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=30;break}g=v>i.wnext?(v-=i.wnext,i.wsize-v):i.wnext-v,v>i.length&&(v=i.length),A=i.window}else A=o,g=a-i.offset,v=i.length;for(s<v&&(v=s),s-=v,i.length-=v;o[a++]=A[g++],--v;);0===i.length&&(i.mode=21);break;case 26:if(0===s)break t;o[a++]=i.length,s--,i.mode=21;break;case 27:if(i.wrap){for(;d<32;){if(0===c)break t;c--,h|=u[l++]<<d,d+=8}if(f-=s,t.total_out+=f,i.total+=f,f&&(t.adler=i.check=(i.flags?Ji:Zi)(i.check,o,f,a-f)),f=s,(i.flags?h:eo(h))!==i.check){t.msg="incorrect data check",i.mode=30;break}d=h=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;d<32;){if(0===c)break t;c--,h+=u[l++]<<d,d+=8}if(h!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=30;break}d=h=0}i.mode=29;case 29:m=go;break t;case 30:m=xo;break t;case 31:return bo;default:return yo}return t.next_out=a,t.avail_out=s,t.next_in=l,t.avail_in=c,i.hold=h,i.bits=d,(i.wsize||f!==t.avail_out&&i.mode<30&&(i.mode<27||e!==ho))&&oo(t,t.output,t.next_out,f-t.avail_out),p-=t.avail_in,f-=t.avail_out,t.total_in+=p,t.total_out+=f,i.total+=f,i.wrap&&f&&(t.adler=i.check=(i.flags?Ji:Zi)(i.check,o,f,t.next_out-f)),t.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),m=(0==p&&0===f||e===ho)&&m===mo?_o:m},inflateEnd:function(t){if(!t||!t.state)return yo;var e=t.state;return e.window&&(e.window=null),t.state=null,mo},inflateGetHeader:function(t,e){return!t||!t.state||0==(2&(t=t.state).wrap)?yo:((t.head=e).done=!1,mo)},inflateSetDictionary:function(t,e){var r=e.length;if(!t||!t.state)return yo;var n=t.state;if(0!==n.wrap&&11!==n.mode)return yo;if(11===n.mode&&Zi(1,e,r,0)!==n.check)return xo;return oo(t,e,r,r)?(n.mode=31,bo):(n.havedict=1,mo)},inflateInfo:"pako inflate (from Nodeca project)"},So=function(){this.os=this.xflags=this.time=this.text=0,this.extra=null,this.extra_len=0,this.comment=this.name="",this.hcrc=0,this.done=!1},Eo=Object.prototype.toString,Io=Eu.Z_NO_FLUSH,Lo=Eu.Z_FINISH,Ro=Eu.Z_OK,Po=Eu.Z_STREAM_END,Do=Eu.Z_NEED_DICT,Oo=Eu.Z_STREAM_ERROR,Fo=Eu.Z_DATA_ERROR,Bo=Eu.Z_MEM_ERROR;O.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;if(this.ended)return!1;var a=e===~~e?e:!0===e?Lo:Io;for("[object ArrayBuffer]"===Eo.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(e=To.inflate(r,a))===Do&&i&&((e=To.inflateSetDictionary(r,i))===Ro?e=To.inflate(r,a):e===Fo&&(e=Do));0<r.avail_in&&e===Po&&0<r.state.wrap&&0!==t[r.next_in];)To.inflateReset(r),e=To.inflate(r,a);switch(e){case Oo:case Fo:case Do:case Bo:return this.onEnd(e),!(this.ended=!0)}var o,s,l,u=r.avail_out;if(!r.next_out||0!==r.avail_out&&e!==Po||("string"===this.options.to?(o=Ga.utf8border(r.output,r.next_out),s=r.next_out-o,l=Ga.buf2string(r.output,o),r.next_out=s,r.avail_out=n-s,s&&r.output.set(r.output.subarray(o,o+s),0),this.onData(l)):this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out))),e!==Ro||0!==u){if(e===Po){e=To.inflateEnd(this.strm),this.onEnd(e),this.ended=!0;break}if(0===r.avail_in)break}}return!0},O.prototype.onData=function(t){this.chunks.push(t)},O.prototype.onEnd=function(t){t===Ro&&(this.result="string"===this.options.to?this.chunks.join(""):za.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var No=function(t,e){return(e=e||{}).raw=!0,P(t,e)},zo=function(t,e){return(e=e||{}).raw=!0,F(t,e)},Uo=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=n=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))},e.RANDOM=e.ARRAY_TYPE=e.EPSILON=void 0;var r=1e-6;e.EPSILON=r;var n="undefined"!=typeof Float32Array?Float32Array:Array;e.ARRAY_TYPE=n,e.RANDOM=Math.random;var i=Math.PI/180});r(Uo);var ko=n(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2];return r=r[3],t[0]=n*o+a*s,t[1]=i*o+e*s,t[2]=n*l+a*r,t[3]=i*l+e*r,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new l.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,r,n){var i=new l.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},e.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},e.transpose=function(t,e){var r;return t===e?(r=e[1],t[1]=e[2],t[2]=r):(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*(e=e[3])-i*n;return a?(a=1/a,t[0]=e*a,t[1]=-n*a,t[2]=-i*a,t[3]=r*a,t):null},e.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+a*o,t[1]=i*r+e*o,t[2]=n*-o+a*r,t[3]=i*-o+e*r,t},e.scale=function(t,e,r){var n=e[1],i=e[2],a=e[3],o=r[0];return r=r[1],t[0]=e[0]*o,t[1]=n*o,t[2]=i*r,t[3]=a*r,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2];t=t[3];var a=e[0],o=e[1],s=e[2];return e=e[3],Math.abs(r-a)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(t-e)<=l.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.sub=e.mul=void 0;var l=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.mul=r,e.sub=n});r(ko);var Ho=n(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=r[0],u=r[1],c=r[2],h=r[3],d=r[4];return r=r[5],t[0]=n*l+a*u,t[1]=i*l+o*u,t[2]=n*c+a*h,t[3]=i*c+o*h,t[4]=n*d+a*r+s,t[5]=i*d+o*r+e,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new d.ARRAY_TYPE(6);return d.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new d.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,r,n,i,a){var o=new d.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o},e.set=function(t,e,r,n,i,a,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4];e=e[5];var s=r*a-n*i;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*e-a*o)*s,t[5]=(n*o-r*e)*s,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=Math.sin(r);return r=Math.cos(r),t[0]=n*r+a*l,t[1]=i*r+o*l,t[2]=n*-l+a*r,t[3]=i*-l+o*r,t[4]=s,t[5]=e,t},e.scale=function(t,e,r){var n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=r[0];return r=r[1],t[0]=e[0]*l,t[1]=n*l,t[2]=i*r,t[3]=a*r,t[4]=o,t[5]=s,t},e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=r[0];return r=r[1],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=n*l+a*r+s,t[5]=i*l+o*r+e,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4];t=t[5];var s=e[0],l=e[1],u=e[2],c=e[3],h=e[4];return e=e[5],Math.abs(r-s)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=d.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(t-e)<=d.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var d=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.mul=r,e.sub=n});r(Ho);var Go=n(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=r[0],d=r[1],p=r[2],f=r[3],m=r[4],g=r[5],v=r[6],y=r[7];return r=r[8],t[0]=h*n+d*o+p*u,t[1]=h*i+d*s+p*c,t[2]=h*a+d*l+p*e,t[3]=f*n+m*o+g*u,t[4]=f*i+m*s+g*c,t[5]=f*a+m*l+g*e,t[6]=v*n+y*o+r*u,t[7]=v*i+y*s+r*c,t[8]=v*a+y*l+r*e,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new y.ARRAY_TYPE(9);return y.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new y.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,n,i,a,o,s,l){var u=new y.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u},e.set=function(t,e,r,n,i,a,o,s,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){var r,n,i;return t===e?(r=e[1],n=e[2],i=e[5],t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=(e=e[8])*o-s*u,h=-e*a+s*l,d=u*a-o*l,p=r*c+n*h+i*d;return p?(p=1/p,t[0]=c*p,t[1]=(-e*n+i*u)*p,t[2]=(s*n-i*o)*p,t[3]=h*p,t[4]=(e*r-i*l)*p,t[5]=(-s*r+i*a)*p,t[6]=d*p,t[7]=(-u*r+n*l)*p,t[8]=(o*r-n*a)*p,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7];return e=e[8],t[0]=o*e-s*u,t[1]=i*u-n*e,t[2]=n*s-i*o,t[3]=s*l-a*e,t[4]=r*e-i*l,t[5]=i*a-r*s,t[6]=a*u-o*l,t[7]=n*l-r*u,t[8]=r*o-n*a,t},e.determinant=function(t){var e=t[3],r=t[4],n=t[5],i=t[6],a=t[7],o=t[8];return t[0]*(o*r-n*a)+t[1]*(-o*e+n*i)+t[2]*(a*e-r*i)},e.multiply=r,e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=r[0];return r=r[1],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=h*n+r*o+u,t[7]=h*i+r*s+c,t[8]=h*a+r*l+e,t},e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=Math.sin(r);return r=Math.cos(r),t[0]=r*n+h*o,t[1]=r*i+h*s,t[2]=r*a+h*l,t[3]=r*o-h*n,t[4]=r*s-h*i,t[5]=r*l-h*a,t[6]=u,t[7]=c,t[8]=e,t},e.scale=function(t,e,r){var n=r[0];return r=r[1],t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=r+r,o=n+n,s=i+i;r*=a;var l=n*a;n*=o;var u=i*a,c=i*o;return i*=s,a*=e=e[3],o*=e,e*=s,t[0]=1-n-i,t[3]=l-e,t[6]=u+o,t[1]=l+e,t[4]=1-r-i,t[7]=c-a,t[2]=u-o,t[5]=c+a,t[8]=1-r-n,t},e.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=r*s-n*o,y=r*l-i*o,x=r*u-a*o,b=n*l-i*s,_=n*u-a*s,A=i*u-a*l,w=c*m-h*f,M=c*g-d*f,C=h*g-d*m;return(p=v*(d=d*(e=e[15])-p*g)-y*(h=h*e-p*m)+x*C+b*(c=c*e-p*f)-_*M+A*w)?(p=1/p,t[0]=(s*d-l*h+u*C)*p,t[1]=(l*c-o*d-u*M)*p,t[2]=(o*h-s*c+u*w)*p,t[3]=(i*h-n*d-a*C)*p,t[4]=(r*d-i*c+a*M)*p,t[5]=(n*c-r*h-a*w)*p,t[6]=(m*A-g*_+e*b)*p,t[7]=(g*x-f*A-e*y)*p,t[8]=(f*_-m*x+e*v)*p,t):null},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7];t=t[8];var c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],m=e[5],g=e[6],v=e[7];return e=e[8],Math.abs(r-c)<=y.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=y.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=y.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-p)<=y.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=y.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=y.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-g)<=y.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=y.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(t-e)<=y.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var y=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.mul=r,e.sub=n});r(Go);var Vo=n(function(t,e){function f(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14];e=e[15];var y=r[0],x=r[1],b=r[2],_=r[3];return t[0]=y*n+x*s+b*h+_*m,t[1]=y*i+x*l+b*d+_*g,t[2]=y*a+x*u+b*p+_*v,t[3]=y*o+x*c+b*f+_*e,y=r[4],x=r[5],b=r[6],_=r[7],t[4]=y*n+x*s+b*h+_*m,t[5]=y*i+x*l+b*d+_*g,t[6]=y*a+x*u+b*p+_*v,t[7]=y*o+x*c+b*f+_*e,y=r[8],x=r[9],b=r[10],_=r[11],t[8]=y*n+x*s+b*h+_*m,t[9]=y*i+x*l+b*d+_*g,t[10]=y*a+x*u+b*p+_*v,t[11]=y*o+x*c+b*f+_*e,y=r[12],x=r[13],b=r[14],_=r[15],t[12]=y*n+x*s+b*h+_*m,t[13]=y*i+x*l+b*d+_*g,t[14]=y*a+x*u+b*p+_*v,t[15]=y*o+x*c+b*f+_*e,t}function d(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,l=i+i,u=a+a;e=n*s;var c=n*l;n*=u;var h=i*l;return i*=u,a*=u,s*=o,l*=o,o*=u,t[0]=1-(h+a),t[1]=c+o,t[2]=n-l,t[3]=0,t[4]=c-o,t[5]=1-(e+a),t[6]=i+s,t[7]=0,t[8]=n+l,t[9]=i-s,t[10]=1-(e+h),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new P.ARRAY_TYPE(16);return P.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},e.clone=function(t){var e=new P.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m){var g=new P.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=n,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=l,g[9]=u,g[10]=c,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,g},e.set=function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m,g){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=m,t[15]=g,t},e.identity=f,e.transpose=function(t,e){var r,n,i,a,o,s;return t===e?(r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s):(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=r*s-n*o,y=r*l-i*o,x=r*u-a*o,b=n*l-i*s,_=n*u-a*s,A=i*u-a*l,w=c*m-h*f,M=c*g-d*f,C=c*(e=e[15])-p*f,T=h*g-d*m,S=h*e-p*m,E=d*e-p*g,I=v*E-y*S+x*T+b*C-_*M+A*w;return I?(I=1/I,t[0]=(s*E-l*S+u*T)*I,t[1]=(i*S-n*E-a*T)*I,t[2]=(m*A-g*_+e*b)*I,t[3]=(d*_-h*A-p*b)*I,t[4]=(l*C-o*E-u*M)*I,t[5]=(r*E-i*C+a*M)*I,t[6]=(g*x-f*A-e*y)*I,t[7]=(c*A-d*x+p*y)*I,t[8]=(o*S-s*C+u*w)*I,t[9]=(n*C-r*S-a*w)*I,t[10]=(f*_-m*x+e*v)*I,t[11]=(h*x-c*_-p*v)*I,t[12]=(s*M-o*T-l*w)*I,t[13]=(r*T-n*M+i*w)*I,t[14]=(m*y-f*b-g*v)*I,t[15]=(c*b-h*y+d*v)*I,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14];return e=e[15],t[0]=s*(d*e-p*g)-h*(l*e-u*g)+m*(l*p-u*d),t[1]=-(n*(d*e-p*g)-h*(i*e-a*g)+m*(i*p-a*d)),t[2]=n*(l*e-u*g)-s*(i*e-a*g)+m*(i*u-a*l),t[3]=-(n*(l*p-u*d)-s*(i*p-a*d)+h*(i*u-a*l)),t[4]=-(o*(d*e-p*g)-c*(l*e-u*g)+f*(l*p-u*d)),t[5]=r*(d*e-p*g)-c*(i*e-a*g)+f*(i*p-a*d),t[6]=-(r*(l*e-u*g)-o*(i*e-a*g)+f*(i*u-a*l)),t[7]=r*(l*p-u*d)-o*(i*p-a*d)+c*(i*u-a*l),t[8]=o*(h*e-p*m)-c*(s*e-u*m)+f*(s*p-u*h),t[9]=-(r*(h*e-p*m)-c*(n*e-a*m)+f*(n*p-a*h)),t[10]=r*(s*e-u*m)-o*(n*e-a*m)+f*(n*u-a*s),t[11]=-(r*(s*p-u*h)-o*(n*p-a*h)+c*(n*u-a*s)),t[12]=-(o*(h*g-d*m)-c*(s*g-l*m)+f*(s*d-l*h)),t[13]=r*(h*g-d*m)-c*(n*g-i*m)+f*(n*d-i*h),t[14]=-(r*(s*g-l*m)-o*(n*g-i*m)+f*(n*l-i*s)),t[15]=r*(s*d-l*h)-o*(n*d-i*h)+c*(n*l-i*s),t},e.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14];return(e*o-r*a)*(h*(t=t[15])-d*m)-(e*s-n*a)*(c*t-d*f)+(e*l-i*a)*(c*m-h*f)+(r*s-n*o)*(u*t-d*p)-(r*l-i*o)*(u*m-h*p)+(n*l-i*s)*(u*f-c*p)},e.multiply=r,e.translate=function(t,e,r){var n,i,a,o,s,l,u,c,h,d,p,f,m=r[0],g=r[1];return r=r[2],e===t?(t[12]=e[0]*m+e[4]*g+e[8]*r+e[12],t[13]=e[1]*m+e[5]*g+e[9]*r+e[13],t[14]=e[2]*m+e[6]*g+e[10]*r+e[14],t[15]=e[3]*m+e[7]*g+e[11]*r+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*m+s*g+h*r+e[12],t[13]=i*m+l*g+d*r+e[13],t[14]=a*m+u*g+p*r+e[14],t[15]=o*m+c*g+f*r+e[15]),t},e.scale=function(t,e,r){var n=r[0],i=r[1];return r=r[2],t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,r,n){var i=n[0],a=n[1];if(n=n[2],(u=Math.sqrt(i*i+a*a+n*n))<P.EPSILON)return null;i*=u=1/u,a*=u,n*=u;var o=Math.sin(r),s=Math.cos(r),l=1-s;r=e[0];var u=e[1],c=e[2],h=e[3],d=e[4],p=e[5],f=e[6],m=e[7],g=e[8],v=e[9],y=e[10],x=e[11],b=i*i*l+s,_=a*i*l+n*o,A=n*i*l-a*o,w=i*a*l-n*o,M=a*a*l+s,C=n*a*l+i*o,T=i*n*l+a*o,i=a*n*l-i*o,a=n*n*l+s;return t[0]=r*b+d*_+g*A,t[1]=u*b+p*_+v*A,t[2]=c*b+f*_+y*A,t[3]=h*b+m*_+x*A,t[4]=r*w+d*M+g*C,t[5]=u*w+p*M+v*C,t[6]=c*w+f*M+y*C,t[7]=h*w+m*M+x*C,t[8]=r*T+d*i+g*a,t[9]=u*T+p*i+v*a,t[10]=c*T+f*i+y*a,t[11]=h*T+m*i+x*a,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},e.rotateX=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[4],a=e[5],o=e[6],s=e[7],l=e[8],u=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*r+l*n,t[5]=a*r+u*n,t[6]=o*r+c*n,t[7]=s*r+h*n,t[8]=l*r-i*n,t[9]=u*r-a*n,t[10]=c*r-o*n,t[11]=h*r-s*n,t},e.rotateY=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[0],a=e[1],o=e[2],s=e[3],l=e[8],u=e[9],c=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r-l*n,t[1]=a*r-u*n,t[2]=o*r-c*n,t[3]=s*r-h*n,t[8]=i*n+l*r,t[9]=a*n+u*r,t[10]=o*n+c*r,t[11]=s*n+h*r,t},e.rotateZ=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[0],a=e[1],o=e[2],s=e[3],l=e[4],u=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r+l*n,t[1]=a*r+u*n,t[2]=o*r+c*n,t[3]=s*r+h*n,t[4]=l*r-i*n,t[5]=u*r-a*n,t[6]=c*r-o*n,t[7]=h*r-s*n,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,r){var n=r[0],i=r[1];if(r=r[2],(a=Math.sqrt(n*n+i*i+r*r))<P.EPSILON)return null;n*=a=1/a,i*=a,r*=a;var a=Math.sin(e),o=1-(e=Math.cos(e));return t[0]=n*n*o+e,t[1]=i*n*o+r*a,t[2]=r*n*o-i*a,t[3]=0,t[4]=n*i*o-r*a,t[5]=i*i*o+e,t[6]=r*i*o+n*a,t[7]=0,t[8]=n*r*o+i*a,t[9]=i*r*o-n*a,t[10]=r*r*o+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=d,e.fromQuat2=function(t,e){var r=new P.ARRAY_TYPE(3),n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=n*n+i*i+a*a+o*o;return 0<h?(r[0]=2*(s*o+c*n+l*a-u*i)/h,r[1]=2*(l*o+c*i+u*n-s*a)/h,r[2]=2*(u*o+c*a+s*i-l*n)/h):(r[0]=2*(s*o+c*n+l*a-u*i),r[1]=2*(l*o+c*i+u*n-s*a),r[2]=2*(u*o+c*a+s*i-l*n)),d(t,e,r),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9];return e=e[10],t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+o*o+s*s),t[2]=Math.sqrt(l*l+u*u+e*e),t},e.getRotation=function(t,e){var r=e[0]+e[5]+e[10];return 0<r?(r=2*Math.sqrt(r+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,u=a+a;e=i*l;var c=i*u;i*=d=o+o;var h=a*u;a*=d,o*=d,l*=s,u*=s,s*=d;var d=n[0],p=n[1];return n=n[2],t[0]=(1-(h+o))*d,t[1]=(c+s)*d,t[2]=(i-u)*d,t[3]=0,t[4]=(c-s)*p,t[5]=(1-(e+o))*p,t[6]=(a+l)*p,t[7]=0,t[8]=(i+u)*n,t[9]=(a-l)*n,t[10]=(1-(e+h))*n,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],l=e[3],u=o+o;e=a*(v=a+a);var c=a*u,h=a*(g=s+s),a=o*u;o*=g;var d=s*g,s=l*v;u*=l;var p=l*g,f=n[0],m=n[1],g=n[2];n=i[0],l=i[1],i=i[2];var v=(1-(a+d))*f,y=(c+p)*f;return f*=h-u,c=(c-p)*m,d=(1-(e+d))*m,m*=o+s,h=(h+u)*g,o=(o-s)*g,e=(1-(e+a))*g,t[0]=v,t[1]=y,t[2]=f,t[3]=0,t[4]=c,t[5]=d,t[6]=m,t[7]=0,t[8]=h,t[9]=o,t[10]=e,t[11]=0,t[12]=r[0]+n-(v*n+c*l+h*i),t[13]=r[1]+l-(y*n+d*l+o*i),t[14]=r[2]+i-(f*n+m*l+e*i),t[15]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=r+r,o=n+n,s=i+i;r*=a;var l=n*a;n*=o;var u=i*a,c=i*o;return i*=s,a*=e=e[3],o*=e,e*=s,t[0]=1-n-i,t[1]=l+e,t[2]=u-o,t[3]=0,t[4]=l-e,t[5]=1-r-i,t[6]=c+a,t[7]=0,t[8]=u+o,t[9]=c-a,t[10]=1-r-n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,r,n,i,a,o){var s=1/(r-e),l=1/(i-n),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t},e.perspective=function(t,e,r,n,i){return e=1/Math.tan(e/2),t[0]=e/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&1/0!==i?(r=1/(n-i),t[10]=(i+n)*r,t[14]=2*i*n*r):(t[10]=-1,t[14]=-2*n),t},e.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=2/(o+(e=Math.tan(e.rightDegrees*Math.PI/180))),l=2/(i+a);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(o-e)*s*.5,t[9]=(i-a)*l*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},e.ortho=function(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(o+a)*u,t[15]=1,t},e.lookAt=function(t,e,r,n){var i=e[0],a=e[1];e=e[2];var o=n[0],s=n[1],l=n[2],u=r[0];n=r[1];var c=r[2];if(Math.abs(i-u)<P.EPSILON&&Math.abs(a-n)<P.EPSILON&&Math.abs(e-c)<P.EPSILON)return f(t);r=i-u,n=a-n;var u=e-c,h=1/Math.sqrt(r*r+n*n+u*u),c=s*(u*=h)-l*(n*=h),l=l*(r*=h)-o*u,o=o*n-s*r;(h=Math.sqrt(c*c+l*l+o*o))?(c*=h=1/h,l*=h,o*=h):o=l=c=0;var s=n*o-u*l,d=u*c-r*o,p=r*l-n*c;return(h=Math.sqrt(s*s+d*d+p*p))?(s*=h=1/h,d*=h,p*=h):p=d=s=0,t[0]=c,t[1]=s,t[2]=r,t[3]=0,t[4]=l,t[5]=d,t[6]=n,t[7]=0,t[8]=o,t[9]=p,t[10]=u,t[11]=0,t[12]=-(c*i+l*a+o*e),t[13]=-(s*i+d*a+p*e),t[14]=-(r*i+n*a+u*e),t[15]=1,t},e.targetTo=function(t,e,r,n){var i=e[0],a=e[1];e=e[2];var o=n[0],s=n[1],l=n[2];n=i-r[0];var u=a-r[1],c=n*n+u*u+(r=e-r[2])*r;0<c&&(n*=c=1/Math.sqrt(c),u*=c,r*=c);var h=s*r-l*u;return 0<(c=h*h+(l=l*n-o*r)*l+(o=o*u-s*n)*o)&&(h*=c=1/Math.sqrt(c),l*=c,o*=c),t[0]=h,t[1]=l,t[2]=o,t[3]=0,t[4]=u*o-r*l,t[5]=r*h-n*o,t[6]=n*l-u*h,t[7]=0,t[8]=n,t[9]=u,t[10]=r,t[11]=0,t[12]=i,t[13]=a,t[14]=e,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14];t=t[15];var v=e[0],y=e[1],x=e[2],b=e[3],_=e[4],A=e[5],w=e[6],M=e[7],C=e[8],T=e[9],S=e[10],E=e[11],I=e[12],L=e[13],R=e[14];return e=e[15],Math.abs(r-v)<=P.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-y)<=P.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-x)<=P.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-b)<=P.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-_)<=P.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-A)<=P.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-w)<=P.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-M)<=P.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-C)<=P.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-T)<=P.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-S)<=P.EPSILON*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-E)<=P.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(f-I)<=P.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-L)<=P.EPSILON*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(g-R)<=P.EPSILON*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(t-e)<=P.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var P=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.mul=r,e.sub=n});r(Vo);var Wo=n(function(t,e){function r(){var t=new f.ARRAY_TYPE(3);return f.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function n(t){var e=t[0],r=t[1];return t=t[2],Math.sqrt(e*e+r*r+t*t)}function i(t,e,r){var n=new f.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function s(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1];return t=e[2]-t[2],Math.sqrt(r*r+n*n+t*t)}function u(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n+(t=e[2]-t[2])*t}function c(t){var e=t[0],r=t[1];return e*e+r*r+(t=t[2])*t}function h(t,e){var r=e[0],n=e[1],i=e[2];return 0<(r=r*r+n*n+i*i)&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new f.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=n,e.fromValues=i,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=a,e.multiply=o,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},e.distance=l,e.squaredDistance=u,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=h,e.dot=d,e.cross=function(t,e,r){var n=e[0],i=e[1];e=e[2];var a=r[0],o=r[1];return r=r[2],t[0]=i*r-e*o,t[1]=e*a-n*r,t[2]=n*o-i*a,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1];return e=e[2],t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=e+n*(r[2]-e),t},e.hermite=function(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1);return a=o*(3-2*a),t[0]=e[0]*s+r[0]*l+n[0]*u+i[0]*a,t[1]=e[1]*s+r[1]*l+n[1]*u+i[1]*a,t[2]=e[2]*s+r[2]*l+n[2]*u+i[2]*a,t},e.bezier=function(t,e,r,n,i,a){var o=1-a,s=o*o,l=a*a,u=s*o;return s*=3*a,o*=3*l,a*=l,t[0]=e[0]*u+r[0]*s+n[0]*o+i[0]*a,t[1]=e[1]*u+r[1]*s+n[1]*o+i[1]*a,t[2]=e[2]*u+r[2]*s+n[2]*o+i[2]*a,t},e.random=function(t,e){e=e||1;var r=2*f.RANDOM()*Math.PI,n=2*f.RANDOM()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1];e=e[2];var a=(a=r[3]*n+r[7]*i+r[11]*e+r[15])||1;return t[0]=(r[0]*n+r[4]*i+r[8]*e+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*e+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*e+r[14])/a,t},e.transformMat3=function(t,e,r){var n=e[0],i=e[1];return e=e[2],t[0]=n*r[0]+i*r[3]+e*r[6],t[1]=n*r[1]+i*r[4]+e*r[7],t[2]=n*r[2]+i*r[5]+e*r[8],t},e.transformQuat=function(t,e,r){var n=r[0],i=r[1],a=r[2],o=e[0],s=e[1],l=i*(e=e[2])-a*s,u=a*o-n*e,c=n*s-i*o;return r=2*r[3],t[0]=o+l*r+2*(i*c-a*u),t[1]=s+u*r+2*(a*l-n*c),t[2]=e+c*r+2*(n*u-i*l),t},e.rotateX=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateY=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateZ=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.angle=function(t,e){return t=i(t[0],t[1],t[2]),e=i(e[0],e[1],e[2]),h(t,t),h(e,e),1<(e=d(t,e))?0:e<-1?Math.PI:Math.acos(e)},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var r=t[0],n=t[1];t=t[2];var i=e[0],a=e[1];return e=e[2],Math.abs(r-i)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(t-e)<=f.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var p,f=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.sub=a,e.mul=o,e.div=s,e.dist=l,e.sqrDist=u,e.len=n,e.sqrLen=c,p=r(),t=function(t,e,r,n,i,a){for(e=e||3,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)p[0]=t[r],p[1]=t[r+1],p[2]=t[r+2],i(p,p,a),t[r]=p[0],t[r+1]=p[1],t[r+2]=p[2];return t},e.forEach=t});r(Wo);var jo=n(function(t,e){function r(){var t=new h.ARRAY_TYPE(4);return h.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function a(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function o(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return t=e[3]-t[3],Math.sqrt(r*r+n*n+i*i+t*t)}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i+(t=e[3]-t[3])*t}function l(t){var e=t[0],r=t[1],n=t[2];return t=t[3],Math.sqrt(e*e+r*r+n*n+t*t)}function u(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n+(t=t[3])*t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new h.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,n){var i=new h.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.multiply=i,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.distance=o,e.squaredDistance=s,e.length=l,e.squaredLength=u,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i+(e=e[3])*e;return 0<a&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=e*a,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.cross=function(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1];r=r[2]*n[3]-r[3]*n[2],n=e[0];var u=e[1],c=e[2];return e=e[3],t[0]=u*r-c*l+e*s,t[1]=-n*r+c*o-e*a,t[2]=n*l-u*o+e*i,t[3]=-n*s+u*a-c*i,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2];return e=e[3],t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=e+n*(r[3]-e),t},e.random=function(t,e){e=e||1;do{var r=2*h.RANDOM()-1,n=2*h.RANDOM()-1,i=r*r+n*n}while(1<=i);do{var a=2*h.RANDOM()-1,o=2*h.RANDOM()-1,s=a*a+o*o}while(1<=s);return i=Math.sqrt((1-i)/s),t[0]=e*r,t[1]=e*n,t[2]=e*a*i,t[3]=e*o*i,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2];return e=e[3],t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*e,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*e,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*e,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*e,t},e.transformQuat=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2],u=(r=r[3])*n+s*a-l*i,c=r*i+l*n-o*a,h=r*a+o*i-s*n,n=-o*n-s*i-l*a;return t[0]=u*r+n*-o+c*-l-h*-s,t[1]=c*r+n*-s+h*-o-u*-l,t[2]=h*r+n*-l+u*-s-c*-o,t[3]=e[3],t},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2];t=t[3];var a=e[0],o=e[1],s=e[2];return e=e[3],Math.abs(r-a)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=h.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var c,h=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.sub=n,e.mul=i,e.div=a,e.dist=o,e.sqrDist=s,e.len=l,e.sqrLen=u,c=r(),t=function(t,e,r,n,i,a){for(e=e||4,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)c[0]=t[r],c[1]=t[r+1],c[2]=t[r+2],c[3]=t[r+3],i(c,c,a),t[r]=c[0],t[r+1]=c[1],t[r+2]=c[2],t[r+3]=c[3];return t},e.forEach=t});r(jo);var Xo=n(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}function n(){var t=new p.ARRAY_TYPE(4);return p.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function i(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function a(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2];return r=r[3],t[0]=n*r+e*o+i*l-a*s,t[1]=i*r+e*s+a*o-n*l,t[2]=a*r+e*l+n*s-i*o,t[3]=e*r-n*o-i*s-a*l,t}function o(t,e,r,n){var i=e[0],a=e[1],o=e[2];e=e[3];var s,l,u=r[0],c=r[1],h=r[2],d=i*u+a*c+o*h+e*(r=r[3]);return d<0&&(d=-d,u=-u,c=-c,h=-h,r=-r),1-d>p.EPSILON?(s=Math.acos(d),l=Math.sin(s),d=Math.sin((1-n)*s)/l,n=Math.sin(n*s)/l):d=1-n,t[0]=d*i+n*u,t[1]=d*a+n*c,t[2]=d*o+n*h,t[3]=d*e+n*r,t}function s(t,e){var r,n,i,a=e[0]+e[4]+e[8];return 0<a?(a=Math.sqrt(a+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a):(r=0,e[4]>e[0]&&(r=1),n=((r=e[8]>e[3*r+r]?2:r)+1)%3,i=(r+2)%3,a=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*i+i]+1),t[r]=.5*a,a=.5/a,t[3]=(e[3*n+i]-e[3*i+n])*a,t[n]=(e[3*n+r]+e[3*r+n])*a,t[i]=(e[3*i+r]+e[3*r+i])*a),t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=n,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=i,e.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>p.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},e.multiply=a,e.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+e*o,t[1]=i*r+a*o,t[2]=a*r-i*o,t[3]=e*r-n*o,t},e.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r-a*o,t[1]=i*r+e*o,t[2]=a*r+n*o,t[3]=e*r-i*o,t},e.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+i*o,t[1]=i*r-n*o,t[2]=a*r+e*o,t[3]=e*r-a*o,t},e.calculateW=function(t,e){var r=e[0],n=e[1];return e=e[2],t[0]=r,t[1]=n,t[2]=e,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-e*e)),t},e.slerp=o,e.random=function(t){var e=p.RANDOM(),r=p.RANDOM(),n=p.RANDOM(),i=Math.sqrt(1-e),e=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=e*Math.sin(2*Math.PI*n),t[3]=e*Math.cos(2*Math.PI*n),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=(a=r*r+n*n+i*i+(e=e[3])*e)?1/a:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=e*a,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=s,e.fromEuler=function(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i,i=Math.sin(e),e=Math.cos(e);var a=Math.sin(r);r=Math.cos(r);var o=Math.sin(n);return n=Math.cos(n),t[0]=i*r*n-e*a*o,t[1]=e*a*n+i*r*o,t[2]=e*r*o-i*a*n,t[3]=e*r*n+i*a*o,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0;var p=r(Uo),l=r(Go),u=r(Wo);t=r(jo),e.clone=t.clone,e.fromValues=t.fromValues,e.copy=t.copy,e.set=t.set,e.add=t.add,e.mul=a,e.scale=t.scale,e.dot=t.dot,e.lerp=t.lerp;var c=t.length;e.length=c,e.len=c,c=t.squaredLength,e.squaredLength=c,e.sqrLen=c;var h,d,f,m,g,v,y=t.normalize;e.normalize=y,e.exactEquals=t.exactEquals,e.equals=t.equals,h=u.create(),d=u.fromValues(1,0,0),f=u.fromValues(0,1,0),t=function(t,e,r){var n=u.dot(e,r);return n<-.999999?(u.cross(h,d,e),u.len(h)<1e-6&&u.cross(h,f,e),u.normalize(h,h),i(t,h,Math.PI),t):.999999<n?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(u.cross(h,e,r),t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=1+n,y(t,t))},e.rotationTo=t,m=n(),g=n(),t=function(t,e,r,n,i,a){return o(m,e,i,a),o(g,r,n,a),o(t,m,g,2*a*(1-a)),t},e.sqlerp=t,v=l.create(),t=function(t,e,r,n){return v[0]=r[0],v[3]=r[1],v[6]=r[2],v[1]=n[0],v[4]=n[1],v[7]=n[2],v[2]=-e[0],v[5]=-e[1],v[8]=-e[2],y(t,s(t,v))},e.setAxes=t});r(Xo);var qo=n(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}function i(t,e,r){var n=.5*r[0],i=.5*r[1];r=.5*r[2];var a=e[0],o=e[1],s=e[2];return e=e[3],t[0]=a,t[1]=o,t[2]=s,t[3]=e,t[4]=n*e+i*s-r*o,t[5]=i*e+r*a-n*s,t[6]=r*e+n*o-i*a,t[7]=-n*a-i*o-r*s,t}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function n(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[4],l=r[5],u=r[6],c=r[7],h=e[4],d=e[5],p=e[6];e=e[7];var f=r[0],m=r[1],g=r[2];return r=r[3],t[0]=n*r+o*f+i*g-a*m,t[1]=i*r+o*m+a*f-n*g,t[2]=a*r+o*g+n*m-i*f,t[3]=o*r-n*f-i*m-a*g,t[4]=n*c+o*s+i*u-a*l+h*r+e*f+d*g-p*m,t[5]=i*c+o*l+a*s-n*u+d*r+e*m+p*f-h*g,t[6]=a*c+o*u+n*l-i*s+p*r+e*g+h*m-d*f,t[7]=o*c-n*s-i*l-a*u+e*r-h*f-d*m-p*g,t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new g.ARRAY_TYPE(8);return g.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},e.clone=function(t){var e=new g.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},e.fromValues=function(t,e,r,n,i,a,o,s){var l=new g.ARRAY_TYPE(8);return l[0]=t,l[1]=e,l[2]=r,l[3]=n,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l},e.fromRotationTranslationValues=function(t,e,r,n,i,a,o){var s=new g.ARRAY_TYPE(8);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,i*=.5,a*=.5,o*=.5,s[4]=i*n+a*r-o*e,s[5]=a*n+o*t-i*r,s[6]=o*n+i*e-a*t,s[7]=-i*t-a*e-o*r,s},e.fromRotationTranslation=i,e.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},e.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.fromMat4=function(t,e){var r=f.create();a.getRotation(r,e);var n=new g.ARRAY_TYPE(3);return a.getTranslation(n,e),i(t,r,n),t},e.copy=c,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.set=function(t,e,r,n,i,a,o,s,l){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t},e.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},e.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.getTranslation=function(t,e){var r=e[4],n=e[5],i=e[6],a=e[7],o=-e[0],s=-e[1],l=-e[2];return e=e[3],t[0]=2*(r*e+a*o+n*l-i*s),t[1]=2*(n*e+a*s+i*o-r*l),t[2]=2*(i*e+a*l+r*s-n*o),t},e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=.5*r[0],l=.5*r[1];r=.5*r[2];var u=e[4],c=e[5],h=e[6];return e=e[7],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=o*s+i*r-a*l+u,t[5]=o*l+a*s-n*r+c,t[6]=o*r+n*l-i*s+h,t[7]=-n*s-i*l-a*r+e,t},e.rotateX=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateX(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateY=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateY(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateZ=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateZ(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateByQuatAppend=function(t,e,r){var n=r[0],i=r[1],a=r[2];r=r[3];var o=e[0],s=e[1],l=e[2],u=e[3];return t[0]=o*r+u*n+s*a-l*i,t[1]=s*r+u*i+l*n-o*a,t[2]=l*r+u*a+o*i-s*n,t[3]=u*r-o*n-s*i-l*a,o=e[4],s=e[5],l=e[6],u=e[7],t[4]=o*r+u*n+s*a-l*i,t[5]=s*r+u*i+l*n-o*a,t[6]=l*r+u*a+o*i-s*n,t[7]=u*r-o*n-s*i-l*a,t},e.rotateByQuatPrepend=function(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2],u=r[3];return t[0]=n*u+e*o+i*l-a*s,t[1]=i*u+e*s+a*o-n*l,t[2]=a*u+e*l+n*s-i*o,t[3]=e*u-n*o-i*s-a*l,o=r[4],s=r[5],l=r[6],u=r[7],t[4]=n*u+e*o+i*l-a*s,t[5]=i*u+e*s+a*o-n*l,t[6]=a*u+e*l+n*s-i*o,t[7]=e*u-n*o-i*s-a*l,t},e.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<g.EPSILON)return c(t,e);var i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;var a=(s=Math.sin(n))*r[0]/i,o=s*r[1]/i;r=s*r[2]/i,n=Math.cos(n);var i=e[0],s=e[1],l=e[2],u=e[3];return t[0]=i*n+u*a+s*r-l*o,t[1]=s*n+u*o+l*a-i*r,t[2]=l*n+u*r+i*o-s*a,t[3]=u*n-i*a-s*o-l*r,i=e[4],s=e[5],l=e[6],e=e[7],t[4]=i*n+e*a+s*r-l*o,t[5]=s*n+e*o+l*a-i*r,t[6]=l*n+e*r+i*o-s*a,t[7]=e*n-i*a-s*o-l*r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},e.multiply=n,e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},e.lerp=function(t,e,r,n){var i=1-n;return o(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t},e.invert=function(t,e){var r=h(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},e.normalize=function(t,e){var r,n,i,a,o,s,l,u,c=h(e);return 0<c&&(c=Math.sqrt(c),r=e[0]/c,n=e[1]/c,i=e[2]/c,a=e[3]/c,u=r*(o=e[4])+n*(s=e[5])+i*(l=e[6])+a*(e=e[7]),t[0]=r,t[1]=n,t[2]=i,t[3]=a,t[4]=(o-r*u)/c,t[5]=(s-n*u)/c,t[6]=(l-i*u)/c,t[7]=(e-a*u)/c),t},e.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6];t=t[7];var u=e[0],c=e[1],h=e[2],d=e[3],p=e[4],f=e[5],m=e[6];return e=e[7],Math.abs(r-u)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-d)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-p)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-f)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-m)<=g.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(t-e)<=g.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sqrLen=e.squaredLength=e.len=e.length=e.dot=e.mul=e.setReal=e.getReal=void 0;var g=r(Uo),f=r(Xo),a=r(Vo);e.getReal=f.copy,e.setReal=f.copy,e.mul=n;var o=f.dot;e.dot=o,t=f.length,e.length=t,e.len=t;var h=f.squaredLength;e.squaredLength=h,e.sqrLen=h});r(qo);var Yo=n(function(t,e){function r(){var t=new h.ARRAY_TYPE(2);return h.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function a(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function o(t,e){var r=e[0]-t[0];return t=e[1]-t[1],Math.sqrt(r*r+t*t)}function s(t,e){var r=e[0]-t[0];return r*r+(t=e[1]-t[1])*t}function l(t){var e=t[0];return t=t[1],Math.sqrt(e*e+t*t)}function u(t){var e=t[0];return e*e+(t=t[1])*t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new h.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var r=new h.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,r){return t[0]=e,t[1]=r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},e.subtract=n,e.multiply=i,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},e.distance=o,e.squaredDistance=s,e.length=l,e.squaredLength=u,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var r=e[0],n=e[1];return 0<(r=r*r+n*n)&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,r){return e=e[0]*r[1]-e[1]*r[0],t[0]=t[1]=0,t[2]=e,t},e.lerp=function(t,e,r,n){var i=e[0];return e=e[1],t[0]=i+n*(r[0]-i),t[1]=e+n*(r[1]-e),t},e.random=function(t,e){e=e||1;var r=2*h.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},e.transformMat2=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[2]*e,t[1]=r[1]*n+r[3]*e,t},e.transformMat2d=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[2]*e+r[4],t[1]=r[1]*n+r[3]*e+r[5],t},e.transformMat3=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[3]*e+r[6],t[1]=r[1]*n+r[4]*e+r[7],t},e.transformMat4=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[4]*e+r[12],t[1]=r[1]*n+r[5]*e+r[13],t},e.rotate=function(t,e,r,n){var i=e[0]-r[0];e=e[1]-r[1];var a=Math.sin(n);return n=Math.cos(n),t[0]=i*n-e*a+r[0],t[1]=i*a+e*n+r[1],t},e.angle=function(t,e){var r=t[0];t=t[1];var n=e[0],i=r*r+t*t,a=n*n+(e=e[1])*e;return 1<(r=(r*n+t*e)*(i=0<i?1/Math.sqrt(i):i)*(a=0<a?1/Math.sqrt(a):a))?0:r<-1?Math.PI:Math.acos(r)},e.zero=function(t){return t[0]=0,t[1]=0,t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var r=t[0];t=t[1];var n=e[0];return e=e[1],Math.abs(r-n)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0;var c,h=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}(Uo);e.len=l,e.sub=n,e.mul=i,e.div=a,e.dist=o,e.sqrDist=s,e.sqrLen=u,c=r(),t=function(t,e,r,n,i,a){for(e=e||2,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)c[0]=t[r],c[1]=t[r+1],i(c,c,a),t[r]=c[0],t[r+1]=c[1];return t},e.forEach=t});r(Yo);var Zo=n(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=ir&&ui?ui(t,n):{}).get||e.set?ir(r,n,e):r[n]=t[n]);return r.default=t,r}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0,t=r(Uo),e.glMatrix=t,t=r(ko),e.mat2=t,t=r(Ho),e.mat2d=t,t=r(Go),e.mat3=t,t=r(Vo),e.mat4=t,t=r(Xo),e.quat=t,t=r(qo),e.quat2=t,t=r(Yo),e.vec2=t,t=r(Wo),e.vec3=t,t=r(jo),e.vec4=t});function Jo(t,e,r,n){if(void 0!==(s=r?r.call(n,t,e):void 0))return!!s;if(t===e)return 1;if("object"===(void 0===t?"undefined":xn(t))&&t&&"object"===(void 0===e?"undefined":xn(e))&&e){var i=ke(t),a=ke(e);if(i.length===a.length){for(var a=Object.prototype.hasOwnProperty.bind(e),o=0;o<i.length;o++){if(!a(s=i[o]))return;var s,l=t[s],u=e[s];if(!1===(s=r?r.call(n,l,u,s):void 0)||void 0===s&&l!==u)return}return 1}}}r(Zo);var Ko=Zo.vec4,Qo=Zo.vec3,$o=Zo.vec2,ts=Zo.quat2,es=Zo.quat,rs=Zo.mat4,ns=Zo.mat3,is=Zo.mat2d,as=Zo.mat2,os=Zo.glMatrix,ss=function(){function u(t,e,r){he(this,u),this.options=e,this.gl=t,r&&(this.map=r.map),r=this.getVertexShader(e.vertexShader);var n=this.getFragmentShader(e.fragmentShader);e=t.createShader(t.VERTEX_SHADER),t.shaderSource(e,r),t.compileShader(e),e=t.getShaderParameter(e,t.COMPILE_STATUS)?(r=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?(n=t.createProgram(),t.attachShader(n,e),t.attachShader(n,r),t.deleteShader(e),t.deleteShader(r),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)?n:(e="Shader program failed to link.  The error log is:"+t.getProgramInfoLog(n),console.error(e),-1)):(e="Fragment shader failed to compile.  The error log is:"+t.getShaderInfoLog(r),console.error(e),-1)):(e="Vertex shader failed to compile.  The error log is:"+t.getShaderInfoLog(e),console.error(e),-1),e=this.program=e,r={};for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=t.getActiveAttrib(e,i);r[a.name]=t.getAttribLocation(e,a.name)}for(var i={},a={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;s++){var l=t.getActiveUniform(e,s);i[l.name]=t.getUniformLocation(e,l.name),a[l.name]=l.type}this.parameter=t={attributes:r,numAttributes:n,uniformsType:a,uniforms:i},this.attributes=t.attributes,this.uniforms=t.uniforms,this.parameter=t}return ar(u,[{key:"getVertexShader",value:function(t){var e="";return this.map&&"cesium"===this.map.type&&(e="#define LOG_DEPTH\n"),e+="#ifdef LOG_DEPTH\nuniform float currentFrustumX;varying float v_depthFromNearPlusOne;\n#endif\nuniform vec2 MAPV_resolution;\n#if defined(PICK)\nuniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}\n#endif\nvoid afterMain(){\n#if defined(LOG_DEPTH)\nv_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;\n#endif\n#if defined(PICK)\nvPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}\n#endif\n}",(t=(t=this.getDefines()+e+t).replace("void main","void originMain"))+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(t){var e="";return this.map&&"cesium"===this.map.type&&(e="#define LOG_DEPTH\n"),e+="#if defined(LOG_DEPTH)\n#extension GL_EXT_frag_depth : enable\n#endif\nprecision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;\n#if defined(PICK)\nvarying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}\n#endif\n#if defined(LOG_DEPTH)\nuniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}\n#endif\nvoid afterMain(){\n#if defined(PICK)\nif(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}\n#endif\n#if defined(LOG_DEPTH)\nwriteLogDepth(v_depthFromNearPlusOne);\n#endif\n}",(t=(t=this.getDefines()+e+t).replace("void main","void originMain"))+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var t="",e=this.options.defines;if(e)for(var r=0;r<e.length;r++)t+="#define "+e[r]+"\n";return t}},{key:"use",value:function(t,e){(this.gl=t).useProgram(this.program),this.map&&"cesium"===this.map.type&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[t.canvas.width,t.canvas.height]})}},{key:"setUniform",value:function(t,e){var r=this.gl,n=this.uniforms[t];if(n)switch(this.parameter.uniformsType[t]){case r.FLOAT:r.uniform1f(n,e);break;case r.FLOAT_VEC2:r.uniform2f(n,e[0],e[1]);break;case r.FLOAT_VEC3:r.uniform3f(n,e[0],e[1],e[2]);break;case r.FLOAT_VEC4:r.uniform4f(n,e[0],e[1],e[2],e[3]);break;case r.SAMPLER_2D:case r.SAMPLER_CUBE:r.activeTexture(r["TEXTURE"+this.textureIndex]),r.uniform1i(n,this.textureIndex),r.bindTexture(r.TEXTURE_2D,e),this.textureIndex++;break;case r.INT:case r.BOOL:r.uniform1i(n,e);break;case r.INT_VEC2:case r.BOOL_VEC2:r.uniform2i(n,e[0],e[1]);break;case r.INT_VEC3:case r.BOOL_VEC3:r.uniform3i(n,e[0],e[1],e[2]);break;case r.INT_VEC4:case r.BOOL_VEC4:r.uniform4i(n,e[0],e[1],e[2],e[3]);break;case r.FLOAT_MAT2:r.uniformMatrix2fv(n,!1,e);break;case r.FLOAT_MAT3:r.uniformMatrix3fv(n,!1,e);break;case r.FLOAT_MAT4:r.uniformMatrix4fv(n,!1,e);break;default:console.error("Unrecognized uniform type: "+t)}else console.warn("Unrecognized uniform type: "+t)}},{key:"setUniforms",value:function(t){for(var e in this.textureIndex=0,t)this.setUniform(e,t[e])}}]),u}(),ls=function(){function e(t){he(this,e),this.options=t,this.gl=t.gl,this.savedState=[],this.currentState=this.getDefaultState()}return ar(e,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var t=this.gl;return{blend:!1,blendEquation:t.FUNC_ADD,blendFunc:[t.ONE,t.ZERO],depthMask:!0,depthTest:!0,depthFunc:t.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var t=this.gl;return{blend:t.getParameter(t.BLEND),blendEquation:t.getParameter(t.BLEND_EQUATION),depthMask:t.getParameter(t.DEPTH_WRITEMASK),depthTest:t.getParameter(t.DEPTH_TEST),depthFunc:t.getParameter(t.DEPTH_FUNC),polygonOffset:[t.getParameter(t.POLYGON_OFFSET_FACTOR),t.getParameter(t.POLYGON_OFFSET_UNITS)],cullFace:t.getParameter(t.CULL_FACE),stencilTest:t.getParameter(t.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var t=this.savedState.pop();this.setState(t,{force:!0})}},{key:"setState",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t=Xe(this.getDefaultState(),t),this.setBlend(t,e),this.setDepth(t,e),this.setCullFace(t,e),this.setPolygonOffset(t,e),this.setStencil(t,e),this.currentState=t}},{key:"setBlend",value:function(t,e){var r=this.gl,n=this.getCurrentState();!(e=e.force)&&Jo(t.blend,n.blend)||(t.blend?r.enable(r.BLEND):r.disable(r.BLEND)),!e&&Jo(t.blendEquation,n.blendEquation)||r.blendEquation(t.blendEquation),!e&&Jo(t.blendFunc,n.blendFunc)||r.blendFunc(t.blendFunc[0],t.blendFunc[1])}},{key:"setDepth",value:function(t,e){var r=this.gl,n=this.getCurrentState();!(e=e.force)&&Jo(t.depthTest,n.depthTest)||(t.depthTest?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST)),!e&&Jo(t.depthMask,n.depthMask)||(t.depthMask?r.depthMask(!0):r.depthMask(!1)),!e&&Jo(t.depthFunc,n.depthFunc)||r.depthFunc(t.depthFunc)}},{key:"setPolygonOffset",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Jo(t.polygonOffset,n.polygonOffset)||(0!==t.polygonOffset[0]&&0!==t.polygonOffset[1]?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),r.polygonOffset(t.polygonOffset[0],t.polygonOffset[1]))}},{key:"setCullFace",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Jo(t.cullFace,n.cullFace)||(t.cullFace?(r.enable(r.CULL_FACE),r.cullFace(r.BACK)):r.disable(r.CULL_FACE))}},{key:"setStencil",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Jo(t.stencilTest,n.stencilTest)||(t.stencilTest?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST))}}]),e}(),us=function(){function e(t){he(this,e),this.options=t,this.gl=t.gl,this.buffer=this.gl.createBuffer(),t.data&&this.updateData(t.data)}return ar(e,[{key:"updateData",value:function(t){var e=this.options,r=this.gl;this.bind(),r.bufferData(r[e.target],t,r[e.usage])}},{key:"bind",value:function(t){(t=t||this.gl).bindBuffer(t[this.options.target],this.buffer)}},{key:"unBind",value:function(t){(t=t||this.gl).bindBuffer(t[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),e}(),cs={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},hs=function(){function e(t){for(he(this,e),this.options=t,this.attributes=t.attributes,this.gl=t.gl,this.program=t.program,t=this.stride=0;t<this.attributes.length;t++)this.stride+=cs[this.attributes[t].type]*this.attributes[t].size}return ar(e,[{key:"setVertexAttribPointers",value:function(){for(var t=this.gl,e=this.program,r=0;r<this.attributes.length;r++){var n=this.attributes[r],i=e.attributes[n.name];void 0!==i&&(n.buffer.bind(t),t.vertexAttribPointer(i,n.size,t[n.type],n.normalize||!1,(void 0!==n.stride?n:this).stride,n.offset),t.enableVertexAttribArray(i))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),e}(),ds=function t(e,r,n){he(this,t),r=r||e.canvas.width,n=n||e.canvas.height;var i=e.createFramebuffer(),a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i.texture=a;var o=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r,n),i.depthBuffer=o,e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,o),r=e.checkFramebufferStatus(e.FRAMEBUFFER),e.FRAMEBUFFER_COMPLETE===r&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),this.framebuffer=i)},ps=function(){function e(t){he(this,e),this.options={},Xe(this.options,t),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return ar(e,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(t){}},{key:"render",value:function(t){var e=t.gl;t=t.texture;var r=this.programSample;e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);var i=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,0),e.drawArrays(e.TRIANGLES,0,i.length/3)}}]),e}(),fs=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture,this.getOptions(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.getProgram(e);e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.uniform2fv(r.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}]),e}(),ms=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){var e;return this.program1||(this.program1=new ss(t,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;\n#define SMAA_THRESHOLD 0.1\nuniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}"})),this.program2||(this.program2=new ss(t,{vertexShader:"precision highp float;\n#define SMAA_MAX_SEARCH_STEPS 8\n#define SMAA_AREATEX_MAX_DISTANCE 16\n#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\nattribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;\n#define SMAA_MAX_SEARCH_STEPS 8\n#define SMAA_AREATEX_MAX_DISTANCE 16\n#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\nuniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}"})),this.program3||(this.program3=new ss(t,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),this.vertexBuffer&&this.sampleBuffer||(this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),e=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}],this.vertexArray1=new hs({gl:t,program:this.program1,attributes:e}),this.vertexArray2=new hs({gl:t,program:this.program2,attributes:e}),this.vertexArray3=new hs({gl:t,program:this.program3,attributes:e})),{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new ds(t),this.bloomBuffer=new ds(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new ds(t)),this.bloomBuffer||(this.bloomBuffer=new ds(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo,this.getOptions(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var n=(a=this.getProgram(e)).program1,i=a.program2,a=a.program3,o=(s=this.getExtraFbo(e)).collectBrightBuffer,s=s.bloomBuffer,l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(n.attributes.position),e.vertexAttribPointer(n.attributes.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.attributes.position),e.vertexAttribPointer(i.attributes.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.position),e.vertexAttribPointer(a.attributes.position,3,e.FLOAT,!1,0,0),l=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(n.attributes.uv),e.vertexAttribPointer(n.attributes.uv,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.attributes.uv),e.vertexAttribPointer(i.attributes.uv,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.uv),e.vertexAttribPointer(a.attributes.uv,2,e.FLOAT,!1,0,0),e.useProgram(n.program),e.bindFramebuffer(e.FRAMEBUFFER,o),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(n.uniforms.tDiffuse,2),e.uniform2fv(n.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(i.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,o.texture),e.uniform1i(i.uniforms.uSampler,2),e.uniform2fv(i.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(a.uniforms.tDiffuse,2),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(a.uniforms.tColor,3),e.uniform2fv(a.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),e}(),gs=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new hs({gl:t,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture,e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.getProgram(e);r.use(e),this.vertexArray.bind(),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3)}}]),e}(),vs=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){return this.programBright||(this.programBright=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new ds(t),this.bloomBuffer=new ds(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new ds(t)),this.bloomBuffer||(this.bloomBuffer=new ds(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo;var n=this.getOptions();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=(o=this.getProgram(e)).programBright,a=o.programBloom,o=o.programResult,s=(l=this.getExtraFbo(e)).collectBrightBuffer,l=l.bloomBuffer,u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(i.attributes.aPos),e.vertexAttribPointer(i.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.aPos),e.vertexAttribPointer(a.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aPos),e.vertexAttribPointer(o.attributes.aPos,3,e.FLOAT,!1,0,0),u=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(i.attributes.aTextureCoord),e.vertexAttribPointer(i.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.aTextureCoord),e.vertexAttribPointer(a.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aTextureCoord),e.vertexAttribPointer(o.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.useProgram(i.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(i.uniforms.uSampler,1),e.uniform1f(i.uniforms.threshold,n.threshold||0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(a.uniforms.uSampler,1),e.uniform1i(a.uniforms.isVertical,!0),e.uniform1f(a.uniforms.blurSize,n.blurSize||2),e.uniform1f(a.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(a.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(a.uniforms.uSampler,1),e.uniform1i(a.uniforms.isVertical,!1),e.uniform1f(a.uniforms.blurSize,n.blurSize||2),e.uniform1f(a.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(a.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(o.uniforms.originalTexture,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(o.uniforms.bloomTexture,0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}]),e}(),ys=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){return this.programBright||(this.programBright=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new ds(t),this.bloomBuffer=new ds(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new ds(t)),this.bloomBuffer||(this.bloomBuffer=new ds(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo;var n=this.getOptions(),i="clarity"in n?n.clarity:1,i=Math.max(0,i);i=Math.min(1,i),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var a=(s=this.getProgram(e)).programBright,o=s.programBloom,s=s.programResult,l=(u=this.getExtraFbo(e)).collectBrightBuffer,u=u.bloomBuffer,c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(a.attributes.aPos),e.vertexAttribPointer(a.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aPos),e.vertexAttribPointer(o.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.attributes.aPos),e.vertexAttribPointer(s.attributes.aPos,3,e.FLOAT,!1,0,0),c=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(a.attributes.aTextureCoord),e.vertexAttribPointer(a.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aTextureCoord),e.vertexAttribPointer(o.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.attributes.aTextureCoord),e.vertexAttribPointer(s.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(a.uniforms.uSampler,1),e.uniform1f(a.uniforms.threshold,n.threshold||0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,u),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(o.uniforms.uSampler,1),e.uniform1i(o.uniforms.isVertical,!0),e.uniform1f(o.uniforms.blurSize,n.blurSize||2),e.uniform1f(o.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(o.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,u.texture),e.uniform1i(o.uniforms.uSampler,1),e.uniform1i(o.uniforms.isVertical,!1),e.uniform1f(o.uniforms.blurSize,n.blurSize||2),e.uniform1f(o.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(o.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(s.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(s.uniforms.originalTexture,1),e.uniform1f(s.uniforms.toneScale,i),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(s.uniforms.bloomTexture,0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}]),e}(),xs=function(){function e(t){return he(this,e),bn(this,(e.__proto__||Qe(e)).call(this,t))}return In(e,ps),ar(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new ss(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture;var r=this.getProgram(e);e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.uniform2fv(r.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3)}}]),e}(),bs=function(){function e(t){he(this,e),this.gl=t,this.effects=[],this.initFbo()}return ar(e,[{key:"addEffect",value:function(t){this.effects.push(t)}},{key:"removeEffect",value:function(t){}},{key:"setEffects",value:function(t){this.effects=t}},{key:"onResize",value:function(){this.initFbo();var t=this.gl,e=this.effects;if(e&&1<e.length)for(var r=1;r<e.length;r++){var n=e[r];n.onResize&&n.onResize(t)}}},{key:"initFbo",value:function(){var t=this.gl;t&&(this.fbo=[new ds(t),new ds(t)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var t=this.gl,e=this.effects;if(e&&0<e.length)for(var r={},n=0;n<e.length;n++){var i=this.fbo[n%2].framebuffer;n===e.length-1&&(i=null),t.bindFramebuffer(t.FRAMEBUFFER,i);var a=[0,0,0,0];t.clearColor(a[0],a[1],a[2],a[3]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),e[n].render({isPickRender:!1,gl:t,texture:r.texture,fbo:i}),r=i}}}]),e}(),_s=function(){function r(t,e){he(this,r),this.map=t,this.options=e||{},this.eventMap={}}return ar(r,[{key:"onResize",value:function(t){}},{key:"onUpdate",value:function(t){throw"未实现onUpdate方法"}},{key:"getContainer",value:function(){throw"未实现getContainer方法"}},{key:"getSize",value:function(){throw"未实现getSize方法"}},{key:"getTilt",value:function(){throw"未实现getTilt方法"}},{key:"getHeading",value:function(){throw"未实现getHeading方法"}},{key:"getZoomUnits",value:function(){throw"未实现getZoomUnits方法"}},{key:"getCenter",value:function(){throw"未实现getCenter方法"}},{key:"getMapType",value:function(){throw"未实现getMapType方法"}},{key:"lnglatToMercator",value:function(t,e){return"gcj02"===this.options.coordinateSystem?(e=e*Math.PI/180,e=3189068.5*Math.log((1+Math.sin(e))/(1-Math.sin(e))),[parseFloat((t*Math.PI/180*6378137).toFixed(2)),parseFloat(e.toFixed(2))]):[(t=f.convertLL2MC({lng:t,lat:e})).lng,t.lat]}}]),r}(),As=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).eventMap={},t}return In(e,_s),ar(e,[{key:"onResize",value:function(t){this.map.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onMousemove",value:function(t){t=this.extendCallback(t),this.map.addEventListener("mousemove",t),this.eventMap.mousemove=t}},{key:"onClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("click",t),this.eventMap.click=t}},{key:"onDblClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("dblclick",t),this.eventMap.dblclick=t}},{key:"onRightClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("rightclick",t),this.eventMap.rightclick=t}},{key:"onUpdate",value:function(t){this.map.addEventListener("update",t),this.map.addEventListener("onearthstatuschange",t),this.eventMap.update=t,this.eventMap.onearthstatuschange=t}},{key:"extendCallback",value:function(e){return function(t){e(Xe(t,{x:t.x,y:t.y}))}}},{key:"unbind",value:function(t){var e=this;this.eventMap[t]?(this.map.removeEventListener(t,this.eventMap[t]),delete this.eventMap[t]):(ke(this.eventMap).forEach(function(t){e.map.removeEventListener(t,e.eventMap[t])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var t=this.map.getCenter();return t=-180<=t.lng&&t.lng<=180?{lng:(t=this.map.lnglatToMercator(t.lng,t.lat))[0],lat:t[1]}:t}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(t,e){return this.map.lnglatToMercator(t,e)}},{key:"mercatorToLnglat",value:function(t,e){return this.map.mercatorToLnglat(t,e)}}]),e}(),ws=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).div=document.createElement("div"),t.div.style.position="absolute",t.div.style.userSelect="none",t.map.getPanes().mapPane.appendChild(t.div),t.eventMap={},t}return In(e,_s),ar(e,[{key:"onResize",value:function(t){this.map.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onMousemove",value:function(t){t=this.extendCallback(t),this.map.addEventListener("mousemove",t),this.eventMap.mousemove=t}},{key:"onClick",value:function(t){t=this.extendCallback(t),Mi?(this.map.addEventListener("touchend",t),this.eventMap.touchend=t):(this.map.addEventListener("click",t),this.eventMap.click=t)}},{key:"onDblClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("dblclick",t),this.eventMap.dblclick=t}},{key:"onRightClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("rightclick",t),this.eventMap.rightclick=t}},{key:"changeCanvas",value:function(){var t=(r=this.map).getSize(),e=r.getCenter(),r=r.pointToOverlayPixel(e);this.div.style.left=r.x-t.width/2+"px",this.div.style.top=r.y-t.height/2+"px"}},{key:"onUpdate",value:function(t){function e(){r.changeCanvas(),t()}var r=this;this.map.addEventListener("moveend",e),this.map.addEventListener("moving",e),this.map.addEventListener("zoomend",e),this.eventMap.moveend=e,this.eventMap.moving=e,this.eventMap.zoomend=e}},{key:"extendCallback",value:function(e){return function(t){e(Xe(t,{x:t.pixel.x,y:t.pixel.y}))}}},{key:"unbind",value:function(){var e=this;ke(this.eventMap).forEach(function(t){e.map.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var t=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(t):Math.pow(2,18-t)}},{key:"getCenter",value:function(){var t=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:t.x,lat:t.y}}},{key:"lnglatToMercator",value:function(t,e){return[(t=this.map.getMapType().getProjection().lngLatToPoint({lng:t,lat:e})).x,t.y]}},{key:"mercatorToLnglat",value:function(t,e){return[(t=this.map.getMapType().getProjection().pointToLngLat({lng:t,lat:e})).lng,t.lat]}}]),e}(),Ms=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).eventMap={},t}return In(e,_s),ar(e,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;ke(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var t=this.map;return{width:t.canvas.clientWidth,height:t.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var t=this.map;return 6.8*t.scene.globe.ellipsoid.cartesianToCartographic(t.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var t=(t=this.map).camera.pickEllipsoid(new Cesium.Cartesian2(t.canvas.clientWidth/2,t.canvas.clientHeight/2));return t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),{lng:(t=this.getMercator([180*t.longitude/Math.PI,180*t.latitude/Math.PI]))[0],lat:t[1]}}},{key:"getMercator",value:function(t){var e=[];return e[0]=t[0]*Math.PI/180*6378137,t=t[1]*Math.PI/180,e[1]=3189068.5*Math.log((1+Math.sin(t))/(1-Math.sin(t))),e}}]),e}(),Cs=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).eventMap={},t}return In(e,_s),ar(e,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;ke(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),e}(),Ts=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).eventMap={},t}return In(r,_s),ar(r,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;ke(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),r}(),Ss=function(){function n(t,e){var r=this;he(this,n),"bmap"===(e=e||{}).mapType?this.map=new ws(t,e):"blank"===e.mapType?this.map=new Cs(t,e):"cesium"===e.mapType?this.map=new Ms(t,e):"three"===e.mapType?this.map=new Ts(t,e):(e.mapType="bmapgl",this.map=new As(t,e)),this.map.type=e.mapType,this._dpr=window.devicePixelRatio,"bmapgl"===e.mapType&&(this._dpr=this.map.map.config.ratio),this.options=e||{},this.renderArr=[],(t=e.canvas)||(t=document.createElement("canvas")),this.canvas=t,this.gl=e.gl||B(t,e),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(t){r.gl.getExtension(t)}),this.changeSize(),this.projectionMatrix=rs.create(Float64Array),this.orthoMatrix=rs.create(Float64Array),this.matrix=rs.create(Float64Array),this.viewMatrix=rs.create(Float64Array),this.pointToPixelMatrix=rs.create(Float64Array),this.pixelToViewMatrix=rs.create(Float64Array),this.fovy=35,this.fps=Math.min(e.fps,60)||60,this.renderTime=(new Date).valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new ls({gl:this.gl}),this.pickFBO=new ds(this.gl),this.transferOptions={},this.bind()}return ar(n,[{key:"bind",value:function(){var e=this,t=this.map;t.onResize(function(){e.changeSize(),e.render()}),t.onUpdate(this._update),t.onClick&&t.onClick(function(t){e.onClick&&e.onClick(t)}),t.onDblClick&&t.onDblClick(function(t){e.onDblClick&&e.onDblClick(t)}),t.onRightClick&&t.onRightClick(function(t){e.onRightClick&&e.onRightClick(t)}),t.onMousemove&&t.onMousemove(function(t){e.onMousemove&&e.onMousemove(t)}),this.options.canvas||t.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var t=this.map;t.unbind&&t.unbind()}},{key:"setOptions",value:function(t){this.options=t}},{key:"onInitialize",value:function(t){t&&(this.transferOptions=t.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(t){var e=this.gl;t?e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer):e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var t=this.gl;this.preFramebuffer=t.getParameter(t.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(t){this.renderArr.push(t)}},{key:"changeSize",value:function(){var t,e,r,n=this.canvas,i=this.options;n&&(t=n.style,e=this.map.getSize(),r=this._dpr,n.width=e.width*r,n.height=e.height*r,t.cssText="position: absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px;z-index:2;","cesium"!==i.mapType||i.canvas||(t.pointerEvents="none"),this.gl.viewport(0,0,n.width,n.height))}},{key:"update",value:function(){!1===this.options.autoUpdate||this.isAnimation&&60<=this.fps||this.render()}},{key:"render",value:function(){if(this.map&&this.gl){var t,e=this.options,r=this.projectionMatrix,n=this.viewMatrix;for("three"===e.mapType?(r=(n=this.map.map.camera).projectionMatrix.elements,n=n.matrixWorldInverse.elements):"cesium"===e.mapType?(t=(n=this.map.map).camera.frustum.projectionMatrix,r=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]),t=n.camera.viewMatrix,n=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]])):"B_EARTH_MAP"===this.map.map.mapType?(r=this.map.map.getEarth().scene._camera.getProjectionMatrix(),n=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix()),t=rs.multiply(this.matrix,r,n),Xe(this.transferOptions,{gl:this.gl,matrix:t,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:r,orthoMatrix:this.orthoMatrix,viewMatrix:n,stateManager:this.stateManager}),"three"!==e.mapType&&"cesium"!==e.mapType&&!1!==e.autoUpdate&&this.clear(),e=0;e<this.renderArr.length;e++)this.renderArr[e]&&this.renderArr[e].bind(this)(this.transferOptions)}}},{key:"clear",value:function(t){var e=this.gl,r=this.options.clearColor||[0,0,0,0];e.clearColor(r[0],r[1],r[2],r[3]),t&&(t instanceof Array||(t=c(t).unitArray()),e.clearColor(t[0],t[1],t[2],t[3])),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var t=this.gl.canvas.width/this.gl.canvas.height,e=this.options.cameraNear||1,r=this.options.cameraFar||4e3;rs.perspective(this.projectionMatrix,u(this.fovy),t,e,r),t=this.map.getSize(),rs.ortho(this.orthoMatrix,-t.width/2,t.width/2,-t.height/2,t.height/2,e,r)}},{key:"updateModelViewMatrix",value:function(){var t=this.map,e=this.viewMatrix,r=this.pointToPixelMatrix,n=this.pixelToViewMatrix;rs.identity(e),rs.identity(r),rs.identity(n);var i=t.getSize(),i=Math.round(-i.height/(2*Math.tan(u(this.fovy)/2)));rs.translate(n,n,[0,0,i]),rs.rotate(n,n,u(t.getTilt()),[-1,0,0]),rs.rotate(n,n,u(t.getHeading()),[0,0,-1]),i=t.getCenter();var a=this.options.pointOffset||[0,0],t=t.getZoomUnits();rs.translate(r,r,[(a[0]-i.lng)/t,(a[1]-i.lat)/t,0]),t=1/t,rs.scale(r,r,[t,t,t]),rs.multiply(e,n,r)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var t=this.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this.map.getContainer().removeChild(this.canvas),this.gl=this.canvas=null}},{key:"animation",value:function(){var t,e,r;this.isAnimation&&(60<=this.fps?this.render():(t=(new Date).valueOf(),(e=Math.floor(1e3/this.fps))<(r=t-this.renderTime)&&(this.render(),this.renderTime=t-r%e)),window.requestAnimationFrame(this._animation))}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),n}(),Es=function(){function e(t){he(this,e),this.layers=[],this.options=t,this.webglLayer=t.webglLayer}return ar(e,[{key:"addLayer",value:function(t){for(var e=!1,r=0;r<this.layers.length;r++)if(this.layers[r]===t){e=!0;break}e||(t.map=this.webglLayer.map,"threeLayer"===t.layerType?(t.setWebglLayer(this.webglLayer),e=t.getThreeLayer(),this.addLayer(e),t.initialize&&t.initialize(e)):(t.setWebglLayer(this.webglLayer),t.commonInitialize&&t.commonInitialize(this.webglLayer.gl),t.initialize&&t.initialize(this.webglLayer.gl),t.onOptionsChanged(t.getOptions(),{}),t.onDataChanged(t.getData()),t.onChanged(t.getOptions(),t.getData())),this.putInLayer(t)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(t){void 0===t.options.renderOrder&&(t.options.renderOrder=this.layers.length),this.layers.push(t),this.layers=this.layers.sort(function(t,e){return t.options.renderOrder-e.options.renderOrder})}},{key:"removeLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&this.layers.splice(e,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&t.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&t.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var t=0;t<this.layers.length;t++){var e=this.layers[t];e.destroy&&e.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var t=[],e=0;e<this.layers.length;e++){var r=this.layers[e];"ThreeLayer"===r.layerType&&t.push(r)}return t}},{key:"isRequestAnimation",value:function(){for(var t=!1,e=0;e<this.layers.length;e++)if(this.layers[e].isRequestAnimation()){t=!0;break}return t}},{key:"beforeRender",value:function(t){t.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(t){(t=t.gl)&&(t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.useProgram(null))}},{key:"renderGLLayers",value:function(t){this.webglLayer.stateManager.save();for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||(this.beforeRender(t),i.render(t),this.afterRender(t)))}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(t){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[t.gl.SRC_ALPHA,t.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:t.gl.LESS,cullFace:!1});for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"ThreeLayer"===i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||i.render(t))}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(t){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[t.gl.SRC_ALPHA,t.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:t.gl.LESS,cullFace:!1});for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"===i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||i.render(t))}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onDblClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onDblClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onDblClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onRightClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onRightClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onRightClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onMousemove",value:function(t){for(var e=!1,r=0;r<this.layers.length;r++){var n,i,a=this.layers[r];!0===a._visible&&"threeLayer"!==a.layerType&&"ThreeLayer"!==a.layerType&&(n=a.map.getZoom(),(i=a.getOptions().zoomThreshold)&&(n<=i[0]||n>=i[1])||!a.options.enablePicked||!a.pick||(n=a.pick(t.x,t.y),this.webglLayer.map.map.platform.style.cursor=-1===n.dataIndex?"default":"pointer",a.options.onMousemove&&a.options.onMousemove(n,t),a.options.autoSelect&&(e=!0)))}e&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),e}(),Is=function(){function n(t){var e=this;he(this,n),this.options={autoUpdate:!0},this._visible=!0,Xe(this.options,t);var r=t.pointOffset;this.webglLayer=t.webglLayer||new Ss(t.map,this.options),this.layerManager=new Es({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new bs(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(t){e._render(t)}),this.webglLayer.onClick=function(t){e._visible&&e.layerManager.onClick(t)},this.webglLayer.onDblClick=function(t){e._visible&&e.layerManager.onDblClick(t)},this.webglLayer.onRightClick=function(t){e._visible&&e.layerManager.onRightClick(t)},this.webglLayer.onMousemove=function(t){e._visible&&e.layerManager.onMousemove(t)},r||"cesium"===this.webglLayer.options.mapType||(r=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[r.lng,r.lat]),this.webglLayer.map.onResize(function(){e.effectManager.onResize()}),(this.postProcessing=t.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),t=this.postProcessing.getThreeLayer(),this.addLayer(t),this.postProcessing.initialize(t),t.postProcessing=this.postProcessing)}return ar(n,[{key:"renderCanvas",value:function(t){var e=this;this.postProcessing?this.postProcessing.addRender(function(){e.layerManager.renderGLLayers(t)}):this.layerManager.renderGLLayers(t),this.layerManager.renderThreeLayers(t),this.layerManager.renderThreeLayer(t)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(t){var e,r=this;this._visible&&((e=this.options.effects)&&0<e.length?(this.webglRender.render=function(){r.renderCanvas(t)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(t),this.webglLayer.restoreFramebuffer()))}},{key:"onRender",value:function(t){this.webglLayer.onRender(t)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){!0!==this._visible&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){!1!==this._visible&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(t){this.layerManager.showLayer(t)}},{key:"hideLayer",value:function(t){this.layerManager.hideLayer(t)}},{key:"add",value:function(t){this.addLayer(t)}},{key:"remove",value:function(t){this.removeLayer(t)}},{key:"addLayer",value:function(t){this.layerManager.addLayer(t)}},{key:"removeLayer",value:function(t){this.layerManager.removeLayer(t)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),n}(),Ls=function(){function e(t){he(this,e),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=Xe(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=Xe(this.options,t),this.options.data&&(this.data=this.options.data,delete this.options.data)}return ar(e,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(t){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(t,e){e=e||{},this.data=t,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),e),!1!==e.autoRender&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(t,e){t=t||{},e=e||{};var r=Xe({},this.getOptions());Xe(this.options,t),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),r),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),e),t.data?(this.setData(t.data,e),delete t.data):!1!==e.autoRender&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(t,e){}},{key:"onDataChanged",value:function(t){}},{key:"onChanged",value:function(t,e){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(t,e){}},{key:"setWebglLayer",value:function(t){this.webglLayer=t}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),e}(),Rs=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).pickedColor=[-1,-1,-1],t}return In(e,Ls),ar(e,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(t){var e=this.getOptions();this.gl=t,e.enablePicked&&(this.pickBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var t=[];return this.getOptions().enablePicked&&t.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),t}},{key:"getProperty",value:function(t,e,r){return"[object Function]"===Object.prototype.toString.call(e)?e(r):(e=r[t]||e,e="properties"in r&&t in r.properties?r.properties[t]:e)}},{key:"normizedColor",value:function(t){var e=t;return void 0===(e=!(t instanceof Array)?c(t).unitArray():e)[3]&&(e[3]=1),e}},{key:"normizedPoint",value:function(t){var e=this.getPointOffset();if(!t||!t[0]||!t[1])return[e[0],e[1],0];var r=Number(t[0]),n=Number(t[1]);-180<=r&&r<=180&&-90<=n&&n<=90&&(r=(n=this.webglLayer.map.lnglatToMercator(r,n))[0],n=n[1]);var i=Number(t[2])||0;return this.webglLayer&&"cesium"===this.webglLayer.options.mapType&&window.Cesium?(r=this.convertLngLat([r,n]),r=(i=window.Cesium.Cartesian3.fromDegrees(r[0],r[1],i)).x,n=i.y,i=i.z):this.webglLayer&&"bmapgl"===this.webglLayer.options.mapType&&"B_EARTH_MAP"===this.webglLayer.map.map.mapType&&(r=this.convertLngLat([r,n]),r=(i=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:r[0],lat:r[1]})).x,n=i.y,i=i.z),3<t.length?[r-e[0],n-e[1],i].concat(Jn(t.slice(3))):[r-e[0],n-e[1],i]}},{key:"convertLngLat",value:function(t){return[t[0]/20037508.34*180,180/Math.PI*(2*Math.atan(Math.exp(t[1]/20037508.34*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var t=[0,0],e=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?t=this.webglLayer.options.pointOffset:e.pointOffset&&(t=e.pointOffset),t}},{key:"indexToRgb",value:function(t){t++;var e=Math.floor(t/65536);t-=65536*e;var r=Math.floor(t/256);return[t-256*r,r,e]}},{key:"rgbToIndex",value:function(t){return t[0]+256*t[1]+65536*t[2]-1}},{key:"getCommonUniforms",value:function(t){t=t.isPickRender;var e,r=this.getOptions(),n={};return r.enablePicked&&(e=0<=r.selectedIndex?r.selectedIndex:-1,e=r.autoSelect?this.pickedColor:this.indexToRgb(e),n=Xe(n,{uSelectedColor:this.normizedColor(r.selectedColor),uEnablePicked:r.enablePicked,uPickedColor:e.map(function(t){return t/255}),uIsPickRender:!!t})),n}},{key:"pick",value:function(t,e){var r=this.gl,n=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:r,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var i=new Uint8Array(4);return r.readPixels(t*n,r.canvas.height-e*n,1,1,r.RGBA,r.UNSIGNED_BYTE,i),t=this.rgbToIndex(i),e=this.getData(),this.pickedColor=[i[0],i[1],i[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:t,dataItem:e[t]}}},{key:"setGLState",value:function(t){this.webglLayer.stateManager.setState(t)}},{key:"addMultipleCoords",value:function(t,e,r){if(!this.options.repeat||!this.webglLayer||"bmapgl"!==this.webglLayer.options.mapType||"B_EARTH_MAP"===this.webglLayer.map.map.mapType)return[t];var n=this.webglLayer.map.map;e=e||n.getZoom();var i=r?n.worldSize(e):40075452.74461451;if(e=function(t){return[[t[0]-i,t[1],t[2]||0],[t[0]+i,t[1],t[2]||0]]},t instanceof Array&&!(t[0]instanceof Array))return e=e(t),[t,(e=Hn(e,2))[0],e[1]];if(t instanceof Array&&t[0]instanceof Array&&!(t[0][0]instanceof Array)){r=[];for(var n=[],a=0;a<t.length;a++){var o=e(t[a]),s=(o=Hn(o,2))[1];r.push(o[0]),n.push(s)}return[t,r,n]}for(r=[],n=[],a=0;a<t.length;a++){o=[];for(var s=[],l=0;l<t[a].length;l++){var u=e(t[a][l]),c=(u=Hn(u,2))[1];o.push(u[0]),s.push(c)}r.push(o),n.push(s)}return[t,r,n]}}]),e}(),Ps=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).name="CircleLayer",t.bufferData=[],t.initializeTime=new Date,t}return In(e,Rs),ar(e,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,size:10,unit:"px",color:"blue",antialias:!0}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.program=new ss(this.gl,{vertexShader:"attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;vSize=aSize*uZoomUnits;if(aIndex==1.0){x+=vSize;y-=vSize;}else if(aIndex==2.0){x-=vSize;y+=vSize;}else if(aIndex==3.0){x+=vSize;y+=vSize;}else{x-=vSize;y-=vSize;}vPosition=vec4(aPos.xyz,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}",fragmentShader:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float lineWidth;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>vSize){discard;}vec4 color=vColor;if(uAntiAliasing==1.0&&d>0.9*vSize&&d<=vSize){color.a*=1.0-smoothstep(0.9*vSize,vSize,d);}gl_FragColor=color;}",defines:e.enablePicked?["PICK"]:[]},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{stride:36,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:36,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:36,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:36,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:20}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onChanged",value:function(t,e){this.gl&&e&&(this.uniforms={},this.data=e,this.processData(),t.enablePicked&&this.parsePickData(e))}},{key:"processData",value:function(){var a=this,o=[],s=[];this.data.forEach(function(t,e){var r=t.color||t.properties&&t.properties.color||a.options.color,n=t.size||t.properties&&t.properties.size||a.options.size,r=a.normizedColor(r);t=a.normizedPoint(t.geometry.coordinates);for(var i=0;i<4;i++)o.push(t[0],t[1],t[2]||0,n,i),o.push(r[0],r[1],r[2],r[3]);r=4*e,0<e&&s.push(r-1,r),s.push(r,r+1,r+2,r+3)}),this.bufferData=o,this.indexData=s,this.buffer.updateData(new Float32Array(o)),this.indexBuffer.updateData(new Uint32Array(s))}},{key:"parsePickData",value:function(t){var e=[];if(this.getOptions().enablePicked){for(var r=0;r<t.length;r++){var n=this.indexToRgb(r);e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255)}this.pickBuffer.updateData(new Float32Array(e))}}},{key:"render",value:function(t){var e=this.getOptions(),r=this.program,n=t.gl,i=t.matrix;this.setGLState({blend:!0,blendEquation:n.FUNC_ADD,blendFunc:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA],depthTest:e.depthTest,depthMask:e.depthWrite}),r.use(n),this.vertexArray.bind(),this.indexBuffer.bind(),e=this.map.getZoomUnits(),Xe(this.uniforms,this.getCommonUniforms(t),{uZoomUnits:"px"===this.options.unit?e:1,uMatrix:i,uAntiAliasing:this.options.antialias?1:0}),r.setUniforms(this.uniforms),n.drawElements(n.TRIANGLE_STRIP,this.indexData.length,n.UNSIGNED_INT,0)}}]),e}(),Ds={wave:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;float R=vRadius;float center=vSize;float time=vStartTime+uTime;float alpha=sin((R-d)/R*trail*2.0*3.14+time/duration);if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){if(alpha>=0.5){color.a=0.9;}else{color.a=1.0-smoothstep(0.9*center,center,d);}}}else{if(alpha>=0.5){color.a=0.9;if(uAntiAliasing==1.0){if(alpha>=0.5&&alpha<=0.6){color.a*=smoothstep(0.0,0.1,alpha-0.5);}if(d>=0.98*R&&d<=R){color.a*=1.0-smoothstep(0.98,1.0,d/R);}}}else{color.a=0.0;}}gl_FragColor=color;}",bubble:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}float center=vSize;float R=vRadius;float r=R*percent;vec4 color=vColor;if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){color.a=1.0-smoothstep(0.9*center,center,d);}}else{if(d<r){color.a=smoothstep(0.1,0.9,pow(d/r,2.0)*0.9);if(uAntiAliasing==1.0&&d>=0.9*r&&d<=r){color.a*=1.0-smoothstep(0.9,1.0,d/r);}if(range>duration){color.a*=1.0-(range-duration)/trail;}}else{color.a=0.0;}}gl_FragColor=color;}",breath:"varying vec4 vPosition;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;if(uAntiAliasing==1.0&&d>0.9*vRadius&&d<=vRadius){color.a=1.0-smoothstep(0.9*vRadius,vRadius,d);}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}color.a*=abs(1.0-percent*2.0)+0.2;gl_FragColor=color;}"},Os=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).name="RippleCircleLayer",t.autoUpdate=!0,t.bufferData=[],t.initializeTime=new Date,t}return In(e,Rs),ar(e,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,type:"bubble",size:10,duration:1,trail:1,unit:"px",random:!0,color:"blue",antialias:!0,radius:function(t){return 2*t}}}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aStartTime;attribute float aRadius;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vWidth;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vStartTime=aStartTime;vSize=aSize*uZoomUnits;vRadius=aRadius*uZoomUnits;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;float R=vRadius;if(aIndex==1.0){x+=R;y-=R;}else if(aIndex==2.0){x-=R;y+=R;}else if(aIndex==3.0){x+=R;y+=R;}else{x-=R;y-=R;}vPosition=vec4(aPos.xy,z,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}",fragmentShader:Ds[this.options.type]||"bubble",defines:this.options.enablePicked?["PICK"]:[]},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var e=(e=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:20},{stride:44,name:"aRadius",buffer:this.buffer,size:1,type:"FLOAT",offset:36},{stride:44,name:"aStartTime",buffer:this.buffer,size:1,type:"FLOAT",offset:40}]).concat(this.getCommonAttributes());this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onChanged",value:function(t,e){this.gl&&e&&(this.uniforms={duration:t.duration,trail:t.trail},this.data=e,this.processData(),t.enablePicked&&this.parsePickData(e))}},{key:"processData",value:function(){var s=this,l=[],u=[];this.data.forEach(function(t,e){var r=t.size||s.options.size,n=t.radius||s.options.radius||1.618*r;"function"==typeof n&&(n=n(r));var i=t.color||s.options.color,i=s.normizedColor(i);t=s.normizedPoint(t.geometry.coordinates);for(var a=s.options.random?Math.random()*s.data.length*9999:0,o=0;o<4;o++)l.push(t[0],t[1],t[2]||0,r,o),l.push(i[0],i[1],i[2],i[3]),l.push(n),l.push(a);r=4*e,0<e&&u.push(r-1,r),u.push(r,r+1,r+2,r+3)}),this.bufferData=l,this.indexData=u,this.buffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(u))}},{key:"parsePickData",value:function(t){var e=[];if(this.getOptions().enablePicked){for(var r=0;r<t.length;r++){var n=this.indexToRgb(r);e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255),e.push(n[0]/255,n[1]/255,n[2]/255)}this.pickBuffer.updateData(new Float32Array(e))}}},{key:"render",value:function(t){var e=this.getOptions(),r=this.program,n=t.gl,i=t.matrix;r.use(n);var a=this.map.getZoomUnits();Xe(this.uniforms,this.getCommonUniforms(t),{uTime:(new Date-this.initializeTime)/1e3,uZoomUnits:"m"===e.unit?1:a,uMatrix:i,uAntiAliasing:e.antialias?1:0}),r.setUniforms(this.uniforms),this.setGLState({blend:!0,blendEquation:n.FUNC_ADD,blendFunc:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA],depthTest:e.depthTest,depthMask:e.depthWrite}),0<this.indexData.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),n.drawElements(n.TRIANGLE_STRIP,this.indexData.length,n.UNSIGNED_INT,0))}}]),e}(),Fs=ke(Ds),Bs=r(n(function(t,e){e.__esModule=!0;var a=Ke&&Ke.__esModule?Ke:{default:Ke},o=li&&li.__esModule?li:{default:li};e.default=function t(e,r,n){null===e&&(e=Function.prototype);var i=(0,o.default)(e,r);return void 0!==i?"value"in i?i.value:void 0===(r=i.get)?void 0:r.call(n):null!==(e=(0,a.default)(e))?t(e,r,n):void 0}}));U.deviation=function(t,e,r,n){var i=e&&e.length,a=Math.abs(rt(t,0,i?e[0]*r:t.length,r));if(i)for(var i=0,o=e.length;i<o;i++)a-=Math.abs(rt(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r));for(i=e=0;i<n.length;i+=3){var o=n[i]*r,s=n[i+1]*r,l=n[i+2]*r;e+=Math.abs((t[o]-t[l])*(t[1+s]-t[o+1])-(t[o]-t[s])*(t[1+l]-t[o+1]))}return 0===a&&0===e?0:Math.abs((e-a)/a)},U.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var o=0;o<e;o++)r.vertices.push(t[i][a][o]);0<i&&(n+=t[i-1].length,r.holes.push(n))}return r},U.default=U;var Ns=void 0===vn?"__target":vn(),zs=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Us=window.URL||window.webkitURL,ks=window.Worker;if(ks){var Hs=nt("self.onmessage = function () {}"),Gs=new Uint8Array(1);try{if(/(?:Trident|Edge)\/(?:[567]|12)/i.test(navigator.userAgent))throw Error("Not available");var Vs=new ks(Hs);Vs.postMessage(Gs,[Gs.buffer])}catch(t){ks=null}finally{Us.revokeObjectURL(Hs),Vs&&Vs.terminate()}}var Ws=new function(t,n){return function(t){var e=this;if(n,ks&&!t)return t=nt(t=(""+n).replace(/^function.+?{/,"").slice(0,-1)),this[Ns]=new ks(t),Us.revokeObjectURL(t),this[Ns];var r={postMessage:function(t){e.onmessage&&setTimeout(function(){return e.onmessage({data:t,target:r})})}};n.call(r),this.postMessage=function(t){setTimeout(function(){return r.onmessage({data:t,target:e})})},this.isThisThread=!0}}(0,function(t,e){}),js={window:1,windowAnimation:2,gradual:3,ripple:4,water:6},Xs=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="ShapeLayer",t._isShow=!0,("windowAnimation"===(e=t.getOptions()).style||"ripple"===e.style||0<e.riseTime)&&(t.autoUpdate=!0),t.selectedColor=[-1,-1,-1],t.textureCache={},t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:"rgba(50, 50, 230, 1.0)",opacity:.8,height:0,isTextureFull:!1,topColor:"rgba(76, 76, 76, 0.8)",textureRotate:0,textureScale:1,useLight:!0,riseTime:0,polygonOffset:[0,0],depthTest:!0}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.dataMgr=new it(this,this.gl),this.texture=null,this.isUseTexture=!1;var r=[];e.enablePicked&&r.push("PICK"),e.texture&&r.push("USE_TEXTURE"),this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform vec4 uSelectedColor;attribute vec4 a_pos;attribute vec3 a_normal;attribute vec4 a_color;attribute vec4 a_pre_color;attribute float a_height;attribute float a_pre_height;\n#if defined(USE_TEXTURE)\nattribute vec2 a_texture_coord;\n#endif\nuniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_use_lighting;uniform bool u_use_texture;uniform vec3 u_ripple_center;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform float dataTime;uniform float riseTime;uniform vec2 uMapCenter;uniform float uMapZoom;varying float v_height;varying vec4 v_color;varying vec3 v_position;varying vec2 v_texture_coord;const vec3 point_color=vec3(0.06,0.06,0.06);const vec3 light_color=vec3(0.53,0.53,0.53);const vec3 light_color_2=vec3(0.4,0.4,0.4);const vec3 uAmbientColor=vec3(0.8,0.8,0.8);const vec3 uLightingDirection=vec3(0.0,1.0,1.0);const vec3 uDirectionalColor=vec3(1.0,1.0,1.0);float getTransitionValue(float pre_value,float to_value,float dataTime,float riseTime){float result=0.0;if(pre_value==to_value){result=to_value;}else{if(riseTime>0.0&&dataTime<riseTime){result=(pre_value+(to_value-pre_value)*(dataTime/riseTime));}else{result=to_value;}}return result;}void main(){vec4 pos=a_pos;pos.z=pos.z+pos.w*getTransitionValue(a_pre_height,a_height,dataTime,riseTime);v_position=pos.xyz;v_height=a_height;\n#if defined(USE_TEXTURE)\nif(u_use_texture){v_texture_coord=a_texture_coord;}\n#endif\nvec4 position=u_proj_matrix*u_mv_matrix*vec4(pos.xyz,1.0);gl_Position=position;vec4 icolor=a_color;\n#if defined(PICK)\nif(mapvIsPicked()){icolor=uSelectedColor;}\n#endif\nif(u_use_lighting){vec3 N=normalize(vec3(u_normal_matrix*vec4(a_normal,1.0)));vec4 point_dir=u_mv_matrix*vec4(0,1,0,0);vec3 L_point=normalize(point_dir.xyz);float lambert_point=max(0.0,dot(N,-L_point));vec4 light_dir=u_mv_matrix*vec4(u_side_light_dir,0);vec3 L=normalize(light_dir.xyz);float lambert=max(0.0,dot(N,-L));if(pos.z<5.0){float deepGradientColor=(5.0-pos.z)/8.0;lambert=lambert-deepGradientColor;}vec4 light_dir_2=u_mv_matrix*vec4(0,0,-1,0);vec3 L2=normalize(light_dir_2.xyz);float lambert_2=max(0.0,dot(N,-L2));if(a_pre_color.r==a_color.r&&a_pre_color.g==a_color.g&&a_pre_color.b==a_color.b){}else{if(riseTime>0.0&&dataTime<riseTime){icolor.r=a_pre_color.r+(a_color.r-a_pre_color.r)*(dataTime/riseTime);icolor.g=a_pre_color.g+(a_color.g-a_pre_color.g)*(dataTime/riseTime);icolor.b=a_pre_color.b+(a_color.b-a_pre_color.b)*(dataTime/riseTime);}}v_color.rgb=icolor.rgb+icolor.rgb*light_color*lambert+icolor.rgb*light_color_2*lambert_2+icolor.rgb*point_color*lambert_point;v_color.a=icolor.a;if(u_use_texture){mat3 normalMatrix=mat3(u_normal_matrix);vec3 transformedNormal=normalMatrix*a_normal;vec3 dir=uLightingDirection;dir=vec3(normalMatrix*vec3(0.0,-1.0,2.0));float directionalLightWeighting=max(dot(normalize(transformedNormal),normalize(dir)),0.0);vec4 vLightWeighting;vLightWeighting=vec4(uAmbientColor+uDirectionalColor*directionalLightWeighting,1.0);v_color=vLightWeighting;}}else{v_color=icolor;}}",fragmentShader:"precision highp float;varying vec4 v_color;varying vec3 v_position;varying float v_height;varying vec2 v_texture_coord;uniform vec3 u_ripple_center;uniform vec4 top_color;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform sampler2D u_sampler;uniform bool u_use_lighting;uniform bool u_use_texture;void main(){vec4 color=vec4(v_color);vec4 textureColor=vec4(1.0,1.0,1.0,1.0);if(u_use_texture){if(style==6.0){float x=v_texture_coord.s;float y=v_texture_coord.t;vec2 cPos=-1.0+2.0*gl_FragCoord.xy/MAPV_resolution;float cLength=length(cPos);vec2 uv=gl_FragCoord.xy/MAPV_resolution+(cPos/cLength)*cos(cLength*12.0-time/1000.0*4.0)*0.03;textureColor=texture2D(u_sampler,uv/2.0+vec2(x,y));}else{textureColor=texture2D(u_sampler,vec2(v_texture_coord.s,v_texture_coord.t));}if(u_use_lighting){color=vec4(textureColor*v_color*1.1);}else{color=textureColor;}}if(style==1.0||style==2.0){float t=time/1000.0;float diffDistance=5.0;float modX=mod(v_position.x,diffDistance*2.0);float modZ=mod(v_position.z,diffDistance*2.0);if(modX<diffDistance&&modZ<diffDistance&&v_position.z<v_height){color*=1.05;if(time>0.0&&style==2.0){float iX=ceil(v_position.x/diffDistance);float iZ=ceil(v_position.z/diffDistance);float timeDistance=8.0;t+=tan(sin(iZ));color*=(1.0+mod(t,timeDistance)/timeDistance);}}color.a=alpha;}else if(style==5.0){float t=time/1000.0;float diffDistance=10.0;float modZ=mod(v_position.z-t*40.0,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.5);if(v_position.z/v_height<0.3){color.r+=0.2;color.g+=0.2;color.b+=0.2;}if(modZ<diffDistance*2.0-4.0){discard;}}else if(style==3.0){float diffDistance=10.0;float modX=mod(v_position.x,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.3);}else if(style==4.0){float dis=distance(u_ripple_center,v_position);float rSize=400.0;if(v_position.z>=v_height){color=top_color;}if(dis>u_radius-rSize&&dis<u_radius+rSize){color*=(1.0-abs(dis-u_radius)/rSize)*2.0+1.0;}}else if(style==6.0){}gl_FragColor=color;}",defines:r},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.heightBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.textureBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),r=[{name:"a_pos",buffer:this.vertexBuffer,stride:28,size:4,type:"FLOAT",offset:0},{name:"a_normal",buffer:this.vertexBuffer,size:3,stride:28,type:"FLOAT",offset:16},{name:"a_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:0},{name:"a_pre_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:16},{name:"a_height",buffer:this.heightBuffer,size:1,stride:8,type:"FLOAT",offset:0},{name:"a_pre_height",buffer:this.heightBuffer,size:1,stride:8,type:"FLOAT",offset:4}],e.texture&&r.push({name:"a_texture_coord",buffer:this.textureBuffer,size:2,stride:8,type:"FLOAT",offset:0}),r=r.concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:r}),this.initializeTime=new Date,this.normalMatrix=rs.create()}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){var r=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){r.loadTexture(function(){r.dataMgr.parseData(e),r.dataTime=new Date,r.webglLayer.render()})},0))}},{key:"render",value:function(t){var e,r,n,i,a,o,s=t.gl,l=t.projectionMatrix,u=t.viewMatrix;this._isShow?!(e=this.getData())||e.length<=0||(e=this.getOptions(),(r=this.program).use(s),e.texture&&!this.texture||(n=0,e.style&&js[e.style]&&(n=js[e.style]),i=[s.ONE,s.ZERO],e.blend&&(i=[s.ONE,s.ONE]),0!==e.height&&"gradual"!==e.style||(i=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA]),this.setGLState({cullFace:!1,blend:!0,blendEquation:s.FUNC_ADD,blendFunc:i,polygonOffset:e.polygonOffset,depthTest:e.depthTest,depthMask:"gradual"!==e.style}),i=this.normizedColor(e.topColor),"ripple"===e.style&&e.rippleLayer&&e.rippleLayer.data&&e.rippleLayer.data[0]&&(a=this.normizedPoint(e.rippleLayer.data[0].geometry.coordinates),r.setUniforms({u_ripple_center:[a[0],a[1],0],u_radius:e.rippleLayer.options.size*e.rippleLayer.currentScale})),a=Qo.fromValues(0,-1,2),e.lightDir&&(a=Qo.fromValues(e.lightDir[0],e.lightDir[1],e.lightDir[2])),o=this.normalMatrix,rs.invert(o,u),rs.transpose(o,o),r.setUniforms(Xe(this.getCommonUniforms(t),{u_normal_matrix:o,u_sampler:this.texture,u_proj_matrix:l,u_mv_matrix:u,style:n,top_color:i,u_use_lighting:e.useLight,u_use_texture:this.isUseTexture,alpha:void 0===e.opacity?.8:parseFloat(e.opacity),time:new Date-this.initializeTime,dataTime:new Date-this.dataTime,riseTime:e.riseTime,u_side_light_dir:a})),0<(t=this.dataMgr.getData()).vertex.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),s.drawElements(s.TRIANGLES,t.index.length,s.UNSIGNED_INT,0)))):this.webglLayer.clear()}},{key:"loadTexture",value:function(r){var n=this,t=this.getOptions();t.texture?(this.isUseTexture=!0,z(this.gl,t.texture,function(t,e){n.image=e,n.texture=t,r&&r(),n.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,r&&r())}}]),r}();it.prototype.initData=function(){this.outBuilding3d={pickColorVertex:[],vertex:[],texture:[],color:[],height:[],index:[]}},it.prototype.getData=function(){return this.outBuilding3d},it.prototype.initWorker=function(){this.worker=new Ws,this.worker.onmessage=function(t){}},it.prototype.parseData=function(t){var e=this;this.initData();for(var r=this.shapeLayer.getOptions(),n=0;n<t.length;n++){var i=t[n],a=i.height||r.height;"properties"in i&&"height"in i.properties&&(a=i.properties.height),a*=1;var o=i.color||r.color;"properties"in i&&"color"in i.properties&&(o=i.properties.color),"properties"in i&&"fillColor"in i.properties&&(o=i.properties.fillColor),"[object Function]"===Object.prototype.toString.call(o)&&(o=o(i));var o=this.shapeLayer.normizedColor(o),s=this.shapeLayer.getProperty("angle",r.textureRotate,i),l=void 0;r.enablePicked&&(l=this.shapeLayer.indexToRgb(n));var u=void 0,c=void 0;if(r.riseTime&&(c=i.preColor,"properties"in i&&"preColor"in i.properties&&(c=i.properties.preColor),u=i.preHeight,void 0===(u="properties"in i&&"preHeight"in i.properties?i.properties.preHeight:u)&&(u=0)),i.geometry.coordinates){if("LineString"===i.geometry.type){for(var h=i.geometry.coordinates.map(function(t){return e.shapeLayer.normizedPoint(t)}),h=(d=U.flatten([h])).vertices,d=d.holes,p=[],f=[],m=0;m<h.length;m+=3)p.push(h[m+0],h[m+1]),f.push(h[m+2]);this.parseBuilding3d(this.outBuilding3d,p,f,u,a,c,o,l,s,d)}if("MultiPolygon"===i.geometry.type){for(h=i.geometry.coordinates,i=[],d=0;d<h.length;d++)i.push(h[d].map(function(t){return t.map(function(t){return e.shapeLayer.normizedPoint(t)})}));for(h=0;h<i.length;h++){d=[];for(var p=[],f=(m=U.flatten(i[h])).vertices,m=m.holes,g=0;g<f.length;g+=3)d.push(f[g+0],f[g+1]),p.push(f[g+2]);this.parseBuilding3d(this.outBuilding3d,d,p,u,a,c,o,l,s,m)}}else{for(h=[],d=0;d<i.geometry.coordinates.length;d++)h.push(i.geometry.coordinates[d].map(function(t){return e.shapeLayer.normizedPoint(t)}));for(i=(h=U.flatten(h)).vertices,h=h.holes,d=[],p=[],f=0;f<i.length;f+=3)d.push(i[f+0],i[f+1]),p.push(i[f+2]);this.parseBuilding3d(this.outBuilding3d,d,p,u,a,c,o,l,s,h)}}}this.shapeLayer.vertexBuffer.updateData(new Float32Array(this.outBuilding3d.vertex)),this.shapeLayer.colorBuffer.updateData(new Float32Array(this.outBuilding3d.color)),this.shapeLayer.heightBuffer.updateData(new Float32Array(this.outBuilding3d.height)),this.shapeLayer.textureBuffer.updateData(new Float32Array(this.outBuilding3d.texture)),this.shapeLayer.indexBuffer.updateData(new Uint32Array(this.outBuilding3d.index)),r.enablePicked&&this.shapeLayer.pickBuffer.updateData(new Float32Array(this.outBuilding3d.pickColorVertex))},it.prototype.getBounds=function(t,e){for(var r=t[0],n=t[1],i=t[0],a=t[1],o=0;o<t.length;o+=2)r=Math.min(t[o],r),n=Math.min(t[o+1],n),i=Math.max(t[o],i),a=Math.max(t[o+1],a);if(o=[(i-r)/2+r,(a-n)/2+n],0===e||!e)return{minX:r,minY:n,maxX:i,maxY:a,width:i-r,height:a-n,center:o};for(r=t.slice(0),n=0;n<r.length;n+=2)i=at(t[n],t[n+1],o,e),r[n]=i[0],r[n+1]=i[1];return this.getBounds(r,0)},it.prototype.parseBuilding3d=function(t,e,r,n,i,a,o,s,l,u){void 0===n&&(n=i);var c=this.shapeLayer.options,h=t.vertex,d=t.texture,p=t.color,f=t.height,m=t.pickColorVertex;t=t.index,void 0===a&&(a=o);var g=0,v=0;if(this.shapeLayer.image&&(g=this.shapeLayer.image.width*c.textureScale,v=this.shapeLayer.image.height*c.textureScale),"gradual"!==c.style){var y,x=(u=u&&u.length?U(e,u,2):U(e))[0],b=u[1],_=u[2],x=[e[2*x],e[2*x+1],1],b=[e[2*b],e[2*b+1],1],A=[e[2*_],e[2*_+1],1],_=[];Qo.cross(_,[A[0]-b[0],A[1]-b[1],A[2]-b[2]],[x[0]-b[0],x[1]-b[1],x[2]-b[2]]),b=h.length/7,c.texture&&(y=this.getBounds(e,l)),x=c.isTextureFull;for(var w,M,A=0,C=e.length;A<C;A+=2)h.push(e[A],e[A+1],r[A/2],1,_[0],_[1],_[2]),p.push(o[0],o[1],o[2],o[3],a[0],a[1],a[2],a[3]),f.push(i,n),c.texture&&(w=at(e[A],e[A+1],y.center,l),w=(M=Hn(w,2))[0],M=M[1],M=x?(w=(w-y.minX)/y.width,(M-y.minY)/y.height):(w=(w-y.minX)/g,(M-y.minY)/v),d.push(w,M)),s&&m.push(s[0]/255,s[1]/255,s[2]/255);for(l=0,y=u.length;l<y;l++)t.push(u[l]+b)}if(!(i===n&&i<=0))for(l=0,u=e.length;l<u;l+=2)y=h.length/7,_=[C=e[l],w=e[l+1],r[l/2],0],b=[C,w,r[l/2],1],A=l+2,M=l+3,l===u-2&&(A=0,M=1),A=e[A],M=e[M],C=Math.sqrt(Math.pow(A-C,2),Math.pow(M-w,2)),w=[A,M,r[l/2],0],A=[A,M,r[l/2],1],M=[],Qo.cross(M,[w[0]-_[0],w[1]-_[1],w[2]-_[2]],[b[0]-_[0],b[1]-_[1],b[2]-_[2]]),h.push(_[0],_[1],_[2],_[3]),h.push(M[0],M[1],M[2]),h.push(b[0],b[1],b[2],b[3]),h.push(M[0],M[1],M[2]),h.push(w[0],w[1],w[2],w[3]),h.push(M[0],M[1],M[2]),h.push(A[0],A[1],A[2],A[3]),h.push(M[0],M[1],M[2]),p.push(o[0],o[1],o[2],o[3]),p.push(a[0],a[1],a[2],a[3]),p.push(o[0],o[1],o[2],o[3]),p.push(a[0],a[1],a[2],a[3]),p.push(o[0],o[1],o[2],o[3]),p.push(a[0],a[1],a[2],a[3]),p.push(o[0],o[1],o[2],o[3]),p.push(a[0],a[1],a[2],a[3]),f.push(i),f.push(n),f.push(i),f.push(n),f.push(i),f.push(n),f.push(i),f.push(n),c.texture&&(x?(d.push(0,0),d.push(0,1),d.push(1,0),d.push(1,1)):(d.push(0,0),d.push(0,i/v),d.push(C/g,0),d.push(C/g,i/v))),s&&(m.push(s[0]/255,s[1]/255,s[2]/255),m.push(s[0]/255,s[1]/255,s[2]/255),m.push(s[0]/255,s[1]/255,s[2]/255),m.push(s[0]/255,s[1]/255,s[2]/255)),t.push(y,y+2,y+3,y,y+3,y+1)};var qs=n(function(t,e){function c(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function s(t,e){return t<e?-1:e<t?1:0}function u(t,e){h(t,0,t.children.length,e,t)}function h(t,e,r,n,i){for((i=i||g(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;e<r;e++){var a=t.children[e];d(i,t.leaf?n(a):a)}return i}function d(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function p(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function l(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,r,n,i){for(var a,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=n||(function t(e,r,n,i,a){for(;n<i;){var o,s,l,u;for(600<i-n&&(o=i-n+1,s=r-n+1,u=Math.log(o),l=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*l*(o-l)/o)*(s-o/2<0?-1:1),t(e,r,Math.max(n,Math.floor(r-s*l/o+u)),Math.min(i,Math.floor(r+(o-s)*l/o+u)),a)),o=e[r],l=i,c(e,s=n,r),0<a(e[i],o)&&c(e,n,i);s<l;){for(c(e,s,l),s++,l--;a(e[s],o)<0;)s++;for(;0<a(e[l],o);)l--}0===a(e[n],o)?c(e,n,l):c(e,++l,i),l<=r&&(n=l+1),r<=l&&(i=l-1)}}(t,a=e+Math.ceil((r-e)/n/2)*n,e||0,r||t.length-1,i||s),o.push(e,a,a,r))}t.exports=((t=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}).prototype.all=function(){return this._all(this.data,[])},t.prototype.search=function(t){var e=this.data,r=[];if(!l(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?n(o):o;l(t,s)&&(e.leaf?r.push(o):m(t,s)?this._all(o,r):i.push(o))}e=i.pop()}return r},t.prototype.collides=function(t){var e=this.data;if(!l(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],a=e.leaf?this.toBBox(i):i;if(l(t,a)){if(e.leaf||m(t,a))return!0;r.push(i)}}e=r.pop()}return!1},t.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}return t=this._build(t.slice(),0,t.length-1,0),this.data.children.length?this.data.height===t.height?this._splitRoot(this.data,t):(this.data.height<t.height&&(e=this.data,this.data=t,t=e),this._insert(t,this.data.height-t.height-1,!0)):this.data=t,this},t.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},t.prototype.clear=function(){return this.data=g([]),this},t.prototype.remove=function(t,e){if(!t)return this;for(var r,n,i,a=this.data,o=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),n=s[s.length-1],r=l.pop(),i=!0),a.leaf){t:{var u=t,c=a.children,h=e;if(h){for(var d=0;d<c.length;d++)if(h(u,c[d])){u=d;break t}u=-1}else u=c.indexOf(u)}if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break}}i||a.leaf||!m(a,o)?n?(r++,a=n.children[r],i=!1):a=null:(s.push(a),l.push(r),r=0,a=(n=a).children[0])}return this},t.prototype.toBBox=function(t){return t},t.prototype.compareMinX=function(t,e){return t.minX-e.minX},t.prototype.compareMinY=function(t,e){return t.minY-e.minY},t.prototype.toJSON=function(){return this.data},t.prototype.fromJSON=function(t){return this.data=t,this},t.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},t.prototype._build=function(t,e,r,n){var i=r-e+1,a=this._maxEntries;if(i<=a){var o=g(t.slice(e,r+1));return u(o,this.toBBox),o}for(n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1))),(o=g([])).leaf=!1,o.height=n,v(t,e,r,a=(i=Math.ceil(i/a))*Math.ceil(Math.sqrt(a)),this.compareMinX);e<=r;e+=a){var s=Math.min(e+a-1,r);v(t,e,s,i,this.compareMinY);for(var l=e;l<=s;l+=i)o.children.push(this._build(t,l,Math.min(l+i-1,s),n-1))}return u(o,this.toBBox),o},t.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=p(l),c=(Math.max(l.maxX,t.maxX)-Math.min(l.minX,t.minX))*(Math.max(l.maxY,t.maxY)-Math.min(l.minY,t.minY))-u;c<a?(a=c,i=u<i?u:i,o=l):c===a&&u<i&&(i=u,o=l)}e=o||e.children[0]}return e},t.prototype._insert=function(t,e,r){r=r?t:this.toBBox(t);var n=[],i=this._chooseSubtree(r,this.data,e,n);for(i.children.push(t),d(i,r);0<=e&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(r,n,e)},t.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n),n=this._chooseSplitIndex(r,i,n),(n=g(r.children.splice(n,r.children.length-n))).height=r.height,n.leaf=r.leaf,u(r,this.toBBox),u(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(r,n)},t.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},t.prototype._chooseSplitIndex=function(t,e,r){for(var n,i=1/0,a=1/0,o=e;o<=r-e;o++){var s=h(t,0,o,this.toBBox),l=h(t,o,r,this.toBBox),u=Math.max(0,Math.min(s.maxX,l.maxX)-Math.max(s.minX,l.minX))*Math.max(0,Math.min(s.maxY,l.maxY)-Math.max(s.minY,l.minY)),s=p(s)+p(l);u<i?(i=u,n=o,a=s<a?s:a):u===i&&s<a&&(a=s,n=o)}return n||r-e},t.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:a,i=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,r,n)<(e=this._allDistMargin(t,e,r,i))&&t.children.sort(n)},t.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=h(t,0,e,n=this.toBBox),a=h(t,r-e,r,n),o=f(i)+f(a),s=e;s<r-e;s++){var l=t.children[s];d(i,t.leaf?n(l):l),o+=f(i)}for(r=r-e-1;e<=r;r--)i=t.children[r],d(a,t.leaf?n(i):i),o+=f(a);return o},t.prototype._adjustParentBBoxes=function(t,e,r){for(;0<=r;r--)d(e[r],t)},t.prototype._condense=function(t){for(var e,r=t.length-1;0<=r;r--)0===t[r].children.length?0<r?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():u(t[r],this.toBBox)},t)}),Ys=function(){function r(t){he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t))).name="TextLayer";var e=t.canvas=document.createElement("canvas");return(e=t.ctx=e.getContext("2d")).textAlign="start",e.textBaseline="top",t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{}}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}}",fragmentShader:"precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e)}},{key:"processCache",value:function(t,e){this.cachedData=[];for(var r=0;r<e.length;r++){var n=this.normizedPoint(e[r].geometry.coordinates),i=e[r].text;"properties"in e[r]&&"text"in e[r].properties&&(i=e[r].properties.text);var a=this.getProperty("angle",t.angle,e[r]),o=this.getProperty("color",t.color,e[r]);n&&void 0!==i&&this.cachedData.push({point:n,text:i,angle:a,color:o,index:r})}}},{key:"render",value:function(t){var e,r,n,i,a;this.cachedData&&this.cachedData.length&&this.map&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.throttleUpdate(t),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),a=this.map.getZoomUnits(),i.setUniforms(Xe(this.getCommonUniforms(t),{matrix:r,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:n.flat,offset:n.offset,zoomUnits:a,zIndex:n.zIndex,uUnitPx:"px"===n.unit})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"throttleUpdate",value:function(t){this.updateText(t)}},{key:"updateText",value:function(t){var e=t.gl,r=t.matrix;t=(p=this.getOptions()).fontSize;var n=p.fontFamily,i=p.padding,a=p.margin,o=p.collides,s=p.enablePicked,l=p.shadow,u=e.canvas.width/window.devicePixelRatio,c=e.canvas.height/window.devicePixelRatio,h=this.canvas;(e=this.ctx).save(),e.scale(window.devicePixelRatio,window.devicePixelRatio),e.textBaseline="top",e.font="20px "+n;for(var d=new qs,p=[],f=0;f<this.cachedData.length;f++){var m=(x=this.cachedData[f]).point,g=x.text,v=x.angle,y=x.color,x=x.index,b=Hn(m,3),b=Ko.clone([b[0],b[1],b[2],1]);Ko.transformMat4(b,b,r),Ko.scale(b,b,1/b[3]);var _=(b[0]+1)/2*u,A=(1-b[1])/2*c,w=e.measureText(g);b=w.width+2*i[0];var M=20;w.actualBoundingBoxAscent&&w.actualBoundingBoxDescent&&(M=w.actualBoundingBoxDescent-w.actualBoundingBoxAscent),M+=2*i[1];var C=b+a[0];if(w=(A-=(w=M+a[1])/2)+w,!((C=(_-=C/2)+C)<0||w<0||u<_||c<A)){if(o){if(w={minX:_,maxX:C,minY:A,maxY:w},d.collides(w))continue;d.insert(w)}p.push({w:b,h:M,point:m,text:g,angle:v,color:y,dataIndex:x})}}for(e.restore(),(r=(a=ot(p)).w)<=0&&(r=1),(a=a.h)<=0&&(a=1),h.width=r*window.devicePixelRatio,h.height=a*window.devicePixelRatio,e.save(),e.scale(window.devicePixelRatio,window.devicePixelRatio),e.textBaseline="top",e.font="20px "+n,e.shadowColor=l&&l.color,e.shadowOffsetX=l&&l.offsetX,e.shadowOffsetY=l&&l.offsetY,e.shadowBlur=l&&l.blur,n=[],l=[],h=[],o=[],u=0,c=p.length;u<c;++u){for(d=p[u],e.fillStyle=d.color,e.fillText(d.text,d.x+i[0],d.y+i[1]),f=(g=Hn(d.point,3))[0],m=g[1],g=g[2],v=0;v<4;v++)n.push(f,m,g),n.push(v),n.push(d.w,d.h),n.push(t/20,d.angle*Math.PI/180);f=d.x/r,m=(d.x+d.w)/r,g=(d.y+d.h)/a,v=d.y/a,l.push(f,g,f,v,m,v,m,g),f=4*u,h.push(f,f+2,f+1,f,f+3,f+2),s&&(d=this.indexToRgb(d.dataIndex),o.push(d[0]/255,d[1]/255,d[2]/255),o.push(d[0]/255,d[1]/255,d[2]/255),o.push(d[0]/255,d[1]/255,d[2]/255),o.push(d[0]/255,d[1]/255,d[2]/255))}e.restore(),this.loadTexture(),this.index=h,this.vertexBuffer.updateData(new Float32Array(n)),this.uvBuffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(h)),s&&this.pickBuffer.updateData(new Float32Array(o))}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),r}(),Zs=function(){function r(t){return he(this,r),bn(this,(r.__proto__||Qe(r)).call(this,t))}return In(r,Ls),ar(r,[{key:"initialize",value:function(e){var r=this;this.children&&this.children.forEach(function(t){t.map=r.map,t.setWebglLayer(r.getWebglLayer()),t.commonInitialize&&t.commonInitialize(e),t.initialize&&t.initialize(e),t.onOptionsChanged(t.getOptions()),t.onDataChanged(t.getData()),t.onChanged(t.getOptions(),t.getData())})}},{key:"isRequestAnimation",value:function(){if(void 0!==this.autoUpdate)return Bs(r.prototype.__proto__||Qe(r.prototype),"isRequestAnimation",this).call(this);for(var t=!1,e=0;e<this.children.length;e++)if(this.children[e].isRequestAnimation()){t=!0;break}return t}},{key:"render",value:function(e){this.children&&this.children.forEach(function(t){t.render(e)})}}]),r}(),Js=function(){function r(t){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t))).preHeightMapper={},t.preColorMapper={},t}return In(r,Xs),ar(r,[{key:"getDefaultOptions",value:function(){return Xe(Bs(r.prototype.__proto__||Qe(r.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gridGap:5,height:function(){return 1e3},color:function(){return"rgb(200, 200, 20)"}})}},{key:"generateGrid",value:function(t,e){var r=e.gridSize,n=[],i={};e=t.length;for(var a=this.getPointOffset(),o=0;o<e;o++){var s=~~(((s=this.normizedPoint(t[o].geometry.coordinates))[0]+a[0])/r)+"_"+~~((s[1]+a[1])/r);void 0===i[s]&&(i[s]=0);var l=~~t[o].count||1;"properties"in t[o]&&"count"in t[o].properties&&(l=~~t[o].properties.count),i[s]+=l}return ke(i).forEach(function(t){var e=t.split("_");n.push([e[0]*r+r/2,e[1]*r+r/2,i[t]])}),n}},{key:"onChanged",value:function(t,e){e=this.processData(e),Bs(r.prototype.__proto__||Qe(r.prototype),"onChanged",this).call(this,t,e)}},{key:"getGridDataRange",value:function(){var t=this.gridData,e=void 0,r=void 0;t[0]&&(e=t[0][2],r=t[0][2]);for(var n=t.length,i=0;i<n;i++)var a=t[i],e=Math.max(a[2],e),r=Math.min(a[2],r);return{max:e/2,min:r}}},{key:"processData",value:function(t){var e=this.getOptions(),r=e.gridSize,n=[];if("normal"===e.style)for(var i=this.getPointOffset(),a=0;a<t.length;a++){var o=(s=this.normizedPoint(t[a].geometry.coordinates))[0]+i[0],s=s[1]+i[1],l=~~t[a].count||1;"properties"in t[a]&&"count"in t[a].properties&&(l=~~t[a].properties.count);var u=t[a].color;"properties"in t[a]&&"color"in t[a].properties&&(u=~~t[a].properties.color),n.push([o,s,l,u])}else n=this.generateGrid(t,e);for(t=[],this._preHeightMapper={},this._preColorMapper={},i=0;i<n.length;i++)(a=n[i])[0]=a[0],a[1]=a[1],o=a[2],e.height&&(o="function"==typeof e.height?e.height({count:a[2],coordinates:[a[0],a[1]]}):e.height),s=r/2-e.gridGap,l=a[3],e.color&&(l="function"==typeof e.color?e.color({count:a[2],color:a[3]}):c(l||e.color).unitArray()),u="p"+a[0]+a[1],t.push({geometry:{type:"Polygon",coordinates:[[[a[0]-s,a[1]-s],[a[0]-s,a[1]+s],[a[0]+s,a[1]+s],[a[0]+s,a[1]-s]]]},color:l,origin:a,count:a[2],preHeight:this.preHeightMapper[u],preColor:this.preColorMapper[u],height:o}),this._preHeightMapper[u]=o,this._preColorMapper[u]=l;return this.preHeightMapper=this._preHeightMapper,this.preColorMapper=this._preColorMapper,this.gridData=t}}]),r}(),Ks=function(){function r(t){he(this,r);var e=bn(this,(r.__proto__||Qe(r)).call(this,t));return e.gridLayer=new Js(t),e.options.textOptions=Xe({show:!1,flat:!0,unit:"m",fontSize:100,collides:!1},t.textOptions||{}),e.textLayer=new Ys(e.options.textOptions),e.children=[e.gridLayer,e.textLayer],e}return In(r,Zs),ar(r,[{key:"setData",value:function(t){this.gridLayer.setData(t),this.options.textOptions.show&&this.setTextData()}},{key:"setTextData",value:function(){var t=this.gridLayer.gridData.map(function(t){return{geometry:{type:"Point",coordinates:[t.origin[0],t.origin[1],t.height+5]},properties:{text:t.count}}});this.textLayer.setData(t)}},{key:"setOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this.options.textOptions;Xe(this.options,t),this.gridLayer.setOptions(this.options),t.textOptions&&(this.options.textOptions.show&&this.setTextData(),this.options.textOptions=Xe(e||{},t.textOptions),this.textLayer.setOptions(this.options.textOptions))}},{key:"getData",value:function(){return this.gridLayer.getData()}},{key:"render",value:function(t){this.gridLayer.render(t),this.options.textOptions.show&&this.textLayer.render(t)}}]),r}(),Qs=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).gridLayer=new Ks(t.getGridOptions()),t.children=[t.gridLayer],t.options.riseTime&&(t.autoUpdate=!0),t}return In(e,Zs),ar(e,[{key:"onDataChanged",value:function(t){this.gridLayer.setData(t)}},{key:"getGridOptions",value:function(){var t=this.getOptions(),e=t.max,r=t.min;void 0===e&&(e=(r=this.gridLayer.getGridDataRange()).max,r=r.min);var n=new b({max:e,min:r,gradient:t.gradient,maxSize:t.maxHeight,minSize:t.minHeight});return t.height=function(t){var e=n.getSize(t.count);return e="properties"in t&&"count"in t.properties?n.getSize(t.properties.count):e},t.color=function(t){var e=n.getImageData(t.count);return[(e="properties"in t&&"count"in t.properties?n.getImageData(t.properties.count):e)[0]/255,e[1]/255,e[2]/255,e[3]/255]},t}},{key:"onOptionsChanged",value:function(t){this.gridLayer.setOptions(this.getGridOptions())}},{key:"getDefaultOptions",value:function(){return{style:"grid",gridSize:500,maxHeight:8e3,minHeight:200,gradient:{0:"rgb(50, 50, 256)",.1:"rgb(50, 250, 56)",.5:"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}}]),e}(),$s=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="SimpleLineLayer",t.bufferData=[],t}return In(r,Rs),ar(r,[{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;attribute vec3 aPos;attribute vec4 aColor;varying vec4 vColor;\n#if defined(DASH)\nvarying vec3 vPos;\n#endif\nvoid main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos,1.0);\n#if defined(DASH)\nvPos=aPos;\n#endif\n}",fragmentShader:"precision highp float;varying vec4 vColor;varying vec3 vPos;void main(){\n#if defined(DASH)\nif(mod(vPos.x,3.0)<1.5){discard;}\n#endif\ngl_FragColor=vColor;}",defines:e.useDash?["DASH"]:""},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new hs({gl:t,program:this.program,attributes:[{stride:28,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12}]})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(t,e){var i=this;if(this.gl){function r(t,e){if(t)for(var r=0;r<t.length-1;r++){var n=i.normizedPoint(t[r]);a.push(n[0]),a.push(n[1]),a.push(n[2]),a.push(e[0],e[1],e[2],e[3]),n=i.normizedPoint(t[r+1]),a.push(n[0]),a.push(n[1]),a.push(n[2]),a.push(e[0],e[1],e[2],e[3])}}var a=[];t=t.color;for(var n=0;n<e.length;n++){var o=this.getProperty("color",t,e[n]),o=this.normizedColor(o),s=e[n].geometry,l=s.coordinates;if("MultiPolygon"===s.type){if(l)for(s=0;s<l.length;s++)r(l[s][0],o)}else if("Polygon"===s.type)l&&r(l[0],o);else if("MultiLineString"===s.type){if(l)for(s=0;s<l.length;s++)r(l[s],o)}else r(l,o)}this.bufferData=a,this.buffer.updateData(new Float32Array(a))}}},{key:"render",value:function(t){var e,r=t.gl;t=t.matrix,!this.bufferData||this.bufferData.length<=0||((e=this.program).use(r),this.vertexArray.bind(),e.setUniforms({u_matrix:t}),t=this.getOptions(),this.setGLState({blend:!0,blendFunc:"lighter"===t.blend?[r.SRC_ALPHA,r.ONE]:[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA],blendEquation:r.FUNC_ADD}),r.drawArrays(r.LINES,0,this.bufferData.length/7))}}]),r}(),tl=Sr.f("species");r(n(function(t){t.exports={default:tl,__esModule:!0}}));var el=void 0!==mc?mc:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},rl=[],nl=[],il="undefined"!=typeof Uint8Array?Uint8Array:Array,al=!1,ol={}.toString,sl=Array.isArray||function(t){return"[object Array]"==ol.call(t)};dt.TYPED_ARRAY_SUPPORT=void 0===el.TYPED_ARRAY_SUPPORT||el.TYPED_ARRAY_SUPPORT,dt.poolSize=8192,dt._augment=function(t){return t.__proto__=dt.prototype,t},dt.from=function(t,e,r){return pt(null,t,e,r)},dt.TYPED_ARRAY_SUPPORT&&(dt.prototype.__proto__=Uint8Array.prototype,dt.__proto__=Uint8Array),dt.alloc=function(t,e,r){return ft(t),t=!(t<=0)&&void 0!==e?"string"==typeof r?ht(null,t).fill(e,r):ht(null,t).fill(e):ht(null,t)},dt.allocUnsafe=function(t){return mt(null,t)},dt.allocUnsafeSlow=function(t){return mt(null,t)},dt.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Ft(t)||"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Ft(t.slice(0,0)))},dt.compare=function(t,e){if(!yt(t)||!yt(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,a=Math.min(r,n);i<a;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},dt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},dt.concat=function(t,e){if(!sl(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return dt.alloc(0);if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;e=dt.allocUnsafe(e);for(var r=0,n=0;n<t.length;++n){var i=t[n];if(!yt(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(e,r),r+=i.length}return e},dt.byteLength=xt,dt.prototype._isBuffer=!0,dt.prototype.swap16=function(){var t=this.length;if(0!=t%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)bt(this,e,e+1);return this},dt.prototype.swap32=function(){var t=this.length;if(0!=t%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)bt(this,e,e+3),bt(this,e+1,e+2);return this},dt.prototype.swap64=function(){var t=this.length;if(0!=t%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)bt(this,e,e+7),bt(this,e+1,e+6),bt(this,e+2,e+5),bt(this,e+3,e+4);return this},dt.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?wt(this,0,t):function(t,e,r){var n=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":for(t=e,e=r,r=this.length,(!e||e<0||r<e)&&(e=r),n="",r=t=!t||t<0?0:t;r<e;++r)n=(t=n)+(n=(n=this[r])<16?"0"+n.toString(16):n.toString(16));return n;case"utf8":case"utf-8":return wt(this,e,r);case"ascii":for(t="",r=Math.min(this.length,r);e<r;++e)t+=String.fromCharCode(127&this[e]);return t;case"latin1":case"binary":for(t="",r=Math.min(this.length,r);e<r;++e)t+=String.fromCharCode(this[e]);return t;case"base64":return e=0===e&&r===this.length?lt(this):lt(this.slice(e,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(e=this.slice(e,r),r="",t=0;t<e.length;t+=2)r+=String.fromCharCode(e[t]+256*e[t+1]);return r;default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},dt.prototype.equals=function(t){if(!yt(t))throw new TypeError("Argument must be a Buffer");return this===t||0===dt.compare(this,t)},dt.prototype.inspect=function(){var t="";return 0<this.length&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(t+=" ... ")),"<Buffer "+t+">"},dt.prototype.compare=function(t,e,r,n,i){if(!yt(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=e)return 0;if(i<=n)return-1;if(r<=e)return 1;if(this===t)return 0;var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),s=Math.min(a,o);for(n=this.slice(n,i),t=t.slice(e,r),e=0;e<s;++e)if(n[e]!==t[e]){a=n[e],o=t[e];break}return a<o?-1:o<a?1:0},dt.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},dt.prototype.indexOf=function(t,e,r){return _t(this,t,e,r,!0)},dt.prototype.lastIndexOf=function(t,e,r){return _t(this,t,e,r,!1)},dt.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||i<r)&&(r=i),0<t.length&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(n=n||"utf8",i=!1;;)switch(n){case"hex":t:{if(e=Number(e)||0,n=this.length-e,r?n<(r=Number(r))&&(r=n):r=n,0!=(n=t.length)%2)throw new TypeError("Invalid hex string");for(n/2<r&&(r=n/2),n=0;n<r;++n){if(i=parseInt(t.substr(2*n,2),16),isNaN(i)){t=n;break t}this[e+n]=i}t=n}return t;case"utf8":case"utf-8":return Ot(Rt(t,this.length-e),this,e,r);case"ascii":return Ot(Pt(t),this,e,r);case"latin1":case"binary":return Ot(Pt(t),this,e,r);case"base64":return Ot(Dt(t),this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=t;for(var i=this.length-e,a=[],o=0;o<n.length&&!((i-=2)<0);++o){var s=n.charCodeAt(o);t=s>>8,s%=256,a.push(s),a.push(t)}return Ot(a,this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},dt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ll=4096;function ul(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}function cl(t,e){var r;return void 0===(t=se(t).constructor)||null==(r=se(t)[Al])?e:ie(r)}function hl(){var t,e=+this;Il.hasOwnProperty(e)&&(t=Il[e],delete Il[e],t())}dt.prototype.slice=function(t,e){var r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t),dt.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,e)).__proto__=dt.prototype;else{e=new dt(r=e-t,void 0);for(var n=0;n<r;++n)e[n]=this[n+t]}return e},dt.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||Mt(t,e,this.length),r=this[t];for(var n=1,i=0;++i<e&&(n*=256);)r+=this[t+i]*n;return r},dt.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||Mt(t,e,this.length),r=this[t+--e];for(var n=1;0<e&&(n*=256);)r+=this[t+--e]*n;return r},dt.prototype.readUInt8=function(t,e){return e||Mt(t,1,this.length),this[t]},dt.prototype.readUInt16LE=function(t,e){return e||Mt(t,2,this.length),this[t]|this[t+1]<<8},dt.prototype.readUInt16BE=function(t,e){return e||Mt(t,2,this.length),this[t]<<8|this[t+1]},dt.prototype.readUInt32LE=function(t,e){return e||Mt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},dt.prototype.readUInt32BE=function(t,e){return e||Mt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},dt.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||Mt(t,e,this.length),r=this[t];for(var n=1,i=0;++i<e&&(n*=256);)r+=this[t+i]*n;return 128*n<=r&&(r-=Math.pow(2,8*e)),r},dt.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||Mt(t,e,this.length),r=e;for(var n=1,i=this[t+--r];0<r&&(n*=256);)i+=this[t+--r]*n;return 128*n<=i&&(i-=Math.pow(2,8*e)),i},dt.prototype.readInt8=function(t,e){return e||Mt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},dt.prototype.readInt16LE=function(t,e){return e||Mt(t,2,this.length),32768&(t=this[t]|this[t+1]<<8)?4294901760|t:t},dt.prototype.readInt16BE=function(t,e){return e||Mt(t,2,this.length),32768&(t=this[t+1]|this[t]<<8)?4294901760|t:t},dt.prototype.readInt32LE=function(t,e){return e||Mt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},dt.prototype.readInt32BE=function(t,e){return e||Mt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},dt.prototype.readFloatLE=function(t,e){return e||Mt(t,4,this.length),ut(this,t,!0,23,4)},dt.prototype.readFloatBE=function(t,e){return e||Mt(t,4,this.length),ut(this,t,!1,23,4)},dt.prototype.readDoubleLE=function(t,e){return e||Mt(t,8,this.length),ut(this,t,!0,52,8)},dt.prototype.readDoubleBE=function(t,e){return e||Mt(t,8,this.length),ut(this,t,!1,52,8)},dt.prototype.writeUIntLE=function(t,e,r,n){t=+t,e|=0,r|=0,n||Ct(this,t,e,r,Math.pow(2,8*r)-1,0),n=1;var i=0;for(this[e]=255&t;++i<r&&(n*=256);)this[e+i]=t/n&255;return e+r},dt.prototype.writeUIntBE=function(t,e,r,n){t=+t,e|=0,r|=0,n||Ct(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1;for(this[e+(n=r-1)]=255&t;0<=--n&&(i*=256);)this[e+n]=t/i&255;return e+r},dt.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,1,255,0),dt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},dt.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,2,65535,0),dt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Tt(this,t,e,!0),e+2},dt.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,2,65535,0),dt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Tt(this,t,e,!1),e+2},dt.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,4,4294967295,0),dt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):St(this,t,e,!0),e+4},dt.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,4,4294967295,0),dt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):St(this,t,e,!1),e+4},dt.prototype.writeIntLE=function(t,e,r,n){t=+t,e|=0,n||Ct(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var i=1,a=n=0;for(this[e]=255&t;++n<r&&(i*=256);)t<0&&0===a&&0!==this[e+n-1]&&(a=1),this[e+n]=(t/i>>0)-a&255;return e+r},dt.prototype.writeIntBE=function(t,e,r,n){t=+t,e|=0,n||Ct(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var i=1,a=0;for(this[e+(n=r-1)]=255&t;0<=--n&&(i*=256);)t<0&&0===a&&0!==this[e+n+1]&&(a=1),this[e+n]=(t/i>>0)-a&255;return e+r},dt.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,1,127,-128),(t=!dt.TYPED_ARRAY_SUPPORT?Math.floor(t):t)<0&&(t=255+t+1),this[e]=255&t,e+1},dt.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,2,32767,-32768),dt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Tt(this,t,e,!0),e+2},dt.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,2,32767,-32768),dt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Tt(this,t,e,!1),e+2},dt.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,4,2147483647,-2147483648),dt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):St(this,t,e,!0),e+4},dt.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||Ct(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),dt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):St(this,t,e,!1),e+4},dt.prototype.writeFloatLE=function(t,e,r){return It(this,t,e,!0,r)},dt.prototype.writeFloatBE=function(t,e,r){return It(this,t,e,!1,r)},dt.prototype.writeDoubleLE=function(t,e,r){return Lt(this,t,e,!0,r)},dt.prototype.writeDoubleBE=function(t,e,r){return Lt(this,t,e,!1,r)},dt.prototype.copy=function(t,e,r,n){if(r=r||0,n||0===n||(n=this.length),e=(e=e>=t.length?t.length:e)||0,(n=0<n&&n<r?r:n)===r||0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var i=(n=t.length-e<n-r?t.length-e+r:n)-r;if(this===t&&r<e&&e<n)for(n=i-1;0<=n;--n)t[n+e]=this[n+r];else if(i<1e3||!dt.TYPED_ARRAY_SUPPORT)for(n=0;n<i;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},dt.prototype.fill=function(t,e,r,n){if("string"==typeof t){var i;if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1!==t.length||(i=t.charCodeAt(0))<256&&(t=i),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!dt.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(t=t||0))for(n=e;n<r;++n)this[n]=t;else for(i=(t=yt(t)?t:Rt(new dt(t,n).toString())).length,n=0;n<r-e;++n)this[n+e]=t[n%i];return this};var dl,pl=/[^+\/0-9A-Za-z-_]/g,fl={normal:null,road:Gt()},ml=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="LineLayer3D",t.initData(),t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",offset:0,blend:"normal",width:4,unit:"px",flat:!1,antialias:!1,style:"normal",dashArray:[0,0],dashOffset:0,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[],uv:[]}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions(),r=[];e.enablePicked&&r.push("PICK"),fl[e.style]&&(this.isUseTexture=!0,r.push("USE_TEXTURE")),this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform vec4 uSelectedColor;uniform mat4 uMatrix;uniform bool uFlat;uniform bool uUnitPx;uniform vec2 uDashArray;uniform float thickness;uniform float zoomUnits;uniform float devicePixelRatio;uniform float uOffset;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aDistance;attribute float aTotalDistance;\n#if defined(USE_TEXTURE)\nattribute vec2 uv;\n#endif\nvarying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vTotalDistance;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}vec3 getNormalAndWidth(vec2 currentScreen,vec2 previousScreen,vec2 nextScreen,float thickness){vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){thickness=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);return vec3(normal,thickness);}void main(){vColor=aColor;vCounter=aDistance/aTotalDistance;vDashArray=uDashArray/aTotalDistance;if(uUnitPx){vDashArray*=zoomUnits;}vTotalDistance=aTotalDistance;\n#if defined(USE_TEXTURE)\nvUV=uv;\n#endif\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\nif(uFlat){float width=thickness;if(uUnitPx){width*=zoomUnits;}vec3 nw=getNormalAndWidth(position.xy,previous.xy,next.xy,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;float offsetXy=uOffset;float offsetHeight=uOffset/100.0;if(uUnitPx){offsetXy/=zoomUnits;offsetHeight*=zoomUnits;}gl_Position=uMatrix*vec4(position.xy+normal*(direction+offsetXy),position.z+offsetHeight,1.0);}else{vec4 previousProjected=uMatrix*vec4(previous,1.0);vec4 currentProjected=uMatrix*vec4(position,1.0);vec4 nextProjected=uMatrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float width=thickness*devicePixelRatio;if(!uUnitPx){width/=zoomUnits;}vec3 nw=getNormalAndWidth(currentScreen,previousScreen,nextScreen,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;vec2 pos=currentScreen+normal*direction;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}}",fragmentShader:"precision highp float;varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vCounter;varying float vTotalDistance;uniform bool uAntialias;uniform float uDashOffset;uniform float zoomUnits;uniform float thickness;\n#if defined(USE_TEXTURE)\nuniform float uTextureMargin;uniform sampler2D textureImage;\n#endif\nvoid main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(vNormal));color.a*=blur;}\n#if defined(USE_TEXTURE)\nfloat segLen=uTextureMargin*zoomUnits;float textureLen=thickness*zoomUnits;float deltaX=mod(vUV.x,segLen);float middle=segLen/2.0;if(deltaX>=middle&&deltaX<=middle+textureLen){float uvx=(deltaX-middle)/textureLen;vec4 texture=texture2D(textureImage,vec2(uvx,vUV.y));color=texture.a>=0.5 ? texture : color;}\n#endif\nif(vDashArray.y>0.0){float offset=uDashOffset*zoomUnits/vTotalDistance;color.a*=(1.0-step(vDashArray.x,mod(vCounter+offset,vDashArray.x+vDashArray.y)));}gl_FragColor=color;}",defines:r},this),this.prevBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),r=(r=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:8,name:"aDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0},{stride:8,name:"aTotalDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:4}]).concat(this.getCommonAttributes()),fl[e.style]&&(r.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),this.setOptions({texture:fl[e.style]}),this.loadTexture()),this.vertexArray=new hs({gl:t,program:this.program,attributes:r})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){var r=this;if(this.gl){this.initData();for(var n=t.color,i=[],a=0;a<e.length;a++){var o=[];(s=e[a].geometry.coordinates)&&0<s.length&&(o="MultiPolygon"===e[a].geometry.type?s.reduce(function(t,e){return t.concat(e)})[0].map(function(t){return r.normizedPoint(t)}):"Polygon"===e[a].geometry.type||"MultiLineString"===e[a].geometry.type?s[0].map(function(t){return r.normizedPoint(t)}):s.map(function(t){return r.normizedPoint(t)})),s=this.getProperty("color",n,e[a]),s=this.getProperty("lineColor",n,e[a]);for(var s=this.normizedColor(s),l=this.addMultipleCoords(o),u=0;u<l.length;u++)this.processData(this.dataMgr,l[u],s);if(t.enablePicked)for(s=this.indexToRgb(a),l=0;l<o.length;l++)i.push(s[0]/255,s[1]/255,s[2]/255),i.push(s[0]/255,s[1]/255,s[2]/255),t.repeat&&(i.push(s[0]/255,s[1]/255,s[2]/255),i.push(s[0]/255,s[1]/255,s[2]/255),i.push(s[0]/255,s[1]/255,s[2]/255),i.push(s[0]/255,s[1]/255,s[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(this.dataMgr.uv)),t.enablePicked&&this.pickBuffer.updateData(new Float32Array(i))}}},{key:"processData",value:function(t,e,r){var n=e.length,i=t.position.length/6,a=(s=kt(e)).arr,o=s.total,s=Bt(a.map(function(t){return[t,o]})),a=a.map(function(t){return[t,0,t,1]}),l=Bt(e.map(function(t){return-1}),!0),u=Bt(e),c=Bt(e.map(zt(-1))),h=Bt(e.map(zt(1)));e=Bt(e.map(function(t){return r})),n=Nt(n,i),(i=t.uv).push.apply(i,Jn(Ut(a))),(a=t.counter).push.apply(a,Jn(Ut(s))),(s=t.position).push.apply(s,Jn(Ut(u))),(u=t.prev).push.apply(u,Jn(Ut(c))),(c=t.next).push.apply(c,Jn(Ut(h))),(h=t.direction).push.apply(h,Jn(l)),(l=t.color).push.apply(l,Jn(Ut(e))),(t=t.index).push.apply(t,Jn(n))}},{key:"render",value:function(t){var e,r,n=t.gl,i=t.matrix,a=this.dataMgr;!a||a.index.length<=0||!this.map||(e=this.getOptions(),(r=this.program).use(n),t=Xe(this.getCommonUniforms(t),{uMatrix:i,uFlat:e.flat,uUnitPx:"px"===e.unit,zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio,thickness:e.width,uDashArray:e.dashArray,uDashOffset:e.dashOffset,uAntialias:e.antialias,uOffset:e.offset}),this.isUseTexture&&(t=Xe(t,{uTextureMargin:140,textureImage:this.texture})),r.setUniforms(t),this.setGLState({blend:!0,blendEquation:n.FUNC_ADD,blendFunc:"lighter"===e.blend?[n.SRC_ALPHA,n.ONE]:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA],polygonOffset:e.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),n.drawElements(n.TRIANGLES,a.index.length,n.UNSIGNED_INT,0))}},{key:"loadTexture",value:function(r){var n=this,t=this.getOptions();t.texture?z(this.gl,t.texture,function(t,e){n.image=e,n.texture=t,r&&r(),n.webglLayer.render()}):(this.image=this.texture=null,r&&r())}}]),r}(),gl=function(){function e(t){he(this,e),this.join=t.join||"miter",this.cap=t.cap||"butt",this.thickness=t.thickness||4,this.miterLimit=t.miterLimit||2*this.thickness,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],colors:[],uvs:[],startIndex:0,maxDistance:0},this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0}return ar(e,[{key:"extrude",value:function(t,e,r,n){var i=this.complex;if(t.length<=1)return i;this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0;for(var a=t.length,o=i.startIndex,s=null,l=1;l<a;l++){var u=s||t[l-1],c=t[l],h=l<a-1?t[l+1]:null;h&&c[0]===h[0]&&c[1]===h[1]&&c[2]===h[2]?s=u:-1!==(u=this._segment(i,o,u,c,h,e,r,n))&&(o+=u,s=null)}return this.dash&&(i.maxDistance=Math.max(this._totalDistance,i.maxDistance)),i.startIndex=i.positions.length/7,i}},{key:"_segment",value:function(t,e,r,n,i,a,o,s){var l=0,u=$o.create(),c=$o.create(),h=$o.create(),d=$o.create(),p=t.indices,f=t.positions,m=t.normals,g=t.colors;t=t.uvs;var v="square"===this.cap,y="round"===this.cap,x="bevel"===this.join,b="round"===this.join,_=[n[0],n[1]];Wt(c,_,w=[r[0],r[1]]);var A=0;if(this.dash&&(A=this._calcDistance(_,w),this._totalDistance+=A),this._normal||(this._normal=$o.create(),Vt(this._normal,c)),!this._started)if(this._started=!0,v){var w=$o.create(),M=$o.create();$o.add(w,this._normal,c),$o.sub(M,this._normal,c),m.push(M[0],M[1],0),m.push(w[0],w[1],0),f.push(r[0],r[1],r[2],this._totalDistance-A,a,o,0),f.push(r[0],r[1],r[2],this._totalDistance-A,-a,o,0),t.push(this._totalDistance-A,0,this._totalDistance-A,1),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3])}else if(y){w=$o.fromValues(-c[0],-c[1]),M=$o.create(),$o.sub(M,this._normal,c),$o.normalize(M,M);var C=$o.create();$o.add(C,this._normal,c),$o.normalize(C,C);var T=$o.fromValues(this._normal[0],this._normal[1]),S=$o.fromValues(-this._normal[0],-this._normal[1]);for(m.push(w[0],w[1],0),m.push(M[0],M[1],0),m.push(-C[0],-C[1],0),m.push(T[0],T[1],0),m.push(S[0],S[1],0),w=0;w<5;w++)f.push(r[0],r[1],r[2],this._totalDistance-A,a,o,0),t.push(this._totalDistance-A,0),g.push(s[0],s[1],s[2],s[3]);p.push(e+0,e+2,e+1,e+1,e+2,e+3,e+3,e+2,e+4),l+=3,e+=3}else this._extrusions(f,m,t,g,r,this._normal,a,this._totalDistance-A,o,s);if(p.push.apply(p,Jn(-1===this._lastFlip?[e+0,e+1,e+2]:[e+1,e+0,e+2])),i)Wt(h,[i[0],i[1]],_),$o.create(),$o.add(d,c,h),$o.normalize(d,d),A=$o.fromValues(-d[1],d[0]),c=$o.fromValues(-c[1],c[0]),c=[a/$o.dot(A,c),A],A=(c=Hn(c,2))[0],c=c[1],d=0<$o.dot(d,this._normal)?-1:1,x||"miter"!==this.join||Math.abs(A)>this.miterLimit&&(x=!0),x?(b=Math.min(2*a,Math.abs(A)),m.push(this._normal[0],this._normal[1],0),m.push(c[0],c[1],0),f.push(n[0],n[1],n[2],this._totalDistance,a*d,o,0),f.push(n[0],n[1],n[2],this._totalDistance,-b*d,o,0),p.push.apply(p,Jn(this._lastFlip===-d?[e+2,e+1,e+3]:[e+0,e+2,e+3])),Vt(u,h),$o.copy(this._normal,u),m.push(this._normal[0],this._normal[1],0),f.push(n[0],n[1],n[2],this._totalDistance,a*d,o,0),p.push.apply(p,Jn(1===d?[e+2,e+3,e+4]:[e+3,e+2,e+4])),this._flipedUV(t,this._totalDistance,d,!0),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3]),l+=3):b?(b=Math.min(2*a,Math.abs(A)),m.push(this._normal[0],this._normal[1],0),m.push(c[0],c[1],0),m.push(c[0],c[1],0),f.push(n[0],n[1],n[2],this._totalDistance,a*d,o,0),f.push(n[0],n[1],n[2],this._totalDistance,a*d,o,0),f.push(n[0],n[1],n[2],this._totalDistance,-b*d,o,0),p.push.apply(p,Jn(this._lastFlip===-d?[e+2,e+1,e+4,e+2,e+4,e+3]:[e+0,e+2,e+4,e+2,e+3,e+4])),Vt(u,h),$o.copy(this._normal,u),m.push(this._normal[0],this._normal[1],0),f.push(n[0],n[1],n[2],this._totalDistance,a*d,o,0),p.push.apply(p,Jn(1===d?[e+4,e+3,e+5]:[e+3,e+4,e+5])),this._flipedUV(t,this._totalDistance,d,!1),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3]),l+=4):(this._extrusions(f,m,t,g,n,c,A,this._totalDistance,o,s),p.push.apply(p,Jn(-1===this._lastFlip?[e+2,e+1,e+3]:[e+2,e+0,e+3])),d=-1,$o.copy(this._normal,c),l+=2),this._lastFlip=d;else if(Vt(this._normal,c),v?(u=$o.create(),h=$o.create(),$o.add(u,c,this._normal),$o.sub(h,c,this._normal),m.push(u[0],u[1],0),m.push(h[0],h[1],0),f.push(n[0],n[1],n[2],this._totalDistance,a,o,0),f.push(n[0],n[1],n[2],this._totalDistance,a,o,0),t.push(this._totalDistance,0,this._totalDistance,1),g.push(s[0],s[1],s[2],s[3]),g.push(s[0],s[1],s[2],s[3])):this._extrusions(f,m,t,g,n,this._normal,a,this._totalDistance,o,s),p.push.apply(p,Jn(-1===this._lastFlip?[e+2,e+1,e+3]:[e+2,e+0,e+3])),l+=2,y){for(u=$o.create(),$o.add(u,c,this._normal),$o.normalize(u,u),h=$o.create(),$o.sub(h,c,this._normal),$o.normalize(h,h),b=$o.fromValues(c[0],c[1]),m.push(u[0],u[1],0),m.push(h[0],h[1],0),m.push(b[0],b[1],0),m=0;m<3;m++)f.push(n[0],n[1],n[2],this._totalDistance-A,a,o,0),t.push(this._totalDistance-A,0),g.push(s[0],s[1],s[2],s[3]);p.push(e+2,e+3,e+4,e+4,e+3,e+5,e+4,e+5,e+6),l+=3}return l}},{key:"_extrusions",value:function(t,e,r,n,i,a,o,s,l,u){e.push(a[0],a[1],0),e.push(a[0],a[1],0),t.push(i[0],i[1],i[2],s,o,l,0),t.push(i[0],i[1],i[2],s,-o,l,0),r.push(s,0,s,1),n.push(u[0],u[1],u[2],u[3]),n.push(u[0],u[1],u[2],u[3])}},{key:"_calcDistance",value:function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}},{key:"_flipedUV",value:function(t,e,r,n){n?-1===r?t.push(e,0,e,1,e,0):t.push(e,1,e,0,e,1):-1===r?t.push(e,0,e,0,e,1,e,0):t.push(e,1,e,1,e,0,e,1)}}]),e}(),vl={normal:null,road:Gt,arrow:function(){var t=(e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).width,e=e.color,r=Ht(),n=r.canvas;return(r=r.ctx).save(),r.moveTo(5,0),r.lineTo(32,16),r.lineTo(5,32),r.strokeStyle=e||"#fff",r.lineWidth=t||8,r.stroke(),r.restore(),n}},yl=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="LineLayer",t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"normal",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions(),r=[];e.enablePicked&&r.push("PICK"),vl[e.style]&&(this.isUseTexture=!0,this.prevStyle=e.style,this.prevStyleOptions=e.styleOptions,r.push("USE_TEXTURE")),!0===e.animation&&(this.isAnimateLine=!0,this.date=new Date,this.autoUpdate=!0,r.push("USE_LINE_ANIMATION")),!0===e.useDash&&r.push("USE_SIMPLE_DASH"),this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform vec4 uSelectedColor;uniform mat4 u_matrix;uniform vec2 u_dash_array;uniform float u_zoom_units;uniform float u_zIndex;uniform bool u_unit_px;attribute vec4 a_color;attribute vec3 a_position;attribute vec3 a_normal;attribute float a_distance;attribute float a_total_distance;attribute float a_width;attribute float a_offset;\n#if defined(USE_TEXTURE)\nattribute vec2 uv;\n#endif\nvarying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_total_distance;varying float v_counter;varying float v_width;\n#if defined(USE_SIMPLE_DASH)\nvarying vec3 v_position;\n#endif\nvoid main(){v_width=a_width;v_color=a_color;v_counter=a_distance/a_total_distance;v_dash_array=u_dash_array/a_total_distance;if(u_unit_px){v_dash_array*=u_zoom_units;}v_total_distance=a_total_distance;v_normal=vec2(normalize(a_normal.xy)*sign(a_width));\n#if defined(USE_TEXTURE)\nv_uv=uv;\n#endif\n#if defined(PICK)\nif(mapvIsPicked()){v_color=uSelectedColor;}\n#endif\nvec2 extrude=a_normal.xy*a_width/2.0;if(u_unit_px){extrude*=u_zoom_units;}vec2 offsetXY=a_normal.xy*-a_offset;float offsetZ=a_offset/100.0+u_zIndex;if(u_unit_px){offsetXY*=u_zoom_units;offsetZ*=u_zoom_units;}\n#if defined(USE_SIMPLE_DASH)\nv_position=a_position;\n#endif\ngl_Position=u_matrix*vec4(a_position.xy+extrude+offsetXY,a_position.z+offsetZ,1.0);}",fragmentShader:"precision highp float;varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_counter;varying float v_total_distance;varying float v_width;\n#if defined(USE_SIMPLE_DASH)\nvarying vec3 v_position;\n#endif\nuniform bool u_antialias;uniform float u_dash_offset;uniform float u_zoom_units;\n#if defined(USE_LINE_ANIMATION)\nuniform bool u_animate;uniform float u_time;uniform float u_duration;uniform float u_interval;uniform float u_trail_length;\n#endif\n#if defined(USE_TEXTURE)\nuniform float u_texture_width;uniform float u_texture_margin;uniform sampler2D u_sampler;\n#endif\nvoid main(){vec4 color=v_color;\n#if defined(USE_SIMPLE_DASH)\nif(mod(v_position.x,5.0)<3.0){discard;}\n#endif\nif(u_antialias){float blur=1.0;blur=1.0-smoothstep(0.9,1.0,length(v_normal));color.a*=blur;}\n#if defined(USE_LINE_ANIMATION)\nif(u_animate){float alpha=1.0-fract(mod(1.0-v_counter,u_interval)*(1.0/u_interval)+u_time/u_duration);alpha=(alpha+u_trail_length-1.0)/u_trail_length;color.a*=alpha;gl_FragColor=color;return;}\n#endif\n#if defined(USE_TEXTURE)\nfloat margin_width=u_texture_margin*u_zoom_units;float margin_width_half=margin_width/2.0;float texture_width=u_texture_width*u_zoom_units;float delta=mod(v_uv.x,texture_width+margin_width);if(delta>=margin_width_half&&delta<=margin_width_half+texture_width){float uvx=(delta-margin_width_half)/texture_width;vec4 texture=texture2D(u_sampler,vec2(uvx,v_uv.y));color=texture.a>=0.5 ? texture : color;}\n#endif\nif(v_dash_array.y>0.0){float offset=u_dash_offset*u_zoom_units/v_total_distance;color.a*=(1.0-step(v_dash_array.x,mod(v_counter+offset,v_dash_array.x+v_dash_array.y)));}gl_FragColor=color;}",defines:r},this),this.positionBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.normalBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),r=(r=[{stride:28,name:"a_position",buffer:this.positionBuffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"a_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:12},{stride:28,name:"a_width",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:16},{stride:28,name:"a_offset",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:20},{stride:28,name:"a_total_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:24},{stride:12,name:"a_normal",buffer:this.normalBuffer,size:3,type:"FLOAT",offset:0},{stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.isUseTexture&&(this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),r.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),e=(0,vl[e.style])(e.styleOptions),this.setOptions({texture:e}),this.loadTexture()),this.vertexArray=new hs({gl:t,program:this.program,attributes:r})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){var r,n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.gl&&(!this.isUseTexture||this.prevStyle===t.style&&ri(this.prevStyleOptions)===ri(t.styleOptions)?this.parseData(t,e,i):(this.prevStyle=t.style,this.prevStyleOptions=t.styleOptions,r=(0,vl[t.style])(t.styleOptions),this.setOptions({texture:r}),this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){n.loadTexture(function(){n.parseData(t,e,i)})},0)))}},{key:"parseData",value:function(s,l,u){for(var c=this,t=s.dashArray,h=s.width,d=s.color,p=s.offset,t=!!this.isUseTexture||!!t[1]||!!this.isAnimateLine,f=new gl({dash:t,cap:s.lineCap,join:s.lineJoin,miterLimit:s.miterLimit,thickness:h}),m=[],e=function(t){(a=l[t].geometry.coordinates)&&0<a.length&&("MultiPolygon"===l[t].geometry.type?a=a.reduce(function(t,e){return t.concat(e)}):"LineString"===l[t].geometry.type&&(a=[a]),a=a.map(function(t){return t=t.map(function(t){return c.normizedPoint(t)}),!0===u.closePath&&t[0].toString()!==t[t.length-1].toString()&&t.push(t[0]),t}));for(var e=c.getProperty("color",d,l[t]),e=c.normizedColor(e),r=c.getProperty("width",h,l[t]),r=Number(r),n=c.getProperty("offset",p,l[t]),n=Number(n),i=f.complex.startIndex,a=c.addMultipleCoords(a),o=0;o<a.length;o++)a[o].forEach(function(t){f.extrude(t,r,n,e)});if(s.enablePicked)for(t=c.indexToRgb(t),a=f.complex.startIndex;i<a;i++)m.push(t[0]/255,t[1]/255,t[2]/255),s.repeat&&(m.push(t[0]/255,t[1]/255,t[2]/255),m.push(t[0]/255,t[1]/255,t[2]/255))},r=0;r<l.length;r++)e(r);if(e=f.complex,t)for(r=0;r<e.positions.length/7;r++)e.positions[7*r+6]=e.maxDistance;this.lineData=e,this.positionBuffer.updateData(new Float32Array(e.positions)),this.normalBuffer.updateData(new Float32Array(e.normals)),this.colorBuffer.updateData(new Float32Array(e.colors)),this.indexBuffer.updateData(new Uint32Array(e.indices)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(e.uvs)),s.enablePicked&&this.pickBuffer.updateData(new Float32Array(m))}},{key:"render",value:function(t){var e,r,n=t.gl,i=t.matrix,a=this.lineData;!a||a.indices.length<=0||!this.map||(e=this.getOptions(),(r=this.program).use(n),t=Xe(this.getCommonUniforms(t),{u_matrix:i,u_zoom_units:this.map.getZoomUnits(),u_dash_array:e.dashArray,u_dash_offset:e.dashOffset,u_antialias:e.antialias,u_unit_px:"px"===e.unit,u_zIndex:e.zIndex}),this.isUseTexture&&(t=Xe(t,{u_texture_width:e.width,u_texture_margin:140,u_sampler:this.texture})),this.isAnimateLine&&(i=this.map.getZoom(),t=Xe(t,{u_time:(new Date-this.date)/1e3,u_animate:!!(i>=e.minZoom&&i<=e.maxZoom&&this.autoUpdate),u_duration:e.duration,u_interval:e.interval,u_trail_length:e.trailLength})),r.setUniforms(t),this.setGLState({blend:!0,blendEquation:n.FUNC_ADD,blendFunc:"lighter"===e.blend?[n.SRC_ALPHA,n.ONE]:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA],polygonOffset:e.polygonOffset,depthTest:e.depthTest,depthMask:e.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),n.drawElements(n.TRIANGLES,a.indices.length,n.UNSIGNED_INT,0))}},{key:"loadTexture",value:function(r){var n=this,t=this.getOptions();t.texture?z(this.gl,t.texture,function(t,e){n.image=e,n.texture=t,r&&r(),n.webglLayer.render()}):(this.image=this.texture=null,r&&r())}}]),r}(),xl=function(){function r(t,e){he(this,r),this.layer=t,this.gl=e,this.initData()}return ar(r,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(t,e){this.initData();var r=t.color,n=t.height,i=t.gradient;t=this.gl;for(var a=0;a<e.length;a++){var o=e[a].geometry.coordinates,s=o.length;this.maxLength=s>this.maxLength?s:this.maxLength;for(var l=[],u=0;u<s;u++){var c=this.layer.normizedPoint(o[u]);l.push(c)}s=e[a].color||r,"properties"in e[a]&&"color"in e[a].properties&&(s=e[a].properties.color),i||"[object Function]"!==Object.prototype.toString.call(s)||(s=s(e[a])),o=this.layer.normizedColor(i?i[0]:s),s=this.layer.normizedColor(i?i[1]:s),u=e[a].height||n,"properties"in e[a]&&"height"in e[a].properties&&(u=e[a].properties.height),"[object Function]"===Object.prototype.toString.call(u)&&(u=u(e[a])),this.processData(this.outWall3d,l,o,s,u)}for(e=0;e<this.outWall3d.vertex.length;e++){for(r=[],n=this.outWall3d.vertex[e].length,i=0;i<n;i++)r.push.apply(r,Jn(this.outWall3d.vertex[e][i]));n=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),this.outWall3d.vertexBuffer[e]=n,t.bindBuffer(t.ARRAY_BUFFER,null),n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[e]),t.STATIC_DRAW),this.outWall3d.indexBuffer[e]=n,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(t,e,r,n,i){var a=t.vertex[t.vertex.length-1],o=t.index[t.index.length-1],s=e.length;(!o||65536<=o.length+2*s+2)&&(a=[],o=[],t.vertex.push(a),t.index.push(o)),(t=a.length)&&o.push(t-1,t);for(var l=t=0;l<s;l++){var u=[],c=[],h=e[l];u.push(h[0],h[1]),u.push(h[2]?Number(h[2])+i:i),u.push(h[3]?Number(h[3]):l),u.push(t),u.push(r[0],r[1],r[2],r[3]),c.push(h[0],h[1]),c.push(h[2]?Number(h[2]):0),c.push(h[3]?Number(h[3]):l),c.push(t),c.push(n[0],n[1],n[2],n[3]),h=a.length,a.push(u,c),o.push(h,h+1),l<s-1&&(t+=this.getDistance(e[l],e[l+1]))}}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(Math.abs(t[0]-e[0]),2)+Math.pow(Math.abs(t[1]-e[1]),2))}}]),r}(),bl=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).startTime=t.options.startTime||0,t.endTime=t.options.endTime,t.time=t.startTime,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(t){this.gl=t,this.dataMgr=new xl(this,this.gl),this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute float aDistance;attribute vec4 aColor;varying vec4 vColor;varying float vHeight;varying float vTime;varying float vDistance;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vHeight=aPos.z;vColor=aColor;vDistance=aDistance;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;varying float vDistance;varying float vHeight;uniform float currentTime;void main(){if(vTime>1.0||vTime<0.0){}float radius=2.5;float distance=vDistance+currentTime*20.0;float modDistance=mod(distance,9.0);float alpha=1.0;if(modDistance>radius*2.0){discard;}else{float x=abs(modDistance-radius);float y=abs(vHeight-radius);float dis=sqrt(pow(x,2.0)+pow(y,2.0));if(dis>radius){discard;}alpha=dis/radius;}gl_FragColor=vec4(vColor.rgb,1.0-alpha);}"})}},{key:"onChanged",value:function(t,e){this.gl&&(this.dataMgr.onLayerChange(t,e),void 0===t.endTime&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;if((t=this.dataMgr.getData())&&!(t.vertex.length<=0)){var n,i,a=this.getOptions(),o=this.program;for(e.useProgram(o.program),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}),e.enableVertexAttribArray(o.attributes.aPos),e.enableVertexAttribArray(o.attributes.aDistance),e.enableVertexAttribArray(o.attributes.aColor),e.uniformMatrix4fv(o.uniforms.u_matrix,!1,r),e.uniform1f(o.uniforms.currentTime,this.time),e.uniform1f(o.uniforms.trailLength,a.trailLength),r=0;r<t.vertex.length;r++)t.vertex[r].length<=0||(i=t.vertex[r],i=(n=new Float32Array(i[0]).BYTES_PER_ELEMENT)*i[0].length,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer[r]),e.vertexAttribPointer(o.attributes.aPos,4,e.FLOAT,!1,i,0),e.vertexAttribPointer(o.attributes.aDistance,1,e.FLOAT,!1,i,4*n),e.vertexAttribPointer(o.attributes.aColor,4,e.FLOAT,!1,i,5*n),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer[r]),e.drawElements(e.TRIANGLE_STRIP,t.index[r].length,e.UNSIGNED_SHORT,0),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null));this.time+=a.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),r}(),_l=n(function(t){var s={},l={};(t=t.exports=function(t,e,r,n,i){var a,o;if(i=i?function(){return t}:Nn(t),r=ae(r,n,e?2:1),n=0,"function"!=typeof i)throw TypeError(t+" is not iterable!");if(void 0===i||or.Array!==i&&Vn[Gn]!==i){for(n=i.call(t);!(o=n.next()).done;)if((i=Fn(n,r,o.value,e))===s||i===l)return i}else for(a=ee(t.length);n<a;n++)if((i=e?r(se(o=t[n])[0],o[1]):r(t[n]))===s||i===l)return i}).BREAK=s,t.RETURN=l}),Al=dr("species"),wl=_e.process,Ml=_e.setImmediate,Cl=_e.clearImmediate,Tl=_e.MessageChannel,Sl=_e.Dispatch,El=0,Il={},Ll=function(t){hl.call(t.data)};function Rl(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}function Pl(t,e){return se(t),oe(e)&&e.constructor===t?e:((0,(t=ql.f(t)).resolve)(e),t.promise)}function Dl(t,e,r){for(var n in e)r&&t[n]?t[n]=e[n]:Be(t,n,e[n]);return t}function Ol(t){t=("function"==typeof be[t]?be:_e)[t],Le&&t&&!t[Jl]&&Fe.f(t,Jl,{configurable:!0,get:function(){return this}})}function Fl(){}function Bl(t){var e;return!(!oe(t)||"function"!=typeof(e=t.then))&&e}function Nl(h,d){var p;h._n||(h._n=!0,p=h._c,Kl(function(){for(var t=h._v,e=1==h._s,r=0;p.length>r;){var n=void 0,i=void 0,a=void 0,o=p[r++],s=e?o.ok:o.fail,l=o.resolve,u=o.reject,c=o.domain;try{s?(e||(2==h._h&&au(h),h._h=1),!0===s?a=t:(c&&c.enter(),a=s(t),c&&(c.exit(),n=!0)),a===o.promise?u(Ql("Promise-chain cycle")):(i=Bl(a))?i.call(a,l,u):l(a)):u(t)}catch(t){c&&!n&&c.exit(),u(t)}}h._c=[],h._n=!1,d&&!h._h&&iu(h)}))}function zl(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Nl(e,!0))}Ml&&Cl||(Ml=function(t){for(var e=[],r=1;r<arguments.length;)e.push(arguments[r++]);return Il[++El]=function(){!function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}t.apply(r,e)}("function"==typeof t?t:Function(t),e)},dl(El),El},Cl=function(t){delete Il[t]},"process"==Qt(wl)?dl=function(t){wl.nextTick(ae(hl,t,1))}:Sl&&Sl.now?dl=function(t){Sl.now(ae(hl,t,1))}:Tl?(Ru=new Tl,Pu=Ru.port2,Ru.port1.onmessage=Ll,dl=ae(Pu.postMessage,Pu,1)):_e.addEventListener&&"function"==typeof postMessage&&!_e.importScripts?(dl=function(t){_e.postMessage(t+"","*")},_e.addEventListener("message",Ll,!1)):dl="onreadystatechange"in(Pe?Re.createElement("script"):{})?function(t){lr.appendChild(Pe?Re.createElement("script"):{}).onreadystatechange=function(){lr.removeChild(this),hl.call(t)}}:function(t){setTimeout(ae(hl,t,1),0)});var Ul,kl,Hl,Gl=Ml,Vl=_e.MutationObserver||_e.WebKitMutationObserver,Wl=_e.process,jl=_e.Promise,Xl="process"==Qt(Wl),ql={f:function(t){return new jt(t)}},Yl=_e.navigator,Zl=Yl&&Yl.userAgent||"",Jl=dr("species"),Kl=function(){function t(){var t;for(Xl&&(t=Wl.domain)&&t.exit();r;){var e=r.fn;r=r.next;try{e()}catch(t){throw r?i():n=void 0,t}}n=void 0,t&&t.enter()}var r,n,e,i,a,o;return i=Xl?function(){Wl.nextTick(t)}:!Vl||_e.navigator&&_e.navigator.standalone?jl&&jl.resolve?(e=jl.resolve(void 0),function(){e.then(t)}):function(){Gl.call(_e,t)}:(a=!0,o=document.createTextNode(""),new Vl(t).observe(o,{characterData:!0}),function(){o.data=a=!a}),function(t){t={fn:t,next:void 0},n&&(n.next=t),r||(r=t,i()),n=t}}(),Ql=_e.TypeError,$l=_e.process,tu=(Zt=$l&&$l.versions)&&Zt.v8||"",eu=_e.Promise,ru="process"==Cn($l),nu=Ul=ql.f,We=!!function(){try{var t=eu.resolve(1),e=(t.constructor={})[dr("species")]=function(t){t(Fl,Fl)};return(ru||"function"==typeof PromiseRejectionEvent)&&t.then(Fl)instanceof e&&0!==tu.indexOf("6.6")&&-1===Zl.indexOf("Chrome/66")}catch(t){}}(),iu=function(i){Gl.call(_e,function(){var t,e,r=i._v,n=1!==i._h&&0===(i._a||i._c).length;if(n&&(e=Rl(function(){ru?$l.emit("unhandledRejection",r,i):(t=_e.onunhandledrejection)?t({promise:i,reason:r}):(t=_e.console)&&t.error&&t.error("Unhandled promise rejection",r)}),i._h=ru||1!==i._h&&0===(i._a||i._c).length?2:1),i._a=void 0,n&&e.e)throw e.v})},au=function(e){Gl.call(_e,function(){var t;ru?$l.emit("rejectionHandled",e):(t=_e.onrejectionhandled)&&t({promise:e,reason:e._v})})},ou=function(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Ql("Promise can't be resolved itself");(r=Bl(t))?Kl(function(){var e={_w:n,_d:!1};try{r.call(t,ae(ou,e,1),ae(zl,e,1))}catch(t){zl.call(e,t)}}):(n._v=t,n._s=1,Nl(n,!1))}catch(t){zl.call({_w:n,_d:!1},t)}}};We||(eu=function(t){ul(this,eu,"Promise","_h"),ie(t),kl.call(this);try{t(ae(ou,this,1),ae(zl,this,1))}catch(t){zl.call(this,t)}},(kl=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Dl(eu.prototype,{then:function(t,e){var r=nu(cl(this,eu));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=ru?$l.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&Nl(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),Hl=function(){var t=new kl;this.promise=t,this.resolve=ae(ou,t,1),this.reject=ae(zl,t,1)},ql.f=nu=function(t){return t===eu||t===su?new Hl:Ul(t)}),ze(ze.G+ze.W+ze.F*!We,{Promise:eu}),er(eu,"Promise"),Ol("Promise");var su=be.Promise;function lu(t,e){if(!oe(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}function uu(t,e){var r=pu(e);if("F"!==r)return t._i[r];for(t=t._f;t;t=t.n)if(t.k==e)return t}ze(ze.S+ze.F*!We,"Promise",{reject:function(t){var e=nu(this);return(0,e.reject)(t),e.promise}}),ze(ze.S+ +ze.F,"Promise",{resolve:function(t){return Pl(this===su?eu:this,t)}}),ze(ze.S+ze.F*!(We&&Xn(function(t){eu.all(t).catch(Fl)})),"Promise",{all:function(t){var o=this,e=nu(o),s=e.resolve,l=e.reject,r=Rl(function(){var n=[],i=0,a=1;_l(t,!1,function(t){var e=i++,r=!1;n.push(void 0),a++,o.resolve(t).then(function(t){r||(r=!0,n[e]=t,--a||s(n))},l)}),--a||s(n)});return r.e&&l(r.v),e.promise},race:function(t){var e=this,r=nu(e),n=r.reject,i=Rl(function(){_l(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}}),ze(ze.P+ze.R,"Promise",{finally:function(e){var r=cl(this,be.Promise||_e.Promise),t="function"==typeof e;return this.then(t?function(t){return Pl(r,e()).then(function(){return t})}:e,t?function(t){return Pl(r,e()).then(function(){throw t})}:e)}}),ze(ze.S,"Promise",{try:function(t){var e=ql.f(this);return((t=Rl(t)).e?e.reject:e.resolve)(t.v),e.promise}});var cu=be.Promise,hu=r(n(function(t){t.exports={default:cu,__esModule:!0}})),du=Fe.f,pu=Dr.fastKey,fu=Le?"_s":"size",mu={getConstructor:function(t,i,r,n){var a=t(function(t,e){ul(t,a,i,"_i"),t._t=i,t._i=hr(null),t._f=void 0,t._l=void 0,t[fu]=0,null!=e&&_l(e,r,t[n],t)});return Dl(a.prototype,{clear:function(){for(var t=lu(this,i),e=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete e[r.i];t._f=t._l=void 0,t[fu]=0},delete:function(t){var e,r,n=lu(this,i);return(t=uu(n,t))&&(e=t.n,r=t.p,delete n._i[t.i],t.r=!0,r&&(r.n=e),e&&(e.p=r),n._f==t&&(n._f=e),n._l==t&&(n._l=r),n[fu]--),!!t},forEach:function(t){lu(this,i);for(var e,r=ae(t,1<arguments.length?arguments[1]:void 0,3);e=e?e.n:this._f;)for(r(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!uu(lu(this,i),t)}}),Le&&du(a.prototype,"size",{get:function(){return lu(this,i)[fu]}}),a},def:function(t,e,r){var n,i=uu(t,e);return i?i.v=r:(t._l=i={i:n=pu(e,!0),k:e,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=i),e&&(e.n=i),t[fu]++,"F"!==n&&(t._i[n]=i)),t},getEntry:uu,setStrong:function(t,r,e){vr(t,r,function(t,e){this._t=lu(t,r),this._k=e,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?_r(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,_r(1))},e?"entries":"values",!e,!0),Ol(r)}},gu=(dr("species"),Fe.f),vu=function(t,e,r){var n=Object(Jt(t)),i=fe(n);e=ae(e,r,3),r=ee(i.length);var a=0;for(t=void 0;a<r;a++)a in i&&e(i[a],a,n);return t};(function(r,t,e,n){var i=_e.Map,a=i,o=a&&a.prototype,s={};Le&&"function"==typeof a&&o.forEach&&!le(function(){(new a).entries().next()})?(a=t(function(t,e){ul(t,a,r,"_c"),t._c=new i,null!=e&&_l(e,!0,t.set,t)}),vu("add clear delete forEach get has set keys values entries toJSON".split(" "),function(r){var n="add"==r||"set"==r;r in o&&Be(a.prototype,r,function(t,e){return ul(this,a,r),t=this._c[r](0===t?0:t,e),n?this:t})}),gu(a.prototype,"size",{get:function(){return this._c.size}})):(a=n.getConstructor(t,r,!0,"set"),Dl(a.prototype,e),Dr.NEED=!0),er(a,r),s.Map=a,ze(ze.G+ze.W+ze.F,s),n.setStrong(a,r,!0)})("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){return(t=mu.getEntry(lu(this,"Map"),t))&&t.v},set:function(t,e){return mu.def(lu(this,"Map"),0===t?0:t,e)}},mu),ze(ze.P+ze.R,"Map",{toJSON:function(){if("Map"!=Cn(this))throw TypeError("Map#toJSON isn't generic");var t=[];return _l(this,!1,t.push,t,void 0),t}}),ze(ze.S,"Map",{of:function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return new this(e)}}),ze(ze.S,"Map",{from:function(t,e,r){var n;if(ie(this),(n=void 0!==e)&&ie(e),null==t)return new this;var i,a,o=[];return n?(i=0,a=ae(e,r,2),_l(t,!1,function(t){o.push(a(t,i++))})):_l(t,!1,o.push,o),new this(o)}});var yu=be.Map,xu=r(n(function(t){t.exports={default:yu,__esModule:!0}})),bu=((hc=r(n(function(t,e){e.__esModule=!0;var n=nr&&nr.__esModule?nr:{default:nr};e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}})))(cc={},1,1),hc(cc,2,1),hc(cc,3,1),cc),_u=(hc(dc={},1,1),hc(dc,2,1),hc(dc,3,1),dc);(ln=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).vertCount=0,t.bufferMap={},t.bufferData=[],t.autoUpdate=!0,e=t.canvas=document.createElement("canvas"),t.ctx=e.getContext("2d"),t.iconHash=new xu,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:[1,1,1,.8],speed:1,size:5,pointFade:!0,pointFadeBuffer:1,minLineLength:2,animationType:2,shapeType:2,depthTest:!1,delay:0,unit:"px",padding:0}}},{key:"initialize",value:function(t){this.gl=t,this.texture=null,this.isUseTexture=!1;var e=this.getOptions();this.updateUniformsFromOptions(e),this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec3 aPos;attribute vec3 aNextPos;attribute float aIndex;attribute float aNextIndex;attribute float aLength;attribute float aSpeed;attribute float aDelay;attribute vec3 aUV;uniform float uSize;uniform mat4 u_matrix;uniform float uOriginSpeed;uniform float uElapsedSteps;uniform int uAnimationType;uniform int uPointFade;uniform float uPointFadeBuffer;uniform float uZoomUnits;varying float vAddOpacity;varying vec3 vUV;void main(){if(uAnimationType==1){if(abs(aIndex-mod(uElapsedSteps,aLength))>.1){gl_Position=vec4(-2.,-2.,0,1.0);return;}gl_Position=u_matrix*vec4(aPos.xyz,1.0);vAddOpacity=1.;}else if(uAnimationType==2){float lineLength=aLength-1.;float cIndex=mod(uElapsedSteps,lineLength);float rest=cIndex-aIndex;if(rest<1.&&rest>=0.){if(uPointFade==1){if(cIndex<uPointFadeBuffer){vAddOpacity=cIndex/uPointFadeBuffer;}else if(cIndex>lineLength-uPointFadeBuffer){vAddOpacity=(lineLength-cIndex)/uPointFadeBuffer;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}else if(uAnimationType==3){float speedRatio=aSpeed/uOriginSpeed;float percent=mod(mod(uElapsedSteps*aSpeed,aLength)/aLength-aDelay,1.0);if(percent<=aNextIndex&&percent>=aIndex){if(uPointFade==1){float fadePercent=uPointFadeBuffer*1000./aLength;if(percent<fadePercent){vAddOpacity=percent/fadePercent;}else if(percent>1.-fadePercent){vAddOpacity=(1.-percent)/fadePercent;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}float rest=(percent-aIndex)/(aNextIndex-aIndex);gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}vUV=aUV;gl_PointSize=uSize/uZoomUnits;}",fragmentShader:"precision highp float;uniform vec4 uColor;uniform int ushapeType;uniform bool uUseTexture;uniform sampler2D uSampler;varying float vAddOpacity;varying vec3 vUV;void main(){if(ushapeType==2){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(uColor.rgb,uColor.a*vAddOpacity);}else if(ushapeType==3){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(uColor.rgb,uColor.a*smoothstep(1.0,0.0,d*2.)*vAddOpacity);}else{gl_FragColor=vec4(uColor.rgb,uColor.a*vAddOpacity);}if(uUseTexture){float ratio=vUV.z;vec2 uv=vUV.xy;gl_FragColor=texture2D(uSampler,vec2(gl_PointCoord.x*ratio+uv.x,1.0-(uv.y+gl_PointCoord.y*ratio)));}}"}),this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"bindAttributeBufferData",value:function(t,e,r,n){var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),r=new Float32Array(r),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),this.bufferMap[e]={buffer:i,data:r,elementSize:n}}},{key:"onChanged",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.gl&&(Array.isArray(e)||(e=[]),this.processCache(t,e,r))}},{key:"processCache",value:function(e,t,r){var n=this;this.cachedData=[];for(var i=e.icon,a=e.speed,o=0;o<t.length;o++){var s=t[o].geometry.coordinates,l=this.getProperty("icon",i,t[o]),u=this.getProperty("speed",a,t[o]),c=this.getProperty("delay",0,t[o]);s&&(this.cachedData.push({coordinates:s,icon:l,speed:u,delay:c}),this.iconHash.get(l)||this.iconHash.set(l,l))}t=Zn(this.iconHash.entries()).filter(function(t){return"string"==typeof t[1]}).map(function(t){var r=Hn(t,2)[0];return new hu(function(e,t){n.url2canvas(r,function(t){n.iconHash.set(r,t),e()})})}),hu.all(t).then(function(t){n.buildSprite(e),!1!==r.autoRender&&n.webglLayer&&n.webglLayer.render()})}},{key:"buildSprite",value:function(t){var e=t.padding,r=this.canvas,n=this.ctx,i=0,a=[],o=new xu;if(t.icon){var i=!0,s=!1,l=void 0;try{for(var u,c=kn(this.iconHash);!(i=(u=c.next()).done);i=!0){var h,d,p=Hn(u.value,2),f=p[1];"string"!=typeof f&&(d=(h=f.width)+e,a.push({w:d,h:d,width:h,key:p[0],icon:f}))}}catch(t){s=!0,l=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}for(c=ot(a),u=0;u<a.length;u++)p=a[u],o.get(p.key)||o.set(p.key,p);for(i=Math.max(m(c.w),m(c.h)),r.width=i||1,r.height=i||1,n.save(),r=0;r<a.length;r++)c=a[r],n.drawImage(c.icon,c.x+e,c.y+e,c.width,c.width);n.restore()}this.loadTexture(),this.buildVertex(t,o,i)}},{key:"buildVertex",value:function(t,e,r){var n=this.gl;this.updateUniformsFromOptions(t);for(var i=[],a=[],o=[],s=[],l=[],u=[],c=[],h=[],d=t.minLineLength,p=0;p<this.cachedData.length;p++){var f=(v=this.cachedData[p]).coordinates,m=v.icon,g=v.speed,v=v.delay,y=f.length,x=[];if(!(y<d)){for(t.icon&&(x=(x=e.get(m))?[x.x/r,x.y/r,x.w/r]:[0,0,0]),m=0;m<y;++m){var b=this.normizedPoint(f[m]);i.push(b[0]),i.push(b[1]),i.push(b[2]||0),h.push.apply(h,Jn(x)),3!==this.animationType&&(a.push(m),s.push(y))}if(1!==this.animationType){for(m=i.length-3*y+3,x=i.length,f=m;f<x;++f)l.push(i[f]);if(i.splice(x-3,3),h.splice(x-3,3),2===this.animationType)a.pop(),s.pop();else if(3===this.animationType){for(m-=3,x=i.length-3,f=0,y=[],b=m;b<=x;b+=3)f+=m=Math.sqrt(Math.pow(l[b]-i[b],2)+Math.pow(l[b+1]-i[b+1],2)+Math.pow(l[b+2]-i[b+2],2)),y.push(m);a.push(0),u.push(g),v/=f/g,c.push(v);for(var b=x=0,_=y.length-1;b<_;++b)m=(x+=y[b])/f,a.push(m),o.push(m),s.push(f),u.push(g),c.push(v);o.push(1),s.push(f)}}}}this.bindAttributeBufferData(n,"aPos",i,3),this.bindAttributeBufferData(n,"aIndex",a,1),this.bindAttributeBufferData(n,"aLength",s,1),1!==this.animationType&&(this.bindAttributeBufferData(n,"aNextPos",l,3),3===this.animationType&&(this.bindAttributeBufferData(n,"aNextIndex",o,1),this.bindAttributeBufferData(n,"aSpeed",u,1),this.bindAttributeBufferData(n,"aDelay",c,1))),t.icon&&this.bindAttributeBufferData(n,"aUV",h,3),this.vertCount=i.length/3}},{key:"updateUniformsFromOptions",value:function(t){this.color=this.normizedColor(t.color),this.startTime=(new Date).getTime(),bu[t.animationType]||(t.animationType=2),_u[t.shapeType]||(t.shapeType=2),(isNaN(t.minLineLength)||t.minLineLength<2)&&(t.minLineLength=2),this.animationType=t.animationType}},{key:"renderAttributeArr",value:function(t,e,r){var n;void 0===e.attributes[r]||(n=this.bufferMap[r])&&(t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(e.attributes[r]),t.vertexAttribPointer(e.attributes[r],n.elementSize,t.FLOAT,!1,n.data.BYTES_PER_ELEMENT*n.elementSize,0))}},{key:"render",value:function(t){var e,r,n,i,a,o,s=t.gl;t=t.matrix,this.vertCount<=0||(e=this.getOptions(),r=this.program,s.useProgram(r.program),this.renderAttributeArr(s,r,"aPos"),this.renderAttributeArr(s,r,"aIndex"),this.renderAttributeArr(s,r,"aLength"),1!==this.animationType&&(this.renderAttributeArr(s,r,"aNextPos"),3===this.animationType&&(this.renderAttributeArr(s,r,"aNextIndex"),this.renderAttributeArr(s,r,"aSpeed"),this.renderAttributeArr(s,r,"aDelay"))),e.icon&&this.texture&&(this.renderAttributeArr(s,r,"aUV"),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.texture),s.uniform1i(r.uniforms.uSampler,0)),s.uniform1i(r.uniforms.uUseTexture,this.isUseTexture),n=(n=(new Date).getTime()-this.startTime)<this.options.delay?0:(n-=this.options.delay,1===this.animationType?Math.round(n/1e3*this.options.speed*20):3===this.animationType?n/1e3*this.options.speed*1e3:n/1e3*this.options.speed),o=this.options.size,Array.isArray(o)&&(i=this.map.map.getMaxZoom(),a=this.map.map.getMinZoom(),o=o[0]+(this.map.getZoom()-a)/(i-a)*(o[1]-o[0])),s.uniformMatrix4fv(r.uniforms.u_matrix,!1,t),s.uniform4f(r.uniforms.uColor,this.color[0],this.color[1],this.color[2],this.color[3]),s.uniform1f(r.uniforms.uSize,o),s.uniform1f(r.uniforms.uElapsedSteps,n),s.uniform1f(r.uniforms.uOriginSpeed,this.options.speed),s.uniform1i(r.uniforms.uAnimationType,this.animationType),s.uniform1i(r.uniforms.ushapeType,this.options.shapeType),s.uniform1i(r.uniforms.uPointFade,this.options.pointFade?1:0),s.uniform1f(r.uniforms.uPointFadeBuffer,this.options.pointFadeBuffer),s.uniform1f(r.uniforms.uZoomUnits,"m"===this.options.unit?this.map.getZoomUnits():1),this.setGLState({blend:!0,blendEquation:s.FUNC_ADD,blendFunc:"lighter"===e.blend?[s.SRC_ALPHA,s.ONE]:[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA],depthTest:!!e.depthTest}),s.drawArrays(s.POINTS,0,this.vertCount))}},{key:"url2canvas",value:function(t,e){var r;"object"===(void 0===t?"undefined":xn(t))?e(t):((r=new Image).crossOrigin="anonymous",r.onload=function(){var t=document.createElement("canvas");t.width=128,t.height=128,t.getContext("2d").drawImage(r,0,0,128,128),e(t)},r.src=t)}},{key:"loadTexture",value:function(){var e=this;this.canvas&&this.getOptions().icon?z(this.gl,this.canvas,function(t){e.isUseTexture=!0,e.texture=t}):(this.isUseTexture=!1,this.texture=null)}}]),r}()).ANIMATION_TYPE_LEAP=1,ln.ANIMATION_TYPE_SMOOTH=2,ln.ANIMATION_TYPE_UNIFORM_SPEED=3,ln.SHAPE_TYPE_SQUARE=1,ln.SHAPE_TYPE_CIRCLE=2,ln.SHAPE_TYPE_CIRCLE_GRADIENT=3;var Au=function(){function r(t,e){he(this,r),this.layer=t,this.gl=e,this.initData()}return ar(r,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]}}},{key:"getData",value:function(){return this.outWall3d}},{key:"onLayerChange",value:function(t,e){this.initData();for(var r=t.color,n=t.height,i=t.gradient,a=t.enablePreciseMap,o=t.repeatMap,s=this.gl,l=0;l<e.length;l++){var u=e[l],c=u.color||r;"properties"in u&&"color"in u.properties&&(c=u.properties.color),i||"[object Function]"!==Object.prototype.toString.call(c)||(c=c(u));var h=this.layer.normizedColor(i?i[0]:c),c=this.layer.normizedColor(i?i[1]:c),d=u.height||n;if("properties"in u&&"height"in u.properties&&(d=u.properties.height),"[object Function]"===Object.prototype.toString.call(d)&&(d=d(u)),"MultiLineString"===u.geometry.type||"Polygon"===u.geometry.type)for(var p=0;p<u.geometry.coordinates.length;p++){for(var f=u.geometry.coordinates[p],m=f.length,g=[],v=[],y=0,x=0;x<m;x++){var b,_=this.layer.normizedPoint(f[x]);0<x&&(a||o)&&(b=this.layer.normizedPoint(f[x-1]),y+=Math.sqrt(Math.pow(_[0]-b[0],2)+Math.pow(_[1]-b[1],2))),g.push(_),v.push(y)}this.processData(this.outWall3d,t,g,v,h,c,d)}else{for(p=(u=u.geometry.coordinates).length,f=[],m=[],v=g=0;v<p;v++)y=this.layer.normizedPoint(u[v]),0<v&&(a||o)&&(x=this.layer.normizedPoint(u[v-1]),g+=Math.sqrt(Math.pow(y[0]-x[0],2)+Math.pow(y[1]-x[1],2))),f.push(y),m.push(g);this.processData(this.outWall3d,t,f,m,h,c,d)}}for(t=0;t<this.outWall3d.vertex.length;t++){for(e=[],r=this.outWall3d.vertex[t].length,n=0;n<r;n++)e.push.apply(e,Jn(this.outWall3d.vertex[t][n]));r=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,r),s.bufferData(s.ARRAY_BUFFER,new Float32Array(e),s.STATIC_DRAW),this.outWall3d.vertexBuffer[t]=r,s.bindBuffer(s.ARRAY_BUFFER,null),r=s.createBuffer(),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),s.bufferData(s.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[t]),s.STATIC_DRAW),this.outWall3d.indexBuffer[t]=r,s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(t,e,r,n,i,a,o){var s=n[n.length-1],l=t.vertex[t.vertex.length-1],u=t.index[t.index.length-1],c=r.length;for((!u||65536<=u.length+2*c+2)&&(l=[],u=[],t.vertex.push(l),t.index.push(u)),(t=l.length)&&u.push(t-1,t),t=0;t<c;t++){var h=[],d=[],p=r[t];h.push(p[0],p[1],p[2]+o),h.push(i[0],i[1],i[2],i[3]),d.push(p[0],p[1],p[2]),d.push(a[0],a[1],a[2],a[3]),e.texture&&(p=n[t],e.enablePreciseMap||e.repeatMap?(h.push(p,1,s),d.push(p,0,s)):(h.push(t,1,c-1),d.push(t,0,c-1))),p=l.length,l.push(h,d),u.push(p,p+1)}}}]),r}(),un=function(){function r(t,e){return he(this,r),bn(this,(r.__proto__||Qe(r)).call(this,t,e))}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{texture:null,enablePreciseMap:!1,repeatMap:0,height:100,color:[1,1,1,1]}}},{key:"initialize",value:function(t){this.gl=t,this.dataMgr=new Au(this,this.gl),this.texture=null,this.isUseTexture=!1,this.vertexLength=10,this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform bool uUseTexture;attribute vec3 aPos;attribute vec4 aColor;attribute vec2 aTextureCoords;attribute float aTotalDistance;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}if(uUseTexture){vTextureCoords=aTextureCoords;vTotalDistance=aTotalDistance;}gl_Position=u_matrix*vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform bool uUseTexture;uniform float uDistance;uniform sampler2D uSampler;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(uUseTexture){float uvx=vTextureCoords.x/vTotalDistance;if(uDistance>0.0){uvx=mod(vTextureCoords.x,uDistance)/uDistance;}gl_FragColor=vec4(1.0,1.0,1.0,1.0)*texture2D(uSampler,vec2(uvx,vTextureCoords.y));}else{gl_FragColor=vColor;}}"}),this.loadTexture()}},{key:"onChanged",value:function(t,e){var r=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){r.loadTexture(function(){r.dataMgr.onLayerChange(t,e),r.webglLayer.render()})},0))}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;if((t=this.dataMgr.getData())&&!(t.vertex.length<=0)){var n,i,a=this.getOptions(),o=this.program;if(e.useProgram(o.program),a.texture){if(!this.texture)return;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(o.uniforms.uSampler,0)}for(this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],depthMask:!!a.texture,depthFunc:a.texture?e.LESS:e.LEQUAL}),a.texture?e.enableVertexAttribArray(o.attributes.aTextureCoords):e.disableVertexAttribArray(o.attributes.aTextureCoords),e.enableVertexAttribArray(o.attributes.aPos),e.enableVertexAttribArray(o.attributes.aColor),e.uniformMatrix4fv(o.uniforms.u_matrix,!1,r),e.uniform1i(o.uniforms.uUseTexture,this.isUseTexture),e.uniform1f(o.uniforms.uDistance,a.repeatMap),r=0;r<t.vertex.length;r++)t.vertex[r].length<=0||(i=t.vertex[r],i=(n=new Float32Array(i[0]).BYTES_PER_ELEMENT)*i[0].length,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer[r]),e.vertexAttribPointer(o.attributes.aPos,3,e.FLOAT,!1,i,0),e.vertexAttribPointer(o.attributes.aColor,4,e.FLOAT,!1,i,3*n),a.texture&&(e.vertexAttribPointer(o.attributes.aTextureCoords,2,e.FLOAT,!1,i,7*n),e.vertexAttribPointer(o.attributes.aTotalDistance,1,e.FLOAT,!1,i,9*n)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer[r]),e.drawElements(e.TRIANGLE_STRIP,t.index[r].length,e.UNSIGNED_SHORT,0),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))}}},{key:"loadTexture",value:function(r){var n=this,t=this.getOptions();t.texture?(this.isUseTexture=!0,z(this.gl,t.texture,function(t,e){n.image=e,n.texture=t,r&&r(),n.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,r&&r())}}]),r}(),wu=function(){function r(t,e){he(this,r),this.layer=t,this.gl=e,this.initData()}return ar(r,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(t,e){this.initData();var r=t.color,n=t.height,i=t.gradient;t=this.gl;for(var a=0;a<e.length;a++){var o=e[a].geometry.coordinates,s=o.length;this.maxLength=s>this.maxLength?s:this.maxLength;for(var l=[],u=0;u<s;u++){var c=this.layer.normizedPoint(o[u]);l.push(c)}s=e[a].color||r,"properties"in e[a]&&"color"in e[a].properties&&(s=e[a].properties.color),i||"[object Function]"!==Object.prototype.toString.call(s)||(s=s(e[a])),o=this.layer.normizedColor(i?i[0]:s),s=this.layer.normizedColor(i?i[1]:s),u=e[a].height||n,"properties"in e[a]&&"height"in e[a].properties&&(u=e[a].properties.height),"[object Function]"===Object.prototype.toString.call(u)&&(u=u(e[a])),this.processData(this.outWall3d,l,o,s,u)}for(e=0;e<this.outWall3d.vertex.length;e++){for(r=[],n=this.outWall3d.vertex[e].length,i=0;i<n;i++)r.push.apply(r,Jn(this.outWall3d.vertex[e][i]));n=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),this.outWall3d.vertexBuffer[e]=n,t.bindBuffer(t.ARRAY_BUFFER,null),n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[e]),t.STATIC_DRAW),this.outWall3d.indexBuffer[e]=n,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(t,e,r,n,i){var a=t.vertex[t.vertex.length-1],o=t.index[t.index.length-1],s=e.length;for((!o||65536<=o.length+2*s+2)&&(a=[],o=[],t.vertex.push(a),t.index.push(o)),(t=a.length)&&o.push(t-1,t),t=0;t<s;t++){var l=[],u=[],c=e[t];l.push(c[0],c[1]),l.push(c[2]?Number(c[2])+i:i),l.push(c[3]?Number(c[3]):t),l.push(r[0],r[1],r[2],r[3]),u.push(c[0],c[1]),u.push(c[2]?Number(c[2]):0),u.push(c[3]?Number(c[3]):t),u.push(n[0],n[1],n[2],n[3]),c=a.length,a.push(l,u),o.push(c,c+1)}}}]),r}(),cn=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).startTime=t.options.startTime||0,t.endTime=t.options.endTime,t.time=t.startTime,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(t){this.gl=t,this.dataMgr=new wu(this,this.gl),this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;varying float vTime;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vColor=aColor;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"})}},{key:"onChanged",value:function(t,e){this.gl&&(this.dataMgr.onLayerChange(t,e),void 0===t.endTime&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;if((t=this.dataMgr.getData())&&!(t.vertex.length<=0)){var n,i,a=this.getOptions(),o=this.program;for(e.useProgram(o.program),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}),e.enableVertexAttribArray(o.attributes.aPos),e.enableVertexAttribArray(o.attributes.aColor),e.uniformMatrix4fv(o.uniforms.u_matrix,!1,r),e.uniform1f(o.uniforms.currentTime,this.time),e.uniform1f(o.uniforms.trailLength,a.trailLength),r=0;r<t.vertex.length;r++)t.vertex[r].length<=0||(i=t.vertex[r],i=(n=new Float32Array(i[0]).BYTES_PER_ELEMENT)*i[0].length,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer[r]),e.vertexAttribPointer(o.attributes.aPos,4,e.FLOAT,!1,i,0),e.vertexAttribPointer(o.attributes.aColor,4,e.FLOAT,!1,i,4*n),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer[r]),e.drawElements(e.TRIANGLE_STRIP,t.index[r].length,e.UNSIGNED_SHORT,0),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null));this.time+=a.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),r}(),rn=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).simpleLineLayer=new $s(t.getHeatOptions()),t.children=[t.simpleLineLayer],t}return In(r,Zs),ar(r,[{key:"getDefaultOptions",value:function(){return{blend:"normal",gradient:{0:"rgb(50, 50, 256)",.1:"rgb(50, 250, 56)",.5:"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}},{key:"onDataChanged",value:function(t){this.simpleLineLayer.setData(t)}},{key:"onOptionsChanged",value:function(t){this.simpleLineLayer.setOptions(this.getHeatOptions())}},{key:"getHeatOptions",value:function(){var t=this.getOptions(),e=t.max,r=t.min;void 0===e&&(e=(r=this.getDataRange()).max,r=r.min);var n=new b({max:e,min:r,gradient:t.gradient});return t.color=function(t){var e=~~t.count||1;return"properties"in t&&"count"in t.properties&&(e=~~t.properties.count),[(t=n.getImageData(e))[0]/255,t[1]/255,t[2]/255,t[3]/255]},t}},{key:"getDataRange",value:function(){var t=this.getData(),e=0,r=0;t[0]&&(e=~~t[0].count||1,r=~~t[0].count||1),"properties"in t[0]&&"count"in t[0].properties&&(e=~~t[0].properties.count,r=~~t[0].properties.count);for(var n=t.length,i=0;i<n;i++){var a=~~t[i].count||1;"properties"in t[i]&&"count"in t[i].properties&&(a=~~t[i].properties.count),e=Math.max(a,e),r=Math.min(a,r)}return{max:e/2,min:r}}}]),r}(),Mu=n(function(t,e){t.exports=function(){function s(t,e,r,n,i,a){if(!(i-n<=r)){var o=n+i>>1;c(t,e,o,n,i,a%2);s(t,e,r,n,o-1,a+1);s(t,e,r,o+1,i,a+1)}}function c(t,e,r,n,i,a){for(;i>n;){if(600<i-n){var o=i-n+1,s=r-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*u*(o-u)/o)*(0>s-o/2?-1:1);c(t,e,r,Math.max(n,Math.floor(r-s*u/o+l)),Math.min(i,Math.floor(r+(o-s)*u/o+l)),a)}o=e[2*r+a];s=n;u=i;h(t,e,n,r);for(e[2*i+a]>o&&h(t,e,n,i);s<u;){h(t,e,s,u);s++;for(u--;e[2*s+a]<o;)s++;for(;e[2*u+a]>o;)u--}e[2*n+a]===o?h(t,e,n,u):(u++,h(t,e,u,i));u<=r&&(n=u+1);r<=u&&(i=u-1)}}function h(t,e,r,n){i(t,r,n);i(e,2*r,2*n);i(e,2*r+1,2*n+1)}function i(t,e,r){var n=t[e];t[e]=t[r];t[r]=n}function t(t,e){return{x:(i=i.geometry.coordinates)[0]/360+.5,y:u(i[1]),zoom:1/0,index:a,parentId:-1}}function l(t){var e=t.id,r=d(t);return{type:"Feature",id:e,properties:r,geometry:{type:"Point",coordinates:[360*(t.x-.5),360*Math.atan(Math.exp((180-360*t.y)*Math.PI/180))/Math.PI-90]}}}function d(t){var e=t.numPoints,r=1e4<=e?Math.round(e/1e3)+"k":1e3<=e?Math.round(e/100)/10+"k":e;return n(n({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function u(t){t=Math.sin(t*Math.PI/180);t=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return 0>t?0:1<t?1:t}function n(t,e){for(var r in e)t[r]=e[r];return t}function p(t){return t.x}function f(t){return t.y}var m=function(t){return t[0]},g=function(t){return t[1]},v=function(t,e,r,n,i){void 0===e&&(e=m);void 0===r&&(r=g);void 0===n&&(n=64);void 0===i&&(i=Float64Array);this.nodeSize=n;this.points=t;var a=this.ids=new(65536>t.length?Uint16Array:Uint32Array)(t.length);i=this.coords=new i(2*t.length);for(var o=0;o<t.length;o++)a[o]=o,i[2*o]=e(t[o]),i[2*o+1]=r(t[o]);s(a,i,n,0,a.length-1,0)};v.prototype.range=function(t,e,r,n){for(var i=this.ids,a=this.coords,o=this.nodeSize,s=[0,i.length-1,0],l=[],u,c;s.length;){var h=s.pop(),d=s.pop(),p=s.pop();if(d-p<=o)for(h=p;h<=d;h++)u=a[2*h],c=a[2*h+1],u>=t&&u<=r&&c>=e&&c<=n&&l.push(i[h]);else{var f=Math.floor((p+d)/2);u=a[2*f];c=a[2*f+1];u>=t&&u<=r&&c>=e&&c<=n&&l.push(i[f]);var m=(h+1)%2;if(0===h?t<=u:e<=c)s.push(p),s.push(f-1),s.push(m);if(0===h?r>=u:n>=c)s.push(f+1),s.push(d),s.push(m)}}return l};var e={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!(v.prototype.within=function(t,e,r){for(var n=this.ids,i=this.coords,a=this.nodeSize,o=[0,n.length-1,0],s=[],l=r*r;o.length;){var u=o.pop(),c=o.pop(),h=o.pop();if(c-h<=a)for(u=h;u<=c;u++){h=i[2*u]-t;var d=i[2*u+1]-e;h*h+d*d<=l&&s.push(n[u])}else{d=Math.floor((h+c)/2);var p=i[2*d],f=i[2*d+1],m=p-t,g=f-e;m*m+g*g<=l&&s.push(n[d]);m=(u+1)%2;if(0===u?t-r<=p:e-r<=f)o.push(h),o.push(d-1),o.push(m);if(0===u?t+r>=p:e+r>=f)o.push(d+1),o.push(c),o.push(m)}}return s}),generateId:!1,reduce:null,map:function(t){return t}},r=function(t){this.options=n(En(e),t);this.trees=Array(this.options.maxZoom+1)};return r.prototype.load=function(t){var e=(n=this.options).minZoom,r=n.maxZoom,n=n.nodeSize;this.points=t;for(var i,a,o=[],s=0;s<t.length;s++)t[s].geometry&&o.push((i=t[s],a=s,{x:(i=i.geometry.coordinates)[0]/360+.5,y:u(i[1]),zoom:1/0,index:a,parentId:-1}));for(this.trees[r+1]=new v(o,p,f,n,Float32Array),t=r;e<=t;t--)o=this._cluster(o,t),this.trees[t]=new v(o,p,f,n,Float32Array);return this},r.prototype.getClusters=function(t,e){var r=((t[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[3]));if(360<=t[2]-t[0])r=-180,i=180;else if(i<r)return r=this.getClusters([r,n,180,a],e),n=this.getClusters([-180,n,i,a],e),r.concat(n);t=[];for(var o=0,n=(e=this.trees[this._limitZoom(e)]).range(r/360+.5,u(a),i/360+.5,u(n));o<n.length;o+=1)i=e.points[n[o]],t.push(i.numPoints?l(i):this.points[i.index]);return t},r.prototype.getChildren=function(t){var e=this._getOriginId(t),r=this._getOriginZoom(t),n=this.trees[r];if(!n)throw Error("No cluster with the specified id.");var i=n.points[e];if(!i)throw Error("No cluster with the specified id.");for(var e=[],a=0,r=n.within(i.x,i.y,this.options.radius/(this.options.extent*Math.pow(2,r-1)));a<r.length;a+=1)(i=n.points[r[a]]).parentId===t&&e.push(i.numPoints?l(i):this.points[i.index]);if(0===e.length)throw Error("No cluster with the specified id.");return e},r.prototype.getLeaves=function(t,e,r){var n=[];return this._appendLeaves(n,t,e||10,r||0,0),n},r.prototype.getTile=function(t,e,r){var n=this.trees[this._limitZoom(t)];t=Math.pow(2,t);var i=this.options,a=(r-(i=i.radius/i.extent))/t,o=(r+1+i)/t,s={features:[]};return this._addTileFeatures(n.range((e-i)/t,a,(e+1+i)/t,o),n.points,e,r,t,s),0===e&&this._addTileFeatures(n.range(1-i/t,a,1,o),n.points,t,r,t,s),e===t-1&&this._addTileFeatures(n.range(0,a,i/t,o),n.points,-1,r,t,s),s.features.length?s:null},r.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom&&(e++,1===(t=this.getChildren(t)).length);)t=t[0].properties.cluster_id;return e},r.prototype._appendLeaves=function(t,e,r,n,i){var a=0;for(e=this.getChildren(e);a<e.length;a+=1){var o=e[a],s=o.properties;if(s&&s.cluster?i=i+s.point_count<=n?i+s.point_count:this._appendLeaves(t,s.cluster_id,r,n,i):i<n?i++:t.push(o),t.length===r)break}return i},r.prototype._addTileFeatures=function(t,e,r,n,i,a){for(var o=0;o<t.length;o+=1){var s=e[t[o]],l=s.numPoints,u={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-r)),Math.round(this.options.extent*(s.y*i-n))]],tags:l?d(s):this.points[s.index].properties},c=void 0;l?c=s.id:this.options.generateId?c=s.index:this.points[s.index].id&&(c=this.points[s.index].id),void 0!==c&&(u.id=c),a.features.push(u)}},r.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},r.prototype._cluster=function(t,e){for(var r=[],n=(a=this.options).reduce,i=a.minPoints,a=a.radius/(a.extent*Math.pow(2,e)),o=0;o<t.length;o++){var s=t[o];if(!(s.zoom<=e)){s.zoom=e;for(var l=this.trees[e+1],u=l.within(s.x,s.y,a),c=f=s.numPoints||1,h=0,d=u;h<d.length;h+=1){var p=l.points[d[h]];p.zoom>e&&(c+=p.numPoints||1)}if(i<=c){for(var h=s.x*f,d=s.y*f,f=n&&1<f?this._map(s,!0):null,p=(o<<5)+(e+1)+this.points.length,m=0;m<u.length;m+=1){var g,v=l.points[u[m]];v.zoom<=e||(v.zoom=e,g=v.numPoints||1,h+=v.x*g,d+=v.y*g,v.parentId=p,n&&n(f=f||this._map(s,!0),this._map(v)))}s.parentId=p,r.push({x:h/c,y:d/c,zoom:1/0,id:p,parentId:-1,numPoints:c,properties:f})}else if(r.push(s),1<c)for(s=0,c=u;s<c.length;s+=1)(u=l.points[c[s]]).zoom<=e||(u.zoom=e,r.push(u))}}return r},r.prototype._getOriginId=function(t){return t-this.points.length>>5},r.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},r.prototype._map=function(t,e){if(t.numPoints)return e?n({},t.properties):t.properties;t=this.points[t.index].properties;var r=this.options.map(t);return e&&r===t?n({},r):r},r}()}),Jr=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).shapeLayer=new Xs(t.options),t.textLayer=new Ys(t.options.textOptions),t.children=[t.shapeLayer,t.textLayer],t.max=[],t}return In(e,Zs),ar(e,[{key:"getDefaultOptions",value:function(){return{size:50,height:0,maxZoom:19,minZoom:5,gradient:{0:"rgb(50, 50, 256)",.1:"rgb(50, 250, 56)",.5:"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},enableCluster:!1,showText:!0,textOptions:{fontSize:13,color:"white"}}}},{key:"onOptionsChanged",value:function(t){this.textLayer.setOptions(t.textOptions)}},{key:"setOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this.options.textOptions;t.textOptions&&Xe(e,t.textOptions);var r=t.minZoom,n=t.maxZoom,i=t.size,r=n&&n!==this.options.maxZoom||r&&r!==this.options.minZoom||i&&i!==this.options.size;Xe(this.options,t,{textOptions:e}),r?this.onChanged(this.options,this.data):this.refreshLayer(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(t,e){var r,n,i;e&&e.length&&(this.zoom=Math.floor(this.map.getZoom()),r=t.maxZoom,n=t.minZoom,i=t.enableCluster,t=t.size,this.zoom>r?this.zoom=r:this.zoom<n&&(this.zoom=n),i&&(this.supercluster=new Mu({maxZoom:r,minZoom:n,radius:t/2}),this.supercluster.load(e)),this.refreshLayer())}},{key:"refreshLayer",value:function(){var t,e,r,n,l,i,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.data,s=this.map,c=this.zoom;(u=o.enableCluster&&this.supercluster?this.getClusterData(o):u)&&u.length&&(a=o.gradient,t=o.showText,e=o.textOptions,r=o.height,n=o.size,n*=Math.pow(2,18-c),u=function(t,e,r){for(var n={},i=[],a=t.length,o=e/2/Math.sin(Math.PI/3),s=1.5*o,l=1,u=0;u<a;++u){var c,h,d,p,f=t[u].geometry.coordinates,m=+(f=r?r(f):f)[0],g=+f[1];isNaN(m)||isNaN(g)||(f=Math.round(g/=s),c=Math.round(m=m/e-(1&f)/2),h=g-f,1<3*Math.abs(h)&&(d=m-c,(m-=p=c+(m<c?-1:1)/2)*m+(g-=m=f+(g<f?-1:1))*g<d*d+h*h&&(c=p+(1&f?1:-1)/2,f=m)),(d=n[h=c+"-"+f])?(d.count+=t[u].count||1,l=Math.max(l,d.count)):(n[h]={center:{x:(c+(1&f)/2)*e,y:f*s},count:t[u].count||1},i.push(n[h])))}return i.max=l,i.r=o,i}(u,n,function(t){var e=(r=Hn(t,2))[0],r=r[1];return-180<=e&&e<=180&&-90<=r&&r<=90&&(e=(r=s.lnglatToMercator(e,r))[0],r=r[1]),t[0]=e,t[1]=r,t}),this.max[c]=Math.max(this.max[c]||0,u.max),l=new b({max:this.max[c],min:0,maxSize:r*Math.pow(2,18-c),minSize:0,gradient:a}),a=[],t&&(i="function"==typeof(i=e&&e.format)?i:null,a=u.map(function(t){return{geometry:{coordinates:[t.center.x,t.center.y,l.getSize(t.count)+e.fontSize/2*Math.pow(2,18-c)]},text:i?i(t.count):t.count}})),this.textLayer.setData(a),t=u.map(function(t){for(var e,r,n,i=t.center,a=u.r,o=[],s=0;s<6;s++)o.push((e={x:i.x,y:i.y},r=a,n=s,n=Math.PI/180*(60*n+30),[e.x+r*Math.cos(n),e.y+r*Math.sin(n)]));return{geometry:{type:"Polygon",coordinates:[o]},properties:{height:l.getSize(t.count),color:l.getColor(t.count)}}}),this.shapeLayer.setData(t),o.enablePicked&&o.autoSelect&&this.pick(-1,-1))}},{key:"getClusterData",value:function(){var t=this.map,e=(r=t.getBounds()).ne,r=r.sw;this.ne=e,this.sw=r;var n=(i=e).lng,i=i.lat,a=[],a=-180<=n&&n<=180&&-90<=i&&i<=90?[r.lng,r.lat,e.lng,e.lat]:(e=t.mercatorToLnglat(this.ne.lng,this.ne.lat),(r=t.mercatorToLnglat(this.sw.lng,this.sw.lat)).concat(e));return this.supercluster.getClusters(a,this.zoom).map(function(t){var e=0;return t.properties&&t.properties.point_count&&(e=t.properties.point_count),{geometry:t.geometry,count:e}})}},{key:"pick",value:function(t,e){return this.shapeLayer.pick(t,e)}},{key:"shouldUpdate",value:function(){if(!this.data)return!1;var t=this.map,e=Math.floor(t.getZoom()),r=(n=this.options).maxZoom,n=n.minZoom;return r<e?e=r:e<n&&(e=n),this.zoom!==e?(this.zoom=e,!0):!!this.options.enableCluster&&(t=(e=t.getBounds()).ne,e=e.sw,!!(t&&e&&this.ne&&this.sw)&&(this.ne.lng!==t.lng||this.ne.lat!==t.lat||this.sw.lng!==e.lng||this.sw.lat!==e.lat||void 0))}},{key:"render",value:function(t){this.shouldUpdate()?this.refreshLayer():Bs(e.prototype.__proto__||Qe(e.prototype),"render",this).call(this,t)}}]),e}(),Cu=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).name="PointLayer",t.bufferData=[],t}return In(e,Rs),ar(e,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],blend:"normal",shape:"circle",size:5,unit:"px",borderWidth:0,borderColor:[1,1,1,.9],polygonOffset:[0,0],depthTest:!0}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions(),r=[];e.enablePicked&&r.push("PICK"),e.shape&&"circle"===e.shape&&r.push("SHAPE_CIRCLE"),this.program=new ss(this.gl,{vertexShader:"attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aBorderWidth;attribute vec4 aBorderColor;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float size=aSize*devicePixelRatio;float borderWidth=aBorderWidth*devicePixelRatio;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=uUnitPx ? size : size/zoomUnits;vSize=size;vBorderWidth=borderWidth;vBorderColor=aBorderColor;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}",fragmentShader:"varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){vec4 color=vColor;\n#if defined(SHAPE_CIRCLE)\nfloat d=distance(gl_PointCoord,vec2(0.5,0.5));float ratio=1.0-vBorderWidth/vSize*2.0;if(d>0.5){discard;}if(d>ratio*0.5){color=vBorderColor;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;\n#else\nfloat ratio=vBorderWidth/vSize;if(gl_PointCoord.x<ratio||gl_PointCoord.x>1.0-ratio||gl_PointCoord.y<ratio||gl_PointCoord.y>1.0-ratio){color=vBorderColor;}\n#endif\ngl_FragColor=color;}",defines:r},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{stride:52,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:52,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:52,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28},{stride:52,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:32},{stride:52,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:36}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(t,e){if(this.gl){for(var r=[],n=t.color,i=t.size,a=t.borderWidth,o=t.borderColor,s=0;s<e.length;s++)for(var l=this.normizedPoint(e[s].geometry.coordinates),u=this.getProperty("color",n,e[s]),u=this.normizedColor(u),c=this.getProperty("size",i,e[s]),c=Number(c),h=this.getProperty("borderWidth",a,e[s]),h=Number(h),d=this.getProperty("borderColor",o,e[s]),d=this.normizedColor(d),l=this.addMultipleCoords(l),p=0;p<l.length;p++){var f=l[p];r.push(f[0],f[1],Number(f[2]||0)),r.push(u[0],u[1],u[2],u[3]),r.push(c),r.push(h,d[0],d[1],d[2],d[3])}this.bufferData=r,this.buffer.updateData(new Float32Array(r)),t.enablePicked&&this.parsePickData(e)}}},{key:"parsePickData",value:function(t){var e=this.getOptions(),r=[];if(e.enablePicked)for(var n=0;n<t.length;n++){var i=this.indexToRgb(n);r.push(i[0]/255,i[1]/255,i[2]/255),e.repeat&&(r.push(i[0]/255,i[1]/255,i[2]/255),r.push(i[0]/255,i[1]/255,i[2]/255))}e.enablePicked&&this.pickBuffer.updateData(new Float32Array(r))}},{key:"render",value:function(t){var e,r,n=t.gl,i=t.matrix,a=t.isPickRender;this.bufferData.length<=0||(e=this.getOptions(),(r=this.program).use(n),t=this.getCommonUniforms(t),t=Xe(t,{uMatrix:i,uUnitPx:"px"===e.unit,zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio}),r.setUniforms(t),this.setGLState({blend:!a,blendFunc:"lighter"===e.blend?[n.SRC_ALPHA,n.ONE]:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA],blendEquation:n.FUNC_ADD,polygonOffset:e.polygonOffset,depthTest:e.depthTest}),this.vertexArray.bind(),n.drawArrays(n.POINTS,0,this.bufferData.length/13))}}]),e}(),_n=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="GroundRippleLayer",t.bufferDataArr=[],t.indexDataArr=[],t.vertexBuffer=[],t.indexBuffer=[],t.position=[],t.opacity=1,t.currentScale=1,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],size:5,segs:32,scale:2,unit:"m",step:.1}}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_projectionMatrix;uniform mat4 u_modelViewMatrix;uniform mat4 u_modelMatrix;uniform float u_opacity;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;void main(){vColor=aColor;vColor.a=u_opacity;gl_Position=u_projectionMatrix*u_modelViewMatrix*u_modelMatrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;void main(){if(vColor.a==0.0){discard;}gl_FragColor=vColor;}"})}},{key:"onDestroy",value:function(){this.bufferDataArr=[],this.indexDataArr=[],this.vertexBuffer=[],this.indexBuffer=[]}},{key:"onChanged",value:function(t,e){var r=this.gl;if(r&&(this.currentScale=this.opacity=1,(this.data=e)&&e.length)){var n=t.color,i=t.segs;t=t.size;for(var a=360/i,o=0;o<e.length;o++){var s=[],l=[],u=this.normizedPoint(e[o].geometry.coordinates),c=n;"[object Function]"===Object.prototype.toString.call(c)?c=c(e[o]):(c=e[o].color||n,"properties"in e[o]&&"color"in e[o].properties&&(c=e[o].properties.color));var c=this.normizedColor(c),h="[object Function]"===Object.prototype.toString.call(t)?t(e[o]):Number(t),d=u[0],p=u[1];s.push(0,0,-.5),s.push(c[0],c[1],c[2],0);for(var f=1,m=0;f<=i;f++,m+=a)s.push(u[0]-d+Math.cos(Math.PI/180*m)*h,u[1]-p+Math.sin(Math.PI/180*m)*h,-.5),s.push(c[0],c[1],c[2],this.opacity),f===i?l.push(0,0+f,1):l.push(0,0+f,0+f+1);c=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW),this.vertexBuffer[o]=c,this.bufferDataArr[o]=s,r.bindBuffer(r.ARRAY_BUFFER,null),s=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,s),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),r.STATIC_DRAW),this.indexBuffer[o]=s,this.indexDataArr[o]=l,r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),this.position[o]=[u[0],u[1]]}this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(t){var e,r,n=t.gl,i=t.projectionMatrix,a=t.viewMatrix;for(t=this.program,n.useProgram(t.program),n.uniformMatrix4fv(t.uniforms.u_projectionMatrix,!1,i),n.uniformMatrix4fv(t.uniforms.u_modelViewMatrix,!1,a),i=this.opacity,void 0!==this.options.opacity&&(i=this.options.opacity),n.uniform1f(t.uniforms.u_opacity,i),this.setGLState({blend:!0,blendEquation:n.FUNC_ADD,blendFunc:[n.SRC_ALPHA,n.DST_ALPHA]}),n.enableVertexAttribArray(t.attributes.aPos),n.enableVertexAttribArray(t.attributes.aColor),i=0;i<this.bufferDataArr.length;i++)this.bufferDataArr[i].length<=0||(a=new Float32Array(this.bufferDataArr[i]).BYTES_PER_ELEMENT,n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer[i]),n.vertexAttribPointer(t.attributes.aColor,4,n.FLOAT,!1,7*a,3*a),n.vertexAttribPointer(t.attributes.aPos,3,n.FLOAT,!1,7*a,0),a=this.position[i],e=rs.create(),r=[this.currentScale,this.currentScale,this.currentScale],"px"===this.options.unit&&this.map&&(r=this.map.getZoomUnits(),r=[this.currentScale*r,this.currentScale*r,this.currentScale]),rs.identity(e),rs.translate(e,e,[a[0],a[1],0]),rs.scale(e,e,r),n.uniformMatrix4fv(t.uniforms.u_modelMatrix,!1,e),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer[i]),n.drawElements(n.TRIANGLES,this.indexDataArr[i].length,n.UNSIGNED_SHORT,0),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null));n=(t=this.getOptions()).scale,t=t.step,this.opacity-=t/10,this.currentScale+=n*t,this.opacity<0&&(this.currentScale=this.opacity=1)}}]),r}(),Tu=function(){function e(t){return he(this,e),(t=bn(this,(e.__proto__||Qe(e)).call(this,t))).name="RippleLayer",t.bufferData=[],t.date=new Date,t.autoUpdate=!0,t}return In(e,Rs),ar(e,[{key:"getDefaultOptions",value:function(){return{depthTest:!0,polygonOffset:[0,0],color:[.1,.1,.9,1],blend:"normal",size:20,unit:"px",duration:2}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.program=new ss(this.gl,{vertexShader:"attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform float uTime;uniform float duration;uniform float zoomUnits;varying vec4 vColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float percent=mod(uTime,duration)/duration;vColor.a=1.-percent;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize/zoomUnits*percent;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}",fragmentShader:"varying vec4 vColor;void main(void){vec4 color=vColor;float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;gl_FragColor=color;}",defines:e.enablePicked?["PICK"]:[]},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{stride:32,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:32,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:32,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(t,e){if(this.gl){for(var r=[],n=t.color,i=t.size,a=0;a<e.length;a++){var o=e[a].geometry.coordinates,s=n;"[object Function]"===Object.prototype.toString.call(s)?s=s(e[a]):(s=e[a].color||n,"properties"in e[a]&&"color"in e[a].properties&&(s=e[a].properties.color));var s=this.normizedColor(s),o=this.normizedPoint(o),l=e[a].size||i;"properties"in e[a]&&"size"in e[a].properties&&(l=e[a].properties.size),l="[object Function]"===Object.prototype.toString.call(l)?l(e[a]):Number(l),r.push(o[0],o[1],Number(o[2]||0)),r.push(s[0],s[1],s[2],s[3]),r.push(l*window.devicePixelRatio)}this.bufferData=r,this.buffer.updateData(new Float32Array(r)),t.enablePicked&&this.parsePickData(e)}}},{key:"parsePickData",value:function(t){var e=this.getOptions(),r=[];if(e.enablePicked)for(var n=0;n<t.length;n++){var i=this.indexToRgb(n);r.push(i[0]/255,i[1]/255,i[2]/255)}e.enablePicked&&this.pickBuffer.updateData(new Float32Array(r))}},{key:"render",value:function(t){var e,r,n,i=t.gl,a=t.matrix,o=t.isPickRender;this.bufferData.length<=0||(e=this.getOptions(),(r=this.program).use(i),this.vertexArray.bind(),t=this.getCommonUniforms(t),n=1,"m"===e.unit&&this.map&&(n=this.map.getZoomUnits()),t=Xe(t,{zoomUnits:n,uTime:(new Date-this.date)/1e3,duration:e.duration,uMatrix:a}),r.setUniforms(t),this.setGLState({blend:!o,blendFunc:"lighter"===e.blend?[i.SRC_ALPHA,i.ONE]:[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA],blendEquation:i.FUNC_ADD,polygonOffset:e.polygonOffset,depthTest:e.depthTest}),i.drawArrays(i.POINTS,0,this.bufferData.length/8))}}]),e}(),Oa=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="SparkLayer",t.bufferData=[],t.startTime=Number(t.options.startTime)||0,t.endTime=Number(t.options.endTime),t.time=t.startTime,t.segs=Number(t.options.segs)||10,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:[.9,.1,.1,1],trailLength:3,height:100,step:.1,segs:10,polygonOffset:[0,0]}}},{key:"setTime",value:function(t){this.time=t}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"precision mediump float;attribute vec4 aPos;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision mediump float;uniform vec3 uFragColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(uFragColor,1.0*vTime);}"}),this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(t,e){var r=this.gl;if(r){this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.buffer);for(var n=[],i=t.height,a=0;a<e.length;a++)for(var o=e[a].geometry.coordinates,s="[object Function]"===Object.prototype.toString.call(i)?i(e[a]):Number(i),l=0,u=0;u<this.segs;u++){var c=this.normizedPoint(o);n.push(c[0],c[1],l),void 0===o[2]?n.push(u):n.push(Number(o[2])),l+=s/this.segs,n.push(c[0],c[1],l),void 0===o[2]?n.push(u+1):n.push(Number(o[2]))}void 0===t.endTime&&(this.endTime=this.segs),this.bufferData=n,r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;t=this.program,e.useProgram(t.program),e.uniformMatrix4fv(t.uniforms.u_matrix,!1,r),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.enableVertexAttribArray(t.attributes.aPos),e.vertexAttribPointer(t.attributes.aPos,4,e.FLOAT,!1,0,0),r=this.normizedColor(this.options.color),e.uniform3f(t.uniforms.uFragColor,r[0],r[1],r[2]),e.uniform1f(t.uniforms.currentTime,this.time),e.uniform1f(t.uniforms.trailLength,this.options.trailLength),this.setGLState({blend:!0,blendFunc:[e.SRC_ALPHA,e.ONE],blendEquation:e.FUNC_ADD,polygonOffset:this.options.polygonOffset}),e.drawArrays(e.LINES,0,this.bufferData.length/4),this.time+=Number(this.options.step),this.time>1.5*this.endTime&&(this.time=this.startTime)}}]),r}(),Su=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="IconLayer",t.index=[],e=t.canvas=document.createElement("canvas"),t.ctx=e.getContext("2d"),t.iconHash=new xu,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,flat:!1,unit:"px",scale:1,angle:0,opacity:1,offset:[0,0],padding:[0,0],polygonOffset:[0,0]}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform float u_opacity;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}textureColor.a*=u_opacity;gl_FragColor=textureColor;\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})}},{key:"processCache",value:function(e,t,r){var n=this;this.cachedData=[];for(var i=e.icon,a=e.width,o=e.height,s=e.offset,l=e.angle,u=0;u<t.length;u++){var c=this.normizedPoint(t[u].geometry.coordinates),h=this.getProperty("icon",i,t[u]),d=this.getProperty("width",a,t[u]),p=this.getProperty("height",o,t[u]),f=this.getProperty("offset",s,t[u]),m=this.getProperty("angle",l,t[u]);c&&h&&(this.cachedData.push({point:c,icon:h,width:d,height:p,offset:f,angle:m,index:u}),this.iconHash.get(h)||this.iconHash.set(h,h))}t=Zn(this.iconHash.entries()).filter(function(t){return"string"==typeof t[1]}).map(function(t){var r=Hn(t,2)[0];return new hu(function(e,t){n.url2canvas(r,function(t){n.iconHash.set(r,t),e()})})}),hu.all(t).then(function(t){n.buildSprite(e),!1!==r.autoRender&&n.webglLayer&&n.webglLayer.render()})}},{key:"buildSprite",value:function(t){var e=t.padding,r=this.canvas,n=this.ctx,i=[],a=new xu,o=!0,s=!1,l=void 0;try{for(var u=kn(this.iconHash);!(o=(h=u.next()).done);o=!0){var c,h,d=Hn(h.value,2),p=d[1];"string"!=typeof p&&(c=p.width,h=p.height,i.push({w:c+e[0],h:h+e[0],width:c,height:h,key:d[0],icon:p}))}}catch(t){s=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(s)throw l}}for(s=ot(i),o=0;o<i.length;o++)l=i[o],a.get(l.key)||a.set(l.key,l);for(o=m(s.w),s=m(s.h),r.width=o||1,r.height=s||1,n.save(),r=0;r<i.length;r++)l=i[r],n.drawImage(l.icon,l.x+e[0],l.y+e[1],l.width,l.height);n.restore(),this.loadTexture(),this.buildVertex(t,a,o,s)}},{key:"buildVertex",value:function(t,e,r,n){t=t.enablePicked;for(var i=[],a=[],o=[],s=[],l=0;l<this.cachedData.length;l++){var u=this.cachedData[l],c=u.point,h=u.width,d=u.height,p=u.offset,f=u.angle,m=u.index;if(u=e.get(u.icon)){for(var h=h||u.icon.width,d=d||u.icon.height,c=(v=Hn(c,3))[0],g=v[1],v=v[2],y=0;y<4;y++)i.push(c,g,v),i.push(y),i.push(h,d),i.push.apply(i,Jn(p)),i.push(f*Math.PI/180);h=u.x/r,d=(u.x+u.w)/r,p=(u.y+u.h)/n,u=u.y/n,a.push(h,p,h,u,d,u,d,p),u=4*l,o.push(u,u+2,u+1,u,u+3,u+2),t&&(m=this.indexToRgb(m),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255))}}this.index=o,this.vertexBuffer.updateData(new Float32Array(i)),this.uvBuffer.updateData(new Float32Array(a)),this.indexBuffer.updateData(new Uint32Array(o)),t&&this.pickBuffer.updateData(new Float32Array(s))}},{key:"render",value:function(t){var e,r,n,i;this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.setGLState({blend:!0,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),i.setUniforms(Xe(this.getCommonUniforms(t),{u_icon:this.texture,u_matrix:r,u_flat:n.flat,u_unit_px:"px"===n.unit,u_zoom_units:this.map.getZoomUnits(),u_scale:n.scale,u_opacity:n.opacity,u_zIndex:n.zIndex,devicePixelRatio:window.devicePixelRatio})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"url2canvas",value:function(t,n){var i;"object"===(void 0===t?"undefined":xn(t))?n(t):((i=new Image).crossOrigin="anonymous",i.onload=function(){var t=i.width,e=i.height,r=document.createElement("canvas");r.width=t,r.height=e,r.getContext("2d").drawImage(i,0,0,t,e),n(r)},i.onerror=function(){var t=document.createElement("canvas");t.width=20,t.height=40;var e=t.getContext("2d");e.fillStyle="red",e.beginPath(),e.lineTo(0,0),e.lineTo(20,0),e.lineTo(10,40),e.closePath(),e.fill(),n(t)},i.src=t)}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t}):this.texture=null}}]),r}(),Fa=function(){function r(t){he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t))).pointLayer=new Cu(t.options),t.options.textOptions=Xe({depthTest:!1},t.options.textOptions),t.textLayer=new Ys(t.options.textOptions);var e=Xe({},t.options,t.options.iconOptions);return t.iconLayer=new Su(e),t.children=[t.pointLayer,t.textLayer,t.iconLayer],t}return In(r,Zs),ar(r,[{key:"getDefaultOptions",value:function(){return{minSize:25,maxSize:40,clusterRadius:200,minPoints:2,extent:400,showText:!0,maxZoom:19,minZoom:4,gradient:{0:"rgb(50, 50, 256)",.1:"rgb(50, 250, 56)",.5:"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"onOptionsChanged",value:function(t){this.textLayer.setOptions(t.textOptions)}},{key:"setOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this.options.textOptions;t.textOptions&&Xe(e,t.textOptions);var r=t.minZoom,n=t.maxZoom,i=t.clusterRadius,r=n&&n!==this.options.maxZoom||r&&r!==this.options.minZoom||i&&i!==this.options.clusterRadius;Xe(this.options,t,{textOptions:e}),r?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(t,e){var n=this;e&&e.length?(e.forEach(function(t){var e=(r=Hn(t.geometry.coordinates,2))[0],r=r[1];-180<=e&&e<=180&&-90<=r&&r<=90||(e=n.map.mercatorToLnglat(e,r),t.geometry.coordinates[0]=e[0],t.geometry.coordinates[1]=e[1])}),this.supercluster=new Mu({maxZoom:t.maxZoom,minZoom:t.minZoom,radius:t.clusterRadius,minPoints:t.minPoints,extent:t.extent}),this.supercluster.load(e),this.supercluster.trees.forEach(function(t){var e=0,r=1/0;t.points.forEach(function(t){e=Math.max(t.numPoints||0,e),r=Math.min(t.numPoints||1/0,r)}),t.max=e,t.min=r}),this.refreshCluster()):(this.supercluster=null,this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]))}},{key:"refreshCluster",value:function(){var t,e,r,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;!this.supercluster||(t=this.getClusterData(i))&&t.length&&("function"==typeof i.beforeRender&&!1===i.beforeRender(t)?(this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([])):(e=[],r=[],n=[],t.forEach(function(t){t.properties.text?(e.push(t),n.push({geometry:t.geometry,properties:{text:t.properties.text}})):(t.properties.icon?r:e).push(t)}),this.pointLayer.setData(e),this.iconLayer.setData(r),this.textLayer.setData(i.showText?n:[]),i.enablePicked&&i.autoSelect&&this.pick(-1,-1)))}},{key:"getClusterData",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options,e=this.map.getBounds(),r=this.ne=e.getNorthEast(),e=this.sw=e.getSouthWest(),n=(i=r).lng,i=i.lat;return e=-180<=n&&n<=180&&-90<=i&&i<=90?[e.lng,e.lat,r.lng,r.lat]:(r=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),(e=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat)).concat(r)),r=Math.floor(this.map.getZoom()),e=this.supercluster.getClusters(e,r),this.zoom!==r&&0<e.length&&(this.zoom=r,(n=(i=this.supercluster.trees)[r]&&i[r].max||this.max)!==(r=i[r]&&i[r].min||this.min)&&(this.max=n,this.min=r)),this.processData(e,t)}},{key:"processData",value:function(t,e){var i=e.defaultColor,a=e.defaultSize,r=e.gradient,n=e.minSize,o=e.textOptions,s=new b({max:this.max,min:~~this.min||1,minSize:n||8,maxSize:e.maxSize||30,gradient:r}),i=i||r[0]||"black",a=a||.5*n||5,l="function"==typeof(l=o&&o.format)?l:null;return t.map(function(t){var e=a,r=i,n="";return t.properties&&t.properties.point_count&&(n=t.properties.point_count,e=s.getSize(n)||e,r=s.getColor(n),n=l?l(n):n),e=Xe({},t.properties,{text:n,size:e,color:r}),Xe({},t,{properties:e,children:t.id})})}},{key:"pick",value:function(t,e){var r=this.pointLayer.pick(t,e);return(t=(r=r.dataIndex<0?this.iconLayer.pick(t,e):r).dataItem)&&"number"==typeof t.children&&(t.children=this.getClusterPoints(t.children)),r}},{key:"getClusterPoints",value:function(t){var e=this;return t?this.supercluster.getChildren(t).map(function(t){return"Feature"===t.type?e.getClusterPoints(t.id):t}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var t=(e=this.map.getBounds()).getNorthEast(),e=e.getSouthWest();return this.ne.lng!==t.lng||this.ne.lat!==t.lat||this.sw.lng!==e.lng||this.sw.lat!==e.lat||void 0}},{key:"render",value:function(t){this.shouldUpdate()?this.refreshCluster():Bs(r.prototype.__proto__||Qe(r.prototype),"render",this).call(this,t)}}]),r}(),Eu=function(){function r(t,e){return he(this,r),bn(this,(r.__proto__||Qe(r)).call(this,t,e))}return In(r,Cu),ar(r,[{key:"getDefaultOptions",value:function(){return Xe(Bs(r.prototype.__proto__||Qe(r.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gradient:{0:"rgb(50, 50, 256)",.1:"rgb(50, 250, 56)",.5:"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}})}},{key:"onChanged",value:function(t,e){this.gl&&(e=this.processData(e,t),Bs(r.prototype.__proto__||Qe(r.prototype),"onChanged",this).call(this,t,e))}},{key:"generateGrid",value:function(t,e){var r=e.gridSize,n=[],i={};e=t.length;for(var a=this.getPointOffset(),o=0;o<e;o++){var s=(l=this.normizedPoint(t[o].geometry.coordinates))[2],l=~~((l[0]+a[0])/r)+"_"+~~((l[1]+a[1])/r);void 0===i[l]&&(i[l]={count:0,num:0,z:0});var u=~~t[o].count||1;"properties"in t[o]&&"count"in t[o].properties&&(u=~~t[o].properties.count),i[l].count+=u,i[l].num+=1,i[l].z+=s}return ke(i).forEach(function(t){var e=t.split("_");n.push([e[0]*r+r/2,e[1]*r+r/2,i[t].z/i[t].num,i[t].count])}),n}},{key:"processData",value:function(t,e){var r=[];if("normal"===e.style)for(var n=this.getPointOffset(),i=0;i<t.length;i++){var a=(s=this.normizedPoint(t[i].geometry.coordinates))[0]+n[0],o=s[1]+n[1],s=s[2],l=~~t[i].count||1;"properties"in t[i]&&"count"in t[i].properties&&(l=~~t[i].properties.count),r.push([a,o,s,l])}else r=this.generateGrid(t,e);if(void(n=t=0)!==e.max&&void 0!==e.min)t=e.max,n=e.min;else{for(r[0]&&(t=r[0][3],n=r[0][3]),i=r.length,a=0;a<i;a++)o=r[a],t=Math.max(o[3],t),n=Math.min(o[3],n);t/=2}for(e=new b({max:~~t,min:n,gradient:e.gradient}),t=[],n=0;n<r.length;n++)(i=r[n])[0]=i[0],i[1]=i[1],a=e.getImageData(i[3]),t.push({geometry:{type:"Point",coordinates:[i[0],i[1],i[2]]},color:[a[0]/255,a[1]/255,a[2]/255,a[3]/255]});return t}}]),r}(),vn=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).bufferData=[],t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1]}}},{key:"onChanged",value:function(t,e){var i=this;if(t=this.gl){this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer);for(var a=[],r=0;r<20;r++)!function(t){var n=5*t;for(t=0;t<e.length;t++)e[t].geometry.coordinates.forEach(function(t){for(var e=0;e<t.length-1;e++){var r=i.normizedPoint(t[e]);a.push(r[0]),a.push(r[1]),a.push(Number(n)),r=i.normizedPoint(t[e+1]),a.push(r[0]),a.push(r[1]),a.push(Number(n))}})}(r);t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),this.bufferData=a,t.bindBuffer(t.ARRAY_BUFFER,null)}}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(t,{vertexShader:"uniform mat4 uMatrix;attribute vec3 aPos;void main(){gl_PointSize=10.0;gl_Position=uMatrix*vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform vec4 uFragColor;void main(){gl_FragColor=uFragColor;}"}),this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"render",value:function(t){var e=t.gl;t=t.matrix;var r=this.program;e.useProgram(r.program);var n=this.normizedColor(this.options.color);e.uniform4f(r.uniforms.uFragColor,n[0],n[1],n[2],n[3]),e.uniformMatrix4fv(r.uniforms.uMatrix,!1,t),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.ONE,e.ONE]}),e.drawArrays(e.LINES,0,this.bufferData.length/3)}}]),r}(),Iu={circle:1,square:2},el=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).bufferData=[],t.startTime=t.options.startTime||0,t.endTime=t.options.endTime,t.time=t.startTime,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"attribute vec4 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 u_matrix;varying vec4 vColor;uniform float currentTime;uniform float trailLength;varying float vTime;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;varying vec4 vColor;uniform int uShape;varying float vTime;void main(void){if(vTime>1.0||vTime<0.0){discard;}if(uShape==1){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d<0.5){gl_FragColor=vColor;}else{discard;}}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vTime);}}"}),this.f32BufferData=new Float32Array,this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"onChanged",value:function(t,e){var r=this.gl;if(r){this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.buffer);for(var n=[],i=t.color||[.1,.1,.9,1],a=t.size||5,o=0;o<e.length;o++){var s=e[o].geometry.coordinates,l=i;"[object Function]"===Object.prototype.toString.call(l)?l=l(e[o]):(l=e[o].color||i,"properties"in e[o]&&"color"in e[o].properties&&(l=e[o].properties.color));var l=this.normizedColor(l),u=this.normizedPoint(s),c=a,c="[object Function]"===Object.prototype.toString.call(c)?c(e[o]):Number(c),h=e[o].time||o;"properties"in e[o]&&"time"in e[o].properties&&(h=e[o].properties.time),n.push(u[0],u[1],Number(s[2]||0),h),n.push(l[0],l[1],l[2],l[3]),n.push(c*window.devicePixelRatio)}void 0===t.endTime&&(this.endTime=e.length),this.bufferData=n,this.f32BufferData=new Float32Array(n),r.bufferData(r.ARRAY_BUFFER,this.f32BufferData,r.STATIC_DRAW)}}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;this.bufferData.length<=0||(t=this.program,e.useProgram(t.program),e.uniformMatrix4fv(t.uniforms.u_matrix,!1,r),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),r=this.f32BufferData.BYTES_PER_ELEMENT,e.enableVertexAttribArray(t.attributes.aPos),e.vertexAttribPointer(t.attributes.aPos,4,e.FLOAT,!1,9*r,0),e.enableVertexAttribArray(t.attributes.aColor),e.vertexAttribPointer(t.attributes.aColor,4,e.FLOAT,!1,9*r,4*r),e.enableVertexAttribArray(t.attributes.aSize),e.vertexAttribPointer(t.attributes.aSize,1,e.FLOAT,!1,9*r,8*r),e.uniform1f(t.uniforms.currentTime,this.time),e.uniform1f(t.uniforms.trailLength,this.options.trailLength||3),r=1,this.options.shape&&Iu[this.options.shape]&&(r=Iu[this.options.shape]),e.uniform1i(t.uniforms.uShape,r),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:"lighter"===this.options.blend?[e.SRC_ALPHA,e.ONE]:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}),e.drawArrays(e.POINTS,0,this.bufferData.length/9),this.time+=this.options.step||.1,this.time>this.endTime&&(this.time=this.startTime))}}]),r}(),Cl=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).bufferData=[],t.startTime=t.options.startTime||0,t.endTime=t.options.endTime,t.time=t.startTime,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1],trailLength:3,step:.1,polygonOffset:[0,0]}}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec4 aPos;attribute vec4 aColor;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;varying vec4 vColor;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vColor=aColor;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;uniform vec3 uFragColor;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"},this),this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"setTime",value:function(t){this.time=t}},{key:"onChanged",value:function(t,e){var r=this.gl;if(r){this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.buffer);for(var n=[],i=0,a=this.options.color,o=0;o<e.length;o++){var s=e[o].geometry.coordinates;e[o].color&&(a=e[o].color),"properties"in e[o]&&"color"in e[o].properties&&(a=e[o].properties.color),"[object Function]"===Object.prototype.toString.call(a)&&(a=a(e[o])),a=this.normizedColor(a),s.length>i&&(i=s.length);for(var l=0;l<s.length-1;l++){var u=this.normizedPoint(s[l]);n.push(u[0]),n.push(u[1]),n.push(u[2]),void 0===s[l][3]?n.push(l):n.push(Number(s[l][3])),n.push(a[0]),n.push(a[1]),n.push(a[2]),n.push(a[3]),u=this.normizedPoint(s[l+1]),n.push(u[0]),n.push(u[1]),n.push(u[2]),void 0===s[l+1][3]?n.push(l+1):n.push(Number(s[l+1][3])),n.push(a[0]),n.push(a[1]),n.push(a[2]),n.push(a[3])}}void 0===t.endTime&&(this.endTime=i),this.bufferData=n,this.f32BufferData=new Float32Array(n),r.bufferData(r.ARRAY_BUFFER,this.f32BufferData,r.STATIC_DRAW)}}},{key:"render",value:function(t){var e=t.gl,r=t.matrix;t=this.getOptions();var n=this.program;n.use(e),e.uniformMatrix4fv(n.uniforms.u_matrix,!1,r),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),r=this.f32BufferData.BYTES_PER_ELEMENT,e.enableVertexAttribArray(n.attributes.aPos),e.vertexAttribPointer(n.attributes.aPos,4,e.FLOAT,!1,8*r,0),e.enableVertexAttribArray(n.attributes.aColor),e.vertexAttribPointer(n.attributes.aColor,4,e.FLOAT,!1,8*r,4*r),r=this.normizedColor(t.color),e.uniform3f(n.uniforms.uFragColor,r[0],r[1],r[2]),e.uniform1f(n.uniforms.currentTime,this.time),e.uniform1f(n.uniforms.trailLength,t.trailLength),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:"lighter"===t.blend?[e.ONE,e.ONE]:[e.SRC_ALPHA,e.ONE],polygonOffset:t.polygonOffset,depthMask:!1}),e.drawArrays(e.LINES,0,this.bufferData.length/8),this.time+=t.step,this.time>this.endTime&&(this.time=this.startTime)}}]),r}(),Tl=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="IconCollidesLayer",t.index=[],e=t.canvas=document.createElement("canvas"),t.ctx=e.getContext("2d"),t.iconHash=new xu,t.boxHash=new xu,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{flat:!1,unit:"px",scale:1,angle:0,offset:[0,0],padding:[0,0]}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.gl&&(this.cachedData=[],this.boxHash.clear(),this.processCache(t,e,r))}},{key:"processCache",value:function(e,t,r){for(var n=this,i=e.icon,a=e.width,o=e.height,s=e.offset,l=e.angle,u=0;u<t.length;u++){var c=this.normizedPoint(t[u].geometry.coordinates),h=this.getProperty("icon",i,t[u]),d=this.getProperty("width",a,t[u]),p=this.getProperty("height",o,t[u]),f=this.getProperty("offset",s,t[u]),m=this.getProperty("angle",l,t[u]);c&&h&&(this.cachedData.push({point:c,icon:h,width:d,height:p,offset:f,angle:m,dataIndex:u}),this.iconHash.get(h)||this.iconHash.set(h,h))}t=Zn(this.iconHash.entries()).filter(function(t){return"string"==typeof t[1]}).map(function(t){var r=Hn(t,2)[0];return new hu(function(e,t){n.url2canvas(r,function(t){n.iconHash.set(r,t),e()})})}),hu.all(t).then(function(t){n.buildSprite(e),!1!==r.autoRender&&n.webglLayer&&n.webglLayer.render()})}},{key:"buildSprite",value:function(t){t=t.padding;var e=this.canvas,r=this.ctx,n=[],i=!0,a=!1,o=void 0;try{for(var s,l=kn(this.iconHash);!(i=(s=l.next()).done);i=!0){var u,c,h=Hn(s.value,2),d=h[1];"string"!=typeof d&&(u=d.width,c=d.height,n.push({w:u+t[0],h:c+t[0],width:u,height:c,key:h[0],icon:d}))}}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}for(l=ot(n),s=0;s<n.length;s++)h=n[s],this.boxHash.get(h.key)||this.boxHash.set(h.key,h);for(s=m(l.w)||1,l=m(l.h)||1,e.width=s,e.height=l,r.save(),e=0;e<n.length;e++)l=n[e],r.drawImage(l.icon,l.x+t[0],l.y+t[1],l.width,l.height);r.restore(),this.loadTexture()}},{key:"render",value:function(t){var e,r,n,i;this.cachedData&&this.cachedData.length&&this.texture&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.throttleUpdate(t),this.setGLState({blend:!0,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}),i.setUniforms(Xe(this.getCommonUniforms(t),{u_icon:this.texture,u_matrix:r,u_flat:n.flat,u_unit_px:"px"===n.unit,u_zoom_units:this.map.getZoomUnits(),u_scale:n.scale,u_zIndex:n.zIndex,devicePixelRatio:window.devicePixelRatio})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"throttleUpdate",value:function(t){this.updateIcon(t)}},{key:"updateIcon",value:function(t){if(this.iconHash.size&&this.boxHash.size){var e=this.getOptions(),r=t.gl;t=t.matrix;for(var e=e.enablePicked,n=[],i=[],a=[],o=[],s=this.canvas.width,l=this.canvas.height,u=r.canvas.width/window.devicePixelRatio,r=r.canvas.height/window.devicePixelRatio,c=new qs,h=0,d=0;d<this.cachedData.length;d++){var p=this.cachedData[d],f=p.point,m=p.width,g=p.height,v=p.offset,y=p.angle,x=p.dataIndex;if(p=this.boxHash.get(p.icon)){var m=m||p.icon.width,g=g||p.icon.height,f=(_=Hn(f,3))[0],b=_[1],_=_[2],A=Ko.clone([f,b,_,1]);Ko.transformMat4(A,A,t),Ko.scale(A,A,1/A[3]);var w=(A[0]+1)/2*u-m/2,M=w+m,C=(A=(1-A[1])/2*r-g/2)+g;if(!(M<0||C<0||u<w||r<A||(w={minX:w,maxX:M,minY:A,maxY:C},c.collides(w)))){for(c.insert(w),w=0;w<4;w++)n.push(f,b,_),n.push(w),n.push(m,g),n.push.apply(n,Jn(v)),n.push(y*Math.PI/180);m=p.x/s,g=(p.x+p.w)/s,v=(p.y+p.h)/l,p=p.y/l,i.push(m,v,m,p,g,p,g,v),p=4*h,a.push(p,p+2,p+1,p,p+3,p+2),e&&(x=this.indexToRgb(x),o.push(x[0]/255,x[1]/255,x[2]/255),o.push(x[0]/255,x[1]/255,x[2]/255),o.push(x[0]/255,x[1]/255,x[2]/255),o.push(x[0]/255,x[1]/255,x[2]/255)),h+=1}}}this.index=a,this.vertexBuffer.updateData(new Float32Array(n)),this.uvBuffer.updateData(new Float32Array(i)),this.indexBuffer.updateData(new Uint32Array(a)),e&&this.pickBuffer.updateData(new Float32Array(o))}}},{key:"url2canvas",value:function(t,n){var i;"object"===(void 0===t?"undefined":xn(t))?n(t):((i=new Image).crossOrigin="anonymous",i.onload=function(){var t=i.width,e=i.height,r=document.createElement("canvas");r.width=t,r.height=e,r.getContext("2d").drawImage(i,0,0,t,e),n(r)},i.onerror=function(){var t=document.createElement("canvas");t.width=20,t.height=40;var e=t.getContext("2d");e.fillStyle="red",e.beginPath(),e.lineTo(0,0),e.lineTo(20,0),e.lineTo(10,40),e.closePath(),e.fill(),n(t)},i.src=t)}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t}):this.texture=null}}]),r}(),Lu=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="LineFlowLayer",t.initData(),t.date=new Date,t.autoUpdate=!0,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",blend:"normal",width:2,antialias:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[]}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.program=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float thickness;uniform vec4 uSelectedColor;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aCounter;attribute vec2 uv;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}void main(){vColor=aColor;vCounter=aCounter;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\nvec4 previousProjected=u_matrix*vec4(previous,1.0);vec4 currentProjected=u_matrix*vec4(position,1.0);vec4 nextProjected=u_matrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float len=thickness;float orientation=direction;vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){len=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);vNormal=normal*orientation;normal*=len/2.0;vec2 pos=currentScreen+normal*orientation;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}",fragmentShader:"precision highp float;uniform bool uAntialias;uniform bool uAnimate;uniform float uTime;uniform float duration;uniform float interval;uniform float trailLength;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.98,1.0,length(vNormal));color.a*=blur;}if(uAnimate){float alpha=1.0-fract(mod(1.0-vCounter,interval)*(1.0/interval)+uTime/duration);alpha=(alpha+trailLength-1.0)/trailLength;color.a*=alpha;}gl_FragColor=color;}",defines:e.enablePicked?["PICK"]:[]},this),this.prevBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:4,name:"aCounter",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){var r=this;if(this.gl){this.initData();for(var n=1,i=[],a=0;a<e.length;a++){var o=[],s=(o=kt(o=(s=e[a].geometry.coordinates)&&0<s.length?"Polygon"===e[a].geometry.type?s[0].map(function(t){return r.normizedPoint(t)}):s.map(function(t){return r.normizedPoint(t)}):o)).total;i[a]=o.arr,n=Math.max(s,n)}for(a=[],o=t.color,s=0;s<e.length;s++){var l=[];(u=e[s].geometry.coordinates)&&0<u.length&&(l="Polygon"===e[s].geometry.type?u[0].map(function(t){return r.normizedPoint(t)}):u.map(function(t){return r.normizedPoint(t)})),u=o,"[object Function]"===Object.prototype.toString.call(u)?u=u(e[s]):(u=e[s].color||o,"properties"in e[s]&&"color"in e[s].properties&&(u=e[s].properties.color));for(var u=this.normizedColor(u),c=this.addMultipleCoords(l),h=0;h<c.length;h++)this.processData(this.dataMgr,c[h],i[s],n,u);if(t.enablePicked)for(u=this.indexToRgb(s),c=0;c<l.length;c++)a.push(u[0]/255,u[1]/255,u[2]/255),a.push(u[0]/255,u[1]/255,u[2]/255),t.repeat&&(a.push(u[0]/255,u[1]/255,u[2]/255),a.push(u[0]/255,u[1]/255,u[2]/255),a.push(u[0]/255,u[1]/255,u[2]/255),a.push(u[0]/255,u[1]/255,u[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),t.enablePicked&&this.pickBuffer.updateData(new Float32Array(a))}}},{key:"processData",value:function(t,e,r,n,i){var a=e.length,o=t.position.length/6;r=Bt(r.map(function(t){return t/n}));var s=Bt(e.map(function(t){return-1}),!0),l=Bt(e),u=Bt(e.map(zt(-1))),c=Bt(e.map(zt(1)));e=Bt(e.map(function(t){return i})),a=Nt(a,o),(o=t.counter).push.apply(o,Jn(r)),(r=t.position).push.apply(r,Jn(Ut(l))),(l=t.prev).push.apply(l,Jn(Ut(u))),(u=t.next).push.apply(u,Jn(Ut(c))),(c=t.direction).push.apply(c,Jn(s)),(s=t.color).push.apply(s,Jn(Ut(e))),(t=t.index).push.apply(t,Jn(a))}},{key:"render",value:function(t){var e,r,n,i=t.gl,a=t.matrix,o=this.dataMgr;!o||o.index.length<=0||(e=this.getOptions(),(r=this.program).use(i),n=!this.map||!!((n=this.map.getZoom())>=e.minZoom&&n<=e.maxZoom&&this.autoUpdate),r.setUniforms(Xe(this.getCommonUniforms(t),{u_matrix:a,thickness:e.width,uAntialias:e.antialias,uTime:(new Date-this.date)/1e3,uAnimate:n,duration:e.duration,interval:e.interval,trailLength:e.trailLength})),this.setGLState({blend:!0,blendEquation:i.FUNC_ADD,blendFunc:"lighter"===e.blend?[i.SRC_ALPHA,i.ONE]:[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA],polygonOffset:e.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),i.drawElements(i.TRIANGLES,o.index.length,i.UNSIGNED_INT,0))}}]),r}(),Ru=function(){function r(t,e){return he(this,r),bn(this,(r.__proto__||Qe(r)).call(this,t,e))}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform sampler2D uTerrain;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;\n#if defined(TERRAIN)\nvec4 terrainColor=texture2D(uTerrain,vec2(v_texture_coord.s,v_texture_coord.t));vec3 rgb=terrainColor.rgb*256.0;pos.z=-10000.0+((rgb.r*256.0*256.0+rgb.g*256.0+rgb.b)*0.1);pos.z=pos.z-60.0;\n#endif\nvec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}",fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform bool uUseFilter;uniform vec4 uFilterColor;void main(){vec4 textureColor=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}",defines:e.terrain?["TERRAIN"]:""},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new hs({gl:t,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}},{key:"onChanged",value:function(t,e){var r=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){r.loadTexture(function(){r.parseData(e),r.dataTime=new Date,r.webglLayer.render()})},0))}},{key:"render",value:function(t){var e=t.gl,r=t.projectionMatrix;t=t.viewMatrix;var n=this.getOptions(),i=this.program,a=i.uniforms;i.use(e),this.texture&&(e.activeTexture(e.TEXTURE0),e.uniform1i(a.uTile,0),e.bindTexture(e.TEXTURE_2D,this.texture),e.activeTexture(e.TEXTURE1),e.uniform1i(a.uTerrain,1),e.bindTexture(e.TEXTURE_2D,this.terrainSampler),this.setGLState({cullFace:!1}),i.setUniforms({u_proj_matrix:r,uUseFilter:!!n.filterColor,uFilterColor:this.normizedColor(n.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:t}),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"loadTexture",value:function(r){var n=this,i=this.getOptions();i.tile?i.terrain?z(this.gl,i.terrain,function(t,e){n.terrainSampler=t,z(n.gl,i.tile,function(t,e){n.texture=t,r&&r(),n.webglLayer.render()})},{TEXTURE_WRAP_S:"MIRRORED_REPEAT",TEXTURE_WRAP_T:"MIRRORED_REPEAT"}):z(this.gl,i.tile,function(t,e){n.texture=t,r&&r(),n.webglLayer.render()}):(this.texture=null,r&&r())}},{key:"parseData",value:function(t){var e=this,r=[],n=[];if(t&&t[0]){var i=t[0].geometry.coordinates[0];t=(i=i.map(function(t){return e.normizedPoint(t)}))[0][0];var a=i[0][1],o=i[0][2],s=(i[2][0]-t)/16;i=(i[2][1]-a)/16;for(var l=0;l<=16;l++)for(var u,c,h=0;h<=16;h++)r.push(t+s*h,a+i*l,o),r.push(h/16,l/16),h<16&&l<16&&(u=17*l+h,c=17*(l+1)+h,n.push(u,c+1,u+1),n.push(u,c,c+1))}this.index=n,this.vertexBuffer.updateData(new Float32Array(r)),this.indexBuffer.updateData(new Uint32Array(n))}}]),r}(),Pu=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="BoardLayer",t.index=[],e=t.canvas=document.createElement("canvas"),t.ctx=e.getContext("2d"),t.iconHash=new xu,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{unit:"px",scale:1,angle:0,offsetZ:0,padding:[0,0],polygonOffset:[0,0]}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute float a_offsetZ;attribute vec2 a_size;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float u_zoom_units;uniform float u_scale;uniform bool u_unit_px;varying vec2 v_texture_coord;/***三维空间内，绕Z轴旋转的矩阵，右手坐标系下*[x'][cos0-sin0  0  0]*[y']=[sin0 cos0   0  0]*[z'][0     0     1  0]*[1][0     0     0  1]*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(a_rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){v_texture_coord=a_texture_coord;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=a_offsetZ;gl_Position=u_matrix*vec4(current,1.0);}",fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"a_offsetZ",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e)}},{key:"forceUpdate",value:function(){this.gl&&this.processCache(this.options,this.data)}},{key:"processCache",value:function(e,t){var n=this;this.cachedData=[];for(var r=e.icon,i=e.width,a=e.height,o=e.offsetZ,s=e.angle,l=0;l<t.length;l++){var u=this.normizedPoint(t[l].geometry.coordinates),c=this.getProperty("icon",r,t[l]),h=this.getProperty("width",i,t[l]),d=this.getProperty("height",a,t[l]),p=this.getProperty("angle",s,t[l]),f=this.getProperty("offsetZ",o,t[l]);u&&c&&(this.cachedData.push({point:u,icon:c,width:h,height:d,offsetZ:f,angle:p,index:l}),this.iconHash.get(c)||this.iconHash.set(c,c))}t=Zn(this.iconHash.entries()).filter(function(t){return"string"==typeof t[1]}).map(function(t){var r=Hn(t,2)[0];return new hu(function(e,t){n.url2canvas(r,function(t){n.iconHash.set(r,t),e()})})}),hu.all(t).then(function(t){n.buildSprite(e),n.webglLayer.render()})}},{key:"buildSprite",value:function(t){var e=t.padding,r=this.canvas,n=this.ctx,i=[],a=new xu,o=!0,s=!1,l=void 0;try{for(var u=kn(this.iconHash);!(o=(h=u.next()).done);o=!0){var c,h,d=Hn(h.value,2),p=d[1];"string"!=typeof p&&(c=p.width,h=p.height,i.push({w:c+e[0],h:h+e[0],width:c,height:h,key:d[0],icon:p}))}}catch(t){s=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(s)throw l}}for(s=ot(i),o=0;o<i.length;o++)l=i[o],a.get(l.key)||a.set(l.key,l);for(o=m(s.w),s=m(s.h),r.width=o||1,r.height=s||1,n.save(),r=0;r<i.length;r++)l=i[r],n.drawImage(l.icon,l.x+e[0],l.y+e[1],l.width,l.height);n.restore(),this.loadTexture(),this.buildVertex(t,a,o,s)}},{key:"buildVertex",value:function(t,e,r,n){t=t.enablePicked;for(var i=[],a=[],o=[],s=[],l=0;l<this.cachedData.length;l++){var u=this.cachedData[l],c=u.point,h=u.width,d=u.height,p=u.offsetZ,f=u.angle,m=u.index;if(u=e.get(u.icon)){for(var h=h||u.icon.width,d=d||u.icon.height,c=(v=Hn(c,3))[0],g=v[1],v=v[2],y=0;y<4;y++)i.push(c,g,v),i.push(y),i.push(h,d),i.push(p),i.push(f*Math.PI/180);h=u.x/r,d=(u.x+u.w)/r,p=(u.y+u.h)/n,u=u.y/n,a.push(h,p,h,u,d,u,d,p),u=4*l,o.push(u,u+2,u+1,u,u+3,u+2),t&&(m=this.indexToRgb(m),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255),s.push(m[0]/255,m[1]/255,m[2]/255))}}this.index=o,this.vertexBuffer.updateData(new Float32Array(i)),this.uvBuffer.updateData(new Float32Array(a)),this.indexBuffer.updateData(new Uint32Array(o)),t&&this.pickBuffer.updateData(new Float32Array(s))}},{key:"render",value:function(t){var e,r,n,i;this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.setGLState({blend:!0,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset}),i.setUniforms(Xe(this.getCommonUniforms(t),{u_icon:this.texture,u_matrix:r,u_unit_px:"px"===n.unit,u_zoom_units:this.map.getZoomUnits(),u_scale:n.scale})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"url2canvas",value:function(t,n){var i;"object"===(void 0===t?"undefined":xn(t))?n(t):((i=new Image).crossOrigin="anonymous",i.onload=function(){var t=i.width,e=i.height,r=document.createElement("canvas");r.width=t,r.height=e,r.getContext("2d").drawImage(i,0,0,t,e),n(r)},i.onerror=function(){var t=document.createElement("canvas");t.width=20,t.height=40;var e=t.getContext("2d");e.fillStyle="red",e.beginPath(),e.lineTo(0,0),e.lineTo(20,0),e.lineTo(10,40),e.closePath(),e.fill(),n(t)},i.src=t)}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t}):this.texture=null}}]),r}(),Ll=function(){function r(t){he(this,r);var e=bn(this,(r.__proto__||Qe(r)).call(this,t));return t=e.getOptions(),e.shapeLayer=new Xs({enablePicked:t.enablePicked}),e.lineLayer=new yl,e.children=[e.shapeLayer,e.lineLayer],e}return In(r,Zs),ar(r,[{key:"pick",value:function(t,e){return this.shapeLayer.pick(t,e)}},{key:"onOptionsChanged",value:function(e){this.shapeLayer.setOptions({onClick:function(t){e.onClick&&e.onClick(t)},selectedIndex:e.selectedIndex,selectedColor:e.selectedColor,height:0,polygonOffset:[2,2],autoSelect:e.autoSelect,color:e.fillColor,opacity:e.fillOpacity,topColor:e.fillColor,useLight:!1}),this.lineLayer.setOptions({dashArray:e.dashArray,color:e.lineColor,width:e.lineWidth,lineJoin:e.lineJoin})}},{key:"onDataChanged",value:function(t){this.shapeLayer.setData(t),this.lineLayer.setData(t,{closePath:!0})}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,dashArray:[0,0],lineColor:"rgba(250, 250, 25, 1)",lineWidth:2,lineJoin:"miter",fillColor:"rgba(25, 25, 250, 1)",fillOpacity:1}}}]),r}(),Du=0,Ou=null,Fu=(fc=fc||{}).Scene=function(t,e){this.name=void 0!==e.name?e.name:null,this.nodes=Array(e.nodes.length);for(var r=0,n=e.nodes.length;r<n;r++)this.nodes[r]=t.nodes[e.nodes[r]];this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.boundingBox=null},Bu=fc.BoundingBox=function(t,e,r){t=t||Qo.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e=e||Qo.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),void 0===r||!0===r?(this.min=Qo.clone(t),this.max=Qo.clone(e)):(this.min=t,this.max=e),this.transform=rs.create()};Bu.prototype.updateBoundingBox=function(t){Qo.min(this.min,this.min,t.min),Qo.max(this.max,this.max,t.max)},Bu.prototype.calculateTransform=function(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]},Bu.getAABBFromOBB=function(){var n=Qo.create(),i=Qo.create(),a=Qo.create(),o=Qo.create(),s=Qo.create();return function(t,e){Qo.set(n,e[0],e[1],e[2]),Qo.set(i,e[4],e[5],e[6]),Qo.set(a,e[8],e[9],e[10]),e=Qo.fromValues(e[12],e[13],e[14]);var r=Qo.clone(e);return Qo.scale(o,n,t.min[0]),Qo.scale(s,n,t.max[0]),Qo.min(n,o,s),Qo.add(e,e,n),Qo.max(n,o,s),Qo.add(r,r,n),Qo.scale(o,i,t.min[1]),Qo.scale(s,i,t.max[1]),Qo.min(i,o,s),Qo.add(e,e,i),Qo.max(i,o,s),Qo.add(r,r,i),Qo.scale(o,a,t.min[2]),Qo.scale(s,a,t.max[2]),Qo.min(a,o,s),Qo.add(e,e,a),Qo.max(a,o,s),Qo.add(r,r,a),(t=new Bu(e,r,!1)).calculateTransform(),t}}();var Nu=fc.Accessor=function(t,e){this.bufferView=e,this.componentType=t.componentType,this.byteOffset=void 0!==t.byteOffset?t.byteOffset:0,this.byteStride=e.byteStride,this.normalized=void 0!==t.normalized&&t.normalized,this.count=t.count,this.type=t.type,this.size=sc[this.type],this.min=t.min,this.max=t.max,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null};Nu.prototype.prepareVertexAttrib=function(t,e){e.vertexAttribPointer(t,this.size,this.componentType,this.normalized,this.byteStride,this.byteOffset),e.enableVertexAttribArray(t)};var zu=fc.BufferView=function(t,e){this.byteLength=t.byteLength,this.byteOffset=void 0!==t.byteOffset?t.byteOffset:0,this.byteStride=void 0!==t.byteStride?t.byteStride:0,this.target=void 0!==t.target?t.target:null,this.data=e.slice(this.byteOffset,this.byteOffset+this.byteLength),this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.buffer=null};zu.prototype.createBuffer=function(t){this.buffer=t.createBuffer()},zu.prototype.bindData=function(t){return!!this.target&&(t.bindBuffer(this.target,this.buffer),t.bufferData(this.target,this.data,t.STATIC_DRAW),t.bindBuffer(this.target,null),!0)};var Uu=fc.Camera=function(t){this.name=void 0!==t.name?t.name:null,this.type=t.type,this.othographic=void 0===t.othographic?null:t.othographic,this.perspective=void 0===t.perspective?null:{yfov:t.perspective.yfov,znear:t.perspective.znear,zfar:void 0!==t.perspective.zfar?t.perspective.zfar:null,aspectRatio:void 0!==t.perspective.aspectRatio?t.perspective.aspectRatio:null},this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},ku=fc.Node=function(t,e){if(this.name=void 0!==t.name?t.name:null,this.nodeID=e,this.camera=void 0!==t.camera?t.camera:null,this.matrix=rs.create(),t.hasOwnProperty("matrix")){for(e=0;e<16;++e)this.matrix[e]=t.matrix[e];this.translation=Qo.create(),rs.getTranslation(this.translation,this.matrix),this.rotation=es.create(),rs.getRotation(this.rotation,this.matrix),this.scale=Qo.create(),rs.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(t.translation,t.rotation,t.scale);this.children=t.children||[],this.mesh=void 0!==t.mesh?Ou.glTF.meshes[t.mesh]:null,this.skin=void 0!==t.skin?t.skin:null,void 0!==t.extensions&&void 0!==t.extensions.gl_avatar&&!0===Ou.enableGLAvatar&&(this.skin=new Qu(Ou.glTF,Ou.skeletonGltf.skins[Ou.skeletonGltf.json.extensions.gl_avatar.skins[t.extensions.gl_avatar.skin.name]],t.extensions.gl_avatar.skin.inverseBindMatrices)),this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.aabb=null,this.bvh=new Bu};ku.prototype.traverse=function(t,e){e(this,t),t=0;for(var r=this.children.length;t<r;t++)this.children[t].traverse(this,e)},ku.prototype.traversePostOrder=function(t,e){for(var r=0,n=this.children.length;r<n;r++)this.children[r].traversePostOrder(this,e);e(this,t)},ku.prototype.traverseTwoExecFun=function(t,e,r){e(this,t);for(var n=0,i=this.children.length;n<i;n++)this.children[n].traverseTwoExecFun(this,e,r);r(this,t)};var Hu=rs.create();ku.prototype.getTransformMatrixFromTRS=function(t,e,r){this.translation=void 0!==t?Qo.fromValues(t[0],t[1],t[2]):Qo.fromValues(0,0,0),this.rotation=void 0!==e?Ko.fromValues(e[0],e[1],e[2],e[3]):Ko.fromValues(0,0,0,1),this.scale=void 0!==r?Qo.fromValues(r[0],r[1],r[2]):Qo.fromValues(1,1,1),this.updateMatrixFromTRS()},ku.prototype.updateMatrixFromTRS=function(){rs.fromRotationTranslation(Hu,this.rotation,this.translation),rs.scale(this.matrix,Hu,this.scale)};var Gu=fc.Mesh=function(t,e){this.meshID=e,this.name=void 0!==t.name?t.name:null,this.primitives=[],this.boundingBox=null,e=0;for(var r=t.primitives.length;e<r;++e){var n=t.primitives[e],n=new Vu(Ou.glTF,n);this.primitives.push(n),n.boundingBox&&(this.boundingBox||(this.boundingBox=new Bu),this.boundingBox.updateBoundingBox(n.boundingBox))}this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},Vu=fc.Primitive=function(t,e){if(this.attributes=e.attributes,this.indices=void 0!==e.indices?e.indices:null,void 0!==e.extensions&&void 0!==e.extensions.gl_avatar&&!0===Ou.enableGLAvatar&&e.extensions.gl_avatar.attributes)for(var r in e.extensions.gl_avatar.attributes)this.attributes[r]=e.extensions.gl_avatar.attributes[r];for(r in null!==this.indices?(this.indicesComponentType=t.json.accessors[this.indices].componentType,this.indicesLength=t.json.accessors[this.indices].count,this.indicesOffset=t.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=t.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=t.json.accessors[this.attributes.POSITION].byteOffset||0),this.attributes)this.attributes[r]=t.accessors[this.attributes[r]];this.material=void 0!==e.material?t.materials[e.material]:null,this.mode=void 0!==e.mode?e.mode:4,this.targets=e.targets,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.boundingBox=this.shader=this.indexBuffer=this.vertexBuffer=this.vertexArray=null,void 0===this.attributes.POSITION||(t=this.attributes.POSITION).max&&"VEC3"===t.type&&(this.boundingBox=new Bu(Qo.fromValues(t.min[0],t.min[1],t.min[2]),Qo.fromValues(t.max[0],t.max[1],t.max[2]),!1),this.boundingBox.calculateTransform())},Wu=fc.Texture=function(t){this.name=void 0!==t.name?t.name:null,this.sampler=void 0!==t.sampler?Ou.glTF.samplers[t.sampler]:null,this.source=void 0!==t.source?Ou.glTF.images[t.source]:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.texture=null};Wu.prototype.createTexture=function(t){this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.source),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)};var ju=fc.Sampler=function(t){this.name=void 0!==t.name?t.name:null,this.magFilter=void 0!==t.magFilter?t.magFilter:null,this.minFilter=void 0!==t.minFilter?t.minFilter:null,this.wrapS=void 0!==t.wrapS?t.wrapS:10497,this.wrapT=void 0!==t.wrapT?t.wrapT:10497,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.sampler=null};ju.prototype.createSampler=function(t){this.sampler=t.createSampler(),this.minFilter?t.samplerParameteri(this.sampler,t.TEXTURE_MIN_FILTER,this.minFilter):t.samplerParameteri(this.sampler,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_LINEAR),this.magFilter?t.samplerParameteri(this.sampler,t.TEXTURE_MAG_FILTER,this.magFilter):t.samplerParameteri(this.sampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.sampler,t.TEXTURE_WRAP_S,this.wrapS),t.samplerParameteri(this.sampler,t.TEXTURE_WRAP_T,this.wrapT)};var Xu=fc.TextureInfo=function(t){this.index=t.index,this.texCoord=void 0!==t.texCoord?t.texCoord:0,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},qu=fc.PbrMetallicRoughness=function(t){this.baseColorFactor=void 0!==t.baseColorFactor?t.baseColorFactor:[1,1,1,1],this.baseColorTexture=void 0!==t.baseColorTexture?new Xu(t.baseColorTexture):null,this.metallicFactor=void 0!==t.metallicFactor?t.metallicFactor:1,this.roughnessFactor=void 0!==t.roughnessFactor?t.roughnessFactor:1,this.metallicRoughnessTexture=void 0!==t.metallicRoughnessTexture?new Xu(t.metallicRoughnessTexture):null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},Yu=fc.NormalTextureInfo=function(t){this.index=t.index,this.texCoord=void 0!==t.texCoord?t.texCoord:0,this.scale=void 0!==t.scale?t.scale:1,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},Zu=fc.OcclusionTextureInfo=function(t){this.index=t.index,this.texCoord=void 0!==t.texCoord?t.texCoord:0,this.strength=void 0!==t.strength?t.strength:1,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},Ju=fc.Material=function(t){this.name=void 0!==t.name?t.name:null,this.pbrMetallicRoughness=void 0!==t.pbrMetallicRoughness?new qu(t.pbrMetallicRoughness):new qu({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=void 0!==t.normalTexture?new Yu(t.normalTexture):null,this.occlusionTexture=void 0!==t.occlusionTexture?new Zu(t.occlusionTexture):null,this.emissiveTexture=void 0!==t.emissiveTexture?new Xu(t.emissiveTexture):null,this.emissiveFactor=void 0!==t.emissiveFactor?t.emissiveFactor:[0,0,0],this.alphaMode=void 0!==t.alphaMode?t.alphaMode:"OPAQUE",this.alphaCutoff=void 0!==t.alphaCutoff?t.alphaCutoff:.5,this.doubleSided=t.doubleSided||!1,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},Ku=fc.Skin=function(t,e,r){var n;for(this.name=void 0!==e.name?e.name:null,this.skinID=r,this.joints=Array(e.joints.length),r=0,n=this.joints.length;r<n;r++)this.joints[r]=t.nodes[e.joints[r]];if(this.skeleton=void 0!==e.skeleton?t.nodes[e.skeleton]:null,this.inverseBindMatrices=void 0!==e.inverseBindMatrices?t.accessors[e.inverseBindMatrices]:null,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.uniformBlockID=Du++,this.inverseBindMatrices)for(this.inverseBindMatricesData=Xt(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),r=0,n=this.inverseBindMatricesData.length;r<n;r+=16)this.inverseBindMatrix.push(rs.fromValues(this.inverseBindMatricesData[r],this.inverseBindMatricesData[r+1],this.inverseBindMatricesData[r+2],this.inverseBindMatricesData[r+3],this.inverseBindMatricesData[r+4],this.inverseBindMatricesData[r+5],this.inverseBindMatricesData[r+6],this.inverseBindMatricesData[r+7],this.inverseBindMatricesData[r+8],this.inverseBindMatricesData[r+9],this.inverseBindMatricesData[r+10],this.inverseBindMatricesData[r+11],this.inverseBindMatricesData[r+12],this.inverseBindMatricesData[r+13],this.inverseBindMatricesData[r+14],this.inverseBindMatricesData[r+15]))},Qu=fc.SkinLink=function(t,e,r){if(this.isLink=!0,t.skins||(t.skins=[]),t.skins.push(this),this.name=e.name,this.skinID=t.skins.length-1,this.joints=e.joints,this.skeleton=e.skeleton,this.inverseBindMatrices=void 0!==r?t.accessors[r]:null,this.uniformBlockID=Du++,this.inverseBindMatrices)for(this.inverseBindMatricesData=Xt(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),t=0,e=this.inverseBindMatricesData.length;t<e;t+=16)this.inverseBindMatrix.push(rs.fromValues(this.inverseBindMatricesData[t],this.inverseBindMatricesData[t+1],this.inverseBindMatricesData[t+2],this.inverseBindMatricesData[t+3],this.inverseBindMatricesData[t+4],this.inverseBindMatricesData[t+5],this.inverseBindMatricesData[t+6],this.inverseBindMatricesData[t+7],this.inverseBindMatricesData[t+8],this.inverseBindMatricesData[t+9],this.inverseBindMatricesData[t+10],this.inverseBindMatricesData[t+11],this.inverseBindMatricesData[t+12],this.inverseBindMatricesData[t+13],this.inverseBindMatricesData[t+14],this.inverseBindMatricesData[t+15]))},$u=fc.Target=function(t){this.nodeID=void 0!==t.node?t.node:null,this.path=t.path,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},tc=fc.Channel=function(t,e){this.sampler=e.samplers[t.sampler],this.target=new $u(t.target),this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},ec=fc.AnimationSampler=function(t,e){this.input=t.accessors[e.input],this.output=t.accessors[e.output],this.inputTypedArray=Xt(this.input),this.outputTypedArray=Xt(this.output),this.interpolation=void 0!==e.interpolation?e.interpolation:"LINEAR",this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.curIdx=0,this.curValue=Ko.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]},rc=Ko.create(),nc=Ko.create();ec.prototype.getValue=function(t){t>this.endT&&(t-=this.inputMax*Math.ceil((t-this.endT)/this.inputMax),this.curIdx=0);for(var e=this.inputTypedArray.length;this.curIdx<=e-2&&t>=this.inputTypedArray[this.curIdx+1];)this.curIdx++;this.curIdx>=e-1&&(t-=this.inputMax,this.curIdx=0);var r=4===(e=sc[this.output.type])?es.slerp:Ko.lerp,n=this.curIdx,i=n*e,a=i+e;for(t=Math.max(0,t-this.inputTypedArray[n])/(this.inputTypedArray[n+1]-this.inputTypedArray[n]),n=0;n<e;n++)rc[n]=this.outputTypedArray[i+n],nc[n]=this.outputTypedArray[a+n];"LINEAR"===this.interpolation&&r(this.curValue,rc,nc,t)};var ic=fc.Animation=function(t,e){this.name=void 0!==e.name?e.name:null,this.samplers=[];for(var r=0,n=e.samplers.length;r<n;r++)this.samplers[r]=new ec(t,e.samplers[r]);for(this.channels=[],r=0,n=e.channels.length;r<n;r++)this.channels[r]=new tc(e.channels[r],this);this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null},ac=fc.glTFModel=function(t){this.json=t,this.defaultScene=void 0!==t.scene?t.scene:0,this.version=Number(t.asset.version),t.accessors&&(this.accessors=Array(t.accessors.length)),t.bufferViews&&(this.bufferViews=Array(t.bufferViews.length)),t.scenes&&(this.scenes=Array(t.scenes.length)),t.nodes&&(this.nodes=Array(t.nodes.length)),t.meshes&&(this.meshes=Array(t.meshes.length)),t.materials&&(this.materials=Array(t.materials.length)),t.textures&&(this.textures=Array(t.textures.length)),t.samplers&&(this.samplers=Array(t.samplers.length)),t.images&&(this.images=Array(t.images.length)),t.skins&&(this.skins=Array(t.skins.length)),t.animations&&(this.animations=Array(t.animations.length)),t.cameras&&(this.cameras=Array(t.cameras.length)),this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null},oc=fc.glTFLoader=function(t){this._init(),this.glTF=null,this.enableGLAvatar=!1,this.linkSkeletonGltf=null};oc.prototype._init=function(){this._loadDone=!1,this._bufferLoaded=this._bufferRequested=0,this._buffers=[],this._bufferTasks={},this._finishedPendingTasks=this._pendingTasks=this._imageLoaded=this._imageRequested=this._shaderLoaded=this._shaderRequested=0,this.onload=null,Ou=this},oc.prototype._checkComplete=function(){this._bufferRequested==this._bufferLoaded&&this._imageRequested==this._imageLoaded&&(this._loadDone=!0),this._loadDone&&this._pendingTasks==this._finishedPendingTasks&&(this._postprocess(),this.onload(this.glTF))},oc.prototype.loadGLTF_GL_Avatar_Skin=function(t,e,r){this.enableGLAvatar=!0,this.skeletonGltf=e,this.loadGLTF(t,r)},oc.prototype.loadGLTF=function(t,e){var r,n;this._init(),this.onload=e||function(t){},this.baseUri=(n="",e=(r=t).lastIndexOf("/"),n=-1!==e?r.substring(0,e+1):n);var i,a,o=this;t=t,i=function(t){t=JSON.parse(t),o.glTF=new ac(t);var n,e,r=function(t){if(o._buffers[n]=t,o._bufferLoaded++,o._bufferTasks[n])for(var e=0,r=o._bufferTasks[n].length;e<r;++e)o._bufferTasks[n][e](t);o._checkComplete()};if(t.buffers)for(n in t.buffers){o._bufferRequested++;var i=t.buffers[n].uri;(function(t,e){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET",t,!0),r.onreadystatechange=function(){var t;4!=r.readyState||"200"!=r.status||(t=r.response)&&e&&e(t)},r.send(null)})(i=-1===i.indexOf("base64")?o.baseUri+i:i,r)}if(r=function(t,e){o._imageLoaded++,o.glTF.images[e]=t,o._checkComplete()},t.images)for(e in t.images)o._imageRequested++,function(t,e,r){var n=new Image;n.crossOrigin="Anonymous",n.src=t,n.onload=function(){r(n,e)}}(o.baseUri+t.images[e].uri,e,r);o._checkComplete()},(a=new XMLHttpRequest).overrideMimeType("application/json"),a.open("GET",t,!0),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&i(a.responseText,this)},a.send(null)},oc.prototype._postprocess=function(){function t(t,e){var r=l[t.nodeID];null!==e?rs.mul(r,l[e.nodeID],t.matrix):rs.copy(r,t.matrix)}function e(t,e){var r=l[t.nodeID];e=null!==e?e.bvh:u.boundingBox,!t.mesh||(n=t.mesh).boundingBox&&(t.aabb=Bu.getAABBFromOBB(n.boundingBox,r),0===t.children.length&&(Qo.copy(t.bvh.min,t.aabb.min),Qo.copy(t.bvh.max,t.aabb.max))),Qo.min(e.min,e.min,t.bvh.min),Qo.max(e.max,e.max,t.bvh.max)}var n;if((Ou=this).glTF.cameras)for(var r=0,i=this.glTF.cameras.length;r<i;r++)this.glTF.cameras[r]=new Uu(this.glTF.json.cameras[r]);if(this.glTF.bufferViews)for(r=0,i=this.glTF.bufferViews.length;r<i;r++)this.glTF.bufferViews[r]=new zu(this.glTF.json.bufferViews[r],this._buffers[this.glTF.json.bufferViews[r].buffer]);if(this.glTF.accessors)for(r=0,i=this.glTF.accessors.length;r<i;r++)this.glTF.accessors[r]=new Nu(this.glTF.json.accessors[r],this.glTF.bufferViews[this.glTF.json.accessors[r].bufferView]);if(this.glTF.materials)for(r=0,i=this.glTF.materials.length;r<i;r++)this.glTF.materials[r]=new Ju(this.glTF.json.materials[r]);if(this.glTF.samplers)for(r=0,i=this.glTF.samplers.length;r<i;r++)this.glTF.samplers[r]=new ju(this.glTF.json.samplers[r]);if(this.glTF.textures)for(r=0,i=this.glTF.textures.length;r<i;r++)this.glTF.textures[r]=new Wu(this.glTF.json.textures[r]);for(r=0,i=this.glTF.meshes.length;r<i;r++)this.glTF.meshes[r]=new Gu(this.glTF.json.meshes[r],r);for(r=0,i=this.glTF.nodes.length;r<i;r++)this.glTF.nodes[r]=new ku(this.glTF.json.nodes[r],r);for(r=0,i=this.glTF.nodes.length;r<i;r++)for(var a=this.glTF.nodes[r],o=0,s=a.children.length;o<s;o++)a.children[o]=this.glTF.nodes[a.children[o]];var l=Array(this.glTF.nodes.length),r=0;for(i=l.length;r<i;r++)l[r]=rs.create();for(r=0,i=this.glTF.scenes.length;r<i;r++){var u=this.glTF.scenes[r]=new Fu(this.glTF,this.glTF.json.scenes[r]);for(u.boundingBox=new Bu,o=0,s=u.nodes.length;o<s;o++)(a=u.nodes[o]).traverseTwoExecFun(null,t,e);u.boundingBox.calculateTransform()}for(o=0,s=this.glTF.nodes.length;o<s;o++)null!==(a=this.glTF.nodes[o]).bvh&&a.bvh.calculateTransform();if(this.glTF.animations)for(r=0,i=this.glTF.animations.length;r<i;r++)this.glTF.animations[r]=new ic(this.glTF,this.glTF.json.animations[r]);if(this.glTF.json.skins)for(r=0,i=this.glTF.skins.length;r<i;r++)for(this.glTF.skins[r]=new Ku(this.glTF,this.glTF.json.skins[r],r),o=0,s=(a=this.glTF.skins[r].joints).length;o<s;o++)a[o].jointID=o;for(r=0,i=this.glTF.nodes.length;r<i;r++)null!==(a=this.glTF.nodes[r]).skin&&"number"==typeof a.skin&&(a.skin=this.glTF.skins[a.skin])};var sc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},lc=function(){function r(t,e){return he(this,r),bn(this,(r.__proto__||Qe(r)).call(this,t,e))}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{scale:1}}},{key:"initialize",value:function(t){var e=this;this.gl=t;var r=this.getOptions();this.gltfObj=qt({gl:t,options:r}),(new oc).loadGLTF(r.url,function(t){e.gltfObj.setupScene(t),e.webglLayer.render()})}},{key:"onChanged",value:function(t,e){}},{key:"render",value:function(t){var e=t.gl;t=t.matrix;var r=this.getData(),n=(o=this.getOptions()).scale,i=[n,n,n];for("px"===o.unit&&this.map&&(i=[n*(i=this.map.getZoomUnits()),n*i,n*i]),n=0;n<r.length;n++){var a=r[n].geometry.coordinates,o=rs.create(),s=rs.create(),a=this.normizedPoint(a);rs.identity(o),rs.translate(o,o,[a[0],a[1],a[2]]),rs.rotateX(o,o,Math.PI/2),rs.rotateY(o,o,(r[n].angle||0)*Math.PI/180),rs.scale(o,o,i),rs.mul(s,t,o),this.gltfObj.render({gl:e,matrix:s})}}}]),r}(),uc=uc||{};!function(){function i(t,e,r){return r=t.createShader(r),t.shaderSource(r,e),t.compileShader(r),r}uc.getShaderSource=function(t){return document.getElementById(t).textContent.replace(/^\s+|\s+$/g,"")},uc.createProgram=function(t,e,r){var n=t.createProgram();return e=i(t,e,t.VERTEX_SHADER),r=i(t,r,t.FRAGMENT_SHADER),t.attachShader(n,e),t.deleteShader(e),t.attachShader(n,r),t.deleteShader(r),t.linkProgram(n),t.getProgramInfoLog(n),t.getShaderInfoLog(e),t.getShaderInfoLog(r),n};var o=uc.loadImage=function(t,e){var r=new Image;return r.crossOrigin="Anonymous",r.src=t,r.onload=e,r};uc.loadImages=function(t,e){function r(){--i<=0&&e(n)}for(var n=[],i=t.length,a=0;a<i;++a)n.push(o(t[a],r))}}(),Ml=function(){function n(t){he(this,n);var e=bn(this,(n.__proto__||Qe(n)).call(this,t));return t=e.getOptions(),e.gltfLayer=new lc({url:t.url,scale:t.scale}),e.children=[e.gltfLayer],e.autoUpdate=!0,e.index=[],e.newData=[],e.isStarted=!1!==t.autoPlay,e}return In(n,Zs),ar(n,[{key:"getDefaultOptions",value:function(){return{url:"https://mapv-website.bj.bcebos.com/gl/examples/model/car.gltf",scale:1,step:1,defaultAngle:90}}},{key:"onOptionsChanged",value:function(t){this.gltfLayer.setOptions({})}},{key:"onDataChanged",value:function(t){var e=this;this.index=[],this.newData=[];for(var r=0;r<t.length;r++){this.index.push(0);var n=t[r].geometry.coordinates;"LineString"===t[r].geometry.type?this.newData.push(this._addPath(n)):n.forEach(function(t){e.newData.push(e._addPath(t))})}this.updatePoints()}},{key:"lnglatToMercator",value:function(t,e){return e=e*Math.PI/180,e=3189068.5*Math.log((1+Math.sin(e))/(1-Math.sin(e))),[parseFloat((t*Math.PI/180*6378137).toFixed(2)),parseFloat(e.toFixed(2))]}},{key:"getDeg",value:function(t,e){-180<t[0]&&t[0]<180&&(t=this.lnglatToMercator(t[0],t[1]),e=this.lnglatToMercator(e[0],e[1]));var r=180*Math.atan((e[1]-t[1])/(e[0]-t[0]))/Math.PI;return e[0]>t[0]&&(r-=180),r}},{key:"getPoint",value:function(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r,t[2]&&e[2]?t[2]+(e[2]-t[2])*r:0]}},{key:"updatePoints",value:function(){for(var t=this.getOptions(),e=this.newData,r=[],n=0;n<e.length;n++){for(var i=e[n],a=Math.floor(this.index[n]),o=a+1;i[o]&&i[o][0]===i[a][0]&&i[o][1]===i[a][1];)o++;o>=i.length-1&&(o=--a),o=this.getDeg(i[a],i[o]),r.push({geometry:{type:"Point",coordinates:this.getPoint(i[a],i[a+1],this.index[n]%1)},angle:o-t.defaultAngle})}this.pointData=r,this.gltfLayer.setData(r,{autoRender:!1})}},{key:"getCurrentPoint",value:function(){return this.pointData}},{key:"getDistance",value:function(t,e){var r=t[1]*Math.PI/180,n=e[1]*Math.PI/180;return t=2*Math.asin(Math.sqrt(Math.pow(Math.sin((r-n)/2),2)+Math.cos(r)*Math.cos(n)*Math.pow(Math.sin((t[0]*Math.PI/180-e[0]*Math.PI/180)/2),2))),Math.round(6378137e4*t)/1e4}},{key:"_addPath",value:function(t){for(var e=t.length,r=0,n=[],i=[],a=1;a<e;a++){var o=this.getDistance(t[a-1],t[a]);n.push(o),r+=o}for(o=[0],a=1;a<e;a++){var s=(n[a-1]/r).toFixed(2);o[a]=o[a-1]+parseFloat(s,10),i=i.concat(this._getPath(t[a-1],t[a],1e3*s))}return this._pathPercents=o,i}},{key:"_getPath",value:function(t,e,r){if(0===r)return[t];for(var n=[],i=0;i<=r;i++)n.push([(e[0]-t[0])/r*i+t[0],(e[1]-t[1])/r*i+t[1],e[2]&&t[2]?(e[2]-t[2])/r*i+t[2]:0]);return n}},{key:"start",value:function(){this.isStarted=!0}},{key:"stop",value:function(){this.isStarted=!1}},{key:"render",value:function(t){if(Bs(n.prototype.__proto__||Qe(n.prototype),"render",this).call(this,t),t=this.getOptions(),this.isStarted)for(var e=this.newData,r=0;r<this.index.length;r++)this.index[r]+=t.step,this.index[r]>e[r].length-2&&(this.index[r]=0);this.updatePoints()}}]),n}(),Yl=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="BoardTextLayer",e=t.canvas=document.createElement("canvas"),(e=t.ctx=e.getContext("2d")).textAlign="start",e.textBaseline="top",t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,collides:!0,unit:"px",angle:0,translateX:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},maxHeightLine:20,lineBreak:"\n"}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uUnitPx;uniform float zoomUnits;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}",fragmentShader:"precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){vec4 textureColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));if(textureColor.a<=0.1&&uIsPickRender==false){discard;}gl_FragColor=textureColor;\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e)}},{key:"processCache",value:function(t,e){this.cachedData=[];for(var r=0;r<e.length;r++){var n=this.normizedPoint(e[r].geometry.coordinates),i=e[r].text;"properties"in e[r]&&"text"in e[r].properties&&(i=e[r].properties.text);var a=this.getProperty("angle",t.angle,e[r]),o=this.getProperty("color",t.color,e[r]),s=this.getProperty("maxHeightLine",t.maxHeightLine,e[r]);n&&void 0!==i&&this.cachedData.push({point:n,text:i,angle:a,color:o,maxHeightLine:s,index:r})}}},{key:"render",value:function(t){var e,r,n,i,a;this.cachedData&&this.cachedData.length&&this.map&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.throttleUpdate(t),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),a=this.map.getZoomUnits(),i.setUniforms(Xe(this.getCommonUniforms(t),{matrix:r,textureImage:this.texture,offset:n.offset,zoomUnits:a,zIndex:n.zIndex,uUnitPx:"px"===n.unit})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"throttleUpdate",value:function(t){this.updateText(t)}},{key:"updateText",value:function(t){var e=t.gl,r=t.matrix;t=(c=this.getOptions()).fontSize;var n=c.fontFamily,i=c.translateX,a=c.padding,o=c.margin,s=c.collides,l=c.enablePicked,u=c.shadow,c=c.lineBreak,h=e.canvas.width/window.devicePixelRatio,d=e.canvas.height/window.devicePixelRatio,p=this.canvas,f=this.ctx;f.save(),f.scale(window.devicePixelRatio,window.devicePixelRatio),f.textBaseline="top",f.font="normal bold 20px "+n;for(var m=new qs,e=[],g=0;g<this.cachedData.length;g++){var v=(A=this.cachedData[g]).point,y=A.text,x=A.angle,b=A.index,_=A.color,A=A.maxHeightLine,w=Hn(v,3),M=Ko.clone([w[0],w[1],w[2],1]);Ko.transformMat4(M,M,r),Ko.scale(M,M,1/M[3]);for(var w=(M[0]+1)/2*h,M=(1-M[1])/2*d,C=f.measureText(y),T=y.split(c),S=T.map(function(t){return f.measureText(t).width}),S=Math.max.apply(Math,Jn(S)),E=20,I=0;I<T.length-1;I++)E+=A;if(T=E,C=Math.min(C.width,S)+1,C+=2*a[0]+i,T+=2*a[1],E=C+o[0],S=(M-=(S=T+o[1])/2)+S,!((E=(w-=E/2)+E)<0||S<0||h<w||d<M)){if(s){if(w={minX:w,maxX:E,minY:M,maxY:S},m.collides(w))continue;m.insert(w)}e.push({w:C,h:T,point:v,text:y,color:_,angle:x,maxHeightLine:A,dataIndex:b})}}for(f.restore(),r=[],o=[],s=[],h=[],(d=(m=ot(e)).w)<=0&&(d=1),(m=m.h)<=0&&(m=1),p.width=d*window.devicePixelRatio,p.height=m*window.devicePixelRatio,f.save(),f.scale(window.devicePixelRatio,window.devicePixelRatio),f.textBaseline="top",f.font="normal bold 20px "+n,f.shadowColor=u&&u.color,f.shadowOffsetX=u&&u.offsetX,f.shadowOffsetY=u&&u.offsetY,f.shadowBlur=u&&u.blur,n=0,u=e.length;n<u;++n){for(p=e[n],f.fillStyle=p.color,function(t,e,r,n,i,a){if("string"==typeof e&&"number"==typeof r&&"number"==typeof n)for(e=e.split(a),a=0;a<e.length;a++)t.fillText(e[a],r,n),n+=i}(f,p.text,p.x+a[0]+i,p.y+a[1],p.maxHeightLine,c),g=(y=Hn(p.point,3))[0],v=y[1],y=y[2],x=0;x<4;x++)r.push(g,v,y),r.push(x),r.push(p.w,p.h),r.push(t/20,p.angle*Math.PI/180);g=p.x/d,v=(p.x+p.w)/d,y=(p.y+p.h)/m,x=p.y/m,o.push(g,y,g,x,v,x,v,y),g=4*n,s.push(g,g+2,g+1,g,g+3,g+2),l&&(p=this.indexToRgb(p.dataIndex),h.push(p[0]/255,p[1]/255,p[2]/255),h.push(p[0]/255,p[1]/255,p[2]/255),h.push(p[0]/255,p[1]/255,p[2]/255),h.push(p[0]/255,p[1]/255,p[2]/255))}f.restore(),this.loadTexture(),this.index=s,this.vertexBuffer.updateData(new Float32Array(r)),this.uvBuffer.updateData(new Float32Array(o)),this.indexBuffer.updateData(new Uint32Array(s)),l&&this.pickBuffer.updateData(new Float32Array(h))}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),r}(),Zt=function(){function r(t){he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t))).name="LabelLayer";var e=t.canvas=document.createElement("canvas");return t.ctx=e.getContext("2d"),t.arrowHeight=8,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,textColor:"#0f0",borderColor:"#f00",backgroundColor:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,lineHeight:20,textAlign:"left",collides:!1,offset:[0,0],padding:[2,2],polygonOffset:[0,0],borderRadius:5}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x;y+=size.y;}else if(corner==2.0){x+=size.x;y+=size.y;}else if(corner==3.0){x+=size.x;y+=-size.y;}else{x+=-size.x;y+=-size.y;}return vec3(x,y+size.y,coord.z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}",fragmentShader:"precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"position",buffer:this.vertexBuffer,size:3,stride:24,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:24,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:24,type:"FLOAT",offset:16},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e)}},{key:"processCache",value:function(t,e){for(this.cachedData=[],t=0;t<e.length;t++){var r=e[t],n=this.normizedPoint(r.geometry.coordinates);n&&this.cachedData.push({point:n,item:r,index:t})}}},{key:"render",value:function(t){var e,r,n,i,a;this.cachedData&&this.cachedData.length&&this.map&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.updateText(t),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),a=this.map.getZoomUnits(),i.setUniforms(Xe(this.getCommonUniforms(t),{matrix:r,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,offset:n.offset,zoomUnits:a,zIndex:n.zIndex})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"updateText",value:function(t){var o=this,e=t.gl,r=t.matrix,s=this.getOptions().enablePicked;t=this.canvas;var l=this.ctx,u=(r=ot(e=this.createMapbox(l,e,r))).w,c=r.h;u<=0&&(u=1),c<=0&&(c=1),t.width=u*window.devicePixelRatio,t.height=c*window.devicePixelRatio;var h=[],d=[],p=[],f=[];e.forEach(function(t,e){o.drawItem(l,t);for(var r=(i=Hn(t.point,3))[0],n=i[1],i=i[2],a=0;a<4;a++)h.push(r,n,i),h.push(a),h.push(t.w,t.h);r=t.x/u,n=(t.x+t.w)/u,i=(t.y+t.h)/c,a=t.y/c,d.push(r,i,r,a,n,a,n,i),e*=4,p.push(e,e+2,e+1,e,e+3,e+2),s&&(t=o.indexToRgb(t.dataIndex),f.push(t[0]/255,t[1]/255,t[2]/255),f.push(t[0]/255,t[1]/255,t[2]/255),f.push(t[0]/255,t[1]/255,t[2]/255),f.push(t[0]/255,t[1]/255,t[2]/255))}),this.loadTexture(),this.index=p,this.vertexBuffer.updateData(new Float32Array(h)),this.uvBuffer.updateData(new Float32Array(d)),this.indexBuffer.updateData(new Uint32Array(p)),s&&this.pickBuffer.updateData(new Float32Array(f))}},{key:"createMapbox",value:function(u,t,c){var h=this,e=this.getOptions(),d=e.padding,p=e.collides,f=e.fontSize,m=t.canvas.width/window.devicePixelRatio,g=t.canvas.height/window.devicePixelRatio,v=new qs,y=[];return this.cachedData.forEach(function(t){var e=t.point,r=t.item;t=t.index;var n=Hn(e,3),n=Ko.clone([n[0],n[1],n[2],1]);Ko.transformMat4(n,n,c),Ko.scale(n,n,1/n[3]);var i=(n[0]+1)/2*m,a=(1-n[1])/2*g;n=h.computeTextWH(r,u,d,f);var o=Hn(n,2),s=(i-=(n=o[0])/2)+n,l=(a-=(o=o[1])/2)+o;if(!(s<0||l<0||m<i||g<a)){if(p){if(i={minX:i,maxX:s,minY:a,maxY:l},v.collides(i))return;v.insert(i)}y.push({w:n,h:o+h.arrowHeight,point:e,item:r,dataIndex:t})}}),y}},{key:"computeTextWH",value:function(t,e){var r=(o=this.getOptions()).padding,n=o.fontSize,i=o.borderRadius,a=o.fontFamily,o=o.lineHeight;return e.save(),e.scale(window.devicePixelRatio,window.devicePixelRatio),e.font=n+"px "+a,n=(t=t.properties.text.split("\n")).reduce(function(t,e){return t.length<e.length?e:t},""),n=e.measureText(n),e.restore(),[n.width+2*(r[1]+i),2*(r[0]+i)+o*t.length]}},{key:"drawItem",value:function(r,t){var n=(c=this.getOptions()).padding,e=c.backgroundColor,i=c.textColor,a=c.fontSize,o=c.borderColor,s=c.borderRadius,l=c.fontFamily,u=c.lineHeight,c=c.textAlign,h=s-1,d=t.x,p=t.y,f=t.w,m=t.h;t=t.item;var g="";"object"===xn(t.properties)&&(g=t.properties.text||"",i=t.properties.textColor||i,o=t.properties.borderColor||o,e=t.properties.backgroundColor||e),t=g.split("\n"),m-=this.arrowHeight,r.save(),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.textBaseline="top",r.font=a+"px "+l,r.translate(d,p),r.fillStyle=e,r.strokeStyle=o,r.beginPath(),r.arc(s,s,h,Math.PI,1.5*Math.PI),r.lineTo(f-s,1),r.arc(f-s,s,h,1.5*Math.PI,0),r.lineTo(f-1,m-s),r.arc(f-s,m-s,h,0*Math.PI,.5*Math.PI),r.lineTo(s,m-1),r.arc(s,m-s,h,.5*Math.PI,+Math.PI),r.lineTo(1,s),r.closePath(),r.fill(),r.stroke(),r.beginPath(),l=f/2,h=(e=this.arrowHeight)/2,r.moveTo(l-h,m-1),r.lineTo(l+h,m-1),r.lineTo(l,m+.8*e),r.fillStyle=o,r.fill(),r.fillStyle=i;var v="center"===c?l:"right"===c?f-s-n[1]:s+n[1];r.textAlign=c,t.forEach(function(t,e){r.fillText(t,v,s+n[0]+(e+.5)*u-.5*a)}),r.restore()}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),r}(),Yt.prototype.parseColors=function(t){this.arrFeatureStyles=[[2,t[0]||"rgba(79,210,125,1)",2,2,0,[],0,0],[2,t[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,t[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,t[0]||"rgba(79,210,125,1)",5,2,0,[],0,0],[2,t[0]||"rgba(79,210,125,1)",6,2,0,[],0,0],[2,t[2]||"rgba(255,208,69,1)",2,2,0,[],0,0],[2,t[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,t[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,t[2]||"rgba(255,208,69,1)",5,2,0,[],0,0],[2,t[2]||"rgba(255,208,69,1)",6,2,0,[],0,0],[2,t[1]||"rgba(232,14,14,1)",2,2,0,[],0,0],[2,t[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,t[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,t[1]||"rgba(232,14,14,1)",5,2,0,[],0,0],[2,t[1]||"rgba(232,14,14,1)",6,2,0,[],0,0],[2,t[3]||"rgba(181,0,0,1)",2,2,0,[],0,0],[2,t[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,t[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,t[3]||"rgba(181,0,0,1)",5,2,0,[],0,0],[2,t[3]||"rgba(181,0,0,1)",6,2,0,[],0,0],[2,"rgba(255,255,255,1)",4,0,0,[],0,0],[2,"rgba(255,255,255,1)",5.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",7,0,0,[],0,0],[2,"rgba(255,255,255,1)",8.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",10,0,0,[],0,0]]},Yt.prototype.setColors=function(t){this.parseColors(t)},Yt.prototype.initialize=function(t){this._initialize||(this._initialize=!0)},Yt.prototype.clearCache=function(t){this.cache={}},Yt.prototype.setMap=function(t){t?(this.map=t,this._initialize?this.canvaslayer.show():this.initialize(t)):this.canvaslayer.hide()},Yt.prototype.draw=function(t){(t=t||{}).clearCache&&this.clearCache(),this.canvaslayer.draw()},Yt.prototype.clear=function(){},Yt.prototype.update=function(){var t=this.map,e=this.getDataZoom(),r=Math.pow(2,18-e),n=256*r,i=f.convertLL2MC(t.getCenter()),a=Math.ceil(i.lng/n),o=Math.ceil(i.lat/n),s=this.tileSize,l=e-Math.round(t.getZoom());for(0<l&&(s/=Math.pow(2,l)),n=[a,o,(i.lng-a*n)/n*s,(i.lat-o*n)/n*s],i=(a=t.getBounds()).getNorthEast(),a=a.getSouthWest(),t.getSize(),t.getSize(),t=(i.lng-a.lng)/r,r=(i.lat-a.lat)/r,i=n[1]-Math.ceil((r/2-n[3])/s),a=n[0]+Math.ceil((t/2+n[2])/s),o=n[1]+Math.ceil((r/2+n[3])/s),r=[],s=n[0]-Math.ceil((t/2-n[2])/s);s<a;s++)for(n=i;n<o;n++)r.push([s,n,e]);for(this.tilesOrder=r,this._loadCount={},s=0;s<r.length;s++)n=r[s][0],t=r[s][1],this._loadCount[n+"_"+t+"_"+r[s][2]]=!1;for(s=0;s<r.length;s++)n=r[s][0],t=r[s][1],this.showTile(n,t,e)},Yt.prototype.showTile=function(t,e,r){this._parseDataAndDraw(t,e,r)},Yt.prototype.drawCurrentData=function(){this.clear();for(var t=[],e=0;e<this.tilesOrder.length;e++){var r=this.tilesOrder[e][0],n=this.tilesOrder[e][1],i=this.tilesOrder[e][2],a=this.cache[this.getCacheKey(r,n,i)];if(a)for(r=this._drawFeatures(a,r,n,i),n=0;n<r.length;n++)t.push(r[n])}this.lineLayer.setData(t)},Yt.prototype.isAllLoaded=function(){var t,e=!0;for(t in this._loadCount)if(!this._loadCount[t]){e=!1;break}return e},Yt.prototype.getCacheKey=function(t,e,r){return t+"_"+e+"_"+r},Yt.prototype.getDataZoom=function(){var t=Math.round(this.map.getZoom());return t=19<t?19:t},Yt.prototype._parseDataAndDraw=function(n,i,a){var o=this,s=o.map,l=s.getCenter(),u=Math.round(s.getZoom()),c=this.getCacheKey(n,i,a),h="_cbk"+(1e5*Math.random()).toFixed(0),t=this.getTileUrl(n,i,a,"BMapGL."+h);BMapGL[h]=function(t){o._loadCount[n+"_"+i+"_"+a]=!0;var e=s.getCenter(),r=Math.round(s.getZoom());e.equals(l)&&r===u?(e=t.content&&t.content.tf,t.data&&(e=t.data),o.cache[c]=e?{traffic:e,precision:t.precision}:null,o.drawTogether&&o.isAllLoaded()&&o.drawCurrentData()):r!==u&&o.clear(),delete BMapGL[h]},void 0!==o.cache[c]?(o._loadCount[n+"_"+i+"_"+a]=!0,o.drawTogether&&o.isAllLoaded()&&o.drawCurrentData()):this.request(t)},Yt.prototype.getTileUrl=function(t,e,r,n){return"https://sp3.baidu.com/7_AZsjOpB1gCo2Kml5_Y_DAcsMJiwa/traffic/?qt=vtraffic&x="+t+"&y="+e+"&z="+r+"&fn="+n+"&t="+(new Date).getTime()},Yt.prototype._drawFeatures=function(t,e,r,n){var i=10;if(n=Math.pow(2,18-n),this.map.getCenter(),e=[e*(a=this.tileSize)*n,(r+1)*a*n],r=[],t&&t.traffic){i*=t.precision;for(var a=0,o=(t=t.traffic).length;a<o;a++){var s=(l=t[a])[1],l=this.arrFeatureStyles[l[3]],u=s[0]/i,c=-s[1]/i,h=[];h.push([e[0]+u*n,e[1]+c*n,1]);for(var d=2,p=s.length;d<p;d+=2)u+=s[d]/i,c-=s[d+1]/i,h.push([e[0]+u*n,e[1]+c*n,1]);r.push({color:l[1],geometry:{type:"LineString",coordinates:h}})}}return r},Yt.prototype.request=function(t,e){var r;e&&(r=(1e5*Math.random()).toFixed(0),BMapGL._rd["_cbk"+r]=function(t){e&&e(t),delete BMapGL._rd["_cbk"+r]},t+="&callback=BMapGL._rd._cbk"+r);var n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.src=t,n.addEventListener?n.addEventListener("load",function(t){(t=t.target).parentNode.removeChild(t)},!1):n.attachEvent&&n.attachEvent("onreadystatechange",function(t){!(t=window.event.srcElement)||"loaded"!==t.readyState&&"complete"!==t.readyState||t.parentNode.removeChild(t)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(n),n=null},1)},Yt.prototype.getRGBA=function(t){return"rgba("+((t>>>=0)>>24&255)+","+(t>>16&255)+","+(t>>8&255)+","+(255&t)/256+")"},Yt.prototype.getLineCap=function(t){return["butt","square","round"][t]},Yt.prototype.getLineJoin=function(t){return["miter","bevel","round"][t]};var We=function(){function r(t){he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t))).autoUpdate=!0,t.getOptions();var e=new Lu({color:"rgba(257, 254, 47, 0.9)",minZoom:18,duration:.8,interval:.2,trailLength:.4});return t.lineLayer=e,t.children=[e],t}return In(r,Zs),ar(r,[{key:"initialize",value:function(t){Bs(r.prototype.__proto__||Qe(r.prototype),"initialize",this).call(this,t),t=this.map.map;var e=new Yt({});e.lineLayer=this.lineLayer,(this.trafficTileManager=e).setMap(t),e.update(),t.addEventListener("moveend",function(){e.update()}),t.addEventListener("zoomend",function(){e.update()}),t.addEventListener("ondraw",function(){})}},{key:"onOptionsChanged",value:function(t){}},{key:"onDataChanged",value:function(t){}},{key:"getDefaultOptions",value:function(){return{}}}]),r}(),Xn=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="HeatmapLayer",t.bufferData=[],t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{size:13,unit:"px",height:0,max:100,min:0}}},{key:"initialize",value:function(t){var e=this;this.gl=t;var r,n,i,a,o,s=this.getOptions();this.inverseMatrix=rs.create(Float64Array),this.frameBuffer=new ds(t),this.webglLayer.map.onResize(function(){e.frameBuffer=new ds(t)}),this.circle=(a=new x(2*(i=(r=64)+(n=r/2)),2*i),(o=a.getContext("2d")).shadowBlur=n,o.shadowColor="black",o.shadowOffsetX=o.shadowOffsetY=1e4,o.beginPath(),o.arc(i-1e4,i-1e4,r,0,2*Math.PI,!0),o.closePath(),o.fill(),a),this.circleTexture=N(t,this.circle,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}),this.intensity=new b({gradient:s.gradient}),this.paletteTexture=N(t,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}),this.offlineProgram=new ss(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform mat4 pointToPixelMatrix;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform int unit;uniform float size;uniform float max;uniform float min;attribute vec3 aPos;attribute vec2 aOffset;attribute float aCount;varying vec2 vOffset;varying float vCount;varying vec3 vPosition;void main(){vOffset=aOffset;vCount=(aCount-min)/(max-min);if(unit==1){vec2 pos=(pointToPixelMatrix*vec4(aPos.xy,0.0,1.0)).xy+aOffset.xy*size/2.0;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pos,0.0,1.0);}else{vec2 pos=aPos.xy+aOffset.xy*size;gl_Position=u_matrix*vec4(pos,0.0,1.0);}vPosition=vec3(gl_Position.z/gl_Position.w);}",fragmentShader:"varying vec2 vOffset;varying float vCount;varying vec3 vPosition;uniform sampler2D uCircle;void main(){vec4 circle=texture2D(uCircle,(vOffset+1.0)/2.0);float intensity=circle.a*vCount;if(intensity<=0.0){discard;}gl_FragColor=vec4(vPosition,intensity);}"},this),this.offlineBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineIndexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineVertexArray=new hs({gl:t,program:this.offlineProgram,attributes:[{stride:24,name:"aPos",buffer:this.offlineBuffer,size:3,type:"FLOAT",offset:0},{stride:24,name:"aOffset",buffer:this.offlineBuffer,size:2,type:"FLOAT",offset:12},{stride:24,name:"aCount",buffer:this.offlineBuffer,size:1,type:"FLOAT",offset:20}]}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.program=new ss(this.gl,{vertexShader:"attribute vec2 aPos;varying vec2 vPos;uniform float uHeight;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform sampler2D u_sampler;uniform mat4 inverseMatrix;void main(){vPos=aPos;if(uHeight<=0.0){gl_Position=vec4(aPos,0.0,1.0);}else{vec4 gray=texture2D(u_sampler,(aPos+1.0)/2.0);vec4 m0=inverseMatrix*vec4(aPos.xy,0.0,1.0);vec4 m1=inverseMatrix*vec4(aPos.xy,1.0,1.0);m0/=m0.w;m1/=m1.w;vec4 pixel=m0+(-m0.z/(m1.z-m0.z))*(m1-m0);pixel.z=uHeight*gray.a;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pixel.xyz,1.0);}}",fragmentShader:"uniform sampler2D u_sampler;uniform sampler2D u_samplerPalette;uniform float uHeight;varying vec2 vPos;void main(){vec4 gray=texture2D(u_sampler,(vPos+1.0)/2.0);float grayAlpha=gray.a;if(grayAlpha<=0.0){discard;}vec4 color=texture2D(u_samplerPalette,vec2(grayAlpha,1.0));gl_FragColor=vec4(color.rgb,grayAlpha*color.a);}"},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new hs({gl:t,program:this.program,attributes:[{stride:8,name:"aPos",buffer:this.buffer,size:2,type:"FLOAT",offset:0}]});for(var s=[],l=[],u=Math.floor(t.canvas.width/4),c=Math.floor(t.canvas.height/4),h=u+1,d=0;d<=c;d++)for(var p,f,m=0;m<=u;m++)s.push(2*m/u-1,2*d/c-1),m<u&&d<c&&(p=h*d+m,f=h*(d+1)+m,l.push(p,p+1,f+1),l.push(p,f+1,f));this.bufferData=s,this.buffer.updateData(new Float32Array(s)),this.indexData=l,this.indexBuffer.updateData(new Uint32Array(l))}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onOptionsChanged",value:function(t,e){var r=this.gl;r&&t.gradient!==e.gradient&&(this.intensity=new b({gradient:t.gradient}),this.paletteTexture=N(r,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}))}},{key:"onDataChanged",value:function(t){if(this.gl){var e=[],r=[];this.getOptions();for(var n=0;n<t.length;n++){var i=t[n],a=this.normizedPoint(t[n].geometry.coordinates),o=void 0===i.count?1:i.count;"properties"in i&&"count"in i.properties&&(o=i.properties.count),e.push(a[0],a[1],a[2]),e.push(-1,-1),e.push(o),e.push(a[0],a[1],a[2]),e.push(-1,1),e.push(o),e.push(a[0],a[1],a[2]),e.push(1,1),e.push(o),e.push(a[0],a[1],a[2]),e.push(1,-1),e.push(o),i=4*n,r.push(i+0,i+2,i+1),r.push(i+0,i+3,i+2)}this.offlineBufferData=e,this.offlineIndexData=r,this.offlineBuffer.updateData(new Float32Array(e)),this.offlineIndexBuffer.updateData(new Uint32Array(r))}}},{key:"render",value:function(t){var e,r=t.gl,n=t.matrix,i=t.pointToPixelMatrix,a=t.pixelToViewMatrix;t=t.projectionMatrix,!this.offlineBufferData||this.offlineBufferData.length<=0||(e=this.getOptions(),this.setGLState({blend:!0,blendFunc:[r.ONE,r.ONE],depthTest:!1}),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer.framebuffer),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),this.offlineProgram.use(r),this.offlineProgram.setUniforms({u_matrix:n,uCircle:this.circleTexture,pointToPixelMatrix:i,pixelToViewMatrix:a,projectionMatrix:t,unit:"px"===e.unit?1:0,size:e.size,max:e.max,min:e.min}),this.offlineVertexArray.bind(),this.offlineIndexBuffer.bind(),r.drawElements(r.TRIANGLES,this.offlineIndexData.length,r.UNSIGNED_INT,0),r.bindFramebuffer(r.FRAMEBUFFER,null),this.program.use(r),this.vertexArray.bind(),n=this.inverseMatrix,rs.identity(n),rs.multiply(n,t,a),rs.invert(n,n),this.setGLState({blend:!1,depthTest:!0}),this.program.setUniforms({u_sampler:this.frameBuffer.framebuffer.texture,u_samplerPalette:this.paletteTexture,uHeight:e.height,pixelToViewMatrix:a,inverseMatrix:n,projectionMatrix:t}),this.indexBuffer.bind(),r.drawElements(r.TRIANGLES,this.indexData.length,r.UNSIGNED_INT,0))}}]),r}(),cc=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="BarLayer",t.selectedColor=[-1,-1,-1],t.textureCache={},t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:"rgba(0, 180, 0, 1.0)",edgeCount:4,unit:"m",height:1e5,type:"normal",size:5e4}}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions(),r=(r={normal:["attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float r=vSize/cos(b);if(aEdgeIndex<0.0){float index=aPointIndex;float angle=0.0;if(mod(index,2.0)==0.0){angle=a*(index/2.0)-b;}else{angle=-a*((index-1.0)/2.0)-b;}y=y+r*sin(angle);x=x+r*cos(angle);}else{float i=aEdgeIndex-1.0;float j=aPointIndex;float angle=a*i+b;y=y+r*sin(angle);x=x+r*cos(angle);}vPosition=vec4(aPos,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;if(aEdgeIndex==1.0&&aPointIndex==1.0){gl_PointSize=20.0;}else{gl_PointSize=10.0;}\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}","varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;if(vEdgeIndex<0.0){color.r+=0.2;color.g+=0.2;color.b+=0.2;}else{float i=ceil(vEdgeIndex);;float d=i/vEdgeCount*0.5;if(i<=vEdgeCount/2.0){d=0.2*(i/vEdgeCount*0.5)-0.1;}else{d=0.2*(vEdgeCount-i)/vEdgeCount*0.5-0.1;}color.r+=d;color.g+=d;color.b+=d;}gl_FragColor=color;}"],light:["attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float i=aEdgeIndex;float j=aPointIndex;float angle=a*(i-1.0)+b;float r=vSize/cos(b);y=y+r*sin(angle);x=x+r*cos(angle);if(j==1.0){z=0.0;}vPosition=vec4(aPos.xyz,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;\n#if defined(PICK)\nif(mapvIsPicked()){vColor=uSelectedColor;}\n#endif\n}","varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;color.a=1.0-vFragPosition.z/vPosition.z;gl_FragColor=color;}"]})[e.type]||r.normal;this.program=new ss(this.gl,{vertexShader:r[0],fragmentShader:r[1],defines:e.enablePicked?["PICK"]:[]},this),this.buffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aEdgeIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aPointIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:20},{stride:44,name:"aEdgeCount",buffer:this.buffer,size:1,type:"FLOAT",offset:24},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:28}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onChanged",value:function(t,e){this.gl&&e&&(this.uniforms={},this.data=e,this.options=t,this.processData(),t.enablePicked&&this.parsePickData(e))}},{key:"processData",value:function(){var t=[],e=[];"light"===this.options.type?this.createLightBuffer(this.data,t,e):this.createNormalBuffer(this.data,t,e),this.bufferData=t,this.indexData=e,this.buffer.updateData(new Float32Array(t)),this.indexBuffer.updateData(new Uint32Array(e))}},{key:"createNormalBuffer",value:function(t,d,p){var f=this,m=parseInt(this.options.edgeCount,10)||4;t.forEach(function(t,e){var i=t.color||f.options.color,a=t.size||f.options.size,o=Array.isArray(t.value)?t.value:"number"==typeof t.value?[t.value]:[1],s=f.normizedPoint(t.geometry.coordinates),l=t.height||f.options.height,u=o.reduce(function(t,e){return Number(t)+Number(e)}),c=0,h="blue";for(o.forEach(function(t,e){h=f.normizedColor("function"==typeof i?i(t,e,o):Array.isArray(i)?i[e]:i),t="function"==typeof l?l(t,e,o):Array.isArray(l)?l[e]:l/u*t;var r=p[p.length-1],n=d.length/11;for(0<n&&(1==m%2&&0===e?p.push(r,r,n):p.push(r,n)),e=1;e<=2*m;e++)0==e%2?d.push.apply(d,[s[0],s[1],c,a,e/2,2,m].concat(Jn(h))):d.push.apply(d,[s[0],s[1],c+t,a,(e+1)/2,1,m].concat(Jn(h))),p.push(n+e-1),e===2*m&&(d.push.apply(d,[s[0],s[1],c+t,a,e/2+1,1,m].concat(Jn(h))),d.push.apply(d,[s[0],s[1],c,a,e/2+1,2,m].concat(Jn(h))),p.push(n+e,n+e+1));c+=t}),e=p[p.length-1],0<(t=d.length/11)&&p.push(e,t),e=1;e<=m;e++)d.push.apply(d,[s[0],s[1],c,a,-1,e,m].concat(Jn(h))),p.push(t+e-1)})}},{key:"createLightBuffer",value:function(t,s,l){var u=this,c=parseInt(this.options.edgeCount,10)||4;t.forEach(function(t,e){e=t.color||u.options.color,e=u.normizedColor("function"==typeof e?e(t.value):"string"==typeof e?e:"blue");var r=t.size||u.options.size,n=u.normizedPoint(t.geometry.coordinates),i="function"==typeof(i=t.height||u.options.height)?i(t.value):i;for(t=1;t<=c;t++){var a=l[l.length-1],o=s.length/11;for(0<o&&l.push(a,o),a=1;a<=2*c;a++)0==a%2?s.push.apply(s,[n[0],n[1],i,r,a/2,1,c].concat(Jn(e))):s.push.apply(s,[n[0],n[1],i,r,(a+1)/2,2,c].concat(Jn(e))),l.push(o+a-1),a===2*c&&l.push(o,1+o)}})}},{key:"render",value:function(t){var e=this.program,r=t.gl,n=t.matrix;this.setGLState({cullFace:"normal"===this.options.type}),e.use(r),this.vertexArray.bind(),this.indexBuffer.bind();var i=this.map.getZoomUnits();Xe(this.uniforms,this.getCommonUniforms(t),{uZoomUnits:"px"===this.options.unit?i:1,uMatrix:n}),e.setUniforms(this.uniforms),r.drawElements(r.TRIANGLE_STRIP,this.indexData.length,r.UNSIGNED_INT,0)}}]),r}(),hc=function(){function r(t){he(this,r);var e=bn(this,(r.__proto__||Qe(r)).call(this,t));return t=e.getOptions(),e.fillPoint=new Cu({enablePicked:t.enablePicked,autoSelect:t.autoSelect}),e.shadowPoint=new Cu,e.textPoint=new Ys,e.children=[e.shadowPoint,e.fillPoint,e.textPoint],e}return In(r,Zs),ar(r,[{key:"pick",value:function(t,e){return this.fillPoint.pick(t,e)}},{key:"onOptionsChanged",value:function(e){this.shadowPoint.setOptions({depthTest:!1,polygonOffset:[1,1],color:e.shadowColor,size:e.shadowSize,borderWidth:e.shadowBorderWidth,borderColor:e.shadowBorderColor}),this.fillPoint.setOptions({onClick:function(t){e.onClick&&e.onClick(t)},selectedIndex:e.selectedIndex,selectedColor:e.selectedColor,depthTest:!1,color:e.fillColor,size:e.fillSize,borderWidth:e.fillBorderWidth,borderColor:e.fillBorderColor}),this.textPoint.setOptions({collides:!1,polygonOffset:[-1,-1],color:e.fontColor,fontFamily:e.fontFamily,fontSize:e.fontSize})}},{key:"onDataChanged",value:function(t){var e=this,r=this.getOptions(),n=JSON.parse(ri(t)).map(function(t){return t.properties.size=e.getProperty("shadowSize",r.shadowSize,t),t.properties.color=e.getProperty("shadowColor",r.shadowColor,t),t.properties.borderColor=e.getProperty("shadowBorderColor",r.shadowBorderColor,t),t.properties.borderWidth=e.getProperty("shadowBorderWidth",r.shadowBorderWidth,t),t}),i=JSON.parse(ri(t)).map(function(t){return t.properties.size=e.getProperty("fillSize",r.fillSize,t),t.properties.color=e.getProperty("fillColor",r.fillColor,t),t.properties.borderColor=e.getProperty("fillBorderColor",r.fillBorderColor,t),t.properties.borderWidth=e.getProperty("fillBorderWidth",r.fillBorderWidth,t),t});this.shadowPoint.setData(n),this.fillPoint.setData(i),this.textPoint.setData(t)}},{key:"getProperty",value:function(t,e,r){return"[object Function]"===Object.prototype.toString.call(e)?e(r):(e=r[t]||e,e="properties"in r&&t in r.properties?r.properties[t]:e)}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ffff00",autoSelect:!0,fillColor:"rgba(255, 50, 10, 1)",fillSize:20,fillBorderColor:"#ffffff",fillBorderWidth:1.2,shadowColor:"rgba(255, 80, 110, 0.7)",shadowSize:40,shadowBorderColor:"rgba(255, 80, 110, 1)",shadowBorderWidth:1.2,fontSize:12,fontFamily:"Microsoft Yahei",fontColor:"#ffffff"}}}]),r}(),dc=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="MaskLayer",t.bufferData=[],t.indices=[],t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{color:"rgba(100, 100, 100, 0.6)",height:0,polygonOffset:[0,0],depthTest:!1,depthWrite:!1}}},{key:"initialize",value:function(t){this.gl=t,this.program=new ss(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var e=(e=[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes());this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"onChanged",value:function(t,e){var r=this;if(this.gl){t=[];for(var n=[],i=0;i<e.length;i++)if(e[i].geometry.coordinates){var a=[[this.normizedPoint([-180,-90]),this.normizedPoint([180,-90]),this.normizedPoint([180,90]),this.normizedPoint([-180,90])]],o=[];if("LineString"===e[i].geometry.type&&(o=[e[i].geometry.coordinates.map(function(t){return r.normizedPoint(t)})]),"MultiPolygon"===e[i].geometry.type)for(var s=e[i].geometry.coordinates,l=0;l<s.length;l++)o=o.concat(s[l].map(function(t){return t.map(function(t){return r.normizedPoint(t)})}));else for(s=0;s<e[i].geometry.coordinates.length;s++)o.push(e[i].geometry.coordinates[s].map(function(t){return r.normizedPoint(t)}));for(a=(o=U.flatten(a.concat(o))).vertices,o=o.holes,s=[],l=0;l<a.length;l+=3)s.push(a[l+0],a[l+1]);this.parseBufferData(t,n,s,o)}this.bufferData=t,this.index=n,this.vertexBuffer.updateData(new Float32Array(t)),this.indexBuffer.updateData(new Uint32Array(n))}}},{key:"parseBufferData",value:function(t,e,r,n){var i=t.length/2;for(n=n&&n.length?U(r,n,2):U(r),t.push.apply(t,Jn(r)),t=0;t<n.length;t++)e.push(n[t]+i)}},{key:"render",value:function(t){var e,r,n,i;this.index&&this.index.length&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),t=Xe(this.getCommonUniforms(t),{u_matrix:r,u_height:n.height,u_color:this.normizedColor(n.color)}),i.setUniforms(t),this.setGLState({blend:!1,polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0))}}]),r}(),pc=function(){function t(){return he(this,t),bn(this,(t.__proto__||Qe(t)).apply(this,arguments))}return In(t,qs),ar(t,[{key:"toBBox",value:function(t){var e=Hn(t.item.geometry.coordinates,2);return{minX:t=e[0],minY:e=e[1],maxX:t,maxY:e}}},{key:"compareMinX",value:function(t,e){return t.item.geometry.coordinates[0]-e.item.geometry.coordinates[0]}},{key:"compareMinY",value:function(t,e){return t.item.geometry.coordinates[1]-e.item.geometry.coordinates[1]}}]),t}(),fc=function(){function r(t,e){return he(this,r),(t=bn(this,(r.__proto__||Qe(r)).call(this,t,e))).name="PointCanvasCustomLayer",e=t.canvas=document.createElement("canvas"),t.ctx=e.getContext("2d"),t.geoRBush=new pc,t}return In(r,Rs),ar(r,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],itemDimension:[20,20],renderItem:this.defaultOptionRenderItem}}},{key:"defaultOptionRenderItem",value:function(t,e,r){r.fillStyle="red",r.fillRect(e.x,e.y,e.w,e.h)}},{key:"initialize",value:function(t){this.gl=t;var e=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ss(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***点A(x,y)，绕原点顺时针旋转角度a新坐标的计算公式*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:"precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));\n#if defined(PICK)\nif(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}\n#endif\n}",defines:e.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new us({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new us({gl:t,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),e=(e=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}]).concat(this.getCommonAttributes()),this.vertexArray=new hs({gl:t,program:this.program,attributes:e})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(t,e){this.gl&&this.processCache(t,e)}},{key:"processCache",value:function(t,e){for(this.cachedData=[],this.geoRBush.clear(),t=0;t<e.length;t++){var r=e[t],n=this.normizedPoint(r.geometry.coordinates);n&&this.cachedData.push({point:n,item:r,extra:{},index:t})}this.geoRBush.load(this.cachedData)}},{key:"render",value:function(t){var e,r,n,i,a;this.cachedData&&this.cachedData.length&&this.map&&(e=t.gl,r=t.matrix,n=this.getOptions(),(i=this.program).use(e),this.throttleUpdate(t),this.setGLState({blend:!0,blendEquation:e.FUNC_ADD,blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA],polygonOffset:n.polygonOffset,depthTest:n.depthTest,depthMask:n.depthWrite}),a=this.map.getZoomUnits(),i.setUniforms(Xe(this.getCommonUniforms(t),{matrix:r,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:n.flat,offset:n.offset,zoomUnits:a,zIndex:n.zIndex,uUnitPx:"px"===n.unit})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),e.drawElements(e.TRIANGLES,this.index.length,e.UNSIGNED_INT,0)))}},{key:"throttleUpdate",value:function(t){this.updateText(t)}},{key:"updateText",value:function(t){var e=t.gl,r=t.matrix,n=(u=this.getOptions()).padding,i=u.margin,a=u.collides;t=u.enablePicked;var o=u.itemDimension,s=u.beforeRenderAll,l=u.beforeComputeDimension,u=u.renderItem,c=this.map.getBounds(),h=e.canvas.width/window.devicePixelRatio,d=e.canvas.height/window.devicePixelRatio,p=this.canvas;(e=this.ctx).save(),e.scale(window.devicePixelRatio,window.devicePixelRatio),l&&l(e);for(var c=this.geoRBush.search({minX:c.sw.lng,minY:c.sw.lat,maxX:c.ne.lng,maxY:c.ne.lat}),f=new qs,l=[],m=0;m<c.length;m++){var g=(x=c[m]).point,v=x.item,y=x.extra,x=x.index,b=Hn(g,3),b=Ko.clone([b[0],b[1],b[2],1]);Ko.transformMat4(b,b,r),Ko.scale(b,b,1/b[3]);var _=(b[0]+1)/2*h,A=(1-b[1])/2*d;b=(w=Array.isArray(o)?o:o(v,e,y))[0]+2*n[0];var w=w[1]+2*n[1],M=b+i[0],C=(A-=(C=w+i[1])/2)+C;if(!((M=(_-=M/2)+M)<0||C<0||h<_||d<A)){if(a){if(C={minX:_,maxX:M,minY:A,maxY:C},f.collides(C))continue;f.insert(C)}l.push({w:b,h:w,point:g,item:v,extra:y,dataIndex:x})}}for(e.restore(),(r=(n=ot(l)).w)<=0&&(r=1),(n=n.h)<=0&&(n=1),p.width=r*window.devicePixelRatio,p.height=n*window.devicePixelRatio,e.save(),e.scale(window.devicePixelRatio,window.devicePixelRatio),s&&s(e),s=[],p=[],i=[],a=[],o=0,h=l.length;o<h;++o){for(u((d=l[o]).item,d,e,d.extra),c=(m=Hn(d.point,3))[0],f=m[1],m=m[2],g=0;g<4;g++)s.push(c,f,m),s.push(g),s.push(d.w,d.h),s.push(1,0);c=d.x/r,f=(d.x+d.w)/r,m=(d.y+d.h)/n,g=d.y/n,p.push(c,m,c,g,f,g,f,m),c=4*o,i.push(c,c+2,c+1,c,c+3,c+2),t&&(d=this.indexToRgb(d.dataIndex),a.push(d[0]/255,d[1]/255,d[2]/255),a.push(d[0]/255,d[1]/255,d[2]/255),a.push(d[0]/255,d[1]/255,d[2]/255),a.push(d[0]/255,d[1]/255,d[2]/255))}e.restore(),this.loadTexture(),this.index=i,this.vertexBuffer.updateData(new Float32Array(s)),this.uvBuffer.updateData(new Float32Array(p)),this.indexBuffer.updateData(new Uint32Array(i)),t&&this.pickBuffer.updateData(new Float32Array(a))}},{key:"loadTexture",value:function(){var e=this;this.canvas?z(this.gl,this.canvas,function(t){e.texture=t},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),r}();window._hmt=window._hmt||[],function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?e8002ef3d9e0d8274b5b74cc4a027d08";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}(),t.View=Is,t.CanvasLayer=e,t.CircleLayer=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return he(this,t),new(Fs.includes(e.type)?Os:Ps)(e)},t.GridLayer=Ks,t.HeatGridLayer=Qs,t.ShapeLayer=Xs,t.SimpleLineLayer=$s,t.LineLayer3D=ml,t.LineLayer=yl,t.WallSpriteLayer=bl,t.LinePointLayer=ln,t.WallLayer=un,t.WallTripLayer=cn,t.HeatLineLayer=rn,t.HoneycombLayer=Jr,t.WebglLayer=Ss,t.PointLayer=Cu,t.GroundRippleLayer=_n,t.RippleLayer=Tu,t.SparkLayer=Oa,t.ClusterLayer=Fa,t.HeatPointLayer=Eu,t.ShapeLineLayer=vn,t.PointTripLayer=el,t.LineTripLayer=Cl,t.IconCollidesLayer=Tl,t.LineFlowLayer=Lu,t.TileLayer=Ru,t.IconLayer=Su,t.BoardLayer=Pu,t.PolygonLayer=Ll,t.CarLineLayer=Ml,t.Layer=Rs,t.TextLayer=Ys,t.BoardTextLayer=Yl,t.LabelLayer=Zt,t.TrafficLayer=We,t.GltfLayer=lc,t.HeatmapLayer=Xn,t.BarLayer=cc,t.MarkerListLayer=hc,t.MaskLayer=dc,t.PointCanvasCustomLayer=fc,t.FXAA=fs,t.SMAA=ms,t.BlurEffect=gs,t.BloomEffect=vs,t.BrightEffect=ys,t.DepthEffect=xs,t.EffectManager=bs,t.getContext=B,t.createTexture=N,t.loadTextureImage=z,t.FrameBufferObject=ds,t.Program=ss,t.StateManager=ls,t.Buffer=us,t.VertexArray=hs,t.CommonLayer=Ls,t.MercatorProjection=f,t.Canvas=x,t.Intensity=b,t.BezierCurve=_,t.GeodesicCurve=w,t.OdCurve=xi,t.utilCity={getProvinceNameByCityName:function(t){for(var e=0;e<_i.length;e++)for(var r=_i[e].n,n=_i[e].cities,i=0;i<n.length;i++)if(n[i].n==t)return r;return null},getCenterByCityName:function(t){t=t.replace("市","");for(var e=0;e<bi.length;e++)if(bi[e].n==t)return C(bi[e].g);for(e=0;e<Ai.length;e++)if(Ai[e].n==t)return C(Ai[e].g);for(e=0;e<_i.length;e++){if(_i[e].n==t)return C(_i[e].g);for(var r=_i[e].cities,n=0;n<r.length;n++)if(r[n].n==t)return C(r[n].g)}return null}},t.isMobile=Mi,t.Encryptor={encode:function(t){t=No(t);for(var e=[],r=0;r<t.length;r++)e.push(23^t[r]);return new Uint8Array(e)},decode:function(e){e=new Uint8Array(e);for(var t=[],r=0;r<e.length;r++)t.push(23^e[r]);e=new Uint8Array(t);try{var n=window.flate.deflate_decode_raw(e);return new TextDecoder("utf-8").decode(n)}catch(t){return console.warn("inflate by pako!"),zo(e,{to:"string"})}},download:function(t,e){var r=new Blob([t],{type:"application/octet-binary"});t=document.createElement("a"),r=window.URL.createObjectURL(r),t.href=r,t.download=e||"mapvgl_download",t.click()}},t.createFusionView=function(e,r){var n=void 0,i=!1;e.addEventListener("glmoduleloaded",function(t){i||(i=!0,setTimeout(function(){(n=new Is({cameraNear:10,cameraFar:8e3,gl:e._webglPainter.gl,canvas:e._webglPainter.gl.canvas,autoUpdate:!1,map:e})).webglLayer.canvas.style.zIndex=1;var t=n.webglLayer.stateManager;e.insertRender=function(){t.setState({blend:!0,depthTest:!1}),n.render()},r&&r(n)},3e3))}),setTimeout(function(){var t;i||(i=!0,(n=new Is({cameraNear:10,cameraFar:8e3,gl:e._webglPainter.gl,canvas:e._webglPainter.gl.canvas,autoUpdate:!1,map:e})).webglLayer.canvas.style.zIndex=1,t=n.webglLayer.stateManager,e.insertRender=function(){t.setState({blend:!0,depthTest:!1}),n.render()},r&&r(n))},4e3)},t.toRadian=u,t.toAngle=h,t.ceilPowerOfTwo=m,t.floorPowerOfTwo=d,t.approximatelyEqual=p,t.__moduleExports=Zo,t.vec4=Ko,t.vec3=Qo,t.vec2=$o,t.quat2=ts,t.quat=es,t.mat4=rs,t.mat3=ns,t.mat2d=is,t.mat2=as,t.glMatrix=os,Object.defineProperty(t,"__esModule",{value:!0})}(e)}.call(this,r(18))},function(t,e,r){"use strict";var n=r(30),r="object"==typeof self&&self&&self.Object===Object&&self,r=n.a||r||Function("return this")();e.a=r},function(t,e,r){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,r){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},function(t,e,r){"use strict";var n=r(20),i=r(3).a["__core-js_shared__"],a=(i=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";var o=function(t){return!!a&&a in t},s=r(4),l=r(13),u=/^\[object .+?Constructor\]$/,i=Function.prototype,r=Object.prototype,i=i.toString,r=r.hasOwnProperty,c=RegExp("^"+i.call(r).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var h=function(t){return!(!Object(s.a)(t)||o(t))&&(Object(n.a)(t)?c:u).test(Object(l.a)(t))};var d=function(t,e){return null==t?void 0:t[e]};e.a=function(t,e){return e=d(t,e),h(e)?e:void 0}},function(t,e,r){"use strict";var n=r(11),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,s=n.a?n.a.toStringTag:void 0;var i=function(t){var e=a.call(t,s),r=t[s];try{var n=!(t[s]=void 0)}catch(t){}var i=o.call(t);return n&&(e?t[s]=r:delete t[s]),i},l=Object.prototype.toString;var u=function(t){return l.call(t)},c=n.a?n.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(c&&c in Object(t)?i:u)(t)}},function(t,e,r){"use strict";var u=r(33),c=r(24);e.a=function(t,e,r,n){var i=!r;r=r||{};for(var a=-1,o=e.length;++a<o;){var s=e[a],l=n?n(r[s],t[s],s,r,t):void 0;void 0===l&&(l=t[s]),(i?Object(c.a):Object(u.a))(r,s,l)}return r}},function(t,e,r){"use strict";var n=r(39),i=r(4),a=r(22);var o=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},s=Object.prototype.hasOwnProperty;var l=function(t){if(!Object(i.a)(t))return o(t);var e,r=Object(a.a)(t),n=[];for(e in t)("constructor"!=e||!r&&s.call(t,e))&&n.push(e);return n},u=r(16);e.a=function(t){return Object(u.a)(t)?Object(n.a)(t,!0):l(t)}},function(t,e,r){"use strict";var n=Array.isArray;e.a=n},function(t,e,r){"use strict";r=r(3).a.Symbol;e.a=r},function(t,a,o){"use strict";!function(t){var e=o(30),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,n=r&&"object"==typeof t&&t&&!t.nodeType&&t,i=n&&n.exports===r&&e.a.process,e=function(){try{var t=n&&n.require&&n.require("util").types;return t?t:i&&i.binding&&i.binding("util")}catch(t){}}();a.a=e}.call(this,o(41)(t))},function(t,e,r){"use strict";var n=Function.prototype.toString;e.a=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,y,e){"use strict";!function(e){var r={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-r.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*r.Bounce.In(2*t):.5*r.Bounce.Out(2*t-1)+.5}}},t="undefined"==typeof self&&void 0!==e&&e.hrtime?function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},o=t,n=(i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},i.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},i.prototype.update=function(t,e){void 0===t&&(t=o()),void 0===e&&(e=!1);var r=Object.keys(this._tweens);if(0===r.length)return!1;for(;0<r.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<r.length;n++){var i=this._tweens[r[n]],a=!e;i&&!1===i.update(t,a)&&!e&&delete this._tweens[r[n]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},i);function i(){this._tweens={},this._tweensAddedDuringUpdate={}}var a,s={Linear:function(t,e){var r=t.length-1,n=r*e,i=Math.floor(n),a=s.Utils.Linear;return e<0?a(t[0],t[1],n):1<e?a(t[r],t[r-1],r-n):a(t[i],t[r<i+1?r:i+1],n-i)},Bezier:function(t,e){for(var r=0,n=t.length-1,i=Math.pow,a=s.Utils.Bernstein,o=0;o<=n;o++)r+=i(1-e,n-o)*i(e,o)*t[o]*a(n,o);return r},CatmullRom:function(t,e){var r=t.length-1,n=r*e,i=Math.floor(n),a=s.Utils.CatmullRom;return t[0]===t[r]?a(t[((i=e<0?Math.floor(n=r*(1+e)):i)-1+r)%r],t[i],t[(i+1)%r],t[(i+2)%r],n-i):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[r]-(a(t[r],t[r],t[r-1],t[r-1],n-r)-t[r]):a(t[i?i-1:0],t[i],t[r<i+1?r:i+1],t[r<i+2?r:i+2],n-i)},Utils:{Linear:function(t,e,r){return(e-t)*r+t},Bernstein:function(t,e){var r=s.Utils.Factorial;return r(t)/r(e)/r(t-e)},Factorial:(a=[1],function(t){var e=1;if(a[t])return a[t];for(var r=t;1<r;r--)e*=r;return a[t]=e}),CatmullRom:function(t,e,r,n,i){var a=.5*(r-t),t=.5*(n-e),n=i*i;return(2*e-2*r+a+t)*(i*n)+(-3*e+3*r-2*a-t)*n+a*i+e}}},l=(u.nextId=function(){return u._nextId++},u._nextId=0,u);function u(){}var c=new n,h=(d.prototype.getId=function(){return this._id},d.prototype.isPlaying=function(){return this._isPlaying},d.prototype.isPaused=function(){return this._isPaused},d.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},d.prototype.duration=function(t){return this._duration=t,this},d.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?o()+parseFloat(t):t:o(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},d.prototype._setupProperties=function(t,e,r,n){for(var i in r){var a=t[i],o=Array.isArray(a),s=o?"array":typeof a,l=!o&&Array.isArray(r[i]);if("undefined"!=s&&"function"!=s){if(l){var u=r[i];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,a)),r[i]=[a].concat(u)}if("object"!=s&&!o||!a||l)void 0===e[i]&&(e[i]=a),o||(e[i]*=1),n[i]=l?r[i].slice().reverse():e[i]||0;else{for(var c in e[i]=o?[]:{},a)e[i][c]=a[c];n[i]=o?[]:{},this._setupProperties(a,e[i],r[i],n[i])}}}},d.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying&&(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object)),this},d.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},d.prototype.pause=function(t){return void 0===t&&(t=o()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},d.prototype.resume=function(t){return void 0===t&&(t=o()),this._isPaused&&this._isPlaying&&(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this)),this},d.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},d.prototype.group=function(t){return this._group=t,this},d.prototype.delay=function(t){return this._delayTime=t,this},d.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},d.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},d.prototype.yoyo=function(t){return this._yoyo=t,this},d.prototype.easing=function(t){return this._easingFunction=t,this},d.prototype.interpolation=function(t){return this._interpolationFunction=t,this},d.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},d.prototype.onStart=function(t){return this._onStartCallback=t,this},d.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},d.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},d.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},d.prototype.onStop=function(t){return this._onStopCallback=t,this},d.prototype.update=function(t,e){if(void 0===t&&(t=o()),void 0===e&&(e=!0),this._isPaused)return!0;var r,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(n<t)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration;n=0===this._duration||1<n?1:n,e=this._easingFunction(n);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,e),this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1!==n)return!0;if(0<this._repeat){for(r in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var i=0,a=this._chainedTweens.length;i<a;i++)this._chainedTweens[i].start(this._startTime+this._duration);return this._isPlaying=!1},d.prototype._updateProperties=function(t,e,r,n){for(var i in r){var a,o,s,l;void 0!==e[i]&&(a=e[i]||0,o=r[i],s=Array.isArray(t[i]),l=Array.isArray(o),!s&&l?t[i]=this._interpolationFunction(o,n):"object"==typeof o&&o?this._updateProperties(t[i],a,o,n):"number"==typeof(o=this._handleRelativeValue(a,o))&&(t[i]=a+(o-a)*n))}},d.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},d.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],r=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof r?this._valuesStartRepeat[t]+parseFloat(r):this._valuesEnd[t],this._valuesEnd[t]=e},d);function d(t,e){void 0===e&&(e=c),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=r.Linear.None,this._interpolationFunction=s.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=l.nextId(),this._isChainStopped=!1,this._goToEnd=!1}var p=l.nextId,f=c,m=f.getAll.bind(f),g=f.removeAll.bind(f),v=f.add.bind(f),t=f.remove.bind(f),f=f.update.bind(f),f={Easing:r,Group:n,Interpolation:s,now:o,Sequence:l,nextId:p,Tween:h,VERSION:"18.6.4",getAll:m,removeAll:g,add:v,remove:t,update:f};y.a=f}.call(this,e(44))},function(t,e,r){"use strict";e.a=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,r){"use strict";var n=r(20),i=r(34);e.a=function(t){return null!=t&&Object(i.a)(t.length)&&!Object(n.a)(t)}},function(t,e,r){"use strict";var n=r(6),r=r(3),r=Object(n.a)(r.a,"Map");e.a=r},function(t,e){var r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){!function(cm){!function(t){function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}function n(t){var r,n;this.promise=new t(function(t,e){if(void 0!==r||void 0!==n)throw TypeError("Bad Promise constructor");r=t,n=e}),this.resolve=Sa(r),this.reject=Sa(n)}function i(){}function At(t,e){this.x=t||0,this.y=e||0}function g(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function d(t,e,r,n,i,a,o,s,l,u){Object.defineProperty(this,"id",{value:ec++}),this.uuid=Qu.generateUUID(),this.name="",this.image=void 0!==t?t:d.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:d.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==i?i:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:1023,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new At(0,0),this.repeat=new At(1,1),this.center=new At(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new g,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function wt(t,e,r,n){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==n?n:1}function T(t,e,r){this.width=t,this.height=e,this.scissor=new wt(0,0,t,e),this.scissorTest=!1,this.viewport=new wt(0,0,t,e),r=r||{},this.texture=new d(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:1006,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function a(t,e,r){T.call(this,t,e,r),this.samples=4}function f(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==n?n:1}function Mt(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}function Ct(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function o(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._order=n||o.DefaultOrder}function s(){this.mask=1}function B(){Object.defineProperty(this,"id",{value:pc++}),this.uuid=Qu.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=B.DefaultUp.clone();var t=new Mt,e=new o,r=new f,n=new Mt(1,1,1);e._onChange(function(){r.setFromEuler(e,!1)}),r._onChange(function(){e.setFromQuaternion(r,void 0,!1)}),ku(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Ct},normalMatrix:{value:new g}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=B.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new s,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Tt(){B.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function N(t,e){this.min=void 0!==t?t:new Mt(1/0,1/0,1/0),this.max=void 0!==e?e:new Mt(-1/0,-1/0,-1/0)}function l(t,e,r,n,i){for(var a=0,o=t.length-3;a<=o;a+=3){zc.fromArray(t,a);var s=i.x*Math.abs(zc.x)+i.y*Math.abs(zc.y)+i.z*Math.abs(zc.z),l=e.dot(zc),u=r.dot(zc),c=n.dot(zc);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}function z(t,e){this.center=void 0!==t?t:new Mt,this.radius=void 0!==e?e:-1}function u(t,e){this.origin=void 0!==t?t:new Mt,this.direction=void 0!==e?e:new Mt(0,0,-1)}function v(t,e){this.normal=void 0!==t?t:new Mt(1,0,0),this.constant=void 0!==e?e:0}function b(t,e,r){this.a=void 0!==t?t:new Mt,this.b=void 0!==e?e:new Mt,this.c=void 0!==r?r:new Mt}function U(t,e,r){return void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}function c(t,e,r){return r<0&&(r+=1),1<r&&--r,r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function h(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function p(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function y(t,e,r,n,i,a){this.a=t,this.b=e,this.c=r,this.normal=n&&n.isVector3?n:new Mt,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new U,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}function k(){Object.defineProperty(this,"id",{value:uh++}),this.uuid=Qu.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function H(t){k.call(this),this.type="MeshBasicMaterial",this.color=new U(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function G(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function m(t,e,r){G.call(this,new Int8Array(t),e,r)}function x(t,e,r){G.call(this,new Uint8Array(t),e,r)}function _(t,e,r){G.call(this,new Uint8ClampedArray(t),e,r)}function A(t,e,r){G.call(this,new Int16Array(t),e,r)}function w(t,e,r){G.call(this,new Uint16Array(t),e,r)}function M(t,e,r){G.call(this,new Int32Array(t),e,r)}function C(t,e,r){G.call(this,new Uint32Array(t),e,r)}function I(t,e,r){G.call(this,new Float32Array(t),e,r)}function S(t,e,r){G.call(this,new Float64Array(t),e,r)}function E(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function L(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e}function X(){Object.defineProperty(this,"id",{value:hh+=2}),this.uuid=Qu.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function V(t,e){B.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new X,this.material=void 0!==e?e:new H,this.updateMorphTargets()}function R(t,e,r,n,i,a,o,s){return null===(1===e.side?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,2!==e.side,s))?null:(Oh.copy(s),Oh.applyMatrix4(t.matrixWorld),(e=r.ray.origin.distanceTo(Oh))<r.near||e>r.far?null:{distance:e,point:Oh.clone(),object:t})}function P(t,e,r,n,i,a,o,s,l,u,c,h){if(_h.fromBufferAttribute(i,u),Ah.fromBufferAttribute(i,c),wh.fromBufferAttribute(i,h),i=t.morphTargetInfluences,e.morphTargets&&a&&i){Sh.set(0,0,0),Eh.set(0,0,0),Ih.set(0,0,0);for(var d=0,p=a.length;d<p;d++){var f=i[d],m=a[d];0!==f&&(Mh.fromBufferAttribute(m,u),Ch.fromBufferAttribute(m,c),Th.fromBufferAttribute(m,h),o?(Sh.addScaledVector(Mh,f),Eh.addScaledVector(Ch,f),Ih.addScaledVector(Th,f)):(Sh.addScaledVector(Mh.sub(_h),f),Eh.addScaledVector(Ch.sub(Ah),f),Ih.addScaledVector(Th.sub(wh),f)))}_h.add(Sh),Ah.add(Eh),wh.add(Ih)}return t.isSkinnedMesh&&(t.boneTransform(u,_h),t.boneTransform(c,Ah),t.boneTransform(h,wh)),(t=R(t,e,r,n,_h,Ah,wh,Dh))&&(s&&(Lh.fromBufferAttribute(s,u),Rh.fromBufferAttribute(s,c),Ph.fromBufferAttribute(s,h),t.uv=b.getUV(Dh,_h,Ah,wh,Lh,Rh,Ph,new At)),l&&(Lh.fromBufferAttribute(l,u),Rh.fromBufferAttribute(l,c),Ph.fromBufferAttribute(l,h),t.uv2=b.getUV(Dh,_h,Ah,wh,Lh,Rh,Ph,new At)),s=new y(u,c,h),b.getNormal(_h,Ah,wh,s.normal),t.face=s),t}function D(){Object.defineProperty(this,"id",{value:Fh+=2}),this.uuid=Qu.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function O(t){var e,r={};for(e in t)for(var n in r[e]={},t[e]){var i=t[e][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?r[e][n]=i.clone():Array.isArray(i)?r[e][n]=i.slice():r[e][n]=i}return r}function F(t){for(var e={},r=0;r<t.length;r++){var n,i=O(t[r]);for(n in i)e[n]=i[n]}return e}function W(t){k.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function j(){B.call(this),this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct}function q(t,e,r,n){j.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Y(t,e,o){var a,s,l,u,c,h;B.call(this),this.type="CubeCamera",!0!==o.isWebGLCubeRenderTarget?console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."):(this.renderTarget=o,(a=new q(90,1,t,e)).layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Mt(1,0,0)),this.add(a),(s=new q(90,1,t,e)).layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Mt(-1,0,0)),this.add(s),(l=new q(90,1,t,e)).layers=this.layers,l.up.set(0,0,1),l.lookAt(new Mt(0,1,0)),this.add(l),(u=new q(90,1,t,e)).layers=this.layers,u.up.set(0,0,-1),u.lookAt(new Mt(0,-1,0)),this.add(u),(c=new q(90,1,t,e)).layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Mt(0,0,1)),this.add(c),(h=new q(90,1,t,e)).layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Mt(0,0,-1)),this.add(h),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=t.xr.enabled,n=t.getRenderTarget();t.xr.enabled=!1;var i=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,t.setRenderTarget(o,0),t.render(e,a),t.setRenderTarget(o,1),t.render(e,s),t.setRenderTarget(o,2),t.render(e,l),t.setRenderTarget(o,3),t.render(e,u),t.setRenderTarget(o,4),t.render(e,c),o.texture.generateMipmaps=i,t.setRenderTarget(o,5),t.render(e,h),t.setRenderTarget(n),t.xr.enabled=r},this.clear=function(t,e,r,n){for(var i=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,r,n);t.setRenderTarget(i)})}function Z(t,e,r){Vu(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=r),T.call(this,t,t,e)}function St(t,e,r,n,i,a,o,s,l,u,c,h){d.call(this,null,a,o,s,l,u,n,i,c,h),this.image={data:t||null,width:e||1,height:r||1},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==u?u:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Et(t,e,r,n,i,a){this.planes=[void 0!==t?t:new v,void 0!==e?e:new v,void 0!==r?r:new v,void 0!==n?n:new v,void 0!==i?i:new v,void 0!==a?a:new v]}function It(){function r(t,e){!1!==i&&(a(t,e),n.requestAnimationFrame(r))}var n=null,i=!1,a=null;return{start:function(){!0!==i&&null!==a&&(n.requestAnimationFrame(r),i=!0)},stop:function(){i=!1},setAnimationLoop:function(t){a=t},setContext:function(t){n=t}}}function Lt(l,t){var u=t.isWebGL2,c=new Bu;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),c.get(t)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=c.get(t);e&&(l.deleteBuffer(e.buffer),c.delete(t))},update:function(t,e){t.isInterleavedBufferAttribute&&(t=t.data);var r,n,i,a,o,s=c.get(t);void 0===s?c.set(t,(n=e,i=(r=t).array,a=r.usage,o=l.createBuffer(),l.bindBuffer(n,o),l.bufferData(n,i,a),r.onUploadCallback(),n=5126,i instanceof Float32Array?n=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?n=5123:i instanceof Int16Array?n=5122:i instanceof Uint32Array?n=5125:i instanceof Int32Array?n=5124:i instanceof Int8Array?n=5120:i instanceof Uint8Array&&(n=5121),{buffer:o,type:n,bytesPerElement:i.BYTES_PER_ELEMENT,version:r.version})):s.version<t.version&&(i=t.array,r=t.updateRange,l.bindBuffer(e,s.buffer),-1===r.count?l.bufferSubData(e,0,i):(u?l.bufferSubData(e,r.offset*i.BYTES_PER_ELEMENT,i,r.offset,r.count):l.bufferSubData(e,r.offset*i.BYTES_PER_ELEMENT,i.subarray(r.offset,r.offset+r.count)),r.count=-1),s.version=t.version)}}}function J(t,e,r,n){D.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new K(t,e,r,n)),this.mergeVertices()}function K(t,e,r,n){X.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n};var i=(t=t||1)/2,a=(e=e||1)/2,o=(r=Math.floor(r)||1)+1,s=(n=Math.floor(n)||1)+1,l=t/r,u=e/n,c=[],h=[],d=[],p=[];for(t=0;t<s;t++){var f=t*u-a;for(e=0;e<o;e++)h.push(e*l-i,-f,0),d.push(0,0,1),p.push(e/r),p.push(1-t/n)}for(t=0;t<n;t++)for(e=0;e<r;e++)i=e+o*(t+1),a=e+1+o*(t+1),s=e+1+o*t,c.push(e+o*t,i,s),c.push(i,a,s);this.setIndex(c),this.setAttribute("position",new I(h,3)),this.setAttribute("normal",new I(d,3)),this.setAttribute("uv",new I(p,2))}function Rt(i,r,a,n){function o(t,e){r.buffers.color.setClear(t.r,t.g,t.b,e,n)}var s,l,u=new U(0),c=0,h=null,d=0,p=null;return{getClearColor:function(){return u},setClearColor:function(t,e){u.set(t),o(u,c=void 0!==e?e:1)},getClearAlpha:function(){return c},setClearAlpha:function(t){o(u,c=t)},render:function(t,e,r,n){e=e.background,null===(e=(r=(r=i.xr).getSession&&r.getSession())&&"additive"===r.environmentBlendMode?null:e)?o(u,c):e&&e.isColor&&(o(e,1),n=!0),(i.autoClear||n)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),e&&(e.isCubeTexture||e.isWebGLCubeRenderTarget||306===e.mapping)?(void 0===l&&((l=new V(new Uh(1,1,1),new W({type:"BackgroundCubeMaterial",uniforms:O(jh.cube.uniforms),vertexShader:jh.cube.vertexShader,fragmentShader:jh.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(l)),n=e.isWebGLCubeRenderTarget?e.texture:e,l.material.uniforms.envMap.value=n,l.material.uniforms.flipEnvMap.value=n.isCubeTexture?-1:1,h===e&&d===n.version&&p===i.toneMapping||(l.material.needsUpdate=!0,h=e,d=n.version,p=i.toneMapping),t.unshift(l,l.geometry,l.material,0,0,null)):e&&e.isTexture&&(void 0===s&&((s=new V(new K(2,2),new W({type:"BackgroundMaterial",uniforms:O(jh.background.uniforms),vertexShader:jh.background.vertexShader,fragmentShader:jh.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(s)),!0===(s.material.uniforms.t2D.value=e).matrixAutoUpdate&&e.updateMatrix(),s.material.uniforms.uvTransform.value.copy(e.matrix),h===e&&d===e.version&&p===i.toneMapping||(s.material.needsUpdate=!0,d=(h=e).version,p=i.toneMapping),t.unshift(s,s.geometry,s.material,0,0,null))}}}function Pt(a,o,s,t){var l,u=t.isWebGL2;this.setMode=function(t){l=t},this.render=function(t,e){a.drawArrays(l,t,e),s.update(e,l)},this.renderInstances=function(t,e,r,n){if(0!==n){if(u){t=a;var i="drawArraysInstanced"}else if(i="drawArraysInstancedANGLE",null===(t=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");t[i](l,e,r,n),s.update(r,l,n)}}}function Dt(e,r,t){function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var i,a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==t.precision?t.precision:"highp";(s=n(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s),t=!0===t.logarithmicDepthBuffer;var s=e.getParameter(34930),l=e.getParameter(35660),u=e.getParameter(3379),c=e.getParameter(34076),h=e.getParameter(34921),d=e.getParameter(36347),p=e.getParameter(36348),f=e.getParameter(36349),m=0<l,g=a||!!r.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var t=r.get("EXT_texture_filter_anisotropic");return i=null!==t?e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:t,maxTextures:s,maxVertexTextures:l,maxTextureSize:u,maxCubemapSize:c,maxAttributes:h,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:g,floatVertexTextures:m&&g,maxSamples:a?e.getParameter(36183):0}}function Ot(){function l(){m.value!==c&&(m.value=c,m.needsUpdate=0<h),o.numPlanes=h,o.numIntersection=0}function u(t,e,r,n){var i=null!==t?t.length:0,a=null;if(0!==i){if(a=m.value,!0!==n||null===a)for(n=r+4*i,e=e.matrixWorldInverse,f.getNormalMatrix(e),(null===a||a.length<n)&&(a=new Float32Array(n)),n=0;n!==i;++n,r+=4)s.copy(t[n]).applyMatrix4(e,f),s.normal.toArray(a,r),a[r+3]=s.constant;m.value=a,m.needsUpdate=!0}return o.numPlanes=i,o.numIntersection=0,a}var o=this,c=null,h=0,d=!1,p=!1,s=new v,f=new g,m={value:null,needsUpdate:!1};this.uniform=m,this.numIntersection=this.numPlanes=0,this.init=function(t,e,r){var n=0!==t.length||e||0!==h||d;return d=e,c=u(t,r,0),h=t.length,n},this.beginShadows=function(){p=!0,u(null)},this.endShadows=function(){p=!1,l()},this.setState=function(t,e,r,n,i,a){if(!d||null===t||0===t.length||p&&!r)p?u(null):l();else{var o=4*(r=p?0:h),s=i.clippingState||null;for(m.value=s,s=u(t,n,o,a),t=0;t!==o;++t)s[t]=c[t];i.clippingState=s,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=r}}}function Ft(r){var n={};return{get:function(t){if(void 0!==n[t])return n[t];switch(t){case"WEBGL_depth_texture":var e=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=r.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n[t]=e}}}function Bt(t,u,n){function i(t){var e,r=t.target;for(e in null!==(t=o.get(r)).index&&u.remove(t.index),t.attributes)u.remove(t.attributes[e]);r.removeEventListener("dispose",i),o.delete(r),(e=c.get(t))&&(u.remove(e),c.delete(t)),n.memory.geometries--}function a(t){var e=[],r=t.index,n=t.attributes.position;if(null!==r)for(var i=r.array,r=r.version,n=0,a=i.length;n<a;n+=3){var o=i[n+0],s=i[n+1],l=i[n+2];e.push(o,s,s,l,l,o)}else for(i=n.array,r=n.version,n=0,a=i.length/3-1;n<a;n+=3)o=n+0,s=n+1,l=n+2,e.push(o,s,s,l,l,o);(e=new(65535<L(e)?C:w)(e,1)).version=r,u.update(e,34963),(i=c.get(t))&&u.remove(i),c.set(t,e)}var o=new Bu,c=new Bu;return{get:function(t,e){var r=o.get(e);return r||(e.addEventListener("dispose",i),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new X).setFromObject(t)),r=e._bufferGeometry),o.set(e,r),n.memory.geometries++,r)},update:function(t){var e,r=t.index,n=t.attributes;for(e in null!==r&&u.update(r,34963),n)u.update(n[e],34962);for(e in t=t.morphAttributes)for(var n=0,i=(r=t[e]).length;n<i;n++)u.update(r[n],34962)},getWireframeAttribute:function(t){var e,r=c.get(t);return(!r||null!==(e=t.index)&&r.version<e.version)&&a(t),c.get(t)}}}function Nt(a,o,s,t){var l,u,c,h=t.isWebGL2;this.setMode=function(t){l=t},this.setIndex=function(t){u=t.type,c=t.bytesPerElement},this.render=function(t,e){a.drawElements(l,e,u,t*c),s.update(e,l)},this.renderInstances=function(t,e,r,n){if(0!==n){if(h){t=a;var i="drawElementsInstanced"}else if(i="drawElementsInstancedANGLE",null===(t=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");t[i](l,r,u,e*c,n),s.update(r,l,n)}}}function zt(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,e,r){switch(r=r||1,n.calls++,e){case 4:n.triangles+=t/3*r;break;case 1:n.lines+=t/2*r;break;case 3:n.lines+=r*(t-1);break;case 2:n.lines+=r*t;break;case 0:n.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e)}}}}function Q(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Ut(u){var c={},h=new Float32Array(8);return{update:function(t,e,r,n){var i=t.morphTargetInfluences,a=void 0===i?0:i.length;if(void 0===(t=c[e.id])){t=[];for(var o=0;o<a;o++)t[o]=[o,0];c[e.id]=t}var s=r.morphTargets&&e.morphAttributes.position;for(r=r.morphNormals&&e.morphAttributes.normal,o=0;o<a;o++){var l=t[o];0!==l[1]&&(s&&e.deleteAttribute("morphTarget"+o),r&&e.deleteAttribute("morphNormal"+o))}for(o=0;o<a;o++)(l=t[o])[0]=o,l[1]=i[o];for(t.sort(Q),o=i=0;o<8;o++)(l=t[o])&&(a=l[0],l=l[1])?(s&&e.setAttribute("morphTarget"+o,s[a]),r&&e.setAttribute("morphNormal"+o,r[a]),i+=h[o]=l):h[o]=0;e=e.morphTargetsRelative?1:1-i,n.getUniforms().setValue(u,"morphTargetBaseInfluence",e),n.getUniforms().setValue(u,"morphTargetInfluences",h)}}}function kt(t,i,a,o){var s=new Bu;return{update:function(t){var e=o.render.frame,r=t.geometry,n=i.get(t,r);return s.get(n)!==e&&(r.isGeometry&&n.updateFromObject(t),i.update(n),s.set(n,e)),t.isInstancedMesh&&a.update(t.instanceMatrix,34962),n},dispose:function(){s=new Bu}}}function $(t,e,r,n,i,a,o,s,l,u){d.call(this,t=void 0!==t?t:[],void 0!==e?e:301,r,n,i,a,void 0!==o?o:1022,s,l,u),this.flipY=!1}function tt(t,e,r,n){d.call(this,null),this.image={data:t||null,width:e||1,height:r||1,depth:n||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function et(t,e,r,n){d.call(this,null),this.image={data:t||null,width:e||1,height:r||1,depth:n||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function rt(t,e,r){var n=t[0];if(n<=0||0<n)return t;var i=e*r,a=Jh[i];if(void 0===a&&(a=new Float32Array(i),Jh[i]=a),0!==e)for(n.toArray(a,0),n=1,i=0;n!==e;++n)i+=r,t[n].toArray(a,i);return a}function nt(t,e){if(t.length===e.length){for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return;return 1}}function it(t,e){for(var r=0,n=e.length;r<n;r++)t[r]=e[r]}function at(t,e){var r=Kh[e];void 0===r&&(r=new Int32Array(e),Kh[e]=r);for(var n=0;n!==e;++n)r[n]=t.allocateTextureUnit();return r}function ot(t,e){var r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function st(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y):nt(r,e)||(t.uniform2fv(this.addr,e),it(r,e))}function lt(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z):void 0!==e.r?r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b):nt(r,e)||(t.uniform3fv(this.addr,e),it(r,e))}function ut(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w):nt(r,e)||(t.uniform4fv(this.addr,e),it(r,e))}function ct(t,e){var r=this.cache,n=e.elements;void 0===n?nt(r,e)||(t.uniformMatrix2fv(this.addr,!1,e),it(r,e)):nt(r,n)||(td.set(n),t.uniformMatrix2fv(this.addr,!1,td),it(r,n))}function ht(t,e){var r=this.cache,n=e.elements;void 0===n?nt(r,e)||(t.uniformMatrix3fv(this.addr,!1,e),it(r,e)):nt(r,n)||($h.set(n),t.uniformMatrix3fv(this.addr,!1,$h),it(r,n))}function dt(t,e){var r=this.cache,n=e.elements;void 0===n?nt(r,e)||(t.uniformMatrix4fv(this.addr,!1,e),it(r,e)):nt(r,n)||(Qh.set(n),t.uniformMatrix4fv(this.addr,!1,Qh),it(r,n))}function pt(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTexture2D(e||Xh,i)}function ft(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(e||qh,i)}function mt(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(e||Yh,i)}function gt(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTextureCube(e||Zh,i)}function vt(t,e){var r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function yt(t,e){var r=this.cache;nt(r,e)||(t.uniform2iv(this.addr,e),it(r,e))}function xt(t,e){var r=this.cache;nt(r,e)||(t.uniform3iv(this.addr,e),it(r,e))}function bt(t,e){var r=this.cache;nt(r,e)||(t.uniform4iv(this.addr,e),it(r,e))}function _t(t,e){var r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function Ht(t,e){t.uniform1fv(this.addr,e)}function Gt(t,e){t.uniform1iv(this.addr,e)}function Vt(t,e){t.uniform2iv(this.addr,e)}function Wt(t,e){t.uniform3iv(this.addr,e)}function jt(t,e){t.uniform4iv(this.addr,e)}function Xt(t,e){e=rt(e,this.size,2),t.uniform2fv(this.addr,e)}function qt(t,e){e=rt(e,this.size,3),t.uniform3fv(this.addr,e)}function Yt(t,e){e=rt(e,this.size,4),t.uniform4fv(this.addr,e)}function Zt(t,e){e=rt(e,this.size,4),t.uniformMatrix2fv(this.addr,!1,e)}function Jt(t,e){e=rt(e,this.size,9),t.uniformMatrix3fv(this.addr,!1,e)}function Kt(t,e){e=rt(e,this.size,16),t.uniformMatrix4fv(this.addr,!1,e)}function Qt(t,e,r){var n=e.length,i=at(r,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)r.safeSetTexture2D(e[t]||Xh,i[t])}function $t(t,e,r){var n=e.length,i=at(r,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)r.safeSetTextureCube(e[t]||Zh,i[t])}function te(t,e,r){this.id=t,this.addr=r,this.cache=[],this.setValue=function(t){switch(t){case 5126:return ot;case 35664:return st;case 35665:return lt;case 35666:return ut;case 35674:return ct;case 35675:return ht;case 35676:return dt;case 5124:case 35670:return vt;case 35667:case 35671:return yt;case 35668:case 35672:return xt;case 35669:case 35673:return bt;case 5125:return _t;case 35678:case 36198:case 36298:case 36306:case 35682:return pt;case 35679:case 36299:case 36307:return mt;case 35680:case 36300:case 36308:case 36293:return gt;case 36289:case 36303:case 36311:case 36292:return ft}}(e.type)}function ee(t,e,r){this.id=t,this.addr=r,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ht;case 35664:return Xt;case 35665:return qt;case 35666:return Yt;case 35674:return Zt;case 35675:return Jt;case 35676:return Kt;case 5124:case 35670:return Gt;case 35667:case 35671:return Vt;case 35668:case 35672:return Wt;case 35669:case 35673:return jt;case 35678:case 36198:case 36298:case 36306:case 35682:return Qt;case 35680:case 36300:case 36308:case 36293:return $t}}(e.type)}function re(t){this.id=t,this.seq=[],this.map={}}function ne(t,e){this.seq=[],this.map={};for(var r=t.getProgramParameter(e,35718),n=0;n<r;++n){var i=t.getActiveUniform(e,n),a=t.getUniformLocation(e,i.name),o=this,s=i.name,l=s.length;for(ed.lastIndex=0;;){var u=ed.exec(s),c=ed.lastIndex,h=u[1],d=u[3];if("]"===u[2]&&(h|=0),void 0===d||"["===d&&c+2===l){s=o,i=new(void 0===d?te:ee)(h,i,a),s.seq.push(i),s.map[i.id]=i;break}void 0===(d=o.map[h])&&(d=new re(h),h=o,o=d,h.seq.push(o),h.map[o.id]=o),o=d}}}function ie(t,e,r){return e=t.createShader(e),t.shaderSource(e,r),t.compileShader(e),e}function ae(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+t)}}function oe(t,e,r){var n=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(n&&""===i)return"";for(t=t.getShaderSource(e).split("\n"),e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+(t=t.join("\n"))}function se(t,e){return"vec4 "+t+"( vec4 value ) { return "+(e=ae(e))[0]+"ToLinear"+e[1]+"; }"}function le(t){return""!==t}function ue(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ce(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function he(t,e){if(void 0===(t=Wh[e]))throw Error("Can not resolve #include <"+e+">");return t.replace(nd,he)}function de(t,e,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),pe(t,e,r,n)}function pe(t,e,r,n){for(t="",e=parseInt(e);e<parseInt(r);e++)t+=n.replace(/\[ i \]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return t}function fe(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function me(t,e,r){var n,i,a,o,s=t.getContext(),l=r.defines,u=r.vertexShader,c=r.fragmentShader,h=(i="SHADOWMAP_TYPE_BASIC",1===(n=r).shadowMapType?i="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?i="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(i="SHADOWMAP_TYPE_VSM"),i),d=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC";break;case 305:e="ENVMAP_TYPE_SPHERE"}return e}(r),p=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(r),f=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(r),m=0<t.gammaFactor?t.gammaFactor:1,g=r.isWebGL2?"":[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||"physical"===r.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(le).join("\n"),v=function(t){var e,r=[];for(e in t){var n=t[e];!1!==n&&r.push("#define "+e+" "+n)}return r.join("\n")}(l),y=s.createProgram();return r.isRawShaderMaterial?(0<(l=[v].filter(le).join("\n")).length&&(l+="\n"),0<(h=[g,v].filter(le).join("\n")).length&&(h+="\n")):(l=[fe(r),"#define SHADER_NAME "+r.shaderName,v,r.instancing?"#define USE_INSTANCING":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(le).join("\n"),h=[g,fe(r),"#define SHADER_NAME "+r.shaderName,v,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+m,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?Wh.tonemapping_pars_fragment:"",0!==r.toneMapping?function(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="Uncharted2";break;case 4:e="OptimizedCineon";break;case 5:e="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.outputEncoding||r.mapEncoding||r.matcapEncoding||r.envMapEncoding||r.emissiveMapEncoding||r.lightMapEncoding?Wh.encodings_pars_fragment:"",r.mapEncoding?se("mapTexelToLinear",r.mapEncoding):"",r.matcapEncoding?se("matcapTexelToLinear",r.matcapEncoding):"",r.envMapEncoding?se("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?se("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMapEncoding?se("lightMapTexelToLinear",r.lightMapEncoding):"",r.outputEncoding?(n="linearToOutputTexel",i=r.outputEncoding,"vec4 "+n+"( vec4 value ) { return LinearTo"+(i=ae(i))[0]+i[1]+"; }"):"",r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(le).join("\n")),u=ce(u=ue(u=u.replace(nd,he),r),r),c=ce(c=ue(c=c.replace(nd,he),r),r),u=u.replace(ad,pe).replace(id,de),c=c.replace(ad,pe).replace(id,de),r.isWebGL2&&!r.isRawShaderMaterial&&(d=!1,p=/^\s*#version\s+300\s+es\s*\n/,r.isShaderMaterial&&null!==u.match(p)&&null!==c.match(p)&&(d=!0,u=u.replace(p,""),c=c.replace(p,"")),l="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+l,h=["#version 300 es\n\n#define varying in",d?"":"out highp vec4 pc_fragColor;",d?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+h),c=h+c,u=ie(s,35633,l+u),c=ie(s,35632,c),s.attachShader(y,u),s.attachShader(y,c),void 0!==r.index0AttributeName?s.bindAttribLocation(y,0,r.index0AttributeName):!0===r.morphTargets&&s.bindAttribLocation(y,0,"position"),s.linkProgram(y),t.debug.checkShaderErrors&&(t=s.getProgramInfoLog(y).trim(),d=s.getShaderInfoLog(u).trim(),p=s.getShaderInfoLog(c).trim(),!(m=f=!0)===s.getProgramParameter(y,35714)?(f=!1,g=oe(s,u,"vertex"),v=oe(s,c,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(y,35715),"gl.getProgramInfoLog",t,g,v)):""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==d&&""!==p||(m=!1),m&&(this.diagnostics={runnable:f,programLog:t,vertexShader:{log:d,prefix:l},fragmentShader:{log:p,prefix:h}})),s.deleteShader(u),s.deleteShader(c),this.getUniforms=function(){return a=void 0===a?new ne(s,y):a},this.getAttributes=function(){if(void 0===o){for(var t={},e=s.getProgramParameter(y,35721),r=0;r<e;r++){var n=s.getActiveAttrib(y,r).name;t[n]=s.getAttribLocation(y,n)}o=t}return o},this.destroy=function(){s.deleteProgram(y),this.program=void 0},this.name=r.shaderName,this.id=rd++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=u,this.fragmentShader=c,this}function ge(d,p,f){function m(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}var o=[],g=f.isWebGL2,v=f.logarithmicDepthBuffer,y=f.floatVertexTextures,x=f.precision,b=f.maxVertexUniforms,_=f.vertexTextures,A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},n="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(t,e,r,n,i,a,o){var s=n.fog;n=t.isMeshStandardMaterial?n.environment:null,n=t.envMap||n;var l,u,c=A[t.type];u=o.isSkinnedMesh?(u=o.skeleton.bones,y?1024:(l=Math.min(Math.floor((b-20)/4),u.length))<u.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+u.length+" bones. This GPU supports "+l+"."),0):l):0,null===t.precision||(x=f.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",x,"instead."),l=c?(l=jh[c],{name:t.type,uniforms:kh.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}):{name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(l,d);var h=d.getRenderTarget();return{isWebGL2:g,shaderID:c,shaderName:l.name,uniforms:l.uniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:t.defines,isRawShaderMaterial:t.isRawShaderMaterial,isShaderMaterial:t.isShaderMaterial,precision:x,instancing:!0===o.isInstancedMesh,supportsVertexTextures:_,outputEncoding:null!==h?m(h.texture):d.outputEncoding,map:!!t.map,mapEncoding:m(t.map),matcap:!!t.matcap,matcapEncoding:m(t.matcap),envMap:!!n,envMapMode:n&&n.mapping,envMapEncoding:m(n),envMapCubeUV:!!n&&(306===n.mapping||307===n.mapping),lightMap:!!t.lightMap,lightMapEncoding:m(t.lightMap),aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:m(t.emissiveMap),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:1===t.normalMapType,tangentSpaceNormalMap:0===t.normalMapType,clearcoatMap:!!t.clearcoatMap,clearcoatRoughnessMap:!!t.clearcoatRoughnessMap,clearcoatNormalMap:!!t.clearcoatNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,sheen:!!t.sheen,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,vertexUvs:!!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatMap||t.clearcoatRoughnessMap||t.clearcoatNormalMap||t.displacementMap),uvsVertexOnly:!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap||!t.displacementMap),fog:!!s,useFog:t.fog,fogExp2:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:v,skinning:t.skinning&&0<u,maxBones:u,useVertexTexture:y,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:d.maxMorphTargets,maxMorphNormals:d.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numDirLightShadows:e.directionalShadowMap.length,numPointLightShadows:e.pointShadowMap.length,numSpotLightShadows:e.spotShadowMap.length,numClippingPlanes:i,numClipIntersection:a,dithering:t.dithering,shadowMapEnabled:d.shadowMap.enabled&&0<r.length,shadowMapType:d.shadowMap.type,toneMapping:t.toneMapped?d.toneMapping:0,physicallyCorrectLights:d.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking,index0AttributeName:t.index0AttributeName,extensionDerivatives:t.extensions&&t.extensions.derivatives,extensionFragDepth:t.extensions&&t.extensions.fragDepth,extensionDrawBuffers:t.extensions&&t.extensions.drawBuffers,extensionShaderTextureLOD:t.extensions&&t.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||null!==p.get("EXT_frag_depth"),rendererExtensionDrawBuffers:g||null!==p.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||null!==p.get("EXT_shader_texture_lod"),onBeforeCompile:t.onBeforeCompile}},this.getProgramCacheKey=function(t){var e=[];if(t.shaderID?e.push(t.shaderID):(e.push(t.fragmentShader),e.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)e.push(r),e.push(t.defines[r]);if(void 0===t.isRawShaderMaterial){for(r=0;r<n.length;r++)e.push(t[n[r]]);e.push(d.outputEncoding),e.push(d.gammaFactor)}return e.push(t.onBeforeCompile.toString()),e.join()},this.acquireProgram=function(t,e){for(var r,n=0,i=o.length;n<i;n++){var a=o[n];if(a.cacheKey===e){++(r=a).usedTimes;break}}return void 0===r&&(r=new me(d,e,t),o.push(r)),r},this.releaseProgram=function(t){var e;0==--t.usedTimes&&(e=o.indexOf(t),o[e]=o[o.length-1],o.pop(),t.destroy())},this.programs=o}function ve(){var n=new Bu;return{get:function(t){var e=n.get(t);return void 0===e&&(e={},n.set(t,e)),e},remove:function(t){n.delete(t)},update:function(t,e,r){n.get(t)[e]=r},dispose:function(){n=new Bu}}}function ye(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function xe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function be(){function o(t,e,r,n,i,a){var o=s[l];return void 0===o?(o={id:t.id,object:t,geometry:e,material:r,program:r.program||h,groupOrder:n,renderOrder:t.renderOrder,z:i,group:a},s[l]=o):(o.id=t.id,o.object=t,o.geometry=e,o.material=r,o.program=r.program||h,o.groupOrder=n,o.renderOrder=t.renderOrder,o.z=i,o.group=a),l++,o}var s=[],l=0,u=[],c=[],h={id:-1};return{opaque:u,transparent:c,init:function(){l=0,u.length=0,c.length=0},push:function(t,e,r,n,i,a){t=o(t,e,r,n,i,a),(!0===r.transparent?c:u).push(t)},unshift:function(t,e,r,n,i,a){t=o(t,e,r,n,i,a),(!0===r.transparent?c:u).unshift(t)},finish:function(){for(var t=l,e=s.length;t<e;t++){var r=s[t];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(t,e){1<u.length&&u.sort(t||ye),1<c.length&&c.sort(e||xe)}}}function _e(){function i(t){(t=t.target).removeEventListener("dispose",i),a.delete(t)}var a=new Bu;return{get:function(t,e){var r,n=a.get(t);return void 0===n?(r=new be,a.set(t,new Bu),a.get(t).set(e,r),t.addEventListener("dispose",i)):void 0===(r=n.get(e))&&(r=new be,n.set(e,r)),r},dispose:function(){a=new Bu}}}function Ae(){var r={};return{get:function(t){if(void 0!==r[t.id])return r[t.id];switch(t.type){case"DirectionalLight":var e={direction:new Mt,color:new U};break;case"SpotLight":e={position:new Mt,direction:new Mt,color:new U,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new Mt,color:new U,distance:0,decay:0};break;case"HemisphereLight":e={direction:new Mt,skyColor:new U,groundColor:new U};break;case"RectAreaLight":e={color:new U,position:new Mt,halfWidth:new Mt,halfHeight:new Mt}}return r[t.id]=e}}}function we(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Me(){for(var r,_=new Ae,A=(r={},{get:function(t){if(void 0!==r[t.id])return r[t.id];switch(t.type){case"DirectionalLight":var e={shadowBias:0,shadowRadius:1,shadowMapSize:new At};break;case"SpotLight":e={shadowBias:0,shadowRadius:1,shadowMapSize:new At};break;case"PointLight":e={shadowBias:0,shadowRadius:1,shadowMapSize:new At,shadowCameraNear:1,shadowCameraFar:1e3}}return r[t.id]=e}}),w={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},t=0;t<9;t++)w.probe.push(new Mt);var M=new Mt,C=new Ct,T=new Ct;return{setup:function(t,e,r){for(var n=0,i=0,a=0,o=0;o<9;o++)w.probe[o].set(0,0,0);var s=e=0,l=0,u=0,c=0,h=0,d=0,p=0;r=r.matrixWorldInverse,t.sort(we);for(var o=0,f=t.length;o<f;o++){var m,g=t[o],v=g.color,y=g.intensity,x=g.distance,b=g.shadow&&g.shadow.map?g.shadow.map.texture:null;if(g.isAmbientLight)n+=v.r*y,i+=v.g*y,a+=v.b*y;else if(g.isLightProbe)for(b=0;b<9;b++)w.probe[b].addScaledVector(g.sh.coefficients[b],y);else g.isDirectionalLight?((m=_.get(g)).color.copy(g.color).multiplyScalar(g.intensity),m.direction.setFromMatrixPosition(g.matrixWorld),M.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(M),m.direction.transformDirection(r),g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,w.directionalShadow[e]=v,w.directionalShadowMap[e]=b,w.directionalShadowMatrix[e]=g.shadow.matrix,h++),w.directional[e]=m,e++):g.isSpotLight?((m=_.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),m.color.copy(v).multiplyScalar(y),m.distance=x,m.direction.setFromMatrixPosition(g.matrixWorld),M.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(M),m.direction.transformDirection(r),m.coneCos=Math.cos(g.angle),m.penumbraCos=Math.cos(g.angle*(1-g.penumbra)),m.decay=g.decay,g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,w.spotShadow[l]=v,w.spotShadowMap[l]=b,w.spotShadowMatrix[l]=g.shadow.matrix,p++),w.spot[l]=m,l++):g.isRectAreaLight?((m=_.get(g)).color.copy(v).multiplyScalar(y),m.position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),T.identity(),C.copy(g.matrixWorld),C.premultiply(r),T.extractRotation(C),m.halfWidth.set(.5*g.width,0,0),m.halfHeight.set(0,.5*g.height,0),m.halfWidth.applyMatrix4(T),m.halfHeight.applyMatrix4(T),w.rectArea[u]=m,u++):g.isPointLight?((m=_.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),m.color.copy(g.color).multiplyScalar(g.intensity),m.distance=g.distance,m.decay=g.decay,g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,v.shadowCameraNear=y.camera.near,v.shadowCameraFar=y.camera.far,w.pointShadow[s]=v,w.pointShadowMap[s]=b,w.pointShadowMatrix[s]=g.shadow.matrix,d++),w.point[s]=m,s++):g.isHemisphereLight&&((m=_.get(g)).direction.setFromMatrixPosition(g.matrixWorld),m.direction.transformDirection(r),m.direction.normalize(),m.skyColor.copy(g.color).multiplyScalar(y),m.groundColor.copy(g.groundColor).multiplyScalar(y),w.hemi[c]=m,c++)}w.ambient[0]=n,w.ambient[1]=i,w.ambient[2]=a,(t=w.hash).directionalLength===e&&t.pointLength===s&&t.spotLength===l&&t.rectAreaLength===u&&t.hemiLength===c&&t.numDirectionalShadows===h&&t.numPointShadows===d&&t.numSpotShadows===p||(w.directional.length=e,w.spot.length=l,w.rectArea.length=u,w.point.length=s,w.hemi.length=c,w.directionalShadow.length=h,w.directionalShadowMap.length=h,w.pointShadow.length=d,w.pointShadowMap.length=d,w.spotShadow.length=p,w.spotShadowMap.length=p,w.directionalShadowMatrix.length=h,w.pointShadowMatrix.length=d,w.spotShadowMatrix.length=p,t.directionalLength=e,t.pointLength=s,t.spotLength=l,t.rectAreaLength=u,t.hemiLength=c,t.numDirectionalShadows=h,t.numPointShadows=d,t.numSpotShadows=p,w.version=od++)},state:w}}function Ce(){var e=new Me,r=[],n=[];return{init:function(){r.length=0,n.length=0},state:{lightsArray:r,shadowsArray:n,lights:e},setupLights:function(t){e.setup(r,n,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){n.push(t)}}}function Te(){function n(t){(t=t.target).removeEventListener("dispose",n),i.delete(t)}var i=new Bu;return{get:function(t,e){var r;return!1===i.has(t)?(r=new Ce,i.set(t,new Bu),i.get(t).set(e,r),t.addEventListener("dispose",n)):!1===i.get(t).has(e)?(r=new Ce,i.get(t).set(e,r)):r=i.get(t).get(e),r},dispose:function(){i=new Bu}}}function Se(t){k.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ee(t){k.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Mt,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Ie(f,m,g){function u(t,e,r){var n=i[r=t<<0|e<<1|r<<2];return void 0===n&&(n=new Se({depthPacking:3201,morphTargets:t,skinning:e}),i[r]=n),n}function c(t,e,r){var n=a[r=t<<0|e<<1|r<<2];return void 0===n&&(n=new Ee({morphTargets:t,skinning:e}),a[r]=n),n}function v(t,e,r,n,i,a,o){var s=u,l=t.customDepthMaterial;return!0===n.isPointLight&&(s=c,l=t.customDistanceMaterial),t=void 0===l?(!(l=!1)===r.morphTargets&&(l=e.morphAttributes&&e.morphAttributes.position&&0<e.morphAttributes.position.length),!(e=!1)===t.isSkinnedMesh&&(!0===r.skinning?e=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),s(l,e,!0===t.isInstancedMesh)):l,f.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length&&(l=t.uuid,s=r.uuid,void 0===(e=h[l])&&(e={},h[l]=e),void 0===(l=e[s])&&(l=t.clone(),e[s]=l),t=l),t.visible=r.visible,t.wireframe=r.wireframe,t.side=3===o?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],t.clipShadows=r.clipShadows,t.clippingPlanes=r.clippingPlanes,t.clipIntersection=r.clipIntersection,t.wireframeLinewidth=r.wireframeLinewidth,t.linewidth=r.linewidth,!0===n.isPointLight&&!0===t.isMeshDistanceMaterial&&(t.referencePosition.setFromMatrixPosition(n.matrixWorld),t.nearDistance=i,t.farDistance=a),t}var y=new Et,x=new At,b=new At,_=new wt,i=[],a=[],h={},d={0:1,1:0,2:2},A=new W({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new At},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),w=A.clone();w.defines.HORIZONAL_PASS=1;var t=new X;t.setAttribute("position",new G(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var M=new V(t,A),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,e,r){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var n=f.getRenderTarget(),i=f.getActiveCubeFace(),a=f.getActiveMipmapLevel(),o=f.state;o.setBlending(0),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var s=0,l=t.length;s<l;s++){var u=t[s],c=u.shadow;if(void 0===c)console.warn("THREE.WebGLShadowMap:",u,"has no shadow.");else{x.copy(c.mapSize);var h=c.getFrameExtents();x.multiply(h),b.copy(c.mapSize),(x.x>g||x.y>g)&&(x.x>g&&(b.x=Math.floor(g/h.x),x.x=b.x*h.x,c.mapSize.x=b.x),x.y>g&&(b.y=Math.floor(g/h.y),x.y=b.y*h.y,c.mapSize.y=b.y)),null!==c.map||c.isPointLightShadow||3!==this.type||(h={minFilter:1006,magFilter:1006,format:1023},c.map=new T(x.x,x.y,h),c.map.texture.name=u.name+".shadowMap",c.mapPass=new T(x.x,x.y,h),c.camera.updateProjectionMatrix()),null===c.map&&(h={minFilter:1003,magFilter:1003,format:1023},c.map=new T(x.x,x.y,h),c.map.texture.name=u.name+".shadowMap",c.camera.updateProjectionMatrix()),f.setRenderTarget(c.map),f.clear();for(var h=c.getViewportCount(),d=0;d<h;d++){var p=c.getViewport(d);_.set(b.x*p.x,b.y*p.y,b.x*p.z,b.y*p.w),o.viewport(_),c.updateMatrices(u,d),y=c.getFrustum(),function t(e,r,n,i,a){if(!1!==e.visible){if(e.layers.test(r.layers)&&(e.isMesh||e.isLine||e.isPoints)&&(e.castShadow||e.receiveShadow&&3===a)&&(!e.frustumCulled||y.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var o=m.update(e),s=e.material;if(Array.isArray(s))for(var l=o.groups,u=0,c=l.length;u<c;u++){var h=l[u],d=s[h.materialIndex];d&&d.visible&&(d=v(e,o,d,i,n.near,n.far,a),f.renderBufferDirect(n,null,o,d,e,h))}else s.visible&&(d=v(e,o,s,i,n.near,n.far,a),f.renderBufferDirect(n,null,o,d,e,null))}for(o=0,s=(e=e.children).length;o<s;o++)t(e[o],r,n,i,a)}}(e,r,c.camera,u,this.type)}c.isPointLightShadow||3!==this.type||(u=c,c=r,h=m.update(M),A.uniforms.shadow_pass.value=u.map.texture,A.uniforms.resolution.value=u.mapSize,A.uniforms.radius.value=u.radius,f.setRenderTarget(u.mapPass),f.clear(),f.renderBufferDirect(c,null,h,A,M,null),w.uniforms.shadow_pass.value=u.mapPass.texture,w.uniforms.resolution.value=u.mapSize,w.uniforms.radius.value=u.radius,f.setRenderTarget(u.map),f.clear(),f.renderBufferDirect(c,null,h,w,M,null))}}C.needsUpdate=!1,f.setRenderTarget(n,i,a)}}}function Le(c,r,t){function e(t,e,r){var n=new Uint8Array(4),i=c.createTexture();for(c.bindTexture(t,i),c.texParameteri(t,10241,9728),c.texParameteri(t,10240,9728),t=0;t<r;t++)c.texImage2D(e+t,0,6408,1,1,0,6408,5121,n);return i}function n(t,e){g[t]=1,0===v[t]&&(c.enableVertexAttribArray(t),v[t]=1),y[t]!==e&&((u?c:r.get("ANGLE_instanced_arrays"))[u?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),y[t]=e)}function h(t){!0!==x[t]&&(c.enable(t),x[t]=!0)}function d(t){!1!==x[t]&&(c.disable(t),x[t]=!1)}function i(t,e,r,n,i,a,o,s){if(0===t)_&&(d(3042),_=!1);else if(_||(h(3042),_=!0),5!==t){if(t!==A||s!==I){if(100===w&&100===T||(c.blendEquation(32774),T=w=100),s)switch(t){case 1:c.blendFuncSeparate(1,771,1,771);break;case 2:c.blendFunc(1,1);break;case 3:c.blendFuncSeparate(0,0,769,771);break;case 4:c.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:c.blendFuncSeparate(770,771,1,771);break;case 2:c.blendFunc(770,1);break;case 3:c.blendFunc(0,769);break;case 4:c.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}E=S=C=M=null,A=t,I=s}}else i=i||e,a=a||r,o=o||n,e===w&&i===T||(c.blendEquationSeparate(G[e],G[i]),w=e,T=i),r===M&&n===C&&a===S&&o===E||(c.blendFuncSeparate(V[r],V[n],V[a],V[o]),M=r,C=n,S=a,E=o),A=t,I=null}function a(t){L!==t&&(t?c.frontFace(2304):c.frontFace(2305),L=t)}function o(t){0!==t?(h(2884),t!==R&&(1===t?c.cullFace(1029):2===t?c.cullFace(1028):c.cullFace(1032))):d(2884),R=t}function s(t,e,r){t?(h(32823),D===e&&O===r||(c.polygonOffset(e,r),D=e,O=r)):d(32823)}function l(t){N!==(t=void 0===t?33984+F-1:t)&&(c.activeTexture(t),N=t)}var u=t.isWebGL2,p=new function(){var e=!1,a=new wt,r=null,o=new wt(0,0,0,0);return{setMask:function(t){r===t||e||(c.colorMask(t,t,t,t),r=t)},setLocked:function(t){e=t},setClear:function(t,e,r,n,i){!0===i&&(t*=n,e*=n,r*=n),a.set(t,e,r,n),!1===o.equals(a)&&(c.clearColor(t,e,r,n),o.copy(a))},reset:function(){e=!1,r=null,o.set(-1,0,0,0)}}},f=new function(){var e=!1,r=null,n=null,i=null;return{setTest:function(t){(t?h:d)(2929)},setMask:function(t){r===t||e||(c.depthMask(t),r=t)},setFunc:function(t){if(n!==t){if(t)switch(t){case 0:c.depthFunc(512);break;case 1:c.depthFunc(519);break;case 2:c.depthFunc(513);break;case 3:c.depthFunc(515);break;case 4:c.depthFunc(514);break;case 5:c.depthFunc(518);break;case 6:c.depthFunc(516);break;case 7:c.depthFunc(517);break;default:c.depthFunc(515)}else c.depthFunc(515);n=t}},setLocked:function(t){e=t},setClear:function(t){i!==t&&(c.clearDepth(t),i=t)},reset:function(){e=!1,i=n=r=null}}},m=new function(){var e=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?h:d)(2960)},setMask:function(t){r===t||e||(c.stencilMask(t),r=t)},setFunc:function(t,e,r){n===t&&i===e&&a===r||(c.stencilFunc(t,e,r),n=t,i=e,a=r)},setOp:function(t,e,r){o===t&&s===e&&l===r||(c.stencilOp(t,e,r),o=t,s=e,l=r)},setLocked:function(t){e=t},setClear:function(t){u!==t&&(c.clearStencil(t),u=t)},reset:function(){e=!1,u=l=s=o=a=i=n=r=null}}};t=c.getParameter(34921);var g=new Uint8Array(t),v=new Uint8Array(t),y=new Uint8Array(t),x={},b=null,_=null,A=null,w=null,M=null,C=null,T=null,S=null,E=null,I=!1,L=null,R=null,P=null,D=null,O=null,F=c.getParameter(35661),B=!1;t=0,-1!==(t=c.getParameter(7938)).indexOf("WebGL")?(t=parseFloat(/^WebGL ([0-9])/.exec(t)[1]),B=1<=t):-1!==t.indexOf("OpenGL ES")&&(t=parseFloat(/^OpenGL ES ([0-9])/.exec(t)[1]),B=2<=t);var N=null,z={},U=new wt,k=new wt,H={};H[3553]=e(3553,3553,1),H[34067]=e(34067,34069,6),p.setClear(0,0,0,1),f.setClear(1),m.setClear(0),h(2929),f.setFunc(3),a(!1),o(1),h(2884),i(0);var G=(Su(t={},100,32774),Su(t,101,32778),Su(t,102,32779),t);u?(G[103]=32775,G[104]=32776):null!==(t=r.get("EXT_blend_minmax"))&&(G[103]=t.MIN_EXT,G[104]=t.MAX_EXT);var V=(Su(t={},200,0),Su(t,201,1),Su(t,202,768),Su(t,204,770),Su(t,210,776),Su(t,208,774),Su(t,206,772),Su(t,203,769),Su(t,205,771),Su(t,209,775),Su(t,207,773),t);return{buffers:{color:p,depth:f,stencil:m},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(t){n(t,0)},enableAttributeAndDivisor:n,disableUnusedAttributes:function(){for(var t=0,e=v.length;t!==e;++t)v[t]!==g[t]&&(c.disableVertexAttribArray(t),v[t]=0)},vertexAttribPointer:function(t,e,r,n,i,a){!0!==u||5124!==r&&5125!==r?c.vertexAttribPointer(t,e,r,n,i,a):c.vertexAttribIPointer(t,e,r,n,i,a)},enable:h,disable:d,useProgram:function(t){return b!==t&&(c.useProgram(t),b=t,!0)},setBlending:i,setMaterial:function(t,e){(2===t.side?d:h)(2884);var r=1===t.side;a(r=e?!r:r),1===t.blending&&!1===t.transparent?i(0):i(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),f.setFunc(t.depthFunc),f.setTest(t.depthTest),f.setMask(t.depthWrite),p.setMask(t.colorWrite),e=t.stencilWrite,m.setTest(e),e&&(m.setMask(t.stencilWriteMask),m.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),m.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),s(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:a,setCullFace:o,setLineWidth:function(t){t!==P&&(B&&c.lineWidth(t),P=t)},setPolygonOffset:s,setScissorTest:function(t){(t?h:d)(3089)},activeTexture:l,bindTexture:function(t,e){null===N&&l();var r=z[N];void 0===r&&(r={type:void 0,texture:void 0},z[N]=r),r.type===t&&r.texture===e||(c.bindTexture(t,e||H[t]),r.type=t,r.texture=e)},unbindTexture:function(){var t=z[N];void 0!==t&&void 0!==t.type&&(c.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{c.compressedTexImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{c.texImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{c.texImage3D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===U.equals(t)&&(c.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===k.equals(t)&&(c.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){for(var t=0;t<v.length;t++)1===v[t]&&(c.disableVertexAttribArray(t),v[t]=0);x={},z={},R=L=A=b=N=null,p.reset(),f.reset(),m.reset()}}}function Re(p,n,f,m,i,g,s){function a(t,e){return D?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function v(t,e,r,n){var i=1;if((i=t.width>n||t.height>n?n/Math.max(t.width,t.height):i)<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return e=(n=e?Qu.floorPowerOfTwo:Math.floor)(i*t.width),i=n(i*t.height),void 0===S&&(S=a(e,i)),(r=r?a(e,i):S).width=e,r.height=i,r.getContext("2d").drawImage(t,0,0,e,i),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+e+"x"+i+")."),r;"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function y(t){return Qu.isPowerOfTwo(t.width)&&Qu.isPowerOfTwo(t.height)}function x(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function b(t,e,r,n){p.generateMipmap(t),m.get(e).__maxMipLevel=Math.log(Math.max(r,n))*Math.LOG2E}function _(t,e,r){if(!1===E)return e;if(null!==t){if(void 0!==p[t])return p[t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+t+"'")}return 6403===(t=e)&&(5126===r&&(t=33326),5131===r&&(t=33325),5121===r&&(t=33321)),6407===e&&(5126===r&&(t=34837),5131===r&&(t=34843),5121===r&&(t=32849)),6408===e&&(5126===r&&(t=34836),5131===r&&(t=34842),5121===r&&(t=32856)),33325!==t&&33326!==t&&34842!==t&&34836!==t||n.get("EXT_color_buffer_float"),t}function o(t){return 1003===t||1004===t||1005===t?9728:9729}function r(t){(t=t.target).removeEventListener("dispose",r);var e=m.get(t);void 0!==e.__webglInit&&(p.deleteTexture(e.__webglTexture),m.remove(t)),t.isVideoTexture&&P.delete(t),s.memory.textures--}function l(t){(t=t.target).removeEventListener("dispose",l);var e=m.get(t),r=m.get(t.texture);if(t){if(void 0!==r.__webglTexture&&p.deleteTexture(r.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(r=0;r<6;r++)p.deleteFramebuffer(e.__webglFramebuffer[r]),e.__webglDepthbuffer&&p.deleteRenderbuffer(e.__webglDepthbuffer[r]);else p.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&p.deleteRenderbuffer(e.__webglDepthbuffer),e.__webglMultisampledFramebuffer&&p.deleteFramebuffer(e.__webglMultisampledFramebuffer),e.__webglColorRenderbuffer&&p.deleteRenderbuffer(e.__webglColorRenderbuffer),e.__webglDepthRenderbuffer&&p.deleteRenderbuffer(e.__webglDepthRenderbuffer);m.remove(t.texture),m.remove(t)}s.memory.textures--}function u(t,e){var r,n=m.get(t);if(t.isVideoTexture&&(r=s.render.frame,P.get(t)!==r&&(P.set(t,r),t.update())),0<t.version&&n.__version!==t.version)if(void 0===(r=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==r.complete)return void d(n,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}f.activeTexture(33984+e),f.bindTexture(3553,n.__webglTexture)}function c(t,e){if(6===t.image.length){var r=m.get(t);if(0<t.version&&r.__version!==t.version){w(r,t),f.activeTexture(33984+e),f.bindTexture(34067,r.__webglTexture),p.pixelStorei(37440,t.flipY);var n=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture);e=t.image[0]&&t.image[0].isDataTexture;for(var i=[],a=0;a<6;a++)i[a]=n||e?e?t.image[a].image:t.image[a]:v(t.image[a],!1,!0,I);var o=i[0],s=y(o)||E,l=g.convert(t.format),u=g.convert(t.type),c=_(t.internalFormat,l,u);if(A(34067,t,s),n){for(a=0;a<6;a++)for(var h=i[a].mipmaps,n=0;n<h.length;n++){var d=h[n];1023!==t.format&&1022!==t.format?null!==l?f.compressedTexImage2D(34069+a,n,c,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):f.texImage2D(34069+a,n,c,d.width,d.height,0,l,u,d.data)}r.__maxMipLevel=h.length-1}else{for(h=t.mipmaps,a=0;a<6;a++)if(e)for(f.texImage2D(34069+a,0,c,i[a].width,i[a].height,0,l,u,i[a].data),n=0;n<h.length;n++)d=(d=h[n]).image[a].image,f.texImage2D(34069+a,n+1,c,d.width,d.height,0,l,u,d.data);else for(f.texImage2D(34069+a,0,c,l,u,i[a]),n=0;n<h.length;n++)d=h[n],f.texImage2D(34069+a,n+1,c,l,u,d.image[a]);r.__maxMipLevel=h.length}x(t,s)&&b(34067,t,o.width,o.height),r.__version=t.version,t.onUpdate&&t.onUpdate(t)}else f.activeTexture(33984+e),f.bindTexture(34067,r.__webglTexture)}}function h(t,e){f.activeTexture(33984+e),f.bindTexture(34067,m.get(t).__webglTexture)}function A(t,e,r){r?(p.texParameteri(t,10242,F[e.wrapS]),p.texParameteri(t,10243,F[e.wrapT]),32879!==t&&35866!==t||p.texParameteri(t,32882,F[e.wrapR]),p.texParameteri(t,10240,B[e.magFilter]),p.texParameteri(t,10241,B[e.minFilter])):(p.texParameteri(t,10242,33071),p.texParameteri(t,10243,33071),32879!==t&&35866!==t||p.texParameteri(t,32882,33071),1001===e.wrapS&&1001===e.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),p.texParameteri(t,10240,o(e.magFilter)),p.texParameteri(t,10241,o(e.minFilter)),1003!==e.minFilter&&1006!==e.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(r=n.get("EXT_texture_filter_anisotropic"))||1015===e.type&&null===n.get("OES_texture_float_linear")||1016===e.type&&null===(E||n.get("OES_texture_half_float_linear"))||!(1<e.anisotropy||m.get(e).__currentAnisotropy)||(p.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,i.getMaxAnisotropy())),m.get(e).__currentAnisotropy=e.anisotropy)}function w(t,e){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",r),t.__webglTexture=p.createTexture(),s.memory.textures++)}function d(t,e,r){var n=3553;e.isDataTexture2DArray&&(n=35866),e.isDataTexture3D&&(n=32879),w(t,e),f.activeTexture(33984+r),f.bindTexture(n,t.__webglTexture),p.pixelStorei(37440,e.flipY),p.pixelStorei(37441,e.premultiplyAlpha),p.pixelStorei(3317,e.unpackAlignment),r=(r=!E&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter))&&!1===y(e.image);var i=y(r=v(e.image,r,!1,L))||E,a=g.convert(e.format),o=g.convert(e.type),s=_(e.internalFormat,a,o);A(n,e,i);var l=e.mipmaps;if(e.isDepthTexture)s=6402,E?s=1015===e.type?36012:1014===e.type?33190:1020===e.type?35056:33189:1015===e.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===e.format&&6402===s&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,o=g.convert(e.type)),1027===e.format&&6402===s&&(s=34041,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,o=g.convert(e.type))),f.texImage2D(3553,0,s,r.width,r.height,0,a,o,null);else if(e.isDataTexture)if(0<l.length&&i){for(var u=0,c=l.length;u<c;u++){var h=l[u];f.texImage2D(3553,u,s,h.width,h.height,0,a,o,h.data)}e.generateMipmaps=!1,t.__maxMipLevel=l.length-1}else f.texImage2D(3553,0,s,r.width,r.height,0,a,o,r.data),t.__maxMipLevel=0;else if(e.isCompressedTexture){for(u=0,c=l.length;u<c;u++)h=l[u],1023!==e.format&&1022!==e.format?null!==a?f.compressedTexImage2D(3553,u,s,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):f.texImage2D(3553,u,s,h.width,h.height,0,a,o,h.data);t.__maxMipLevel=l.length-1}else if(e.isDataTexture2DArray)f.texImage3D(35866,0,s,r.width,r.height,r.depth,0,a,o,r.data),t.__maxMipLevel=0;else if(e.isDataTexture3D)f.texImage3D(32879,0,s,r.width,r.height,r.depth,0,a,o,r.data),t.__maxMipLevel=0;else if(0<l.length&&i){for(u=0,c=l.length;u<c;u++)h=l[u],f.texImage2D(3553,u,s,a,o,h);e.generateMipmaps=!1,t.__maxMipLevel=l.length-1}else f.texImage2D(3553,0,s,a,o,r),t.__maxMipLevel=0;x(e,i)&&b(n,e,r.width,r.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function M(t,e,r,n){var i=g.convert(e.texture.format),a=g.convert(e.texture.type),o=_(e.texture.internalFormat,i,a);f.texImage2D(n,0,o,e.width,e.height,0,i,a,null),p.bindFramebuffer(36160,t),p.framebufferTexture2D(36160,r,n,m.get(e.texture).__webglTexture,0),p.bindFramebuffer(36160,null)}function C(t,e,r){var n;p.bindRenderbuffer(36161,t),e.depthBuffer&&!e.stencilBuffer?(n=33189,r?((r=e.depthTexture)&&r.isDepthTexture&&(1015===r.type?n=36012:1014===r.type&&(n=33190)),r=T(e),p.renderbufferStorageMultisample(36161,r,n,e.width,e.height)):p.renderbufferStorage(36161,n,e.width,e.height),p.framebufferRenderbuffer(36160,36096,36161,t)):e.depthBuffer&&e.stencilBuffer?(r?(r=T(e),p.renderbufferStorageMultisample(36161,r,35056,e.width,e.height)):p.renderbufferStorage(36161,34041,e.width,e.height),p.framebufferRenderbuffer(36160,33306,36161,t)):(t=g.convert(e.texture.format),n=g.convert(e.texture.type),n=_(e.texture.internalFormat,t,n),r?(r=T(e),p.renderbufferStorageMultisample(36161,r,n,e.width,e.height)):p.renderbufferStorage(36161,n,e.width,e.height)),p.bindRenderbuffer(36161,null)}function T(t){return E&&t.isWebGLMultisampleRenderTarget?Math.min(R,t.samples):0}var t,S,E=i.isWebGL2,e=i.maxTextures,I=i.maxCubemapSize,L=i.maxTextureSize,R=i.maxSamples,P=new Bu,D=!1;try{D="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}var O=0,F=(Su(t={},1e3,10497),Su(t,1001,33071),Su(t,1002,33648),t),B=(Su(t={},1003,9728),Su(t,1004,9984),Su(t,1005,9986),Su(t,1006,9729),Su(t,1007,9985),Su(t,1008,9987),t),N=!1,z=!1;this.allocateTextureUnit=function(){var t=O;return e<=t&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+e),O+=1,t},this.resetTextureUnits=function(){O=0},this.setTexture2D=u,this.setTexture2DArray=function(t,e){var r=m.get(t);0<t.version&&r.__version!==t.version?d(r,t,e):(f.activeTexture(33984+e),f.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){var r=m.get(t);0<t.version&&r.__version!==t.version?d(r,t,e):(f.activeTexture(33984+e),f.bindTexture(32879,r.__webglTexture))},this.setTextureCube=c,this.setTextureCubeDynamic=h,this.setupRenderTarget=function(t){var e=m.get(t),r=m.get(t.texture);t.addEventListener("dispose",l),r.__webglTexture=p.createTexture(),s.memory.textures++;var n,i=!0===t.isWebGLCubeRenderTarget,a=!0===t.isWebGLMultisampleRenderTarget,o=y(t)||E;if(!E||1022!==t.texture.format||1015!==t.texture.type&&1016!==t.texture.type||(t.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),i)for(e.__webglFramebuffer=[],a=0;a<6;a++)e.__webglFramebuffer[a]=p.createFramebuffer();else e.__webglFramebuffer=p.createFramebuffer(),a&&(E?(e.__webglMultisampledFramebuffer=p.createFramebuffer(),e.__webglColorRenderbuffer=p.createRenderbuffer(),p.bindRenderbuffer(36161,e.__webglColorRenderbuffer),a=g.convert(t.texture.format),n=g.convert(t.texture.type),a=_(t.texture.internalFormat,a,n),n=T(t),p.renderbufferStorageMultisample(36161,n,a,t.width,t.height),p.bindFramebuffer(36160,e.__webglMultisampledFramebuffer),p.framebufferRenderbuffer(36160,36064,36161,e.__webglColorRenderbuffer),p.bindRenderbuffer(36161,null),t.depthBuffer&&(e.__webglDepthRenderbuffer=p.createRenderbuffer(),C(e.__webglDepthRenderbuffer,t,!0)),p.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(i){for(f.bindTexture(34067,r.__webglTexture),A(34067,t.texture,o),a=0;a<6;a++)M(e.__webglFramebuffer[a],t,36064,34069+a);x(t.texture,o)&&b(34067,t.texture,t.width,t.height),f.bindTexture(34067,null)}else f.bindTexture(3553,r.__webglTexture),A(3553,t.texture,o),M(e.__webglFramebuffer,t,36064,3553),x(t.texture,o)&&b(3553,t.texture,t.width,t.height),f.bindTexture(3553,null);if(t.depthBuffer){if(e=m.get(t),r=!0===t.isWebGLCubeRenderTarget,t.depthTexture){if(r)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(p.bindFramebuffer(36160,e.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(m.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),u(t.depthTexture,0),e=m.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)p.framebufferTexture2D(36160,36096,3553,e,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");p.framebufferTexture2D(36160,33306,3553,e,0)}}else if(r)for(e.__webglDepthbuffer=[],r=0;r<6;r++)p.bindFramebuffer(36160,e.__webglFramebuffer[r]),e.__webglDepthbuffer[r]=p.createRenderbuffer(),C(e.__webglDepthbuffer[r],t,!1);else p.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=p.createRenderbuffer(),C(e.__webglDepthbuffer,t,!1);p.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(t){var e,r=t.texture,n=y(t)||E;x(r,n)&&(n=t.isWebGLCubeRenderTarget?34067:3553,e=m.get(r).__webglTexture,f.bindTexture(n,e),b(n,r,t.width,t.height),f.bindTexture(n,null))},this.updateMultisampleRenderTarget=function(t){var e,r,n,i;t.isWebGLMultisampleRenderTarget&&(E?(e=m.get(t),p.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),p.bindFramebuffer(36009,e.__webglFramebuffer),r=t.width,n=t.height,i=16384,t.depthBuffer&&(i|=256),t.stencilBuffer&&(i|=1024),p.blitFramebuffer(0,0,r,n,0,0,r,n,i,9728),p.bindFramebuffer(36160,e.__webglMultisampledFramebuffer)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),N=!0),t=t.texture),u(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),(t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?c:h)(t,e)}}function Pe(t,r,e){var n=e.isWebGL2;return{convert:function(t){if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t){if(n)return 5131;var e=r.get("OES_texture_half_float");return null!==e?e.HALF_FLOAT_OES:null}if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(e=r.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(e=r.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return null!==(e=r.get("WEBGL_compressed_texture_etc1"))?e.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(e=r.get("WEBGL_compressed_texture_etc"),null!==e)){if(37492===t)return e.COMPRESSED_RGB8_ETC2;if(37496===t)return e.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(e=r.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(e=r.get("EXT_texture_compression_bptc"))?t:null:1020===t?n?34042:null!==(e=r.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function De(t){q.call(this),this.cameras=t||[]}function Oe(){B.call(this),this.type="Group"}function Fe(){this._grip=this._targetRay=null}function Be(u,e){function r(t){var e=m.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function n(){m.forEach(function(t,e){t.disconnect(e)}),m.clear(),u.setFramebuffer(null),u.setRenderTarget(u.getRenderTarget()),C.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}function i(t){p=t,C.setContext(d),C.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}function a(t){for(var e=d.inputSources,r=0;r<f.length;r++)m.set(e[r],f[r]);for(r=0;r<t.removed.length;r++){var e=t.removed[r],n=m.get(e);n&&(n.dispatchEvent({type:"disconnected",data:e}),m.delete(e))}for(r=0;r<t.added.length;r++)e=t.added[r],(n=m.get(e))&&n.dispatchEvent({type:"connected",data:e})}function c(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}var h,o=this,d=null,s=1,p=null,l="local-floor",f=[],m=new Fu,g=new q;g.layers.enable(1),g.viewport=new wt;var v=new q;v.layers.enable(2),v.viewport=new wt;var y=[g,v],x=new De;x.layers.enable(1),x.layers.enable(2);var b=null,_=null;this.isPresenting=this.enabled=!1,this.getController=function(t){var e=f[t];return void 0===e&&(e=new Fe,f[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=f[t];return void 0===e&&(e=new Fe,f[t]=e),e.getGripSpace()},this.setFramebufferScaleFactor=function(t){s=t,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){l=t,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p},this.getSession=function(){return d},this.setSession=function(t){null!==(d=t)&&(d.addEventListener("select",r),d.addEventListener("selectstart",r),d.addEventListener("selectend",r),d.addEventListener("squeeze",r),d.addEventListener("squeezestart",r),d.addEventListener("squeezeend",r),d.addEventListener("end",n),!0!==(t=e.getContextAttributes()).xrCompatible&&e.makeXRCompatible(),t=new XRWebGLLayer(d,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:s}),d.updateRenderState({baseLayer:t}),d.requestReferenceSpace(l).then(i),d.addEventListener("inputsourceschange",a))};var A=new Mt,w=new Mt;this.getCamera=function(t){x.near=v.near=g.near=t.near,x.far=v.far=g.far=t.far,b===x.near&&_===x.far||(d.updateRenderState({depthNear:x.near,depthFar:x.far}),b=x.near,_=x.far);var e=t.parent,r=x.cameras;c(x,e);for(var n,i,a,o,s,l=0;l<r.length;l++)c(r[l],e);for(t.matrixWorld.copy(x.matrixWorld),l=0,e=(t=t.children).length;l<e;l++)t[l].updateMatrixWorld(!0);return 2===r.length?(A.setFromMatrixPosition(g.matrixWorld),w.setFromMatrixPosition(v.matrixWorld),r=A.distanceTo(w),a=g.projectionMatrix.elements,i=v.projectionMatrix.elements,n=a[14]/(a[10]-1),l=a[14]/(a[10]+1),t=(a[9]+1)/a[5],e=(a[9]-1)/a[5],s=(a[8]-1)/a[0],o=(i[8]+1)/i[0],i=n*s,a=n*o,s=(o=r/(o-s))*-s,g.matrixWorld.decompose(x.position,x.quaternion,x.scale),x.translateX(s),x.translateZ(o),x.matrixWorld.compose(x.position,x.quaternion,x.scale),x.matrixWorldInverse.getInverse(x.matrixWorld),n+=o,o=l+o,x.projectionMatrix.makePerspective(i-s,r-s+a,t*l/o*n,e*l/o*n,n,o)):x.projectionMatrix.copy(g.projectionMatrix),x};var M=null,C=new It;C.setAnimationLoop(function(t,e){if(null!==(h=e.getViewerPose(p))){var r=h.views,n=d.renderState.baseLayer;u.setFramebuffer(n.framebuffer);var i=!1;r.length!==x.cameras.length&&(i=!(x.cameras.length=0));for(var a=0;a<r.length;a++){var o=r[a],s=n.getViewport(o),l=y[a];l.matrix.fromArray(o.transform.matrix),l.projectionMatrix.fromArray(o.projectionMatrix),l.viewport.set(s.x,s.y,s.width,s.height),0===a&&x.matrix.copy(l.matrix),!0===i&&x.cameras.push(l)}}for(r=d.inputSources,a=0;a<f.length;a++)f[a].update(r[a],e,p);M&&M(t,e)}),this.setAnimationLoop=function(t){M=t},this.dispose=function(){}}function Ne(a){function s(t,e,r){var n,i;t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),(r=e.envMap||r)&&(t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=a.get(r).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(!0===(i=i.isWebGLRenderTarget?i.texture:i).matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function l(t,e,r){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||r)&&(t.envMapIntensity.value=e.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,e,r,n,i){var a,o;e.isMeshBasicMaterial?s(t,e):e.isMeshLambertMaterial?(s(t,e),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)):e.isMeshToonMaterial?(s(t,e),t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshPhongMaterial?(s(t,e),t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshStandardMaterial?(s(t,e,r),e.isMeshPhysicalMaterial?(l(t,e,r),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transparency.value=e.transparency):l(t,e,r)):e.isMeshMatcapMaterial?(s(t,e),e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshDepthMaterial?(s(t,e),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshDistanceMaterial?(s(t,e),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance):e.isMeshNormalMaterial?(s(t,e),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isLineBasicMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.isLineDashedMaterial&&(t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale)):e.isPointsMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?a=e.map:e.alphaMap&&(a=e.alphaMap),void 0!==a&&(!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uvTransform.value.copy(a.matrix))):e.isSpriteMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?o=e.map:e.alphaMap&&(o=e.alphaMap),void 0!==o&&(!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uvTransform.value.copy(o.matrix))):e.isShadowMaterial?(t.color.value.copy(e.color),t.opacity.value=e.opacity):e.isShaderMaterial&&(e.uniformsNeedUpdate=!1)}}}function ze(t){var A;function e(){M=new Ft(gt),!1===(C=new Dt(gt,M,t)).isWebGL2&&(M.get("WEBGL_depth_texture"),M.get("OES_texture_float"),M.get("OES_texture_half_float"),M.get("OES_texture_half_float_linear"),M.get("OES_standard_derivatives"),M.get("OES_element_index_uint"),M.get("ANGLE_instanced_arrays")),M.get("OES_texture_float_linear"),k=new Pe(0,M,C),(T=new Le(gt,M,C)).scissor(tt.copy(lt).multiplyScalar(it).floor()),T.viewport($.copy(st).multiplyScalar(it).floor()),_=new zt,S=new ve,E=new Re(gt,M,T,S,C,k,_),I=new Lt(gt,C),L=new Bt(0,I,_),R=new kt(0,L,I,_),N=new Ut(gt),P=new ge(H,M,C),D=new Ne(S),O=new _e,F=new Te,B=new Rt(H,T,R,p),z=new Pt(gt,M,_,C),U=new Nt(gt,M,_,C),_.programs=P.programs,H.capabilities=C,H.extensions=M,H.properties=S,H.renderLists=O,H.state=T,H.info=_}function r(t){t.preventDefault(),G=!0}function n(){G=!1,e()}function u(t){(t=t.target).removeEventListener("dispose",u),c(t),S.remove(t)}function c(t){var e=S.get(t).program;(t.program=void 0)!==e&&P.releaseProgram(e)}function o(t,e,r,n){for(var i=0,a=t.length;i<a;i++){var o=(u=t[i]).object,s=u.geometry,l=void 0===n?u.material:n,u=u.group;if(r.isArrayCamera)for(var c=(Q=r).cameras,h=0,d=c.length;h<d;h++){var p=c[h];o.layers.test(p.layers)&&(T.viewport($.copy(p.viewport)),b.setupLights(p),f(o,e,p,s,l,u))}else Q=null,f(o,e,r,s,l,u)}}function f(t,e,r,n,i,a){var o,s;t.onBeforeRender(H,e,r,n,i,a),b=F.get(e,Q||r),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(o=w(r,e,i,t),T.setMaterial(i),Z=A=null,J=!1,s=o,t.render(function(t){H.renderBufferImmediate(t,s)})):H.renderBufferDirect(r,e,n,i,t,a),t.onAfterRender(H,e,r,n,i,a),b=F.get(e,Q||r)}function m(t,e,r){var n=S.get(t),i=b.state.lights,a=i.state.version;r=P.getParameters(t,i.state,b.state.shadowsArray,e,ht.numPlanes,ht.numIntersection,r);var o=P.getProgramCacheKey(r),s=n.program,l=!0;if(void 0===s)t.addEventListener("dispose",u);else if(s.cacheKey!==o)c(t);else{if(n.lightsStateVersion!==a)n.lightsStateVersion=a;else if(void 0!==r.shaderID)return;l=!1}if(l&&(s=P.acquireProgram(r,o),n.program=s,n.uniforms=r.uniforms,n.outputEncoding=r.outputEncoding,t.program=s),r=s.getAttributes(),t.morphTargets)for(o=t.numSupportedMorphTargets=0;o<H.maxMorphTargets;o++)0<=r["morphTarget"+o]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(o=t.numSupportedMorphNormals=0;o<H.maxMorphNormals;o++)0<=r["morphNormal"+o]&&t.numSupportedMorphNormals++;r=n.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=ht.numPlanes,n.numIntersection=ht.numIntersection,r.clippingPlanes=ht.uniform),n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.needsLights=t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights,n.lightsStateVersion=a,n.needsLights&&(r.ambientLightColor.value=i.state.ambient,r.lightProbe.value=i.state.probe,r.directionalLights.value=i.state.directional,r.directionalLightShadows.value=i.state.directionalShadow,r.spotLights.value=i.state.spot,r.spotLightShadows.value=i.state.spotShadow,r.rectAreaLights.value=i.state.rectArea,r.pointLights.value=i.state.point,r.pointLightShadows.value=i.state.pointShadow,r.hemisphereLights.value=i.state.hemi,r.directionalShadowMap.value=i.state.directionalShadowMap,r.directionalShadowMatrix.value=i.state.directionalShadowMatrix,r.spotShadowMap.value=i.state.spotShadowMap,r.spotShadowMatrix.value=i.state.spotShadowMatrix,r.pointShadowMap.value=i.state.pointShadowMap,r.pointShadowMatrix.value=i.state.pointShadowMatrix),t=n.program.getUniforms(),t=ne.seqWithValue(t.seq,r),n.uniformsList=t}function w(t,e,r,n){E.resetTextureUnits();var i=e.fog,a=r.isMeshStandardMaterial?e.environment:null,o=null===X?H.outputEncoding:X.texture.encoding,s=S.get(r),l=b.state.lights;dt&&(pt||t!==K)&&ht.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,t,s,t===K&&r.id===Y),r.version===s.__version?(void 0===s.program||r.fog&&s.fog!==i||s.environment!==a||s.needsLights&&s.lightsStateVersion!==l.state.version||void 0!==s.numClippingPlanes&&(s.numClippingPlanes!==ht.numPlanes||s.numIntersection!==ht.numIntersection)||s.outputEncoding!==o)&&m(r,e,n):(m(r,e,n),s.__version=r.version);var u,c,h=!1,d=!1,p=!1,o=(e=s.program).getUniforms(),l=s.uniforms;return T.useProgram(e.program)&&(p=d=h=!0),r.id!==Y&&(Y=r.id,d=!0),!h&&K===t||(o.setValue(gt,"projectionMatrix",t.projectionMatrix),C.logarithmicDepthBuffer&&o.setValue(gt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),K!==t&&(K=t,p=d=!0),!(r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap)||void 0!==(h=o.map.cameraPosition)&&h.setValue(gt,mt.setFromMatrixPosition(t.matrixWorld)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&o.setValue(gt,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&o.setValue(gt,"viewMatrix",t.matrixWorldInverse)),r.skinning&&(o.setOptional(gt,n,"bindMatrix"),o.setOptional(gt,n,"bindMatrixInverse"),t=n.skeleton)&&(h=t.bones,C.floatVertexTextures?(void 0===t.boneTexture&&(h=Math.sqrt(4*h.length),h=Qu.ceilPowerOfTwo(h),h=Math.max(h,4),(u=new Float32Array(h*h*4)).set(t.boneMatrices),c=new St(u,h,h,1023,1015),t.boneMatrices=u,t.boneTexture=c,t.boneTextureSize=h),o.setValue(gt,"boneTexture",t.boneTexture,E),o.setValue(gt,"boneTextureSize",t.boneTextureSize)):o.setOptional(gt,t,"boneMatrices")),!d&&s.receiveShadow===n.receiveShadow||(s.receiveShadow=n.receiveShadow,o.setValue(gt,"receiveShadow",n.receiveShadow)),d&&(o.setValue(gt,"toneMappingExposure",H.toneMappingExposure),o.setValue(gt,"toneMappingWhitePoint",H.toneMappingWhitePoint),s.needsLights&&(d=p,l.ambientLightColor.needsUpdate=d,l.lightProbe.needsUpdate=d,l.directionalLights.needsUpdate=d,l.directionalLightShadows.needsUpdate=d,l.pointLights.needsUpdate=d,l.pointLightShadows.needsUpdate=d,l.spotLights.needsUpdate=d,l.spotLightShadows.needsUpdate=d,l.rectAreaLights.needsUpdate=d,l.hemisphereLights.needsUpdate=d),i&&r.fog&&D.refreshFogUniforms(l,i),D.refreshMaterialUniforms(l,r,a,it,nt),void 0!==l.ltc_1&&(l.ltc_1.value=Vh.LTC_1),void 0!==l.ltc_2&&(l.ltc_2.value=Vh.LTC_2),ne.upload(gt,s.uniformsList,l,E)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ne.upload(gt,s.uniformsList,l,E),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&o.setValue(gt,"center",n.center),o.setValue(gt,"modelViewMatrix",n.modelViewMatrix),o.setValue(gt,"normalMatrix",n.normalMatrix),o.setValue(gt,"modelMatrix",n.matrixWorld),e}var i=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),a=void 0!==t.context?t.context:null,s=void 0!==t.alpha&&t.alpha,l=void 0===t.depth||t.depth,h=void 0===t.stencil||t.stencil,d=void 0!==t.antialias&&t.antialias,p=void 0===t.premultipliedAlpha||t.premultipliedAlpha,g=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,v=void 0!==t.powerPreference?t.powerPreference:"default",y=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,x=null,b=null;this.domElement=i,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var M,C,T,_,S,E,I,L,R,P,D,O,F,B,N,z,U,k,H=this,G=!1,V=null,W=0,j=0,X=null,q=null,Y=-1,Z=A=null,J=!1,K=null,Q=null,$=new wt,tt=new wt,et=null,rt=i.width,nt=i.height,it=1,at=null,ot=null,st=new wt(0,0,rt,nt),lt=new wt(0,0,rt,nt),ut=!1,ct=new Et,ht=new Ot,dt=!1,pt=!1,ft=new Ct,mt=new Mt;try{s={alpha:s,depth:l,stencil:h,antialias:d,premultipliedAlpha:p,preserveDrawingBuffer:g,powerPreference:v,failIfMajorPerformanceCaveat:y},i.addEventListener("webglcontextlost",r,!1),i.addEventListener("webglcontextrestored",n,!1);var gt=a||i.getContext("webgl",s)||i.getContext("experimental-webgl",s);if(null===gt){if(null!==i.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===gt.getShaderPrecisionFormat&&(gt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}e();var vt=new Be(H,gt);this.xr=vt;var yt=new Ie(H,R,C.maxTextureSize);this.shadowMap=yt,this.getContext=function(){return gt},this.getContextAttributes=function(){return gt.getContextAttributes()},this.forceContextLoss=function(){var t=M.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=M.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return it},this.setPixelRatio=function(t){void 0!==t&&(it=t,this.setSize(rt,nt,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new At),t.set(rt,nt)},this.setSize=function(t,e,r){vt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(rt=t,nt=e,i.width=Math.floor(t*it),i.height=Math.floor(e*it),!1!==r&&(i.style.width=t+"px",i.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new At),t.set(rt*it,nt*it).floor()},this.setDrawingBufferSize=function(t,e,r){rt=t,nt=e,it=r,i.width=Math.floor(t*r),i.height=Math.floor(e*r),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new wt),t.copy($)},this.getViewport=function(t){return t.copy(st)},this.setViewport=function(t,e,r,n){t.isVector4?st.set(t.x,t.y,t.z,t.w):st.set(t,e,r,n),T.viewport($.copy(st).multiplyScalar(it).floor())},this.getScissor=function(t){return t.copy(lt)},this.setScissor=function(t,e,r,n){t.isVector4?lt.set(t.x,t.y,t.z,t.w):lt.set(t,e,r,n),T.scissor(tt.copy(lt).multiplyScalar(it).floor())},this.getScissorTest=function(){return ut},this.setScissorTest=function(t){T.setScissorTest(ut=t)},this.setOpaqueSort=function(t){at=t},this.setTransparentSort=function(t){ot=t},this.getClearColor=function(){return B.getClearColor()},this.setClearColor=function(){B.setClearColor.apply(B,arguments)},this.getClearAlpha=function(){return B.getClearAlpha()},this.setClearAlpha=function(){B.setClearAlpha.apply(B,arguments)},this.clear=function(t,e,r){var n=0;void 0!==t&&!t||(n|=16384),void 0!==e&&!e||(n|=256),void 0!==r&&!r||(n|=1024),gt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",r,!1),i.removeEventListener("webglcontextrestored",n,!1),O.dispose(),F.dispose(),S.dispose(),R.dispose(),vt.dispose(),_t.stop()},this.renderBufferImmediate=function(t,e){T.initAttributes();var r=S.get(t);t.hasPositions&&!r.position&&(r.position=gt.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=gt.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=gt.createBuffer()),t.hasColors&&!r.color&&(r.color=gt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(gt.bindBuffer(34962,r.position),gt.bufferData(34962,t.positionArray,35048),T.enableAttribute(e.position),gt.vertexAttribPointer(e.position,3,5126,!1,0,0)),t.hasNormals&&(gt.bindBuffer(34962,r.normal),gt.bufferData(34962,t.normalArray,35048),T.enableAttribute(e.normal),gt.vertexAttribPointer(e.normal,3,5126,!1,0,0)),t.hasUvs&&(gt.bindBuffer(34962,r.uv),gt.bufferData(34962,t.uvArray,35048),T.enableAttribute(e.uv),gt.vertexAttribPointer(e.uv,2,5126,!1,0,0)),t.hasColors&&(gt.bindBuffer(34962,r.color),gt.bufferData(34962,t.colorArray,35048),T.enableAttribute(e.color),gt.vertexAttribPointer(e.color,3,5126,!1,0,0)),T.disableUnusedAttributes(),gt.drawArrays(4,0,t.count),t.count=0};var xt=new Tt;this.renderBufferDirect=function(t,e,r,n,i,a){null===e&&(e=xt);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=w(t,e,n,i);T.setMaterial(n,o);var l=!1;if(A===r.id&&Z===s.id&&J===(!0===n.wireframe)||(A=r.id,Z=s.id,J=!0===n.wireframe,l=!0),(n.morphTargets||n.morphNormals)&&(N.update(i,r,n,s),l=!0),!0===i.isInstancedMesh&&(l=!0),t=r.index,e=r.attributes.position,null===t){if(void 0===e||0===e.count)return}else if(0===t.count)return;var u,c=1;if(!0===n.wireframe&&(t=L.getWireframeAttribute(r),c=2),o=z,null!==t&&(u=I.get(t),(o=U).setIndex(u)),l){if(!1!==C.isWebGL2||!i.isInstancedMesh&&!r.isInstancedBufferGeometry||null!==M.get("ANGLE_instanced_arrays")){T.initAttributes();var l=r.attributes,s=s.getAttributes(),h=n.defaultAttributeValues;for(_ in s){var d=s[_];if(0<=d)if(void 0!==(v=l[_])){var p,f,m,g,v,y=v.normalized,x=v.itemSize,b=I.get(v);void 0!==b&&(p=b.buffer,f=b.type,b=b.bytesPerElement,v.isInterleavedBufferAttribute?(g=(m=v.data).stride,v=v.offset,m&&m.isInstancedInterleavedBuffer?(T.enableAttributeAndDivisor(d,m.meshPerAttribute),void 0===r._maxInstanceCount&&(r._maxInstanceCount=m.meshPerAttribute*m.count)):T.enableAttribute(d),gt.bindBuffer(34962,p),T.vertexAttribPointer(d,x,f,y,g*b,v*b)):(v.isInstancedBufferAttribute?(T.enableAttributeAndDivisor(d,v.meshPerAttribute),void 0===r._maxInstanceCount&&(r._maxInstanceCount=v.meshPerAttribute*v.count)):T.enableAttribute(d),gt.bindBuffer(34962,p),T.vertexAttribPointer(d,x,f,y,0,0)))}else if("instanceMatrix"===_)void 0!==(b=I.get(i.instanceMatrix))&&(p=b.buffer,f=b.type,T.enableAttributeAndDivisor(d+0,1),T.enableAttributeAndDivisor(d+1,1),T.enableAttributeAndDivisor(d+2,1),T.enableAttributeAndDivisor(d+3,1),gt.bindBuffer(34962,p),gt.vertexAttribPointer(d+0,4,f,!1,64,0),gt.vertexAttribPointer(d+1,4,f,!1,64,16),gt.vertexAttribPointer(d+2,4,f,!1,64,32),gt.vertexAttribPointer(d+3,4,f,!1,64,48));else if(void 0!==h&&void 0!==(y=h[_]))switch(y.length){case 2:gt.vertexAttrib2fv(d,y);break;case 3:gt.vertexAttrib3fv(d,y);break;case 4:gt.vertexAttrib4fv(d,y);break;default:gt.vertexAttrib1fv(d,y)}}T.disableUnusedAttributes()}null!==t&&gt.bindBuffer(34963,u.buffer)}var _=r.drawRange.start*c;l=null!==a?a.start*c:0,u=Math.max(_,l),0!==(a=Math.max(0,Math.min((null!==t?t:e).count,_+r.drawRange.count*c,l+(null!==a?a.count*c:1/0))-1-u+1))&&(i.isMesh?!0===n.wireframe?(T.setLineWidth(n.wireframeLinewidth*(null===X?it:1)),o.setMode(1)):o.setMode(4):i.isLine?(void 0===(n=n.linewidth)&&(n=1),T.setLineWidth(n*(null===X?it:1)),i.isLineSegments?o.setMode(1):i.isLineLoop?o.setMode(2):o.setMode(3)):i.isPoints?o.setMode(0):i.isSprite&&o.setMode(4),i.isInstancedMesh?o.renderInstances(r,u,a,i.count):r.isInstancedBufferGeometry?o.renderInstances(r,u,a,Math.min(r.instanceCount,r._maxInstanceCount)):o.render(u,a))},this.compile=function(i,t){(b=F.get(i,t)).init(),i.traverse(function(t){t.isLight&&(b.pushLight(t),t.castShadow&&b.pushShadow(t))}),b.setupLights(t);var a={};i.traverse(function(t){var e=t.material;if(e)if(Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];!1==n.uuid in a&&(m(n,i,t),a[n.uuid]=!0)}else!1==e.uuid in a&&(m(e,i,t),a[e.uuid]=!0)})};var bt=null,_t=new It;_t.setAnimationLoop(function(t){vt.isPresenting||bt&&bt(t)}),"undefined"!=typeof window&&_t.setContext(window),this.setAnimationLoop=function(t){bt=t,vt.setAnimationLoop(t),_t.start()},this.render=function(t,e,r,n){var i,a;void 0!==r&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=r),void 0!==n&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),a=n),e&&e.isCamera?G||(Z=A=null,J=!1,Y=-1,!(K=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),vt.enabled&&vt.isPresenting&&(e=vt.getCamera(e)),t.onBeforeRender(H,t,e,i||X),(b=F.get(t,e)).init(),ft.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ct.setFromProjectionMatrix(ft),pt=this.localClippingEnabled,dt=ht.init(this.clippingPlanes,pt,e),(x=O.get(t,e)).init(),function t(e,r,n,i){if(!1!==e.visible){if(e.layers.test(r.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(r);else if(e.isLight)b.pushLight(e),e.castShadow&&b.pushShadow(e);else if(e.isSprite){var a,o;e.frustumCulled&&!ct.intersectsSprite(e)||(i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),a=R.update(e),(o=e.material).visible&&x.push(e,a,o,n,mt.z,null))}else if(e.isImmediateRenderObject)i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),x.push(e,null,e.material,n,mt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==_.render.frame&&(e.skeleton.update(),e.skeleton.frame=_.render.frame),!e.frustumCulled||ct.intersectsObject(e)))if(i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),a=R.update(e),o=e.material,Array.isArray(o))for(var s=a.groups,l=0,u=s.length;l<u;l++){var c=s[l],h=o[c.materialIndex];h&&h.visible&&x.push(e,a,h,n,mt.z,c)}else o.visible&&x.push(e,a,o,n,mt.z,null);for(l=0,u=(e=e.children).length;l<u;l++)t(e[l],r,n,i)}}(t,e,0,H.sortObjects),x.finish(),!0===H.sortObjects&&x.sort(at,ot),dt&&ht.beginShadows(),yt.render(b.state.shadowsArray,t,e),b.setupLights(e),dt&&ht.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),B.render(x,t,e,a),r=x.opaque,n=x.transparent,t.overrideMaterial?(i=t.overrideMaterial,r.length&&o(r,t,e,i),n.length&&o(n,t,e,i)):(r.length&&o(r,t,e),n.length&&o(n,t,e)),t.onAfterRender(H,t,e),null!==X&&(E.updateRenderTargetMipmap(X),E.updateMultisampleRenderTarget(X)),T.buffers.depth.setTest(!0),T.buffers.depth.setMask(!0),T.buffers.color.setMask(!0),T.setPolygonOffset(!1),b=x=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){V!==t&&null===X&&gt.bindFramebuffer(36160,t),V=t},this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return X},this.setRenderTarget=function(t,e,r){W=e,j=r,(X=t)&&void 0===S.get(t).__webglFramebuffer&&E.setupRenderTarget(t);var n=V,i=!1;et=t?(n=S.get(t).__webglFramebuffer,t.isWebGLCubeRenderTarget?(n=n[e||0],i=!0):n=t.isWebGLMultisampleRenderTarget?S.get(t).__webglMultisampledFramebuffer:n,$.copy(t.viewport),tt.copy(t.scissor),t.scissorTest):($.copy(st).multiplyScalar(it).floor(),tt.copy(lt).multiplyScalar(it).floor(),ut),q!==n&&(gt.bindFramebuffer(36160,n),q=n),T.viewport($),T.scissor(tt),T.setScissorTest(et),i&&(t=S.get(t.texture),gt.framebufferTexture2D(36160,36064,34069+(e||0),t.__webglTexture,r||0))},this.readRenderTargetPixels=function(t,e,r,n,i,a,o){if(t&&t.isWebGLRenderTarget){var s=S.get(t).__webglFramebuffer;if(s=t.isWebGLCubeRenderTarget&&void 0!==o?s[o]:s){o=!1,s!==q&&(gt.bindFramebuffer(36160,s),o=!0);try{var l=t.texture,u=l.format,l=l.type;1023!==u&&k.convert(u)!==gt.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===l||k.convert(l)===gt.getParameter(35738)||1015===l&&(C.isWebGL2||M.get("OES_texture_float")||M.get("WEBGL_color_buffer_float"))||1016===l&&(C.isWebGL2?M.get("EXT_color_buffer_float"):M.get("EXT_color_buffer_half_float"))?36053===gt.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=r&&r<=t.height-i&&gt.readPixels(e,r,n,i,k.convert(u),k.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{o&&gt.bindFramebuffer(36160,q)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,r){void 0===r&&(r=0);var n=Math.pow(2,-r),i=Math.floor(e.image.width*n),n=Math.floor(e.image.height*n),a=k.convert(e.format);E.setTexture2D(e,0),gt.copyTexImage2D(3553,r,a,t.x,t.y,i,n,0),T.unbindTexture()},this.copyTextureToTexture=function(t,e,r,n){void 0===n&&(n=0);var i=e.image.width,a=e.image.height,o=k.convert(r.format),s=k.convert(r.type);E.setTexture2D(r,0),e.isDataTexture?gt.texSubImage2D(3553,n,t.x,t.y,i,a,o,s,e.image.data):e.isCompressedTexture?gt.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):gt.texSubImage2D(3553,n,t.x,t.y,o,s,e.image),0===n&&r.generateMipmaps&&gt.generateMipmap(3553),T.unbindTexture()},this.initTexture=function(t){E.setTexture2D(t,0),T.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ue(t,e){this.name="",this.color=new U(t),this.density=void 0!==e?e:25e-5}function ke(t,e,r){this.name="",this.color=new U(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3}function He(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Ge(t,e,r,n){this.name="",this.data=t,this.itemSize=e,this.offset=r,this.normalized=!0===n}function Ve(t){k.call(this),this.type="SpriteMaterial",this.color=new U(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function We(t){var e;B.call(this),this.type="Sprite",void 0===ld&&(ld=new X,e=new He(e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),ld.setIndex([0,1,2,0,2,3]),ld.setAttribute("position",new Ge(e,3,0,!1)),ld.setAttribute("uv",new Ge(e,2,3,!1))),this.geometry=ld,this.material=void 0!==t?t:new Ve,this.center=new At(.5,.5)}function je(t,e,r,n,i,a){dd.subVectors(t,r).addScalar(.5).multiply(n),void 0!==i?(pd.x=a*dd.x-i*dd.y,pd.y=i*dd.x+a*dd.y):pd.copy(dd),t.copy(e),t.x+=pd.x,t.y+=pd.y,t.applyMatrix4(fd)}function Xe(){B.call(this),this._currentLevel=0,this.type="LOD",ku(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function qe(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),V.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct}function Ye(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Ct)}function Ze(){B.call(this),this.type="Bone"}function Je(t,e,r){V.call(this,t,e),this.instanceMatrix=new G(new Float32Array(16*r),16),this.count=r,this.frustumCulled=!1}function Ke(t){k.call(this),this.type="LineBasicMaterial",this.color=new U(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function Qe(t,e,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),B.call(this),this.type="Line",this.geometry=void 0!==t?t:new X,this.material=void 0!==e?e:new Ke,this.updateMorphTargets()}function $e(t,e){Qe.call(this,t,e),this.type="LineSegments"}function tr(t,e){Qe.call(this,t,e),this.type="LineLoop"}function er(t){k.call(this),this.type="PointsMaterial",this.color=new U(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function rr(t,e){B.call(this),this.type="Points",this.geometry=void 0!==t?t:new X,this.material=void 0!==e?e:new er,this.updateMorphTargets()}function nr(t,e,r,n,i,a,o){var s=Nd.distanceSqToPoint(t);s<r&&(r=new Mt,Nd.closestPointToPoint(t,r),r.applyMatrix4(n),(t=i.ray.origin.distanceTo(r))<i.near||t>i.far||a.push({distance:t,distanceToRay:Math.sqrt(s),point:r,index:e,face:null,object:o}))}function ir(t,e,r,n,i,a,o,s,l){d.call(this,t,e,r,n,i,a,o,s,l),this.format=void 0!==o?o:1022,this.minFilter=void 0!==a?a:1006,this.magFilter=void 0!==i?i:1006,this.generateMipmaps=!1}function ar(t,e,r,n,i,a,o,s,l,u,c,h){d.call(this,null,a,o,s,l,u,n,i,c,h),this.image={width:e,height:r},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function or(t,e,r,n,i,a,o,s,l){d.call(this,t,e,r,n,i,a,o,s,l),this.needsUpdate=!0}function sr(t,e,r,n,i,a,o,s,l,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d.call(this,null,n,i,a,o,s,u,r=void 0===(r=void 0===r&&1026===u?1012:r)&&1027===u?1020:r,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==s?s:1003,this.generateMipmaps=this.flipY=!1}function lr(t){X.call(this),this.type="WireframeGeometry";var e=[],r=[0,0],n={},i=["a","b","c"];if(t&&t.isGeometry){for(var a=t.faces,o=0,s=a.length;o<s;o++)for(var l=a[o],u=0;u<3;u++){var c=l[i[u]],h=l[i[(u+1)%3]];r[0]=Math.min(c,h),r[1]=Math.max(c,h),void 0===n[c=r[0]+","+r[1]]&&(n[c]={index1:r[0],index2:r[1]})}for(c in n)o=n[c],i=t.vertices[o.index1],e.push(i.x,i.y,i.z),i=t.vertices[o.index2],e.push(i.x,i.y,i.z)}else if(t&&t.isBufferGeometry)if(i=new Mt,null!==t.index){for(var a=t.attributes.position,l=t.index,d=t.groups,p=(d=(t=0)===d.length?[{start:0,count:l.count,materialIndex:0}]:d).length;t<p;++t)for(u=(o=d[t]).start,s=o.count,s=(o=u)+s;o<s;o+=3)for(u=0;u<3;u++)c=l.getX(o+u),h=l.getX(o+(u+1)%3),r[0]=Math.min(c,h),r[1]=Math.max(c,h),void 0===n[c=r[0]+","+r[1]]&&(n[c]={index1:r[0],index2:r[1]});for(c in n)o=n[c],i.fromBufferAttribute(a,o.index1),e.push(i.x,i.y,i.z),i.fromBufferAttribute(a,o.index2),e.push(i.x,i.y,i.z)}else for(o=0,s=(a=t.attributes.position).count/3;o<s;o++)for(u=0;u<3;u++)n=3*o+u,i.fromBufferAttribute(a,n),e.push(i.x,i.y,i.z),n=3*o+(u+1)%3,i.fromBufferAttribute(a,n),e.push(i.x,i.y,i.z);this.setAttribute("position",new I(e,3))}function ur(t,e,r){D.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r},this.fromBufferGeometry(new cr(t,e,r)),this.mergeVertices()}function cr(t,e,r){X.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:r};var n=[],i=[],a=[],o=[],s=new Mt,l=new Mt,u=new Mt,c=new Mt,h=new Mt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=e+1,p=0;p<=r;p++)for(var f=p/r,m=0;m<=e;m++){var g=m/e;t(g,f,l),i.push(l.x,l.y,l.z),0<=g-1e-5?(t(g-1e-5,f,u),c.subVectors(l,u)):(t(1e-5+g,f,u),c.subVectors(u,l)),0<=f-1e-5?(t(g,f-1e-5,u),h.subVectors(l,u)):(t(g,1e-5+f,u),h.subVectors(u,l)),s.crossVectors(c,h).normalize(),a.push(s.x,s.y,s.z),o.push(g,f)}for(p=0;p<r;p++)for(m=0;m<e;m++)t=p*d+m+1,s=(p+1)*d+m+1,l=(p+1)*d+m,n.push(p*d+m,t,l),n.push(t,s,l);this.setIndex(n),this.setAttribute("position",new I(i,3)),this.setAttribute("normal",new I(a,3)),this.setAttribute("uv",new I(o,2))}function hr(t,e,r,n){D.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},this.fromBufferGeometry(new dr(t,e,r,n)),this.mergeVertices()}function dr(r,m,t,e){function g(t){h.push(t.x,t.y,t.z)}function v(t,e){t*=3,e.x=r[t+0],e.y=r[t+1],e.z=r[t+2]}function c(t,e,r,n){n<0&&1===t.x&&(d[e]=t.x-1),0===r.x&&0===r.z&&(d[e]=n/2/Math.PI+.5)}X.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:r,indices:m,radius:t,detail:e},t=t||1;var h=[],d=[];!function(t){for(var e=new Mt,r=new Mt,n=new Mt,i=0;i<m.length;i+=3){v(m[i+0],e),v(m[i+1],r),v(m[i+2],n);for(var a=e,o=r,s=n,l=Math.pow(2,t),u=[],c=0;c<=l;c++){u[c]=[];for(var h=a.clone().lerp(s,c/l),d=o.clone().lerp(s,c/l),p=l-c,f=0;f<=p;f++)u[c][f]=0===f&&c===l?h:h.clone().lerp(d,f/p)}for(c=0;c<l;c++)for(f=0;f<2*(l-c)-1;f++)a=Math.floor(f/2),0==f%2?(g(u[c][a+1]),g(u[c+1][a]),g(u[c][a])):(g(u[c][a+1]),g(u[c+1][a+1]),g(u[c+1][a]))}}(e=e||0),function(t){for(var e=new Mt,r=0;r<h.length;r+=3)e.x=h[r+0],e.y=h[r+1],e.z=h[r+2],e.normalize().multiplyScalar(t),h[r+0]=e.x,h[r+1]=e.y,h[r+2]=e.z}(t),function(){for(var t=new Mt,e=0;e<h.length;e+=3)t.x=h[e+0],t.y=h[e+1],t.z=h[e+2],d.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));for(var t=new Mt,e=new Mt,r=new Mt,n=new Mt,i=new At,a=new At,o=new At,s=0,l=0;s<h.length;s+=9,l+=6){t.set(h[s+0],h[s+1],h[s+2]),e.set(h[s+3],h[s+4],h[s+5]),r.set(h[s+6],h[s+7],h[s+8]),i.set(d[l+0],d[l+1]),a.set(d[l+2],d[l+3]),o.set(d[l+4],d[l+5]),n.copy(t).add(e).add(r).divideScalar(3);var u=Math.atan2(n.z,-n.x);c(i,l+0,t,u),c(a,l+2,e,u),c(o,l+4,r,u)}for(t=0;t<d.length;t+=6)e=d[t+0],r=d[t+2],n=d[t+4],i=Math.min(e,r,n),.9<Math.max(e,r,n)&&i<.1&&(e<.2&&(d[t+0]+=1),r<.2&&(d[t+2]+=1),n<.2&&(d[t+4]+=1))}(),this.setAttribute("position",new I(h,3)),this.setAttribute("normal",new I(h.slice(),3)),this.setAttribute("uv",new I(d,2)),0===e?this.computeVertexNormals():this.normalizeNormals()}function pr(t,e){D.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new fr(t,e)),this.mergeVertices()}function fr(t,e){dr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function mr(t,e){D.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new gr(t,e)),this.mergeVertices()}function gr(t,e){dr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function vr(t,e){D.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new yr(t,e)),this.mergeVertices()}function yr(t,e){var r=(1+Math.sqrt(5))/2;dr.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function xr(t,e){D.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new br(t,e)),this.mergeVertices()}function br(t,e){var r=(1+Math.sqrt(5))/2,n=1/r;dr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function _r(t,e,r,n,i,a){D.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Ar(t,e,r,n,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Ar(i,a,o,s,t){function e(t){d=i.getPointAt(t/a,d);var e=l.normals[t];for(t=l.binormals[t],u=0;u<=s;u++){var r=u/s*Math.PI*2,n=Math.sin(r),r=-Math.cos(r);h.x=r*e.x+n*t.x,h.y=r*e.y+n*t.y,h.z=r*e.z+n*t.z,h.normalize(),f.push(h.x,h.y,h.z),c.x=d.x+o*h.x,c.y=d.y+o*h.y,c.z=d.z+o*h.z,p.push(c.x,c.y,c.z)}}X.call(this),this.type="TubeBufferGeometry",this.parameters={path:i,tubularSegments:a,radius:o,radialSegments:s,closed:t},a=a||64,o=o||1,s=s||8,t=t||!1;var l=i.computeFrenetFrames(a,t);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;for(var u,c=new Mt,h=new Mt,r=new At,d=new Mt,p=[],f=[],n=[],m=[],g=0;g<a;g++)e(g);for(e(!1===t?a:0),g=0;g<=a;g++)for(u=0;u<=s;u++)r.x=g/a,r.y=u/s,n.push(r.x,r.y);!function(){for(u=1;u<=a;u++)for(g=1;g<=s;g++){var t=(s+1)*u+(g-1),e=(s+1)*u+g,r=(s+1)*(u-1)+g;m.push((s+1)*(u-1)+(g-1),t,r),m.push(t,e,r)}}(),this.setIndex(m),this.setAttribute("position",new I(p,3)),this.setAttribute("normal",new I(f,3)),this.setAttribute("uv",new I(n,2))}function wr(t,e,r,n,i,a,o){D.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Mr(t,e,r,n,i,a)),this.mergeVertices()}function Mr(t,e,r,n,i,a){function o(t,e,r,n,i){var a=Math.sin(t);e=r/e*t,r=Math.cos(e),i.x=n*(2+r)*.5*Math.cos(t),i.y=n*(2+r)*a*.5,i.z=n*Math.sin(e)*.5}X.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a},t=t||1,e=e||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,a=a||3;for(var s=[],l=[],u=[],c=[],h=new Mt,d=new Mt,p=new Mt,f=new Mt,m=new Mt,g=new Mt,v=new Mt,y=0;y<=r;++y){var x=y/r*i*Math.PI*2;for(o(x,i,a,t,p),o(x+.01,i,a,t,f),g.subVectors(f,p),v.addVectors(f,p),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize(),x=0;x<=n;++x){var b=x/n*Math.PI*2,_=-e*Math.cos(b),b=e*Math.sin(b);h.x=p.x+(_*v.x+b*m.x),h.y=p.y+(_*v.y+b*m.y),h.z=p.z+(_*v.z+b*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),u.push(d.x,d.y,d.z),c.push(y/r),c.push(x/n)}}for(x=1;x<=r;x++)for(y=1;y<=n;y++)t=(n+1)*x+(y-1),e=(n+1)*x+y,i=(n+1)*(x-1)+y,s.push((n+1)*(x-1)+(y-1),t,i),s.push(t,e,i);this.setIndex(s),this.setAttribute("position",new I(l,3)),this.setAttribute("normal",new I(u,3)),this.setAttribute("uv",new I(c,2))}function Cr(t,e,r,n,i){D.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new Tr(t,e,r,n,i)),this.mergeVertices()}function Tr(t,e,r,n,i){X.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},t=t||1,e=e||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;for(var a,o=[],s=[],l=[],u=[],c=new Mt,h=new Mt,d=new Mt,p=0;p<=r;p++)for(a=0;a<=n;a++){var f=a/n*i,m=p/r*Math.PI*2;h.x=(t+e*Math.cos(m))*Math.cos(f),h.y=(t+e*Math.cos(m))*Math.sin(f),h.z=e*Math.sin(m),s.push(h.x,h.y,h.z),c.x=t*Math.cos(f),c.y=t*Math.sin(f),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(a/n),u.push(p/r)}for(p=1;p<=r;p++)for(a=1;a<=n;a++)t=(n+1)*(p-1)+a-1,e=(n+1)*(p-1)+a,i=(n+1)*p+a,o.push((n+1)*p+a-1,t,i),o.push(t,e,i);this.setIndex(o),this.setAttribute("position",new I(s,3)),this.setAttribute("normal",new I(l,3)),this.setAttribute("uv",new I(u,2))}function Sr(t,e,r,n,i){for(var a,o=0,s=e,l=r-n;s<r;s+=n)o+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;if(i===0<o)for(i=e;i<r;i+=n)a=kr(i,t[i],t[i+1],a);else for(i=r-n;e<=i;i-=n)a=kr(i,t[i],t[i+1],a);return a&&Or(a,a.next)&&(Hr(a),a=a.next),a}function Er(t,e){if(!t)return t;e=e||t;do{var r=!1;if(t.steiner||!Or(t,t.next)&&0!==Dr(t.prev,t,t.next))t=t.next;else{if(Hr(t),(t=e=t.prev)===t.next)break;r=!0}}while(r||t!==e);return e}function Ir(t,e,r,n,i,a,o){if(t){if(!o&&a){for(var s=t,l=s;null===l.z&&(l.z=Rr(l.x,l.y,n,i,a)),l.prevZ=l.prev,l=l.nextZ=l.next,l!==s;);l.prevZ.nextZ=null,l.prevZ=null;var u,c,s=l,h=1;do{for(var l=s,d=s=null,p=0;l;){p++;for(var f=l,m=u=0;m<h&&(u++,f=f.nextZ);m++);for(c=h;0<u||0<c&&f;)0!==u&&(0===c||!f||l.z<=f.z)?(l=(m=l).nextZ,u--):(f=(m=f).nextZ,c--),d?d.nextZ=m:s=m,m.prevZ=d,d=m;l=f}}while(d.nextZ=null,h*=2,1<p)}for(s=t;t.prev!==t.next;){if(l=t.prev,f=t.next,a)d=function(t,e,r,n){var i=t.prev,a=t.next;if(0<=Dr(i,t,a))return!1;var o=(i.x>t.x?i.x>a.x?i:a:t.x>a.x?t:a).x,s=(i.y>t.y?i.y>a.y?i:a:t.y>a.y?t:a).y,l=Rr((i.x<t.x?i.x<a.x?i:a:t.x<a.x?t:a).x,(i.y<t.y?i.y<a.y?i:a:t.y<a.y?t:a).y,e,r,n);for(e=Rr(o,s,e,r,n),r=t.prevZ,n=t.nextZ;r&&r.z>=l&&n&&n.z<=e;){if(r!==t.prev&&r!==t.next&&Pr(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=Dr(r.prev,r,r.next))return!1;if(r=r.prevZ,n!==t.prev&&n!==t.next&&Pr(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=Dr(n.prev,n,n.next))return!1;n=n.nextZ}for(;r&&r.z>=l;){if(r!==t.prev&&r!==t.next&&Pr(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=Dr(r.prev,r,r.next))return!1;r=r.prevZ}for(;n&&n.z<=e;){if(n!==t.prev&&n!==t.next&&Pr(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=Dr(n.prev,n,n.next))return!1;n=n.nextZ}return!0}(t,n,i,a);else t:if(d=t,p=d.prev,u=d,h=d.next,0<=Dr(p,u,h))d=!1;else{for(m=d.next.next;m!==d.prev;){if(Pr(p.x,p.y,u.x,u.y,h.x,h.y,m.x,m.y)&&0<=Dr(m.prev,m,m.next)){d=!1;break t}m=m.next}d=!0}if(d)e.push(l.i/r),e.push(t.i/r),e.push(f.i/r),Hr(t),s=t=f.next;else if((t=f)===s){if(o){if(1===o){for(t=Er(t),o=e,s=r,l=t;f=l.prev,d=l.next.next,!Or(f,d)&&Fr(f,l,l.next,d)&&zr(f,d)&&zr(d,f)&&(o.push(f.i/s),o.push(l.i/s),o.push(d.i/s),Hr(l),Hr(l.next),l=t=d),l=l.next,l!==t;);Ir(t=Er(l),e,r,n,i,a,2)}else if(2===o)t:{o=t;do{for(s=o.next.next;s!==o.prev;){if(l=o.i!==s.i){if(f=s,d=(l=o).next.i!==f.i&&l.prev.i!==f.i){e:{d=l;do{if(d.i!==l.i&&d.next.i!==l.i&&d.i!==f.i&&d.next.i!==f.i&&Fr(d,d.next,l,f)){d=!0;break e}}while((d=d.next)!==l);d=!1}d=!d}if(d){if(d=zr(l,f)&&zr(f,l)){for(d=l,p=!1,u=(l.x+f.x)/2,h=(l.y+f.y)/2;d.y>h!=d.next.y>h&&d.next.y!==d.y&&u<(d.next.x-d.x)*(h-d.y)/(d.next.y-d.y)+d.x&&(p=!p),d=d.next,d!==l;);d=p}d=d&&(Dr(l.prev,l,f.prev)||Dr(l,f.prev,f))||Or(l,f)&&0<Dr(l.prev,l,l.next)&&0<Dr(f.prev,f,f.next)}l=d}if(l){t=Ur(o,s),o=Er(o,o.next),t=Er(t,t.next),Ir(o,e,r,n,i,a),Ir(t,e,r,n,i,a);break t}s=s.next}}while((o=o.next)!==t)}}else Ir(Er(t),e,r,n,i,a,1);break}}}}function Lr(t,e){return t.x-e.x}function Rr(t,e,r,n,i){return 1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1)|(1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Pr(t,e,r,n,i,a,o,s){return 0<=(i-o)*(e-s)-(t-o)*(a-s)&&0<=(t-o)*(n-s)-(r-o)*(e-s)&&0<=(r-o)*(a-s)-(i-o)*(n-s)}function Dr(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Or(t,e){return t.x===e.x&&t.y===e.y}function Fr(t,e,r,n){var i=Nr(Dr(t,e,r)),a=Nr(Dr(t,e,n)),o=Nr(Dr(r,n,t)),s=Nr(Dr(r,n,e));return!!(i!==a&&o!==s||0===i&&Br(t,r,e)||0===a&&Br(t,n,e)||0===o&&Br(r,t,n)||0===s&&Br(r,e,n))}function Br(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Nr(t){return 0<t?1:t<0?-1:0}function zr(t,e){return Dr(t.prev,t,t.next)<0?0<=Dr(t,e,t.next)&&0<=Dr(t,t.prev,e):Dr(t,e,t.prev)<0||Dr(t,t.next,e)<0}function Ur(t,e){var r=new Gr(t.i,t.x,t.y),n=new Gr(e.i,e.x,e.y),i=t.next,a=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(a.next=n).prev=a,n}function kr(t,e,r,n){return t=new Gr(t,e,r),n?(t.next=n.next,(t.prev=n).next.prev=t,n.next=t):(t.prev=t).next=t,t}function Hr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Gr(t,e,r){this.i=t,this.x=e,this.y=r,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Vr(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function Wr(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}function jr(t,e){D.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Xr(t,e)),this.mergeVertices()}function Xr(t,G){X.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:G},t=Array.isArray(t)?t:[t];for(var V=this,W=[],j=[],e=0,r=t.length;e<r;e++)!function(t){function e(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}function r(t,e,r){var n=t.x-e.x,i=t.y-e.y,a=r.x-t.x,o=r.y-t.y,s=n*n+i*i;if(Math.abs(n*o-i*a)>Wu){var l=Math.sqrt(s),u=Math.sqrt(a*a+o*o),s=e.x-i/l;if(e=e.y+n/l,(i=(a=s+n*(o=((r.x-o/u-s)*o-(r.y+a/u-e)*a)/(n*o-i*a))-t.x)*a+(n=e+i*o-t.y)*n)<=2)return new At(a,n);i=Math.sqrt(i/2)}else t=!1,Wu<n?Wu<a&&(t=!0):n<-Wu?a<-Wu&&(t=!0):Gu(i)===Gu(o)&&(t=!0),i=t?(a=-i,Math.sqrt(s)):(a=n,n=i,Math.sqrt(s/2));return new At(a/i,n/i)}function n(t,e){for(O=t.length;0<=--O;){var r=O,n=O-1;n<0&&(n=t.length-1);for(var i=d+2*g,a=0;a<i;a++){var o=P*a,s=e+n+o,l=e+n+(u=P*(a+1)),u=e+r+u;c(e+r+o),c(s),c(u),c(s),c(l),c(u),o=W.length/3,h((o=y.generateSideWallUV(V,W,o-6,o-3,o-2,o-1))[0]),h(o[1]),h(o[3]),h(o[1]),h(o[2]),h(o[3])}}}function i(t,e,r){o.push(t),o.push(e),o.push(r)}function a(t,e,r){c(t),c(e),c(r),t=W.length/3,h((t=y.generateTopUV(V,W,t-3,t-2,t-1))[0]),h(t[1]),h(t[2])}function c(t){W.push(o[3*t]),W.push(o[3*t+1]),W.push(o[3*t+2])}function h(t){j.push(t.x),j.push(t.y)}var o=[],s=void 0!==G.curveSegments?G.curveSegments:12,d=void 0!==G.steps?G.steps:1,l=void 0!==G.depth?G.depth:100,u=void 0===G.bevelEnabled||G.bevelEnabled,p=void 0!==G.bevelThickness?G.bevelThickness:6,f=void 0!==G.bevelSize?G.bevelSize:p-2,m=void 0!==G.bevelOffset?G.bevelOffset:0,g=void 0!==G.bevelSegments?G.bevelSegments:3,v=G.extrudePath,y=void 0!==G.UVGenerator?G.UVGenerator:Gd;void 0!==G.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=G.amount);var x,b,_,A,w,M=!1;v&&(x=v.getSpacedPoints(d),u=!(M=!0),b=v.computeFrenetFrames(d,!1),_=new Mt,A=new Mt,w=new Mt),u||(m=f=p=g=0),t=(s=t.extractPoints(s)).shape;var C=s.holes;if(!Hd.isClockWise(t)){t=t.reverse();for(var T=0,S=C.length;T<S;T++){var E=C[T];Hd.isClockWise(E)&&(C[T]=E.reverse())}}var I=Hd.triangulateShape(t,C),L=t,T=0;for(S=C.length;T<S;T++)E=C[T],t=t.concat(E);var R,P=t.length,D=I.length,s=[],O=0,F=(N=L.length)-1;for(U=O+1;O<N;O++,F++,U++)F===N&&(F=0),U===N&&(U=0),s[O]=r(L[O],L[F],L[U]);var v=[],B=s.concat();for(T=0,S=C.length;T<S;T++){for(var N,E=C[T],z=[],O=0,F=(N=E.length)-1,U=O+1;O<N;O++,F++,U++)F===N&&(F=0),U===N&&(U=0),z[O]=r(E[O],E[F],E[U]);v.push(z),B=B.concat(z)}for(F=0;F<g;F++){N=F/g;var k=p*Math.cos(N*Math.PI/2);for(U=f*Math.sin(N*Math.PI/2)+m,O=0,N=L.length;O<N;O++){var H=e(L[O],s[O],U);i(H.x,H.y,-k)}for(T=0,S=C.length;T<S;T++)for(E=C[T],z=v[T],O=0,N=E.length;O<N;O++)i((H=e(E[O],z[O],U)).x,H.y,-k)}for(U=f+m,O=0;O<P;O++)H=u?e(t[O],B[O],U):t[O],M?(A.copy(b.normals[0]).multiplyScalar(H.x),_.copy(b.binormals[0]).multiplyScalar(H.y),w.copy(x[0]).add(A).add(_),i(w.x,w.y,w.z)):i(H.x,H.y,0);for(N=1;N<=d;N++)for(O=0;O<P;O++)H=u?e(t[O],B[O],U):t[O],M?(A.copy(b.normals[N]).multiplyScalar(H.x),_.copy(b.binormals[N]).multiplyScalar(H.y),w.copy(x[N]).add(A).add(_),i(w.x,w.y,w.z)):i(H.x,H.y,l/d*N);for(F=g-1;0<=F;F--){for(N=F/g,k=p*Math.cos(N*Math.PI/2),U=f*Math.sin(N*Math.PI/2)+m,O=0,N=L.length;O<N;O++)i((H=e(L[O],s[O],U)).x,H.y,l+k);for(T=0,S=C.length;T<S;T++)for(E=C[T],z=v[T],O=0,N=E.length;O<N;O++)H=e(E[O],z[O],U),M?i(H.x,H.y+x[d-1].y,x[d-1].x+k):i(H.x,H.y,l+k)}!function(){var t=W.length/3;if(u){var e=0*P;for(O=0;O<D;O++)a((R=I[O])[2]+e,R[1]+e,R[0]+e);for(e=P*(d+2*g),O=0;O<D;O++)a((R=I[O])[0]+e,R[1]+e,R[2]+e)}else{for(O=0;O<D;O++)a((R=I[O])[2],R[1],R[0]);for(O=0;O<D;O++)a((R=I[O])[0]+P*d,R[1]+P*d,R[2]+P*d)}V.addGroup(t,W.length/3-t,0)}(),function(){var t=W.length/3,e=0;for(n(L,e),e+=L.length,T=0,S=C.length;T<S;T++)n(E=C[T],e),e+=E.length;V.addGroup(t,W.length/3-t,1)}()}(t[e]);this.setAttribute("position",new I(W,3)),this.setAttribute("uv",new I(j,2)),this.computeVertexNormals()}function qr(t,e,r){if(r.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++)r.shapes.push(t[n].uuid);else r.shapes.push(t.uuid);return void 0!==e.extrudePath&&(r.options.extrudePath=e.extrudePath.toJSON()),r}function Yr(t,e){D.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Zr(t,e)),this.mergeVertices()}function Zr(t,e){var r=(e=e||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new D;t=r.generateShapes(t,e.size),e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Xr.call(this,t,e),this.type="TextBufferGeometry"}function Jr(t,e,r,n,i,a,o){D.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Kr(t,e,r,n,i,a,o)),this.mergeVertices()}function Kr(t,e,r,n,i,a,o){X.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;for(var s,l=Math.min(a+o,Math.PI),u=0,c=[],h=new Mt,d=new Mt,p=[],f=[],m=[],g=[],v=0;v<=r;v++){var y=[],x=v/r,b=0;for(0==v&&0==a?b=.5/e:v==r&&l==Math.PI&&(b=-.5/e),s=0;s<=e;s++){var _=s/e;h.x=-t*Math.cos(n+_*i)*Math.sin(a+x*o),h.y=t*Math.cos(a+x*o),h.z=t*Math.sin(n+_*i)*Math.sin(a+x*o),f.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(_+b,1-x),y.push(u++)}c.push(y)}for(v=0;v<r;v++)for(s=0;s<e;s++)t=c[v][s+1],n=c[v][s],i=c[v+1][s],o=c[v+1][s+1],(0!==v||0<a)&&p.push(t,n,o),(v!==r-1||l<Math.PI)&&p.push(n,i,o);this.setIndex(p),this.setAttribute("position",new I(f,3)),this.setAttribute("normal",new I(m,3)),this.setAttribute("uv",new I(g,2))}function Qr(t,e,r,n,i,a){D.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new $r(t,e,r,n,i,a)),this.mergeVertices()}function $r(t,e,r,n,i,a){X.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},t=t||.5,e=e||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8;for(var o,s=[],l=[],u=[],c=[],h=t,d=(e-t)/(n=void 0!==n?Math.max(1,n):1),p=new Mt,f=new At,m=0;m<=n;m++){for(o=0;o<=r;o++)t=i+o/r*a,p.x=h*Math.cos(t),p.y=h*Math.sin(t),l.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,c.push(f.x,f.y);h+=d}for(m=0;m<n;m++)for(e=m*(r+1),o=0;o<r;o++)i=(t=o+e)+r+1,a=t+r+2,h=t+1,s.push(t,i,h),s.push(i,a,h);this.setIndex(s),this.setAttribute("position",new I(l,3)),this.setAttribute("normal",new I(u,3)),this.setAttribute("uv",new I(c,2))}function tn(t,e,r,n){D.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},this.fromBufferGeometry(new en(t,e,r,n)),this.mergeVertices()}function en(t,e,r,n){X.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},e=Math.floor(e)||12,r=r||0,n=n||2*Math.PI,n=Qu.clamp(n,0,2*Math.PI);for(var i=[],a=[],o=[],s=1/e,l=new Mt,u=new At,c=0;c<=e;c++)for(var h=r+c*s*n,d=Math.sin(h),p=Math.cos(h),h=0;h<=t.length-1;h++)l.x=t[h].x*d,l.y=t[h].y,l.z=t[h].x*p,a.push(l.x,l.y,l.z),u.x=c/e,u.y=h/(t.length-1),o.push(u.x,u.y);for(c=0;c<e;c++)for(h=0;h<t.length-1;h++)s=(r=h+c*t.length)+t.length,l=r+t.length+1,u=r+1,i.push(r,s,u),i.push(s,l,u);if(this.setIndex(i),this.setAttribute("position",new I(a,3)),this.setAttribute("uv",new I(o,2)),this.computeVertexNormals(),n===2*Math.PI)for(n=this.attributes.normal.array,i=new Mt,a=new Mt,o=new Mt,r=e*t.length*3,h=c=0;c<t.length;c++,h+=3)i.x=n[h+0],i.y=n[h+1],i.z=n[h+2],a.x=n[r+h+0],a.y=n[r+h+1],a.z=n[r+h+2],o.addVectors(i,a).normalize(),n[h+0]=n[r+h+0]=o.x,n[h+1]=n[r+h+1]=o.y,n[h+2]=n[r+h+2]=o.z}function rn(t,e){D.call(this),this.type="ShapeGeometry","object"===(void 0===e?"undefined":Ou(e))&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new nn(t,e)),this.mergeVertices()}function nn(t,s){function e(t){var e,r=u.length/3,n=(t=t.extractPoints(s)).shape,i=t.holes;for(!1===Hd.isClockWise(n)&&(n=n.reverse()),t=0,e=i.length;t<e;t++){var a=i[t];!0===Hd.isClockWise(a)&&(i[t]=a.reverse())}var o=Hd.triangulateShape(n,i);for(t=0,e=i.length;t<e;t++)a=i[t],n=n.concat(a);for(t=0,e=n.length;t<e;t++)a=n[t],u.push(a.x,a.y,0),c.push(0,0,1),h.push(a.x,a.y);for(t=0,e=o.length;t<e;t++)n=o[t],l.push(n[0]+r,n[1]+r,n[2]+r),d+=3}X.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:s},s=s||12;var l=[],u=[],c=[],h=[],r=0,d=0;if(!1===Array.isArray(t))e(t);else for(var n=0;n<t.length;n++)e(t[n]),this.addGroup(r,d,n),r+=d,d=0;this.setIndex(l),this.setAttribute("position",new I(u,3)),this.setAttribute("normal",new I(c,3)),this.setAttribute("uv",new I(h,2))}function an(t,e){if(e.shapes=[],Array.isArray(t))for(var r=0,n=t.length;r<n;r++)e.shapes.push(t[r].uuid);else e.shapes.push(t.uuid);return e}function on(t,e){X.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var r=[];e=Math.cos(Qu.DEG2RAD*(void 0!==e?e:1));var n=[0,0],i={},a=["a","b","c"];t.isBufferGeometry?(o=new D).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals(),t=o.vertices;for(var o,s=0,l=(o=o.faces).length;s<l;s++)for(var u=o[s],c=0;c<3;c++){var h=u[a[c]],d=u[a[(c+1)%3]];n[0]=Math.min(h,d),n[1]=Math.max(h,d),void 0===i[h=n[0]+","+n[1]]?i[h]={index1:n[0],index2:n[1],face1:s,face2:void 0}:i[h].face2=s}for(h in i)(void 0===(n=i[h]).face2||o[n.face1].normal.dot(o[n.face2].normal)<=e)&&(a=t[n.index1],r.push(a.x,a.y,a.z),a=t[n.index2],r.push(a.x,a.y,a.z));this.setAttribute("position",new I(r,3))}function sn(t,e,r,n,i,a,o,s){D.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new ln(t,e,r,n,i,a,o,s)),this.mergeVertices()}function ln(d,p,f,m,g,t,v,y){function e(t){for(var e=new At,r=new Mt,n=0,i=!0===t?d:p,a=!0===t?1:-1,o=M,s=1;s<=m;s++)_.push(0,T*a,0),A.push(0,a,0),w.push(.5,.5),M++;var l=M;for(s=0;s<=m;s++){var u=s/m*y+v,c=Math.cos(u),u=Math.sin(u);r.x=i*u,r.y=T*a,r.z=i*c,_.push(r.x,r.y,r.z),A.push(0,a,0),e.x=.5*c+.5,e.y=.5*u*a+.5,w.push(e.x,e.y),M++}for(s=0;s<m;s++)e=o+s,r=l+s,!0===t?b.push(r,r+1,e):b.push(r+1,r,e),n+=3;x.addGroup(S,n,!0===t?1:2),S+=n}X.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:d,radiusBottom:p,height:f,radialSegments:m,heightSegments:g,openEnded:t,thetaStart:v,thetaLength:y};var x=this;d=void 0!==d?d:1,p=void 0!==p?p:1,f=f||1,m=Math.floor(m)||8,g=Math.floor(g)||1,t=void 0!==t&&t,v=void 0!==v?v:0,y=void 0!==y?y:2*Math.PI;var b=[],_=[],A=[],w=[],M=0,C=[],T=f/2,S=0;!function(){for(var t=new Mt,e=new Mt,r=0,n=(p-d)/f,i=0;i<=g;i++){for(var a=[],o=i/g,s=o*(p-d)+d,l=0;l<=m;l++){var u=l/m,c=u*y+v,h=Math.sin(c),c=Math.cos(c);e.x=s*h,e.y=-o*f+T,e.z=s*c,_.push(e.x,e.y,e.z),t.set(h,n,c).normalize(),A.push(t.x,t.y,t.z),w.push(u,1-o),a.push(M++)}C.push(a)}for(l=0;l<m;l++)for(i=0;i<g;i++)t=C[i+1][l],e=C[i+1][l+1],n=C[i][l+1],b.push(C[i][l],t,n),b.push(t,e,n),r+=6;x.addGroup(S,r,0),S+=r}(),!1===t&&(0<d&&e(!0),0<p&&e(!1)),this.setIndex(b),this.setAttribute("position",new I(_,3)),this.setAttribute("normal",new I(A,3)),this.setAttribute("uv",new I(w,2))}function un(t,e,r,n,i,a,o){sn.call(this,0,t,e,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function cn(t,e,r,n,i,a,o){ln.call(this,0,t,e,r,n,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function hn(t,e,r,n){D.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new dn(t,e,r,n)),this.mergeVertices()}function dn(t,e,r,n){X.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i=[],a=[],o=[],s=[],l=new Mt,u=new At;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(var c=0,h=3;c<=e;c++,h+=3){var d=r+c/e*n;l.x=t*Math.cos(d),l.y=t*Math.sin(d),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[h]/t+1)/2,u.y=(a[h+1]/t+1)/2,s.push(u.x,u.y)}for(h=1;h<=e;h++)i.push(h,h+1,0);this.setIndex(i),this.setAttribute("position",new I(a,3)),this.setAttribute("normal",new I(o,3)),this.setAttribute("uv",new I(s,2))}function pn(t){k.call(this),this.type="ShadowMaterial",this.color=new U(0),this.transparent=!0,this.setValues(t)}function fn(t){W.call(this,t),this.type="RawShaderMaterial"}function mn(t){k.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new U(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new U(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function gn(t){mn.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new At(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function vn(t){k.call(this),this.type="MeshPhongMaterial",this.color=new U(16777215),this.specular=new U(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new U(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function yn(t){k.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new U(16777215),this.specular=new U(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new U(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function xn(t){k.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function bn(t){k.call(this),this.type="MeshLambertMaterial",this.color=new U(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new U(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function _n(t){k.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new U(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function An(t){Ke.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function wn(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function Mn(t,e,r,n){wn.call(this,t,e,r,n),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Cn(t,e,r,n){wn.call(this,t,e,r,n)}function Tn(t,e,r,n){wn.call(this,t,e,r,n)}function Sn(t,e,r,n){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=jd.convertArray(e,this.TimeBufferType),this.values=jd.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function En(t,e,r){Sn.call(this,t,e,r)}function In(t,e,r,n){Sn.call(this,t,e,r,n)}function Ln(t,e,r,n){Sn.call(this,t,e,r,n)}function Rn(t,e,r,n){wn.call(this,t,e,r,n)}function Pn(t,e,r,n){Sn.call(this,t,e,r,n)}function Dn(t,e,r,n){Sn.call(this,t,e,r,n)}function On(t,e,r,n){Sn.call(this,t,e,r,n)}function Fn(t,e,r,n){this.name=t,this.tracks=r,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==n?n:2500,this.uuid=Qu.generateUUID(),this.duration<0&&this.resetDuration()}function Bn(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e,r,n=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ln;case"vector":case"vector2":case"vector3":case"vector4":return On;case"color":return In;case"quaternion":return Pn;case"bool":case"boolean":return En;case"string":return Dn}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);return void 0===t.times&&(e=[],r=[],jd.flattenJSON(t.keys,e,r,"value"),t.times=e,t.values=r),void 0!==n.parse?n.parse(t):new n(t.name,t.times,t.values,t.interpolation)}function Nn(t,e,r){var n=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){o++,!1===i&&void 0!==n.onStart&&n.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(i=!1,void 0!==n.onLoad)&&n.onLoad()},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){return-1!==(t=l.indexOf(t))&&l.splice(t,2),this},this.getHandler=function(t){for(var e=0,r=l.length;e<r;e+=2){var n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}function zn(t){this.manager=void 0!==t?t:qd,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function Un(t){zn.call(this,t)}function kn(t){zn.call(this,t)}function Hn(t){zn.call(this,t)}function Gn(t){zn.call(this,t)}function Vn(t){zn.call(this,t)}function Wn(t){zn.call(this,t)}function jn(t){zn.call(this,t)}function Xn(){this.type="Curve",this.arcLengthDivisions=200}function qn(t,e,r,n,i,a,o,s){Xn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Yn(t,e,r,n,i,a){qn.call(this,t,e,r,r,n,i,a),this.type="ArcCurve"}function Zn(){var s=0,l=0,u=0,c=0;return{initCatmullRom:function(t,e,r,n,i){u=-3*(s=e)+3*r-2*(l=t=i*(r-t))-(n=i*(n-e)),c=2*e-2*r+t+n},initNonuniformCatmullRom:function(t,e,r,n,i,a,o){u=-3*(s=e)+3*r-2*(l=t=((e-t)/i-(r-t)/(i+a)+(r-e)/a)*a)-(n=((r-e)/a-(n-e)/(a+o)+(n-r)/o)*a),c=2*e-2*r+t+n},calc:function(t){var e=t*t;return s+l*t+u*e+c*e*t}}}function Jn(t,e,r,n){Xn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Kn(t,e,r,n,i){var a=t*t;return(2*r-2*n+(e=.5*(n-e))+(i=.5*(i-r)))*t*a+(-3*r+3*n-2*e-i)*a+e*t+r}function Qn(t,e,r,n){var i=1-t;return i*i*e+2*(1-t)*t*r+t*t*n}function $n(t,e,r,n,i){var a=1-t,o=1-t;return a*a*a*e+3*o*o*t*r+3*(1-t)*t*t*n+t*t*t*i}function ti(t,e,r,n){Xn.call(this),this.type="CubicBezierCurve",this.v0=t||new At,this.v1=e||new At,this.v2=r||new At,this.v3=n||new At}function ei(t,e,r,n){Xn.call(this),this.type="CubicBezierCurve3",this.v0=t||new Mt,this.v1=e||new Mt,this.v2=r||new Mt,this.v3=n||new Mt}function ri(t,e){Xn.call(this),this.type="LineCurve",this.v1=t||new At,this.v2=e||new At}function ni(t,e){Xn.call(this),this.type="LineCurve3",this.v1=t||new Mt,this.v2=e||new Mt}function ii(t,e,r){Xn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new At,this.v1=e||new At,this.v2=r||new At}function ai(t,e,r){Xn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Mt,this.v1=e||new Mt,this.v2=r||new Mt}function oi(t){Xn.call(this),this.type="SplineCurve",this.points=t||[]}function si(){Xn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function li(t){si.call(this),this.type="Path",this.currentPoint=new At,t&&this.setFromPoints(t)}function ui(t){li.call(this,t),this.uuid=Qu.generateUUID(),this.type="Shape",this.holes=[]}function ci(t,e){B.call(this),this.type="Light",this.color=new U(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function hi(t,e,r){ci.call(this,t,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(B.DefaultUp),this.updateMatrix(),this.groundColor=new U(e)}function di(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new At(512,512),this.mapPass=this.map=null,this.matrix=new Ct,this._frustum=new Et,this._frameExtents=new At(1,1),this._viewportCount=1,this._viewports=[new wt(0,0,1,1)]}function pi(){di.call(this,new q(50,1,.5,500))}function fi(t,e,r,n,i,a){ci.call(this,t,e),this.type="SpotLight",this.position.copy(B.DefaultUp),this.updateMatrix(),this.target=new B,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new pi}function mi(){di.call(this,new q(90,1,.5,500)),this._frameExtents=new At(4,2),this._viewportCount=6,this._viewports=[new wt(2,1,1,1),new wt(0,1,1,1),new wt(3,1,1,1),new wt(1,1,1,1),new wt(3,0,1,1),new wt(1,0,1,1)],this._cubeDirections=[new Mt(1,0,0),new Mt(-1,0,0),new Mt(0,0,1),new Mt(0,0,-1),new Mt(0,1,0),new Mt(0,-1,0)],this._cubeUps=[new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,0,1),new Mt(0,0,-1)]}function gi(t,e,r,n){ci.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new mi}function vi(t,e,r,n,i,a){j.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==r?r:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function yi(){di.call(this,new vi(-5,5,5,-5,.5,500))}function xi(t,e){ci.call(this,t,e),this.type="DirectionalLight",this.position.copy(B.DefaultUp),this.updateMatrix(),this.target=new B,this.shadow=new yi}function bi(t,e){ci.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function _i(t,e,r,n){ci.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function Ai(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Mt)}function wi(t,e){ci.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new Ai}function Mi(t){zn.call(this,t),this.textures={}}function Ci(){X.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Ti(t,e,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),G.call(this,t,e,r),this.meshPerAttribute=n||1}function Si(t){zn.call(this,t)}function Ei(t){zn.call(this,t)}function Ii(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),zn.call(this,t),this.options=void 0}function Li(){this.type="ShapePath",this.color=new U,this.subPaths=[],this.currentPath=null}function Ri(t){this.type="Font",this.data=t}function Pi(t){zn.call(this,t)}function Di(t){zn.call(this,t)}function Oi(t,e,r){wi.call(this,void 0,r),t=(new U).set(t),r=(new U).set(e),e=new Mt(t.r,t.g,t.b),t=new Mt(r.r,r.g,r.b);var n=(r=Math.sqrt(Math.PI))*Math.sqrt(.75);this.sh.coefficients[0].copy(e).add(t).multiplyScalar(r),this.sh.coefficients[1].copy(e).sub(t).multiplyScalar(n)}function Fi(t,e){wi.call(this,void 0,e),t=(new U).set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Bi(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ni(){B.call(this),this.type="AudioListener",this.context=sp(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Bi}function zi(t){B.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function Ui(t){zi.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function ki(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Hi(t,e,r){switch(this.binding=t,this.valueSize=r,e){case"quaternion":t=this._slerp,e=this._slerpAdditive;var n=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":e=t=this._select,n=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:t=this._lerp,e=this._lerpAdditive,n=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=e,this._setIdentity=n,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Gi(t,e,r){r=r||Vi.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Vi(t,e,r){this.path=e,this.parsedPath=r||Vi.parseTrackName(e),this.node=Vi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Wi(t,e,r,n){this._mixer=t,this._clip=e,this._localRoot=r||null,this.blendMode=n||e.blendMode,e=(t=e.tracks).length,r=Array(e),n={endingStart:2400,endingEnd:2400};for(var i=0;i!==e;++i){var a=t[i].createInterpolant(null);(r[i]=a).settings=n}this._interpolantSettings=n,this._interpolants=r,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function ji(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Xi(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function qi(t,e,r){He.call(this,t,e),this.meshPerAttribute=r||1}function Yi(t,e,r,n){this.ray=new u(t,e),this.near=r||0,this.far=n||1/0,this.camera=null,this.layers=new s,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},ku(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Zi(t,e){return t.distance-e.distance}function Ji(t,e,r,n){if(t.layers.test(e.layers)&&t.raycast(e,r),!0===n){n=0;for(var i=(t=t.children).length;n<i;n++)Ji(t[n],e,r,!0)}}function Ki(t,e){this.min=void 0!==t?t:new At(1/0,1/0),this.max=void 0!==e?e:new At(-1/0,-1/0)}function Qi(t,e){this.start=void 0!==t?t:new Mt,this.end=void 0!==e?e:new Mt}function $i(t){B.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function ta(t,e){B.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new X,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var r=0,n=1;r<32;r++,n++){var i=r/32*Math.PI*2,a=n/32*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(a),Math.sin(a),1)}t.setAttribute("position",new I(e,3)),e=new Ke({fog:!1,toneMapped:!1}),this.cone=new $e(t,e),this.add(this.cone),this.update()}function ea(t){for(var e=function t(e){var r=[];e&&e.isBone&&r.push(e);for(var n=0;n<e.children.length;n++)r.push.apply(r,t(e.children[n]));return r}(t),r=new X,n=[],i=[],a=new U(0,0,1),o=new U(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}r.setAttribute("position",new I(n,3)),r.setAttribute("color",new I(i,3)),n=new Ke({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),$e.call(this,r,n),this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function ra(t,e,r){this.light=t,this.light.updateMatrixWorld(),this.color=r,t=new Kr(e,4,2),e=new H({wireframe:!0,fog:!1,toneMapped:!1}),V.call(this,t,e),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function na(t,e,r){B.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,(t=new gr(e)).rotateY(.5*Math.PI),this.material=new H({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.setAttribute("color",new G(e,3)),this.add(new V(t,this.material)),this.update()}function ia(t,e,r,n){t=t||10,e=e||10,r=new U(void 0!==r?r:4473924),n=new U(void 0!==n?n:8947848);var i=e/2,a=t/e,o=t/2;t=[];for(var s=[],l=0,u=0,c=-o;l<=e;l++,c+=a){t.push(-o,0,c,o,0,c),t.push(c,0,-o,c,0,o);var h=l===i?r:n;h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3}(e=new X).setAttribute("position",new I(t,3)),e.setAttribute("color",new I(s,3)),r=new Ke({vertexColors:!0,toneMapped:!1}),$e.call(this,e,r),this.type="GridHelper"}function aa(t,e,r,n,i,a){t=t||10,e=e||16,r=r||8,n=n||64,i=new U(void 0!==i?i:4473924),a=new U(void 0!==a?a:8947848);for(var o=[],s=[],l=0;l<=e;l++){var u=l/e*2*Math.PI,c=Math.sin(u)*t,u=Math.cos(u)*t;o.push(0,0,0),o.push(c,0,u);var h=1&l?i:a;s.push(h.r,h.g,h.b),s.push(h.r,h.g,h.b)}for(l=0;l<=r;l++){var h=1&l?i:a,d=t-t/r*l;for(e=0;e<n;e++)u=e/n*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,o.push(c,0,u),s.push(h.r,h.g,h.b),u=(e+1)/n*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,o.push(c,0,u),s.push(h.r,h.g,h.b)}(t=new X).setAttribute("position",new I(o,3)),t.setAttribute("color",new I(s,3)),o=new Ke({vertexColors:!0,toneMapped:!1}),$e.call(this,t,o),this.type="PolarGridHelper"}function oa(t,e,r){B.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===e&&(e=1),(t=new X).setAttribute("position",new I([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new Ke({fog:!1,toneMapped:!1}),this.lightPlane=new Qe(t,e),this.add(this.lightPlane),(t=new X).setAttribute("position",new I([0,0,0,0,0,1],3)),this.targetLine=new Qe(t,e),this.add(this.targetLine),this.update()}function sa(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){a.push(0,0,0),o.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(a.length/3-1)}var r=new X,i=new Ke({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],s={},l=new U(16755200),u=new U(16711680),c=new U(43775),h=new U(16777215),d=new U(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",h),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),r.setAttribute("position",new I(a,3)),r.setAttribute("color",new I(o,3)),$e.call(this,r,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function la(t,e,r,n,i,a,o){if(Op.set(i,a,o).unproject(n),void 0!==(t=e[t]))for(r=r.getAttribute("position"),e=0,n=t.length;e<n;e++)r.setXYZ(t[e],Op.x,Op.y,Op.z)}function ua(t,e){this.object=t,void 0===e&&(e=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new Float32Array(24),n=new X;n.setIndex(new G(t,1)),n.setAttribute("position",new G(r,3)),$e.call(this,n,new Ke({color:e,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function ca(t,e){this.type="Box3Helper",this.box=t,e=e||16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new X;r.setIndex(new G(t,1)),r.setAttribute("position",new I([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),$e.call(this,r,new Ke({color:e,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function ha(t,e,r){this.plane=t,this.size=void 0===e?1:e,t=void 0!==r?r:16776960,(e=new X).setAttribute("position",new I([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),Qe.call(this,e,new Ke({color:t,toneMapped:!1})),this.type="PlaneHelper",(e=new X).setAttribute("position",new I([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new V(e,new H({color:t,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function da(t,e,r,n,i,a){B.call(this),this.type="ArrowHelper",void 0===t&&(t=new Mt(0,0,1)),void 0===e&&(e=new Mt(0,0,0)),void 0===r&&(r=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*r),void 0===a&&(a=.2*i),void 0===Np&&((Np=new X).setAttribute("position",new I([0,0,0,0,1,0],3)),(zp=new ln(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Qe(Np,new Ke({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new V(zp,new H({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(r,i,a)}function pa(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new X).setAttribute("position",new I(e,3)),t.setAttribute("color",new I([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new Ke({vertexColors:!0,toneMapped:!1}),$e.call(this,t,e),this.type="AxesHelper"}function fa(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Jn.call(this,t),this.type="catmullrom"}function ma(){}function ga(t,e){for(var r in e)t[r]=e[r]}function va(t,e){this.lng=t,this.lat=e}function ya(t,e){this.x=t,this.y=e}function xa(t){for(var e=t.length;0<=--e;)t[e]=0}function ba(e){function t(t){return null==t?t:(1<arguments.length&&(t=Array.prototype.slice.call(arguments)),e(t))}return"conversion"in e&&(t.conversion=e.conversion),t}function _a(i){function t(t){if(null==t)return t;1<arguments.length&&(t=Array.prototype.slice.call(arguments));var e=i(t);if("object"===(void 0===e?"undefined":Ou(e)))for(var r=e.length,n=0;n<r;n++)e[n]=Math.round(e[n]);return e}return"conversion"in i&&(t.conversion=i.conversion),t}function Aa(t,e){if(!(this instanceof Aa))return new Aa(t,e);if((e=e&&e in uf?null:e)&&!(e in sf))throw Error("Unknown model: "+e);if(void 0===t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Aa)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){if(null===(e=nf.get(t)))throw Error("Unable to parse color from string: "+t);this.model=e.model;var r=sf[this.model].channels;this.color=e.value.slice(0,r),this.valpha="number"==typeof e.value[r]?e.value[r]:1}else if(t.length)this.model=e||"rgb",r=sf[this.model].channels,e=lf.call(t,0,r),this.color=Ca(e,r),this.valpha="number"==typeof t[r]?t[r]:1;else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{if(this.valpha=1,e=Nu(t),"alpha"in t&&(e.splice(e.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0),!((e=e.sort().join(""))in cf))throw Error("Unable to parse color from object: "+zu(t));this.model=cf[e];var r=sf[this.model].labels,n=[];for(e=0;e<r.length;e++)n.push(t[r[e]]);this.color=Ca(n)}if(hf[this.model])for(r=sf[this.model].channels,e=0;e<r;e++)(t=hf[this.model][e])&&(this.color[e]=t(this.color[e]));this.valpha=Math.max(0,Math.min(1,this.valpha)),Du&&Du(this)}function wa(r,n,i){return(r=Array.isArray(r)?r:[r]).forEach(function(t){(hf[t]||(hf[t]=[]))[n]=i}),r=r[0],function(t){if(arguments.length){i&&(t=i(t));var e=this[r]();return e.color[n]=t,e}return e=this[r]().color[n],e=i?i(e):e}}function Ma(e){return function(t){return Math.max(0,Math.min(e,t))}}function Ca(t,e){for(var r=0;r<e;r++)"number"!=typeof t[r]&&(t[r]=0);return t}function Ta(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1}function Sa(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}function Ea(n,i,t){if(Sa(n),void 0===i)return n;switch(t){case 1:return function(t){return n.call(i,t)};case 2:return function(t,e){return n.call(i,t,e)};case 3:return function(t,e,r){return n.call(i,t,e,r)}}return function(){return n.apply(i,arguments)}}function Ia(t){return"object"==typeof t?null!==t:"function"==typeof t}function La(t){if(!Ia(t))throw TypeError(t+" is not an object!");return t}function Ra(t){try{return!!t()}catch(t){return!0}}function Pa(t,e){if(!Ia(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!Ia(n=r.call(t))||"function"==typeof(r=t.valueOf)&&!Ia(n=r.call(t))||!e&&"function"==typeof(r=t.toString)&&!Ia(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}function Da(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function Oa(t,e){return ja.call(t,e)}var Fa="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==cm?cm:"undefined"!=typeof self?self:{},Ba=r(function(t){t=t.exports="undefined"!=typeof window&&Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=t)}),Na=r(function(t){t=t.exports={version:"2.6.5"},"number"==typeof __e&&(__e=t)}),za=!Ra(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Ua=Ba.document,ka=Ia(Ua)&&Ia(Ua.createElement),Ha=!za&&!Ra(function(){return 7!=Object.defineProperty(ka?Ua.createElement("div"):{},"a",{get:function(){return 7}}).a}),Ga=Object.defineProperty,Va={f:za?Object.defineProperty:function(t,e,r){if(La(t),e=Pa(e,!0),La(r),Ha)try{return Ga(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},Wa=za?function(t,e,r){return Va.f(t,e,Da(1,r))}:function(t,e,r){return t[e]=r,t},ja={}.hasOwnProperty,Xa=function(t,e,r){var n,i,a=t&Xa.F,o=t&Xa.G,s=t&Xa.S,l=t&Xa.P,u=t&Xa.B,c=t&Xa.W,h=o?Na:Na[e]||(Na[e]={}),d=h.prototype,s=o?Ba:s?Ba[e]:(Ba[e]||{}).prototype;for(n in r=o?e:r)(e=!a&&s&&void 0!==s[n])&&Oa(h,n)||(i=(e?s:r)[n],h[n]=o&&"function"!=typeof s[n]?r[n]:u&&e?Ea(i,Ba):c&&s[n]==i?function(n){function t(t,e,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(t);case 2:return new n(t,e)}return new n(t,e,r)}return n.apply(this,arguments)}return t.prototype=n.prototype,t}(i):l&&"function"==typeof i?Ea(Function.call,i):i,l&&((h.virtual||(h.virtual={}))[n]=i,t&Xa.R&&d&&!d[n]&&Wa(d,n,i)))};Xa.F=1,Xa.G=2,Xa.S=4,Xa.P=8,Xa.B=16,Xa.W=32,Xa.U=64,Xa.R=128;var qa=Xa;function Ya(t){return isNaN(t=+t)?0:(0<t?ao:io)(t)}function Za(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}function Ja(t){return so.call(t).slice(8,-1)}function Ka(t){return lo(Za(t))}function Qa(t){return 0<t?uo(Ya(t),9007199254740991):0}function $a(t){return"Symbol(".concat(void 0===t?"":t,")_",(++fo+mo).toString(36))}function to(t,e){var r,n=0,i=[];for(r in t=Ka(t))r!=yo&&Oa(t,r)&&i.push(r);for(;e.length>n;)Oa(t,r=e[n++])&&(~vo(i,r)||i.push(r));return i}function eo(){}function ro(t,e,r){t&&!Oa(t=r?t:t.prototype,Eo)&&So(t,Eo,{configurable:!0,value:e})}qa(qa.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}});var no=Na.Math.log2,Lu=e(r(function(t){t.exports={default:no,__esModule:!0}})),io=Math.ceil,ao=Math.floor,oo={},so={}.toString,lo=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Ja(t)?t.split(""):Object(t)},uo=Math.min,co=Math.max,ho=Math.min,po=r(function(t){var r=Ba["__core-js_shared__"]||(Ba["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:Na.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),fo=0,mo=Math.random(),go=po("keys"),vo=function(t,e,r){t=Ka(t);var n=Qa(t.length);for(r=(r=Ya(r))<0?co(r+n,0):ho(r,n),0;r<n;r++)if(r in t&&t[r]===e)return r||0;return-1},yo=(gs=function(t){return go[t]||(go[t]=$a(t))})("IE_PROTO"),xo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),bo=Object.keys||function(t){return to(t,xo)},_o=za?Object.defineProperties:function(t,e){La(t);for(var r,n=bo(e),i=n.length,a=0;a<i;)Va.f(t,r=n[a++],e[r]);return t},Ao=(ds=Ba.document)&&ds.documentElement,wo=gs("IE_PROTO"),Mo=function(){var t=ka?Ua.createElement("iframe"):{},e=xo.length;for(t.style.display="none",Ao.appendChild(t),t.src="javascript:",(t=t.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Mo=t.F;e--;)delete Mo.prototype[xo[e]];return Mo()},Co=Object.create||function(t,e){var r;return null!==t?(eo.prototype=La(t),r=new eo,eo.prototype=null,r[wo]=t):r=Mo(),void 0===e?r:_o(r,e)},To=r(function(t){var e=po("wks"),r=Ba.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:$a)("Symbol."+t))}).store=e}),So=Va.f,Eo=To("toStringTag"),Io={};function Lo(){return this}function Ro(t,e,r,n,i,a,o){m=e,p=n,(f=r).prototype=Co(Io,{next:Da(1,p)}),ro(f,m+" Iterator");var s,l=e+" Iterator",u="values"==i,c=!(n=function(t){return!Bo&&t in h?h[t]:function(){return new r(this,t)}}),h=t.prototype,d=h[Fo]||h["@@iterator"]||i&&h[i],p=d||n(i),f=i?u?n("entries"):p:void 0,m="Array"==e&&h.entries||d;if(m&&((t=Oo(m.call(new t)))!==Object.prototype&&t.next&&ro(t,l,!0)),u&&d&&"values"!==d.name&&(c=!0,p=function(){return d.call(this)}),o&&(Bo||c||!h[Fo])&&Wa(h,Fo,p),oo[e]=p,oo[l]=Lo,i){var g={values:u?p:n("values"),keys:a?p:n("keys"),entries:f};if(o)for(s in g)s in h||Wa(h,s,g[s]);else qa(qa.P+qa.F*(Bo||c),e,g)}return g}Wa(Io,To("iterator"),function(){return this});var Po=gs("IE_PROTO"),Do=Object.prototype,Oo=Object.getPrototypeOf||function(t){return t=Object(Za(t)),Oa(t,Po)?t[Po]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Do:null},Fo=To("iterator"),Bo=!([].keys&&"next"in[].keys()),No=function(t,e){t=String(Za(t)),e=Ya(e);var r,n=t.length;if(e<0||n<=e)return"";var i=t.charCodeAt(e);return i<55296||56319<i||e+1===n||(r=t.charCodeAt(e+1))<56320||57343<r?t.charAt(e):t.slice(e,e+2)};function zo(e,r,t,n){try{return n?r(La(t)[0],t[1]):r(t)}catch(t){throw void 0!==(r=e.return)&&La(r.call(e)),t}}function Uo(t){var e;if(void 0===t)var r="Undefined";else{if(null===t)var n="Null";else{t:{var i=t=Object(t);try{n=i[Go];break t}catch(t){}n=void 0}n="string"==typeof(r=n)?r:Vo?Ja(t):"Object"==(e=Ja(t))&&"function"==typeof t.callee?"Arguments":e}r=n}return r}Ro(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,e=this._i;return e>=t.length?{value:void 0,done:!0}:(t=No(t,e),this._i+=t.length,{value:t,done:!1})});var ko=To("iterator"),Ho=Array.prototype,Go=To("toStringTag"),Vo="Arguments"==Ja(function(){return arguments}()),Wo=To("iterator"),jo=Na.getIteratorMethod=function(t){if(null!=t)return t[Wo]||t["@@iterator"]||oo[Uo(t)]},Xo=To("iterator"),qo=!1;try{[7][Xo]().return=function(){qo=!0}}catch(t){}var Yo=function(t,e){if(!e&&!qo)return!1;var r=!1;try{var n=(e=[7])[Xo]();n.next=function(){return{done:r=!0}},e[Xo]=function(){return n},t(e)}catch(t){}return r};function Zo(t,e){return{value:e,done:!!t}}qa(qa.S+qa.F*!Yo(function(t){}),"Array",{from:function(t){var e=Object(Za(t)),r="function"==typeof this?this:Array,n=arguments.length,i=1<n?arguments[1]:void 0,a=void 0!==i,o=0,s=jo(e);if(a&&(i=Ea(i,2<n?arguments[2]:void 0,2)),null!=s&&(r!=Array||void 0===s||oo.Array!==s&&Ho[ko]!==s))for(e=s.call(e),r=new r;!(l=e.next()).done;o++)n=r,s=o,l=a?zo(e,i,[l.value,o],!0):l.value,s in n?Va.f(n,s,Da(0,l)):n[s]=l;else for(r=new r(n=Qa(e.length));o<n;o++){var s=r,l=o,u=a?i(e[o],o):e[o];l in s?Va.f(s,l,Da(0,u)):s[l]=u}return r.length=o,r}});var Jo=Na.Array.from,Ko=r(function(t){t.exports={default:Jo,__esModule:!0}}),Ru=e(Ko);Ro(Array,"Array",function(t,e){this._t=Ka(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,Zo(1)):Zo(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),oo.Arguments=oo.Array;for(var Qo=To("toStringTag"),$o="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),ts=0;ts<$o.length;ts++){var es=$o[ts],rs=Ba[es],rs=rs&&rs.prototype;rs&&!rs[Qo]&&Wa(rs,Qo,es),oo[es]=oo.Array}function ns(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}function is(t,e){var r;return void 0===(t=La(t).constructor)||null==(r=La(t)[ls])?e:Sa(r)}function as(){var t,e=+this;ms.hasOwnProperty(e)&&(t=ms[e],delete ms[e],t())}var os,ss=r(function(t){var s={},l={};(t=t.exports=function(t,e,r,n,i){var a,o;if(i=i?function(){return t}:jo(t),r=Ea(r,n,e?2:1),n=0,"function"!=typeof i)throw TypeError(t+" is not iterable!");if(void 0===i||oo.Array!==i&&Ho[ko]!==i){for(n=i.call(t);!(o=n.next()).done;)if((i=zo(n,r,o.value,e))===s||i===l)return i}else for(a=Qa(t.length);n<a;n++)if((i=e?r(La(o=t[n])[0],o[1]):r(t[n]))===s||i===l)return i}).BREAK=s,t.RETURN=l}),ls=To("species"),us=Ba.process,cs=Ba.setImmediate,hs=Ba.clearImmediate,ds=Ba.MessageChannel,ps=Ba.Dispatch,fs=0,ms={},gs=function(t){as.call(t.data)};function vs(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}function ys(t,e){return La(t),Ia(e)&&e.constructor===t?e:((0,(t=Ds.f(t)).resolve)(e),t.promise)}function xs(t,e,r){for(var n in e)r&&t[n]?t[n]=e[n]:Wa(t,n,e[n]);return t}function bs(t){t=("function"==typeof Na[t]?Na:Ba)[t],za&&t&&!t[Fs]&&Va.f(t,Fs,{configurable:!0,get:function(){return this}})}function _s(){}function As(t){var e;return!(!Ia(t)||"function"!=typeof(e=t.then))&&e}function ws(h,d){var p;h._n||(h._n=!0,p=h._c,Bs(function(){for(var t=h._v,e=1==h._s,r=0;p.length>r;){var n=void 0,i=void 0,a=void 0,o=p[r++],s=e?o.ok:o.fail,l=o.resolve,u=o.reject,c=o.domain;try{s?(e||(2==h._h&&js(h),h._h=1),!0===s?a=t:(c&&c.enter(),a=s(t),c&&(c.exit(),n=!0)),a===o.promise?u(Ns("Promise-chain cycle")):(i=As(a))?i.call(a,l,u):l(a)):u(t)}catch(t){c&&!n&&c.exit(),u(t)}}h._c=[],h._n=!1,d&&!h._h&&Ws(h)}))}function Ms(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),ws(e,!0))}cs&&hs||(cs=function(t){for(var e=[],r=1;r<arguments.length;)e.push(arguments[r++]);return ms[++fs]=function(){!function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}t.apply(r,e)}("function"==typeof t?t:Function(t),e)},os(fs),fs},hs=function(t){delete ms[t]},"process"==Ja(us)?os=function(t){us.nextTick(Ea(as,t,1))}:ps&&ps.now?os=function(t){ps.now(Ea(as,t,1))}:ds?(Rl=new ds,Vs=Rl.port2,Rl.port1.onmessage=gs,os=Ea(Vs.postMessage,Vs,1)):Ba.addEventListener&&"function"==typeof postMessage&&!Ba.importScripts?(os=function(t){Ba.postMessage(t+"","*")},Ba.addEventListener("message",gs,!1)):os="onreadystatechange"in(ka?Ua.createElement("script"):{})?function(t){Ao.appendChild(ka?Ua.createElement("script"):{}).onreadystatechange=function(){Ao.removeChild(this),as.call(t)}}:function(t){setTimeout(Ea(as,t,1),0)});var Cs,Ts,Ss,Es=cs,Is=Ba.MutationObserver||Ba.WebKitMutationObserver,Ls=Ba.process,Rs=Ba.Promise,Ps="process"==Ja(Ls),Ds={f:function(t){return new n(t)}},Os=(ds=Ba.navigator)&&ds.userAgent||"",Fs=To("species"),Bs=function(){function t(){var t;for(Ps&&(t=Ls.domain)&&t.exit();r;){var e=r.fn;r=r.next;try{e()}catch(t){throw r?i():n=void 0,t}}n=void 0,t&&t.enter()}var r,n,e,i,a,o;return i=Ps?function(){Ls.nextTick(t)}:!Is||Ba.navigator&&Ba.navigator.standalone?Rs&&Rs.resolve?(e=Rs.resolve(void 0),function(){e.then(t)}):function(){Es.call(Ba,t)}:(a=!0,o=document.createTextNode(""),new Is(t).observe(o,{characterData:!0}),function(){o.data=a=!a}),function(t){t={fn:t,next:void 0},n&&(n.next=t),r||(r=t,i()),n=t}}(),Ns=Ba.TypeError,zs=Ba.process,Us=(Rl=zs&&zs.versions)&&Rl.v8||"",ks=Ba.Promise,Hs="process"==Uo(zs),Gs=Cs=Ds.f,Vs=!!function(){try{var t=ks.resolve(1),e=(t.constructor={})[To("species")]=function(t){t(_s,_s)};return(Hs||"function"==typeof PromiseRejectionEvent)&&t.then(_s)instanceof e&&0!==Us.indexOf("6.6")&&-1===Os.indexOf("Chrome/66")}catch(t){}}(),Ws=function(i){Es.call(Ba,function(){var t,e,r=i._v,n=1!==i._h&&0===(i._a||i._c).length;if(n&&(e=vs(function(){Hs?zs.emit("unhandledRejection",r,i):(t=Ba.onunhandledrejection)?t({promise:i,reason:r}):(t=Ba.console)&&t.error&&t.error("Unhandled promise rejection",r)}),i._h=Hs||1!==i._h&&0===(i._a||i._c).length?2:1),i._a=void 0,n&&e.e)throw e.v})},js=function(e){Es.call(Ba,function(){var t;Hs?zs.emit("rejectionHandled",e):(t=Ba.onrejectionhandled)&&t({promise:e,reason:e._v})})},Xs=function(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Ns("Promise can't be resolved itself");(r=As(t))?Bs(function(){var e={_w:n,_d:!1};try{r.call(t,Ea(Xs,e,1),Ea(Ms,e,1))}catch(t){Ms.call(e,t)}}):(n._v=t,n._s=1,ws(n,!1))}catch(t){Ms.call({_w:n,_d:!1},t)}}};Vs||(ks=function(t){ns(this,ks,"Promise","_h"),Sa(t),Ts.call(this);try{t(Ea(Xs,this,1),Ea(Ms,this,1))}catch(t){Ms.call(this,t)}},(Ts=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=xs(ks.prototype,{then:function(t,e){var r=Gs(is(this,ks));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Hs?zs.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&ws(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),Ss=function(){var t=new Ts;this.promise=t,this.resolve=Ea(Xs,t,1),this.reject=Ea(Ms,t,1)},Ds.f=Gs=function(t){return t===ks||t===qs?new Ss:Cs(t)}),qa(qa.G+qa.W+qa.F*!Vs,{Promise:ks}),ro(ks,"Promise"),bs("Promise");var qs=Na.Promise;qa(qa.S+qa.F*!Vs,"Promise",{reject:function(t){var e=Gs(this);return(0,e.reject)(t),e.promise}}),qa(qa.S+ +qa.F,"Promise",{resolve:function(t){return ys(this===qs?ks:this,t)}}),qa(qa.S+qa.F*!(Vs&&Yo(function(t){ks.all(t).catch(_s)})),"Promise",{all:function(t){var o=this,e=Gs(o),s=e.resolve,l=e.reject,r=vs(function(){var n=[],i=0,a=1;ss(t,!1,function(t){var e=i++,r=!1;n.push(void 0),a++,o.resolve(t).then(function(t){r||(r=!0,n[e]=t,--a||s(n))},l)}),--a||s(n)});return r.e&&l(r.v),e.promise},race:function(t){var e=this,r=Gs(e),n=r.reject,i=vs(function(){ss(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}}),qa(qa.P+qa.R,"Promise",{finally:function(e){var r=is(this,Na.Promise||Ba.Promise),t="function"==typeof e;return this.then(t?function(t){return ys(r,e()).then(function(){return t})}:e,t?function(t){return ys(r,e()).then(function(){throw t})}:e)}}),qa(qa.S,"Promise",{try:function(t){var e=Ds.f(this);return((t=vs(t)).e?e.reject:e.resolve)(t.v),e.promise}});var Ys=Na.Promise,Pu=e(r(function(t){t.exports={default:Ys,__esModule:!0}})),Zs=r(function(t){function r(t){e(t,n,{value:{i:"O"+ ++i,w:{}}})}var n=$a("meta"),e=Va.f,i=0,a=Object.isExtensible||function(){return!0},o=!Ra(function(){return a(Object.preventExtensions({}))}),s=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!Ia(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!Oa(t,n)){if(!a(t))return"F";if(!e)return"E";r(t)}return t[n].i},getWeak:function(t,e){if(!Oa(t,n)){if(!a(t))return!0;if(!e)return!1;r(t)}return t[n].w},onFreeze:function(t){return o&&s.NEED&&a(t)&&!Oa(t,n)&&r(t),t}}}),gs=function(t,e){var r=(Na.Object||{})[t]||Object[t],n={};n[t]=e(r),qa(qa.S+qa.F*Ra(function(){r(1)}),"Object",n)},Js=Zs.onFreeze;gs("freeze",function(e){return function(t){return e&&Ia(t)?e(Js(t)):t}});var Ks=Na.Object.freeze,Du=e(r(function(t){t.exports={default:Ks,__esModule:!0}})),Qs={f:To},$s=Qs.f("iterator"),tl=r(function(t){t.exports={default:$s,__esModule:!0}});function el(t){var e=Na.Symbol||(Na.Symbol={});"_"==t.charAt(0)||t in e||il(e,t,{value:Qs.f(t)})}function rl(t){var e=Ml[t]=Co(yl.prototype);return e._k=t,e}function nl(t,e){La(t);var r,n=e=Ka(e),i=bo(n);if(o=al)for(var a,o=o(n),s=ol,l=0;o.length>l;)s.call(n,a=o[l++])&&i.push(a);for(n=0,a=i.length;n<a;)Ll(t,r=i[n++],e[r]);return t}e(tl);var il=Va.f,al=Object.getOwnPropertySymbols,ol={}.propertyIsEnumerable,sl=Array.isArray||function(t){return"Array"==Ja(t)},ll=xo.concat("length","prototype"),ul=Object.getOwnPropertyNames||function(t){return to(t,ll)},cl={}.toString,hl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],dl=Object.getOwnPropertyDescriptor,pl={f:za?dl:function(t,e){if(t=Ka(t),e=Pa(e,!0),Ha)try{return dl(t,e)}catch(t){}if(Oa(t,e))return Da(!ol.call(t,e),t[e])}},fl=Zs.KEY,ml=pl.f,gl=Va.f,vl=function(t){if(hl&&"[object Window]"==cl.call(t))try{var e=ul(t)}catch(t){e=hl.slice()}else e=ul(Ka(t));return e},yl=Ba.Symbol,xl=Ba.JSON,bl=xl&&xl.stringify,_l=To("_hidden"),cs=To("toPrimitive"),Al={}.propertyIsEnumerable,wl=po("symbol-registry"),Ml=po("symbols"),Cl=po("op-symbols"),Tl=Object.prototype,ds="function"==typeof yl,Sl=!(Rl=Ba.QObject)||!Rl.prototype||!Rl.prototype.findChild,El=za&&Ra(function(){return 7!=Co(gl({},"a",{get:function(){return gl(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=ml(Tl,e);n&&delete Tl[e],gl(t,e,r),n&&t!==Tl&&gl(Tl,e,n)}:gl,Il=ds&&"symbol"==typeof yl.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof yl},Ll=function(t,e,r){return t===Tl&&Ll(Cl,e,r),La(t),e=Pa(e,!0),La(r),Oa(Ml,e)?(r.enumerable?(Oa(t,_l)&&t[_l][e]&&(t[_l][e]=!1),r=Co(r,{enumerable:Da(0,!1)})):(Oa(t,_l)||gl(t,_l,Da(1,{})),t[_l][e]=!0),El(t,e,r)):gl(t,e,r)},Vs=function(t,e){if(t=Ka(t),e=Pa(e,!0),t!==Tl||!Oa(Ml,e)||Oa(Cl,e)){var r=ml(t,e);return!r||!Oa(Ml,e)||Oa(t,_l)&&t[_l][e]||(r.enumerable=!0),r}},Yo=function(t){t=vl(Ka(t));for(var e,r=[],n=0;t.length>n;)Oa(Ml,e=t[n++])||e==_l||e==fl||r.push(e);return r},Rl=function(t){var e=t===Tl;t=vl(e?Cl:Ka(t));for(var r,n=[],i=0;t.length>i;)!Oa(Ml,r=t[i++])||e&&!Oa(Tl,r)||n.push(Ml[r]);return n};ds||(Wa((yl=function(){if(this instanceof yl)throw TypeError("Symbol is not a constructor!");var e=$a(0<arguments.length?arguments[0]:void 0),r=function(t){this===Tl&&r.call(Cl,t),Oa(this,_l)&&Oa(this[_l],e)&&(this[_l][e]=!1),El(this,e,Da(1,t))};return za&&Sl&&El(Tl,e,{configurable:!0,set:r}),rl(e)}).prototype,"toString",function(){return this._k}),pl.f=Vs,Va.f=Ll,ol=function(t){var e=Al.call(this,t=Pa(t,!0));return!(this===Tl&&Oa(Ml,t)&&!Oa(Cl,t))&&(!(e||!Oa(this,t)||!Oa(Ml,t)||Oa(this,_l)&&this[_l][t])||e)},al=Rl,Qs.f=function(t){return rl(To(t))}),qa(qa.G+qa.W+qa.F*!ds,{Symbol:yl});for(var Pl="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),Dl=0;Pl.length>Dl;)To(Pl[Dl++]);for(var Ol=bo(To.store),Fl=0;Ol.length>Fl;)el(Ol[Fl++]);qa(qa.S+qa.F*!ds,"Symbol",{for:function(t){return Oa(wl,t+="")?wl[t]:wl[t]=yl(t)},keyFor:function(t){if(!Il(t))throw TypeError(t+" is not a symbol!");for(var e in wl)if(wl[e]===t)return e},useSetter:function(){Sl=!0},useSimple:function(){Sl=!1}}),qa(qa.S+qa.F*!ds,"Object",{create:function(t,e){return void 0===e?Co(t):nl(Co(t),e)},defineProperty:Ll,defineProperties:nl,getOwnPropertyDescriptor:Vs,getOwnPropertyNames:Yo,getOwnPropertySymbols:Rl}),xl&&qa(qa.S+qa.F*(!ds||Ra(function(){var t=yl();return"[null]"!=bl([t])||"{}"!=bl({a:t})||"{}"!=bl(Object(t))})),"JSON",{stringify:function(t){for(var r,e=[t],n=1;n<arguments.length;)e.push(arguments[n++]);if(r=n=e[1],(Ia(n)||void 0!==t)&&!Il(t))return sl(n)||(n=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Il(e))return e}),e[1]=n,bl.apply(xl,e)}}),yl.prototype[cs]||Wa(yl.prototype,cs,yl.prototype.valueOf),ro(yl,"Symbol"),ro(Math,"Math",!0),ro(Ba.JSON,"JSON",!0),el("asyncIterator"),el("observable");var Bl=Na.Symbol,Nl=r(function(t){t.exports={default:Bl,__esModule:!0}});function zl(t,e){if(!Ia(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}function Ul(t,e){var r=jl(e);if("F"!==r)return t._i[r];for(t=t._f;t;t=t.n)if(t.k==e)return t}function kl(t,e){var r;return sl(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!sl(r.prototype)||(r=void 0),!Ia(r)||null===(r=r[Yl])&&(r=void 0)),new(void 0===r?Array:r)(e)}function Hl(l,t){var u=1==l,c=2==l,h=3==l,d=4==l,p=6==l,f=5==l||p,m=t||kl;return function(t,e,r){var n=Object(Za(t)),i=lo(n);e=Ea(e,r,3),r=Qa(i.length);var a,o,s=0;for(t=u?m(t,r):c?m(t,0):void 0;s<r;s++)if((f||s in i)&&(a=i[s],o=e(a,s,n),l))if(u)t[s]=o;else if(o)switch(l){case 3:return!0;case 5:return a;case 6:return s;case 2:t.push(a)}else if(d)return!1;return p?-1:h||d?d:t}}function Gl(r,t,e,n,i,a){var o=Ba[r],s=o,l=i?"set":"add",u=s&&s.prototype,c={};return za&&"function"==typeof s&&(a||u.forEach&&!Ra(function(){(new s).entries().next()}))?(s=t(function(t,e){ns(t,s,r,"_c"),t._c=new o,null!=e&&ss(e,i,t[l],t)}),Jl("add clear delete forEach get has set keys values entries toJSON".split(" "),function(r){var n="add"==r||"set"==r;r in u&&(!a||"clear"!=r)&&Wa(s.prototype,r,function(t,e){return ns(this,s,r),n||!a||Ia(t)?(t=this._c[r](0===t?0:t,e),n?this:t):"get"==r&&void 0})}),a||Zl(s.prototype,"size",{get:function(){return this._c.size}})):(s=n.getConstructor(t,r,i,l),xs(s.prototype,e),Zs.NEED=!0),ro(s,r),c[r]=s,qa(qa.G+qa.W+qa.F,c),a||n.setStrong(s,r,i),s}e(Nl);var Vl=r(function(t,e){e.__esModule=!0,t=tl&&tl.__esModule?tl:{default:tl};var r=Nl&&Nl.__esModule?Nl:{default:Nl},n="function"==typeof r.default&&"symbol"==typeof t.default?function(t){return typeof t}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":typeof t};e.default="function"==typeof r.default&&"symbol"===n(t.default)?function(t){return void 0===t?"undefined":n(t)}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":void 0===t?"undefined":n(t)}}),Ou=e(Vl),Wl=Va.f,jl=Zs.fastKey,Xl=za?"_s":"size",ql={getConstructor:function(t,i,r,n){var a=t(function(t,e){ns(t,a,i,"_i"),t._t=i,t._i=Co(null),t._f=void 0,t._l=void 0,t[Xl]=0,null!=e&&ss(e,r,t[n],t)});return xs(a.prototype,{clear:function(){for(var t=zl(this,i),e=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete e[r.i];t._f=t._l=void 0,t[Xl]=0},delete:function(t){var e,r,n=zl(this,i);return(t=Ul(n,t))&&(e=t.n,r=t.p,delete n._i[t.i],t.r=!0,r&&(r.n=e),e&&(e.p=r),n._f==t&&(n._f=e),n._l==t&&(n._l=r),n[Xl]--),!!t},forEach:function(t){zl(this,i);for(var e,r=Ea(t,1<arguments.length?arguments[1]:void 0,3);e=e?e.n:this._f;)for(r(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!Ul(zl(this,i),t)}}),za&&Wl(a.prototype,"size",{get:function(){return zl(this,i)[Xl]}}),a},def:function(t,e,r){var n,i=Ul(t,e);return i?i.v=r:(t._l=i={i:n=jl(e,!0),k:e,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=i),e&&(e.n=i),t[Xl]++,"F"!==n&&(t._i[n]=i)),t},getEntry:Ul,setStrong:function(t,r,e){Ro(t,r,function(t,e){this._t=zl(t,r),this._k=e,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?Zo(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,Zo(1))},e?"entries":"values",!e,!0),bs(r)}},Yl=To("species"),Zl=Va.f,Jl=Hl(0);function Kl(t){return t._l||(t._l=new ou)}function Ql(t,e){return nu(t.a,function(t){return t[0]===e})}Gl("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){return(t=ql.getEntry(zl(this,"Map"),t))&&t.v},set:function(t,e){return ql.def(zl(this,"Map"),0===t?0:t,e)}},ql,!0),qa(qa.P+qa.R,"Map",{toJSON:function(){if("Map"!=Uo(this))throw TypeError("Map#toJSON isn't generic");var t=[];return ss(this,!1,t.push,t,void 0),t}}),(Vs=function(t){qa(qa.S,t,{of:function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return new this(e)}})})("Map"),(Yo=function(t){qa(qa.S,t,{from:function(t,e,r){var n;if(Sa(this),(n=void 0!==e)&&Sa(e),null==t)return new this;var i,a,o=[];return n?(i=0,a=Ea(e,r,2),ss(t,!1,function(t){o.push(a(t,i++))})):ss(t,!1,o.push,o),new this(o)}})})("Map");var $l=Na.Map,Fu=e(r(function(t){t.exports={default:$l,__esModule:!0}})),tu=Object.assign,eu=!tu||Ra(function(){var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=tu({},t)[r]||"abcdefghijklmnopqrst"!=Object.keys(tu({},e)).join("")})?function(t,e){for(var r=Object(Za(t)),n=arguments.length,i=1,a=al,o=ol;i<n;)for(var s,l=lo(arguments[i++]),u=a?bo(l).concat(a(l)):bo(l),c=u.length,h=0;h<c;)o.call(l,s=u[h++])&&(r[s]=l[s]);return r}:tu,ru=Zs.getWeak,nu=Hl(5),iu=Hl(6),au=0,ou=function(){this.a=[]};ou.prototype={get:function(t){if(t=Ql(this,t))return t[1]},has:function(t){return!!Ql(this,t)},set:function(t,e){var r=Ql(this,t);r?r[1]=e:this.a.push([t,e])},delete:function(e){var t=iu(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var su={getConstructor:function(t,r,n,i){var a=t(function(t,e){ns(t,a,r,"_i"),t._t=r,t._i=au++,t._l=void 0,null!=e&&ss(e,n,t[i],t)});return xs(a.prototype,{delete:function(t){if(!Ia(t))return!1;var e=ru(t);return!0===e?Kl(zl(this,r)).delete(t):e&&Oa(e,this._i)&&delete e[this._i]},has:function(t){if(!Ia(t))return!1;var e=ru(t);return!0===e?Kl(zl(this,r)).has(t):e&&Oa(e,this._i)}}),a},def:function(t,e,r){var n=ru(La(e),!0);return!0===n?Kl(t).set(e,r):n[t._i]=r,t},ufstore:Kl};r(function(t){function e(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}}var i,r=Hl(0),n=!Ba.ActiveXObject&&"ActiveXObject"in Ba,a=Zs.getWeak,o=Object.isExtensible,s=su.ufstore,l={get:function(t){if(Ia(t)){var e=a(t);return!0===e?s(zl(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return su.def(zl(this,"WeakMap"),t,e)}},u=t.exports=Gl("WeakMap",e,l,su,!0,!0);n&&(i=su.getConstructor(e,"WeakMap"),eu(i.prototype,l),Zs.NEED=!0,r(["delete","has","get","set"],function(r){var t=u.prototype,n=t[r];Wa(t,r,function(t,e){return Ia(t)&&!o(t)?(this._f||(this._f=new i),t=this._f[r](t,e),"set"==r?this:t):n.call(this,t,e)})}))}),Vs("WeakMap"),Yo("WeakMap");var lu=Na.WeakMap,Bu=e(r(function(t){t.exports={default:lu,__esModule:!0}}));function uu(t){return hu.stringify.apply(hu,arguments)}gs("keys",function(){return function(t){return bo(Object(Za(t)))}});var cu=Na.Object.keys,Nu=e(r(function(t){t.exports={default:cu,__esModule:!0}})),hu=Na.JSON||(Na.JSON={stringify:JSON.stringify}),zu=e(r(function(t){t.exports={default:uu,__esModule:!0}}));function du(t,e){return pu.create(t,e)}qa(qa.S,"Object",{create:Co});var pu=Na.Object,fu=r(function(t){t.exports={default:du,__esModule:!0}}),Uu=e(fu);function mu(t,e){return gu.defineProperties(t,e)}qa(qa.S+qa.F*!za,"Object",{defineProperties:_o});var gu=Na.Object,ku=e(r(function(t){t.exports={default:mu,__esModule:!0}}));qa(qa.S+qa.F,"Object",{assign:eu});var vu=Na.Object.assign,Hu=e(r(function(t){t.exports={default:vu,__esModule:!0}}));qa(qa.S,"Math",{sign:Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}});var yu=Na.Math.sign,Gu=e(r(function(t){t.exports={default:yu,__esModule:!0}})),xu=Math.floor;qa(qa.S,"Number",{isInteger:function(t){return!Ia(t)&&isFinite(t)&&xu(t)===t}});var bu=Na.Number.isInteger,Vu=e(r(function(t){t.exports={default:bu,__esModule:!0}}));qa(qa.S,"Number",{EPSILON:Math.pow(2,-52)});var _u=Math.pow(2,-52),Wu=e(r(function(t){t.exports={default:_u,__esModule:!0}})),Au=r(function(t,e){!function(t){function e(){}function At(t,e){this.x=t||0,this.y=e||0}function g(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function d(t,e,r,n,i,a,o,s,l,u){Object.defineProperty(this,"id",{value:La++}),this.uuid=Sa.generateUUID(),this.name="",this.image=void 0!==t?t:d.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:d.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==i?i:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:1023,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new At(0,0),this.repeat=new At(1,1),this.center=new At(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new g,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function wt(t,e,r,n){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==n?n:1}function T(t,e,r){this.width=t,this.height=e,this.scissor=new wt(0,0,t,e),this.scissorTest=!1,this.viewport=new wt(0,0,t,e),r=r||{},this.texture=new d(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:1006,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function r(t,e,r){T.call(this,t,e,r),this.samples=4}function f(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==n?n:1}function Mt(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}function Ct(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function i(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._order=n||i.DefaultOrder}function a(){this.mask=1}function p(){Object.defineProperty(this,"id",{value:Ga++}),this.uuid=Sa.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=p.DefaultUp.clone();var t=new Mt,e=new i,r=new f,n=new Mt(1,1,1);e._onChange(function(){r.setFromEuler(e,!1)}),r._onChange(function(){e.setFromQuaternion(r,void 0,!1)}),ku(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Ct},normalMatrix:{value:new g}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=p.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new a,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Tt(){p.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function n(t,e){this.min=void 0!==t?t:new Mt(1/0,1/0,1/0),this.max=void 0!==e?e:new Mt(-1/0,-1/0,-1/0)}function o(t,e,r,n,i){for(var a=0,o=t.length-3;a<=o;a+=3){fo.fromArray(t,a);var s=i.x*Math.abs(fo.x)+i.y*Math.abs(fo.y)+i.z*Math.abs(fo.z),l=e.dot(fo),u=r.dot(fo),c=n.dot(fo);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}function c(t,e){this.center=void 0!==t?t:new Mt,this.radius=void 0!==e?e:-1}function s(t,e){this.origin=void 0!==t?t:new Mt,this.direction=void 0!==e?e:new Mt(0,0,-1)}function v(t,e){this.normal=void 0!==t?t:new Mt(1,0,0),this.constant=void 0!==e?e:0}function b(t,e,r){this.a=void 0!==t?t:new Mt,this.b=void 0!==e?e:new Mt,this.c=void 0!==r?r:new Mt}function m(t,e,r){return void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}function l(t,e,r){return r<0&&(r+=1),1<r&&--r,r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function u(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function h(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function y(t,e,r,n,i,a){this.a=t,this.b=e,this.c=r,this.normal=n&&n.isVector3?n:new Mt,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new m,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}function x(){Object.defineProperty(this,"id",{value:Uo++}),this.uuid=Sa.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function _(t){x.call(this),this.type="MeshBasicMaterial",this.color=new m(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function S(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function A(t,e,r){S.call(this,new Int8Array(t),e,r)}function w(t,e,r){S.call(this,new Uint8Array(t),e,r)}function M(t,e,r){S.call(this,new Uint8ClampedArray(t),e,r)}function C(t,e,r){S.call(this,new Int16Array(t),e,r)}function E(t,e,r){S.call(this,new Uint16Array(t),e,r)}function I(t,e,r){S.call(this,new Int32Array(t),e,r)}function L(t,e,r){S.call(this,new Uint32Array(t),e,r)}function R(t,e,r){S.call(this,new Float32Array(t),e,r)}function P(t,e,r){S.call(this,new Float64Array(t),e,r)}function D(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function O(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e}function F(){Object.defineProperty(this,"id",{value:Ho+=2}),this.uuid=Sa.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function B(t,e){p.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new F,this.material=void 0!==e?e:new _,this.updateMorphTargets()}function N(t,e,r,n,i,a,o,s){return null===(1===e.side?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,2!==e.side,s))?null:(cs.copy(s),cs.applyMatrix4(t.matrixWorld),(e=r.ray.origin.distanceTo(cs))<r.near||e>r.far?null:{distance:e,point:cs.clone(),object:t})}function z(t,e,r,n,i,a,o,s,l,u,c,h){if(Ko.fromBufferAttribute(i,u),Qo.fromBufferAttribute(i,c),$o.fromBufferAttribute(i,h),i=t.morphTargetInfluences,e.morphTargets&&a&&i){ns.set(0,0,0),is.set(0,0,0),as.set(0,0,0);for(var d=0,p=a.length;d<p;d++){var f=i[d],m=a[d];0!==f&&(ts.fromBufferAttribute(m,u),es.fromBufferAttribute(m,c),rs.fromBufferAttribute(m,h),o?(ns.addScaledVector(ts,f),is.addScaledVector(es,f),as.addScaledVector(rs,f)):(ns.addScaledVector(ts.sub(Ko),f),is.addScaledVector(es.sub(Qo),f),as.addScaledVector(rs.sub($o),f)))}Ko.add(ns),Qo.add(is),$o.add(as)}return t.isSkinnedMesh&&(t.boneTransform(u,Ko),t.boneTransform(c,Qo),t.boneTransform(h,$o)),(t=N(t,e,r,n,Ko,Qo,$o,us))&&(s&&(os.fromBufferAttribute(s,u),ss.fromBufferAttribute(s,c),ls.fromBufferAttribute(s,h),t.uv=b.getUV(us,Ko,Qo,$o,os,ss,ls,new At)),l&&(os.fromBufferAttribute(l,u),ss.fromBufferAttribute(l,c),ls.fromBufferAttribute(l,h),t.uv2=b.getUV(us,Ko,Qo,$o,os,ss,ls,new At)),s=new y(u,c,h),b.getNormal(Ko,Qo,$o,s.normal),t.face=s),t}function U(){Object.defineProperty(this,"id",{value:hs+=2}),this.uuid=Sa.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function k(t){var e,r={};for(e in t)for(var n in r[e]={},t[e]){var i=t[e][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?r[e][n]=i.clone():Array.isArray(i)?r[e][n]=i.slice():r[e][n]=i}return r}function H(t){for(var e={},r=0;r<t.length;r++){var n,i=k(t[r]);for(n in i)e[n]=i[n]}return e}function G(t){x.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function V(){p.call(this),this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct}function W(t,e,r,n){V.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function j(t,e,o){var a,s,l,u,c,h;p.call(this),this.type="CubeCamera",!0!==o.isWebGLCubeRenderTarget?console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."):(this.renderTarget=o,(a=new W(90,1,t,e)).layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Mt(1,0,0)),this.add(a),(s=new W(90,1,t,e)).layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Mt(-1,0,0)),this.add(s),(l=new W(90,1,t,e)).layers=this.layers,l.up.set(0,0,1),l.lookAt(new Mt(0,1,0)),this.add(l),(u=new W(90,1,t,e)).layers=this.layers,u.up.set(0,0,-1),u.lookAt(new Mt(0,-1,0)),this.add(u),(c=new W(90,1,t,e)).layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Mt(0,0,1)),this.add(c),(h=new W(90,1,t,e)).layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Mt(0,0,-1)),this.add(h),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=t.xr.enabled,n=t.getRenderTarget();t.xr.enabled=!1;var i=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,t.setRenderTarget(o,0),t.render(e,a),t.setRenderTarget(o,1),t.render(e,s),t.setRenderTarget(o,2),t.render(e,l),t.setRenderTarget(o,3),t.render(e,u),t.setRenderTarget(o,4),t.render(e,c),o.texture.generateMipmaps=i,t.setRenderTarget(o,5),t.render(e,h),t.setRenderTarget(n),t.xr.enabled=r},this.clear=function(t,e,r,n){for(var i=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,r,n);t.setRenderTarget(i)})}function X(t,e,r){Vu(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=r),T.call(this,t,t,e)}function St(t,e,r,n,i,a,o,s,l,u,c,h){d.call(this,null,a,o,s,l,u,n,i,c,h),this.image={data:t||null,width:e||1,height:r||1},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==u?u:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Et(t,e,r,n,i,a){this.planes=[void 0!==t?t:new v,void 0!==e?e:new v,void 0!==r?r:new v,void 0!==n?n:new v,void 0!==i?i:new v,void 0!==a?a:new v]}function It(){function r(t,e){!1!==i&&(a(t,e),n.requestAnimationFrame(r))}var n=null,i=!1,a=null;return{start:function(){!0!==i&&null!==a&&(n.requestAnimationFrame(r),i=!0)},stop:function(){i=!1},setAnimationLoop:function(t){a=t},setContext:function(t){n=t}}}function Lt(l,t){var u=t.isWebGL2,c=new Bu;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),c.get(t)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=c.get(t);e&&(l.deleteBuffer(e.buffer),c.delete(t))},update:function(t,e){t.isInterleavedBufferAttribute&&(t=t.data);var r,n,i,a,o,s=c.get(t);void 0===s?c.set(t,(n=e,i=(r=t).array,a=r.usage,o=l.createBuffer(),l.bindBuffer(n,o),l.bufferData(n,i,a),r.onUploadCallback(),n=5126,i instanceof Float32Array?n=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?n=5123:i instanceof Int16Array?n=5122:i instanceof Uint32Array?n=5125:i instanceof Int32Array?n=5124:i instanceof Int8Array?n=5120:i instanceof Uint8Array&&(n=5121),{buffer:o,type:n,bytesPerElement:i.BYTES_PER_ELEMENT,version:r.version})):s.version<t.version&&(i=t.array,r=t.updateRange,l.bindBuffer(e,s.buffer),-1===r.count?l.bufferSubData(e,0,i):(u?l.bufferSubData(e,r.offset*i.BYTES_PER_ELEMENT,i,r.offset,r.count):l.bufferSubData(e,r.offset*i.BYTES_PER_ELEMENT,i.subarray(r.offset,r.offset+r.count)),r.count=-1),s.version=t.version)}}}function q(t,e,r,n){U.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Y(t,e,r,n)),this.mergeVertices()}function Y(t,e,r,n){F.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n};var i=(t=t||1)/2,a=(e=e||1)/2,o=(r=Math.floor(r)||1)+1,s=(n=Math.floor(n)||1)+1,l=t/r,u=e/n,c=[],h=[],d=[],p=[];for(t=0;t<s;t++){var f=t*u-a;for(e=0;e<o;e++)h.push(e*l-i,-f,0),d.push(0,0,1),p.push(e/r),p.push(1-t/n)}for(t=0;t<n;t++)for(e=0;e<r;e++)i=e+o*(t+1),a=e+1+o*(t+1),s=e+1+o*t,c.push(e+o*t,i,s),c.push(i,a,s);this.setIndex(c),this.setAttribute("position",new R(h,3)),this.setAttribute("normal",new R(d,3)),this.setAttribute("uv",new R(p,2))}function Rt(i,r,a,n){function o(t,e){r.buffers.color.setClear(t.r,t.g,t.b,e,n)}var s,l,u=new m(0),c=0,h=null,d=0,p=null;return{getClearColor:function(){return u},setClearColor:function(t,e){u.set(t),o(u,c=void 0!==e?e:1)},getClearAlpha:function(){return c},setClearAlpha:function(t){o(u,c=t)},render:function(t,e,r,n){e=e.background,null===(e=(r=(r=i.xr).getSession&&r.getSession())&&"additive"===r.environmentBlendMode?null:e)?o(u,c):e&&e.isColor&&(o(e,1),n=!0),(i.autoClear||n)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),e&&(e.isCubeTexture||e.isWebGLCubeRenderTarget||306===e.mapping)?(void 0===l&&((l=new B(new gs(1,1,1),new G({type:"BackgroundCubeMaterial",uniforms:k(As.cube.uniforms),vertexShader:As.cube.vertexShader,fragmentShader:As.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(l)),n=e.isWebGLCubeRenderTarget?e.texture:e,l.material.uniforms.envMap.value=n,l.material.uniforms.flipEnvMap.value=n.isCubeTexture?-1:1,h===e&&d===n.version&&p===i.toneMapping||(l.material.needsUpdate=!0,h=e,d=n.version,p=i.toneMapping),t.unshift(l,l.geometry,l.material,0,0,null)):e&&e.isTexture&&(void 0===s&&((s=new B(new Y(2,2),new G({type:"BackgroundMaterial",uniforms:k(As.background.uniforms),vertexShader:As.background.vertexShader,fragmentShader:As.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(s)),!0===(s.material.uniforms.t2D.value=e).matrixAutoUpdate&&e.updateMatrix(),s.material.uniforms.uvTransform.value.copy(e.matrix),h===e&&d===e.version&&p===i.toneMapping||(s.material.needsUpdate=!0,d=(h=e).version,p=i.toneMapping),t.unshift(s,s.geometry,s.material,0,0,null))}}}function Pt(a,o,s,t){var l,u=t.isWebGL2;this.setMode=function(t){l=t},this.render=function(t,e){a.drawArrays(l,t,e),s.update(e,l)},this.renderInstances=function(t,e,r,n){if(0!==n){if(u){t=a;var i="drawArraysInstanced"}else if(i="drawArraysInstancedANGLE",null===(t=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");t[i](l,e,r,n),s.update(r,l,n)}}}function Dt(e,r,t){function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var i,a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==t.precision?t.precision:"highp";(s=n(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s),t=!0===t.logarithmicDepthBuffer;var s=e.getParameter(34930),l=e.getParameter(35660),u=e.getParameter(3379),c=e.getParameter(34076),h=e.getParameter(34921),d=e.getParameter(36347),p=e.getParameter(36348),f=e.getParameter(36349),m=0<l,g=a||!!r.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var t=r.get("EXT_texture_filter_anisotropic");return i=null!==t?e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:t,maxTextures:s,maxVertexTextures:l,maxTextureSize:u,maxCubemapSize:c,maxAttributes:h,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:g,floatVertexTextures:m&&g,maxSamples:a?e.getParameter(36183):0}}function Ot(){function l(){m.value!==c&&(m.value=c,m.needsUpdate=0<h),o.numPlanes=h,o.numIntersection=0}function u(t,e,r,n){var i=null!==t?t.length:0,a=null;if(0!==i){if(a=m.value,!0!==n||null===a)for(n=r+4*i,e=e.matrixWorldInverse,f.getNormalMatrix(e),(null===a||a.length<n)&&(a=new Float32Array(n)),n=0;n!==i;++n,r+=4)s.copy(t[n]).applyMatrix4(e,f),s.normal.toArray(a,r),a[r+3]=s.constant;m.value=a,m.needsUpdate=!0}return o.numPlanes=i,o.numIntersection=0,a}var o=this,c=null,h=0,d=!1,p=!1,s=new v,f=new g,m={value:null,needsUpdate:!1};this.uniform=m,this.numIntersection=this.numPlanes=0,this.init=function(t,e,r){var n=0!==t.length||e||0!==h||d;return d=e,c=u(t,r,0),h=t.length,n},this.beginShadows=function(){p=!0,u(null)},this.endShadows=function(){p=!1,l()},this.setState=function(t,e,r,n,i,a){if(!d||null===t||0===t.length||p&&!r)p?u(null):l();else{var o=4*(r=p?0:h),s=i.clippingState||null;for(m.value=s,s=u(t,n,o,a),t=0;t!==o;++t)s[t]=c[t];i.clippingState=s,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=r}}}function Ft(r){var n={};return{get:function(t){if(void 0!==n[t])return n[t];switch(t){case"WEBGL_depth_texture":var e=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=r.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n[t]=e}}}function Bt(t,u,n){function i(t){var e,r=t.target;for(e in null!==(t=o.get(r)).index&&u.remove(t.index),t.attributes)u.remove(t.attributes[e]);r.removeEventListener("dispose",i),o.delete(r),(e=c.get(t))&&(u.remove(e),c.delete(t)),n.memory.geometries--}function a(t){var e=[],r=t.index,n=t.attributes.position;if(null!==r)for(var i=r.array,r=r.version,n=0,a=i.length;n<a;n+=3){var o=i[n+0],s=i[n+1],l=i[n+2];e.push(o,s,s,l,l,o)}else for(i=n.array,r=n.version,n=0,a=i.length/3-1;n<a;n+=3)o=n+0,s=n+1,l=n+2,e.push(o,s,s,l,l,o);(e=new(65535<O(e)?L:E)(e,1)).version=r,u.update(e,34963),(i=c.get(t))&&u.remove(i),c.set(t,e)}var o=new Bu,c=new Bu;return{get:function(t,e){var r=o.get(e);return r||(e.addEventListener("dispose",i),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new F).setFromObject(t)),r=e._bufferGeometry),o.set(e,r),n.memory.geometries++,r)},update:function(t){var e,r=t.index,n=t.attributes;for(e in null!==r&&u.update(r,34963),n)u.update(n[e],34962);for(e in t=t.morphAttributes)for(var n=0,i=(r=t[e]).length;n<i;n++)u.update(r[n],34962)},getWireframeAttribute:function(t){var e,r=c.get(t);return(!r||null!==(e=t.index)&&r.version<e.version)&&a(t),c.get(t)}}}function Nt(a,o,s,t){var l,u,c,h=t.isWebGL2;this.setMode=function(t){l=t},this.setIndex=function(t){u=t.type,c=t.bytesPerElement},this.render=function(t,e){a.drawElements(l,e,u,t*c),s.update(e,l)},this.renderInstances=function(t,e,r,n){if(0!==n){if(h){t=a;var i="drawElementsInstanced"}else if(i="drawElementsInstancedANGLE",null===(t=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");t[i](l,r,u,e*c,n),s.update(r,l,n)}}}function zt(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,e,r){switch(r=r||1,n.calls++,e){case 4:n.triangles+=t/3*r;break;case 1:n.lines+=t/2*r;break;case 3:n.lines+=r*(t-1);break;case 2:n.lines+=r*t;break;case 0:n.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e)}}}}function Z(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Ut(u){var c={},h=new Float32Array(8);return{update:function(t,e,r,n){var i=t.morphTargetInfluences,a=void 0===i?0:i.length;if(void 0===(t=c[e.id])){t=[];for(var o=0;o<a;o++)t[o]=[o,0];c[e.id]=t}var s=r.morphTargets&&e.morphAttributes.position;for(r=r.morphNormals&&e.morphAttributes.normal,o=0;o<a;o++){var l=t[o];0!==l[1]&&(s&&e.deleteAttribute("morphTarget"+o),r&&e.deleteAttribute("morphNormal"+o))}for(o=0;o<a;o++)(l=t[o])[0]=o,l[1]=i[o];for(t.sort(Z),o=i=0;o<8;o++)(l=t[o])&&(a=l[0],l=l[1])?(s&&e.setAttribute("morphTarget"+o,s[a]),r&&e.setAttribute("morphNormal"+o,r[a]),i+=h[o]=l):h[o]=0;e=e.morphTargetsRelative?1:1-i,n.getUniforms().setValue(u,"morphTargetBaseInfluence",e),n.getUniforms().setValue(u,"morphTargetInfluences",h)}}}function kt(t,i,a,o){var s=new Bu;return{update:function(t){var e=o.render.frame,r=t.geometry,n=i.get(t,r);return s.get(n)!==e&&(r.isGeometry&&n.updateFromObject(t),i.update(n),s.set(n,e)),t.isInstancedMesh&&a.update(t.instanceMatrix,34962),n},dispose:function(){s=new Bu}}}function J(t,e,r,n,i,a,o,s,l,u){d.call(this,t=void 0!==t?t:[],void 0!==e?e:301,r,n,i,a,void 0!==o?o:1022,s,l,u),this.flipY=!1}function K(t,e,r,n){d.call(this,null),this.image={data:t||null,width:e||1,height:r||1,depth:n||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Q(t,e,r,n){d.call(this,null),this.image={data:t||null,width:e||1,height:r||1,depth:n||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function $(t,e,r){var n=t[0];if(n<=0||0<n)return t;var i=e*r,a=Ss[i];if(void 0===a&&(a=new Float32Array(i),Ss[i]=a),0!==e)for(n.toArray(a,0),n=1,i=0;n!==e;++n)i+=r,t[n].toArray(a,i);return a}function tt(t,e){if(t.length===e.length){for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return;return 1}}function et(t,e){for(var r=0,n=e.length;r<n;r++)t[r]=e[r]}function rt(t,e){var r=Es[e];void 0===r&&(r=new Int32Array(e),Es[e]=r);for(var n=0;n!==e;++n)r[n]=t.allocateTextureUnit();return r}function nt(t,e){var r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function it(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y):tt(r,e)||(t.uniform2fv(this.addr,e),et(r,e))}function at(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z):void 0!==e.r?r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b):tt(r,e)||(t.uniform3fv(this.addr,e),et(r,e))}function ot(t,e){var r=this.cache;void 0!==e.x?r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w):tt(r,e)||(t.uniform4fv(this.addr,e),et(r,e))}function st(t,e){var r=this.cache,n=e.elements;void 0===n?tt(r,e)||(t.uniformMatrix2fv(this.addr,!1,e),et(r,e)):tt(r,n)||(Rs.set(n),t.uniformMatrix2fv(this.addr,!1,Rs),et(r,n))}function lt(t,e){var r=this.cache,n=e.elements;void 0===n?tt(r,e)||(t.uniformMatrix3fv(this.addr,!1,e),et(r,e)):tt(r,n)||(Ls.set(n),t.uniformMatrix3fv(this.addr,!1,Ls),et(r,n))}function ut(t,e){var r=this.cache,n=e.elements;void 0===n?tt(r,e)||(t.uniformMatrix4fv(this.addr,!1,e),et(r,e)):tt(r,n)||(Is.set(n),t.uniformMatrix4fv(this.addr,!1,Is),et(r,n))}function ct(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTexture2D(e||ws,i)}function ht(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(e||Ms,i)}function dt(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(e||Cs,i)}function pt(t,e,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.safeSetTextureCube(e||Ts,i)}function ft(t,e){var r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function mt(t,e){var r=this.cache;tt(r,e)||(t.uniform2iv(this.addr,e),et(r,e))}function gt(t,e){var r=this.cache;tt(r,e)||(t.uniform3iv(this.addr,e),et(r,e))}function vt(t,e){var r=this.cache;tt(r,e)||(t.uniform4iv(this.addr,e),et(r,e))}function yt(t,e){var r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function xt(t,e){t.uniform1fv(this.addr,e)}function bt(t,e){t.uniform1iv(this.addr,e)}function _t(t,e){t.uniform2iv(this.addr,e)}function Ht(t,e){t.uniform3iv(this.addr,e)}function Gt(t,e){t.uniform4iv(this.addr,e)}function Vt(t,e){e=$(e,this.size,2),t.uniform2fv(this.addr,e)}function Wt(t,e){e=$(e,this.size,3),t.uniform3fv(this.addr,e)}function jt(t,e){e=$(e,this.size,4),t.uniform4fv(this.addr,e)}function Xt(t,e){e=$(e,this.size,4),t.uniformMatrix2fv(this.addr,!1,e)}function qt(t,e){e=$(e,this.size,9),t.uniformMatrix3fv(this.addr,!1,e)}function Yt(t,e){e=$(e,this.size,16),t.uniformMatrix4fv(this.addr,!1,e)}function Zt(t,e,r){var n=e.length,i=rt(r,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)r.safeSetTexture2D(e[t]||ws,i[t])}function Jt(t,e,r){var n=e.length,i=rt(r,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)r.safeSetTextureCube(e[t]||Ts,i[t])}function Kt(t,e,r){this.id=t,this.addr=r,this.cache=[],this.setValue=function(t){switch(t){case 5126:return nt;case 35664:return it;case 35665:return at;case 35666:return ot;case 35674:return st;case 35675:return lt;case 35676:return ut;case 5124:case 35670:return ft;case 35667:case 35671:return mt;case 35668:case 35672:return gt;case 35669:case 35673:return vt;case 5125:return yt;case 35678:case 36198:case 36298:case 36306:case 35682:return ct;case 35679:case 36299:case 36307:return dt;case 35680:case 36300:case 36308:case 36293:return pt;case 36289:case 36303:case 36311:case 36292:return ht}}(e.type)}function Qt(t,e,r){this.id=t,this.addr=r,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return xt;case 35664:return Vt;case 35665:return Wt;case 35666:return jt;case 35674:return Xt;case 35675:return qt;case 35676:return Yt;case 5124:case 35670:return bt;case 35667:case 35671:return _t;case 35668:case 35672:return Ht;case 35669:case 35673:return Gt;case 35678:case 36198:case 36298:case 36306:case 35682:return Zt;case 35680:case 36300:case 36308:case 36293:return Jt}}(e.type)}function $t(t){this.id=t,this.seq=[],this.map={}}function te(t,e){this.seq=[],this.map={};for(var r=t.getProgramParameter(e,35718),n=0;n<r;++n){var i=t.getActiveUniform(e,n),a=t.getUniformLocation(e,i.name),o=this,s=i.name,l=s.length;for(Ps.lastIndex=0;;){var u=Ps.exec(s),c=Ps.lastIndex,h=u[1],d=u[3];if("]"===u[2]&&(h|=0),void 0===d||"["===d&&c+2===l){s=o,i=new(void 0===d?Kt:Qt)(h,i,a),s.seq.push(i),s.map[i.id]=i;break}void 0===(d=o.map[h])&&(d=new $t(h),h=o,o=d,h.seq.push(o),h.map[o.id]=o),o=d}}}function ee(t,e,r){return e=t.createShader(e),t.shaderSource(e,r),t.compileShader(e),e}function re(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+t)}}function ne(t,e,r){var n=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(n&&""===i)return"";for(t=t.getShaderSource(e).split("\n"),e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+(t=t.join("\n"))}function ie(t,e){return"vec4 "+t+"( vec4 value ) { return "+(e=re(e))[0]+"ToLinear"+e[1]+"; }"}function ae(t){return""!==t}function oe(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function se(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function le(t,e){if(void 0===(t=_s[e]))throw Error("Can not resolve #include <"+e+">");return t.replace(Os,le)}function ue(t,e,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ce(t,e,r,n)}function ce(t,e,r,n){for(t="",e=parseInt(e);e<parseInt(r);e++)t+=n.replace(/\[ i \]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return t}function he(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function de(t,e,r){var n,i,a,o,s=t.getContext(),l=r.defines,u=r.vertexShader,c=r.fragmentShader,h=(i="SHADOWMAP_TYPE_BASIC",1===(n=r).shadowMapType?i="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?i="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(i="SHADOWMAP_TYPE_VSM"),i),d=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC";break;case 305:e="ENVMAP_TYPE_SPHERE"}return e}(r),p=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(r),f=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(r),m=0<t.gammaFactor?t.gammaFactor:1,g=r.isWebGL2?"":[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||"physical"===r.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ae).join("\n"),v=function(t){var e,r=[];for(e in t){var n=t[e];!1!==n&&r.push("#define "+e+" "+n)}return r.join("\n")}(l),y=s.createProgram();return r.isRawShaderMaterial?(0<(l=[v].filter(ae).join("\n")).length&&(l+="\n"),0<(h=[g,v].filter(ae).join("\n")).length&&(h+="\n")):(l=[he(r),"#define SHADER_NAME "+r.shaderName,v,r.instancing?"#define USE_INSTANCING":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ae).join("\n"),h=[g,he(r),"#define SHADER_NAME "+r.shaderName,v,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+m,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?_s.tonemapping_pars_fragment:"",0!==r.toneMapping?function(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="Uncharted2";break;case 4:e="OptimizedCineon";break;case 5:e="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.outputEncoding||r.mapEncoding||r.matcapEncoding||r.envMapEncoding||r.emissiveMapEncoding||r.lightMapEncoding?_s.encodings_pars_fragment:"",r.mapEncoding?ie("mapTexelToLinear",r.mapEncoding):"",r.matcapEncoding?ie("matcapTexelToLinear",r.matcapEncoding):"",r.envMapEncoding?ie("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?ie("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMapEncoding?ie("lightMapTexelToLinear",r.lightMapEncoding):"",r.outputEncoding?(n="linearToOutputTexel",i=r.outputEncoding,"vec4 "+n+"( vec4 value ) { return LinearTo"+(i=re(i))[0]+i[1]+"; }"):"",r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(ae).join("\n")),u=se(u=oe(u=u.replace(Os,le),r),r),c=se(c=oe(c=c.replace(Os,le),r),r),u=u.replace(Bs,ce).replace(Fs,ue),c=c.replace(Bs,ce).replace(Fs,ue),r.isWebGL2&&!r.isRawShaderMaterial&&(d=!1,p=/^\s*#version\s+300\s+es\s*\n/,r.isShaderMaterial&&null!==u.match(p)&&null!==c.match(p)&&(d=!0,u=u.replace(p,""),c=c.replace(p,"")),l="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+l,h=["#version 300 es\n\n#define varying in",d?"":"out highp vec4 pc_fragColor;",d?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+h),c=h+c,u=ee(s,35633,l+u),c=ee(s,35632,c),s.attachShader(y,u),s.attachShader(y,c),void 0!==r.index0AttributeName?s.bindAttribLocation(y,0,r.index0AttributeName):!0===r.morphTargets&&s.bindAttribLocation(y,0,"position"),s.linkProgram(y),t.debug.checkShaderErrors&&(t=s.getProgramInfoLog(y).trim(),d=s.getShaderInfoLog(u).trim(),p=s.getShaderInfoLog(c).trim(),!(m=f=!0)===s.getProgramParameter(y,35714)?(f=!1,g=ne(s,u,"vertex"),v=ne(s,c,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(y,35715),"gl.getProgramInfoLog",t,g,v)):""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==d&&""!==p||(m=!1),m&&(this.diagnostics={runnable:f,programLog:t,vertexShader:{log:d,prefix:l},fragmentShader:{log:p,prefix:h}})),s.deleteShader(u),s.deleteShader(c),this.getUniforms=function(){return a=void 0===a?new te(s,y):a},this.getAttributes=function(){if(void 0===o){for(var t={},e=s.getProgramParameter(y,35721),r=0;r<e;r++){var n=s.getActiveAttrib(y,r).name;t[n]=s.getAttribLocation(y,n)}o=t}return o},this.destroy=function(){s.deleteProgram(y),this.program=void 0},this.name=r.shaderName,this.id=Ds++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=u,this.fragmentShader=c,this}function pe(d,p,f){function m(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}var o=[],g=f.isWebGL2,v=f.logarithmicDepthBuffer,y=f.floatVertexTextures,x=f.precision,b=f.maxVertexUniforms,_=f.vertexTextures,A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},n="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(t,e,r,n,i,a,o){var s=n.fog;n=t.isMeshStandardMaterial?n.environment:null,n=t.envMap||n;var l,u,c=A[t.type];u=o.isSkinnedMesh?(u=o.skeleton.bones,y?1024:(l=Math.min(Math.floor((b-20)/4),u.length))<u.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+u.length+" bones. This GPU supports "+l+"."),0):l):0,null===t.precision||(x=f.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",x,"instead."),l=c?(l=As[c],{name:t.type,uniforms:vs.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}):{name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(l,d);var h=d.getRenderTarget();return{isWebGL2:g,shaderID:c,shaderName:l.name,uniforms:l.uniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:t.defines,isRawShaderMaterial:t.isRawShaderMaterial,isShaderMaterial:t.isShaderMaterial,precision:x,instancing:!0===o.isInstancedMesh,supportsVertexTextures:_,outputEncoding:null!==h?m(h.texture):d.outputEncoding,map:!!t.map,mapEncoding:m(t.map),matcap:!!t.matcap,matcapEncoding:m(t.matcap),envMap:!!n,envMapMode:n&&n.mapping,envMapEncoding:m(n),envMapCubeUV:!!n&&(306===n.mapping||307===n.mapping),lightMap:!!t.lightMap,lightMapEncoding:m(t.lightMap),aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:m(t.emissiveMap),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:1===t.normalMapType,tangentSpaceNormalMap:0===t.normalMapType,clearcoatMap:!!t.clearcoatMap,clearcoatRoughnessMap:!!t.clearcoatRoughnessMap,clearcoatNormalMap:!!t.clearcoatNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,sheen:!!t.sheen,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,vertexUvs:!!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatMap||t.clearcoatRoughnessMap||t.clearcoatNormalMap||t.displacementMap),uvsVertexOnly:!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap||!t.displacementMap),fog:!!s,useFog:t.fog,fogExp2:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:v,skinning:t.skinning&&0<u,maxBones:u,useVertexTexture:y,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:d.maxMorphTargets,maxMorphNormals:d.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numDirLightShadows:e.directionalShadowMap.length,numPointLightShadows:e.pointShadowMap.length,numSpotLightShadows:e.spotShadowMap.length,numClippingPlanes:i,numClipIntersection:a,dithering:t.dithering,shadowMapEnabled:d.shadowMap.enabled&&0<r.length,shadowMapType:d.shadowMap.type,toneMapping:t.toneMapped?d.toneMapping:0,physicallyCorrectLights:d.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking,index0AttributeName:t.index0AttributeName,extensionDerivatives:t.extensions&&t.extensions.derivatives,extensionFragDepth:t.extensions&&t.extensions.fragDepth,extensionDrawBuffers:t.extensions&&t.extensions.drawBuffers,extensionShaderTextureLOD:t.extensions&&t.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||null!==p.get("EXT_frag_depth"),rendererExtensionDrawBuffers:g||null!==p.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||null!==p.get("EXT_shader_texture_lod"),onBeforeCompile:t.onBeforeCompile}},this.getProgramCacheKey=function(t){var e=[];if(t.shaderID?e.push(t.shaderID):(e.push(t.fragmentShader),e.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)e.push(r),e.push(t.defines[r]);if(void 0===t.isRawShaderMaterial){for(r=0;r<n.length;r++)e.push(t[n[r]]);e.push(d.outputEncoding),e.push(d.gammaFactor)}return e.push(t.onBeforeCompile.toString()),e.join()},this.acquireProgram=function(t,e){for(var r,n=0,i=o.length;n<i;n++){var a=o[n];if(a.cacheKey===e){++(r=a).usedTimes;break}}return void 0===r&&(r=new de(d,e,t),o.push(r)),r},this.releaseProgram=function(t){var e;0==--t.usedTimes&&(e=o.indexOf(t),o[e]=o[o.length-1],o.pop(),t.destroy())},this.programs=o}function fe(){var n=new Bu;return{get:function(t){var e=n.get(t);return void 0===e&&(e={},n.set(t,e)),e},remove:function(t){n.delete(t)},update:function(t,e,r){n.get(t)[e]=r},dispose:function(){n=new Bu}}}function me(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ge(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function ve(){function o(t,e,r,n,i,a){var o=s[l];return void 0===o?(o={id:t.id,object:t,geometry:e,material:r,program:r.program||h,groupOrder:n,renderOrder:t.renderOrder,z:i,group:a},s[l]=o):(o.id=t.id,o.object=t,o.geometry=e,o.material=r,o.program=r.program||h,o.groupOrder=n,o.renderOrder=t.renderOrder,o.z=i,o.group=a),l++,o}var s=[],l=0,u=[],c=[],h={id:-1};return{opaque:u,transparent:c,init:function(){l=0,u.length=0,c.length=0},push:function(t,e,r,n,i,a){t=o(t,e,r,n,i,a),(!0===r.transparent?c:u).push(t)},unshift:function(t,e,r,n,i,a){t=o(t,e,r,n,i,a),(!0===r.transparent?c:u).unshift(t)},finish:function(){for(var t=l,e=s.length;t<e;t++){var r=s[t];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(t,e){1<u.length&&u.sort(t||me),1<c.length&&c.sort(e||ge)}}}function ye(){function i(t){(t=t.target).removeEventListener("dispose",i),a.delete(t)}var a=new Bu;return{get:function(t,e){var r,n=a.get(t);return void 0===n?(r=new ve,a.set(t,new Bu),a.get(t).set(e,r),t.addEventListener("dispose",i)):void 0===(r=n.get(e))&&(r=new ve,n.set(e,r)),r},dispose:function(){a=new Bu}}}function xe(){var r={};return{get:function(t){if(void 0!==r[t.id])return r[t.id];switch(t.type){case"DirectionalLight":var e={direction:new Mt,color:new m};break;case"SpotLight":e={position:new Mt,direction:new Mt,color:new m,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new Mt,color:new m,distance:0,decay:0};break;case"HemisphereLight":e={direction:new Mt,skyColor:new m,groundColor:new m};break;case"RectAreaLight":e={color:new m,position:new Mt,halfWidth:new Mt,halfHeight:new Mt}}return r[t.id]=e}}}function be(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function _e(){for(var r,_=new xe,A=(r={},{get:function(t){if(void 0!==r[t.id])return r[t.id];switch(t.type){case"DirectionalLight":var e={shadowBias:0,shadowRadius:1,shadowMapSize:new At};break;case"SpotLight":e={shadowBias:0,shadowRadius:1,shadowMapSize:new At};break;case"PointLight":e={shadowBias:0,shadowRadius:1,shadowMapSize:new At,shadowCameraNear:1,shadowCameraFar:1e3}}return r[t.id]=e}}),w={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},t=0;t<9;t++)w.probe.push(new Mt);var M=new Mt,C=new Ct,T=new Ct;return{setup:function(t,e,r){for(var n=0,i=0,a=0,o=0;o<9;o++)w.probe[o].set(0,0,0);var s=e=0,l=0,u=0,c=0,h=0,d=0,p=0;r=r.matrixWorldInverse,t.sort(be);for(var o=0,f=t.length;o<f;o++){var m,g=t[o],v=g.color,y=g.intensity,x=g.distance,b=g.shadow&&g.shadow.map?g.shadow.map.texture:null;if(g.isAmbientLight)n+=v.r*y,i+=v.g*y,a+=v.b*y;else if(g.isLightProbe)for(b=0;b<9;b++)w.probe[b].addScaledVector(g.sh.coefficients[b],y);else g.isDirectionalLight?((m=_.get(g)).color.copy(g.color).multiplyScalar(g.intensity),m.direction.setFromMatrixPosition(g.matrixWorld),M.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(M),m.direction.transformDirection(r),g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,w.directionalShadow[e]=v,w.directionalShadowMap[e]=b,w.directionalShadowMatrix[e]=g.shadow.matrix,h++),w.directional[e]=m,e++):g.isSpotLight?((m=_.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),m.color.copy(v).multiplyScalar(y),m.distance=x,m.direction.setFromMatrixPosition(g.matrixWorld),M.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(M),m.direction.transformDirection(r),m.coneCos=Math.cos(g.angle),m.penumbraCos=Math.cos(g.angle*(1-g.penumbra)),m.decay=g.decay,g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,w.spotShadow[l]=v,w.spotShadowMap[l]=b,w.spotShadowMatrix[l]=g.shadow.matrix,p++),w.spot[l]=m,l++):g.isRectAreaLight?((m=_.get(g)).color.copy(v).multiplyScalar(y),m.position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),T.identity(),C.copy(g.matrixWorld),C.premultiply(r),T.extractRotation(C),m.halfWidth.set(.5*g.width,0,0),m.halfHeight.set(0,.5*g.height,0),m.halfWidth.applyMatrix4(T),m.halfHeight.applyMatrix4(T),w.rectArea[u]=m,u++):g.isPointLight?((m=_.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(r),m.color.copy(g.color).multiplyScalar(g.intensity),m.distance=g.distance,m.decay=g.decay,g.castShadow&&(y=g.shadow,(v=A.get(g)).shadowBias=y.bias,v.shadowRadius=y.radius,v.shadowMapSize=y.mapSize,v.shadowCameraNear=y.camera.near,v.shadowCameraFar=y.camera.far,w.pointShadow[s]=v,w.pointShadowMap[s]=b,w.pointShadowMatrix[s]=g.shadow.matrix,d++),w.point[s]=m,s++):g.isHemisphereLight&&((m=_.get(g)).direction.setFromMatrixPosition(g.matrixWorld),m.direction.transformDirection(r),m.direction.normalize(),m.skyColor.copy(g.color).multiplyScalar(y),m.groundColor.copy(g.groundColor).multiplyScalar(y),w.hemi[c]=m,c++)}w.ambient[0]=n,w.ambient[1]=i,w.ambient[2]=a,(t=w.hash).directionalLength===e&&t.pointLength===s&&t.spotLength===l&&t.rectAreaLength===u&&t.hemiLength===c&&t.numDirectionalShadows===h&&t.numPointShadows===d&&t.numSpotShadows===p||(w.directional.length=e,w.spot.length=l,w.rectArea.length=u,w.point.length=s,w.hemi.length=c,w.directionalShadow.length=h,w.directionalShadowMap.length=h,w.pointShadow.length=d,w.pointShadowMap.length=d,w.spotShadow.length=p,w.spotShadowMap.length=p,w.directionalShadowMatrix.length=h,w.pointShadowMatrix.length=d,w.spotShadowMatrix.length=p,t.directionalLength=e,t.pointLength=s,t.spotLength=l,t.rectAreaLength=u,t.hemiLength=c,t.numDirectionalShadows=h,t.numPointShadows=d,t.numSpotShadows=p,w.version=Ns++)},state:w}}function Ae(){var e=new _e,r=[],n=[];return{init:function(){r.length=0,n.length=0},state:{lightsArray:r,shadowsArray:n,lights:e},setupLights:function(t){e.setup(r,n,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){n.push(t)}}}function we(){function n(t){(t=t.target).removeEventListener("dispose",n),i.delete(t)}var i=new Bu;return{get:function(t,e){var r;return!1===i.has(t)?(r=new Ae,i.set(t,new Bu),i.get(t).set(e,r),t.addEventListener("dispose",n)):!1===i.get(t).has(e)?(r=new Ae,i.get(t).set(e,r)):r=i.get(t).get(e),r},dispose:function(){i=new Bu}}}function Me(t){x.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ce(t){x.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Mt,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Te(f,m,g){function u(t,e,r){var n=i[r=t<<0|e<<1|r<<2];return void 0===n&&(n=new Me({depthPacking:3201,morphTargets:t,skinning:e}),i[r]=n),n}function c(t,e,r){var n=a[r=t<<0|e<<1|r<<2];return void 0===n&&(n=new Ce({morphTargets:t,skinning:e}),a[r]=n),n}function v(t,e,r,n,i,a,o){var s=u,l=t.customDepthMaterial;return!0===n.isPointLight&&(s=c,l=t.customDistanceMaterial),t=void 0===l?(!(l=!1)===r.morphTargets&&(l=e.morphAttributes&&e.morphAttributes.position&&0<e.morphAttributes.position.length),!(e=!1)===t.isSkinnedMesh&&(!0===r.skinning?e=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),s(l,e,!0===t.isInstancedMesh)):l,f.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length&&(l=t.uuid,s=r.uuid,void 0===(e=h[l])&&(e={},h[l]=e),void 0===(l=e[s])&&(l=t.clone(),e[s]=l),t=l),t.visible=r.visible,t.wireframe=r.wireframe,t.side=3===o?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],t.clipShadows=r.clipShadows,t.clippingPlanes=r.clippingPlanes,t.clipIntersection=r.clipIntersection,t.wireframeLinewidth=r.wireframeLinewidth,t.linewidth=r.linewidth,!0===n.isPointLight&&!0===t.isMeshDistanceMaterial&&(t.referencePosition.setFromMatrixPosition(n.matrixWorld),t.nearDistance=i,t.farDistance=a),t}var y=new Et,x=new At,b=new At,_=new wt,i=[],a=[],h={},d={0:1,1:0,2:2},A=new G({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new At},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),w=A.clone();w.defines.HORIZONAL_PASS=1;var t=new F;t.setAttribute("position",new S(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var M=new B(t,A),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,e,r){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var n=f.getRenderTarget(),i=f.getActiveCubeFace(),a=f.getActiveMipmapLevel(),o=f.state;o.setBlending(0),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var s=0,l=t.length;s<l;s++){var u=t[s],c=u.shadow;if(void 0===c)console.warn("THREE.WebGLShadowMap:",u,"has no shadow.");else{x.copy(c.mapSize);var h=c.getFrameExtents();x.multiply(h),b.copy(c.mapSize),(x.x>g||x.y>g)&&(x.x>g&&(b.x=Math.floor(g/h.x),x.x=b.x*h.x,c.mapSize.x=b.x),x.y>g&&(b.y=Math.floor(g/h.y),x.y=b.y*h.y,c.mapSize.y=b.y)),null!==c.map||c.isPointLightShadow||3!==this.type||(h={minFilter:1006,magFilter:1006,format:1023},c.map=new T(x.x,x.y,h),c.map.texture.name=u.name+".shadowMap",c.mapPass=new T(x.x,x.y,h),c.camera.updateProjectionMatrix()),null===c.map&&(h={minFilter:1003,magFilter:1003,format:1023},c.map=new T(x.x,x.y,h),c.map.texture.name=u.name+".shadowMap",c.camera.updateProjectionMatrix()),f.setRenderTarget(c.map),f.clear();for(var h=c.getViewportCount(),d=0;d<h;d++){var p=c.getViewport(d);_.set(b.x*p.x,b.y*p.y,b.x*p.z,b.y*p.w),o.viewport(_),c.updateMatrices(u,d),y=c.getFrustum(),function t(e,r,n,i,a){if(!1!==e.visible){if(e.layers.test(r.layers)&&(e.isMesh||e.isLine||e.isPoints)&&(e.castShadow||e.receiveShadow&&3===a)&&(!e.frustumCulled||y.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var o=m.update(e),s=e.material;if(Array.isArray(s))for(var l=o.groups,u=0,c=l.length;u<c;u++){var h=l[u],d=s[h.materialIndex];d&&d.visible&&(d=v(e,o,d,i,n.near,n.far,a),f.renderBufferDirect(n,null,o,d,e,h))}else s.visible&&(d=v(e,o,s,i,n.near,n.far,a),f.renderBufferDirect(n,null,o,d,e,null))}for(o=0,s=(e=e.children).length;o<s;o++)t(e[o],r,n,i,a)}}(e,r,c.camera,u,this.type)}c.isPointLightShadow||3!==this.type||(u=c,c=r,h=m.update(M),A.uniforms.shadow_pass.value=u.map.texture,A.uniforms.resolution.value=u.mapSize,A.uniforms.radius.value=u.radius,f.setRenderTarget(u.mapPass),f.clear(),f.renderBufferDirect(c,null,h,A,M,null),w.uniforms.shadow_pass.value=u.mapPass.texture,w.uniforms.resolution.value=u.mapSize,w.uniforms.radius.value=u.radius,f.setRenderTarget(u.map),f.clear(),f.renderBufferDirect(c,null,h,w,M,null))}}C.needsUpdate=!1,f.setRenderTarget(n,i,a)}}}function Se(c,r,t){function e(t,e,r){var n=new Uint8Array(4),i=c.createTexture();for(c.bindTexture(t,i),c.texParameteri(t,10241,9728),c.texParameteri(t,10240,9728),t=0;t<r;t++)c.texImage2D(e+t,0,6408,1,1,0,6408,5121,n);return i}function n(t,e){g[t]=1,0===v[t]&&(c.enableVertexAttribArray(t),v[t]=1),y[t]!==e&&((u?c:r.get("ANGLE_instanced_arrays"))[u?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),y[t]=e)}function h(t){!0!==x[t]&&(c.enable(t),x[t]=!0)}function d(t){!1!==x[t]&&(c.disable(t),x[t]=!1)}function i(t,e,r,n,i,a,o,s){if(0===t)_&&(d(3042),_=!1);else if(_||(h(3042),_=!0),5!==t){if(t!==A||s!==I){if(100===w&&100===T||(c.blendEquation(32774),T=w=100),s)switch(t){case 1:c.blendFuncSeparate(1,771,1,771);break;case 2:c.blendFunc(1,1);break;case 3:c.blendFuncSeparate(0,0,769,771);break;case 4:c.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:c.blendFuncSeparate(770,771,1,771);break;case 2:c.blendFunc(770,1);break;case 3:c.blendFunc(0,769);break;case 4:c.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}E=S=C=M=null,A=t,I=s}}else i=i||e,a=a||r,o=o||n,e===w&&i===T||(c.blendEquationSeparate(G[e],G[i]),w=e,T=i),r===M&&n===C&&a===S&&o===E||(c.blendFuncSeparate(V[r],V[n],V[a],V[o]),M=r,C=n,S=a,E=o),A=t,I=null}function a(t){L!==t&&(t?c.frontFace(2304):c.frontFace(2305),L=t)}function o(t){0!==t?(h(2884),t!==R&&(1===t?c.cullFace(1029):2===t?c.cullFace(1028):c.cullFace(1032))):d(2884),R=t}function s(t,e,r){t?(h(32823),D===e&&O===r||(c.polygonOffset(e,r),D=e,O=r)):d(32823)}function l(t){N!==(t=void 0===t?33984+F-1:t)&&(c.activeTexture(t),N=t)}var u=t.isWebGL2,p=new function(){var e=!1,a=new wt,r=null,o=new wt(0,0,0,0);return{setMask:function(t){r===t||e||(c.colorMask(t,t,t,t),r=t)},setLocked:function(t){e=t},setClear:function(t,e,r,n,i){!0===i&&(t*=n,e*=n,r*=n),a.set(t,e,r,n),!1===o.equals(a)&&(c.clearColor(t,e,r,n),o.copy(a))},reset:function(){e=!1,r=null,o.set(-1,0,0,0)}}},f=new function(){var e=!1,r=null,n=null,i=null;return{setTest:function(t){(t?h:d)(2929)},setMask:function(t){r===t||e||(c.depthMask(t),r=t)},setFunc:function(t){if(n!==t){if(t)switch(t){case 0:c.depthFunc(512);break;case 1:c.depthFunc(519);break;case 2:c.depthFunc(513);break;case 3:c.depthFunc(515);break;case 4:c.depthFunc(514);break;case 5:c.depthFunc(518);break;case 6:c.depthFunc(516);break;case 7:c.depthFunc(517);break;default:c.depthFunc(515)}else c.depthFunc(515);n=t}},setLocked:function(t){e=t},setClear:function(t){i!==t&&(c.clearDepth(t),i=t)},reset:function(){e=!1,i=n=r=null}}},m=new function(){var e=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?h:d)(2960)},setMask:function(t){r===t||e||(c.stencilMask(t),r=t)},setFunc:function(t,e,r){n===t&&i===e&&a===r||(c.stencilFunc(t,e,r),n=t,i=e,a=r)},setOp:function(t,e,r){o===t&&s===e&&l===r||(c.stencilOp(t,e,r),o=t,s=e,l=r)},setLocked:function(t){e=t},setClear:function(t){u!==t&&(c.clearStencil(t),u=t)},reset:function(){e=!1,u=l=s=o=a=i=n=r=null}}};t=c.getParameter(34921);var g=new Uint8Array(t),v=new Uint8Array(t),y=new Uint8Array(t),x={},b=null,_=null,A=null,w=null,M=null,C=null,T=null,S=null,E=null,I=!1,L=null,R=null,P=null,D=null,O=null,F=c.getParameter(35661),B=!1;t=0,-1!==(t=c.getParameter(7938)).indexOf("WebGL")?(t=parseFloat(/^WebGL ([0-9])/.exec(t)[1]),B=1<=t):-1!==t.indexOf("OpenGL ES")&&(t=parseFloat(/^OpenGL ES ([0-9])/.exec(t)[1]),B=2<=t);var N=null,z={},U=new wt,k=new wt,H={};H[3553]=e(3553,3553,1),H[34067]=e(34067,34069,6),p.setClear(0,0,0,1),f.setClear(1),m.setClear(0),h(2929),f.setFunc(3),a(!1),o(1),h(2884),i(0);var G={100:32774,101:32778,102:32779};u?(G[103]=32775,G[104]=32776):null!==(t=r.get("EXT_blend_minmax"))&&(G[103]=t.MIN_EXT,G[104]=t.MAX_EXT);var V={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:p,depth:f,stencil:m},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(t){n(t,0)},enableAttributeAndDivisor:n,disableUnusedAttributes:function(){for(var t=0,e=v.length;t!==e;++t)v[t]!==g[t]&&(c.disableVertexAttribArray(t),v[t]=0)},vertexAttribPointer:function(t,e,r,n,i,a){!0!==u||5124!==r&&5125!==r?c.vertexAttribPointer(t,e,r,n,i,a):c.vertexAttribIPointer(t,e,r,n,i,a)},enable:h,disable:d,useProgram:function(t){return b!==t&&(c.useProgram(t),b=t,!0)},setBlending:i,setMaterial:function(t,e){(2===t.side?d:h)(2884);var r=1===t.side;a(r=e?!r:r),1===t.blending&&!1===t.transparent?i(0):i(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),f.setFunc(t.depthFunc),f.setTest(t.depthTest),f.setMask(t.depthWrite),p.setMask(t.colorWrite),e=t.stencilWrite,m.setTest(e),e&&(m.setMask(t.stencilWriteMask),m.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),m.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),s(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:a,setCullFace:o,setLineWidth:function(t){t!==P&&(B&&c.lineWidth(t),P=t)},setPolygonOffset:s,setScissorTest:function(t){(t?h:d)(3089)},activeTexture:l,bindTexture:function(t,e){null===N&&l();var r=z[N];void 0===r&&(r={type:void 0,texture:void 0},z[N]=r),r.type===t&&r.texture===e||(c.bindTexture(t,e||H[t]),r.type=t,r.texture=e)},unbindTexture:function(){var t=z[N];void 0!==t&&void 0!==t.type&&(c.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{c.compressedTexImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{c.texImage2D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{c.texImage3D.apply(c,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===U.equals(t)&&(c.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===k.equals(t)&&(c.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){for(var t=0;t<v.length;t++)1===v[t]&&(c.disableVertexAttribArray(t),v[t]=0);x={},z={},R=L=A=b=N=null,p.reset(),f.reset(),m.reset()}}}function Ee(p,n,f,m,i,g,s){function a(t,e){return D?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function v(t,e,r,n){var i=1;if((i=t.width>n||t.height>n?n/Math.max(t.width,t.height):i)<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return e=(n=e?Sa.floorPowerOfTwo:Math.floor)(i*t.width),i=n(i*t.height),void 0===S&&(S=a(e,i)),(r=r?a(e,i):S).width=e,r.height=i,r.getContext("2d").drawImage(t,0,0,e,i),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+e+"x"+i+")."),r;"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function y(t){return Sa.isPowerOfTwo(t.width)&&Sa.isPowerOfTwo(t.height)}function x(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function b(t,e,r,n){p.generateMipmap(t),m.get(e).__maxMipLevel=Math.log(Math.max(r,n))*Math.LOG2E}function _(t,e,r){if(!1===E)return e;if(null!==t){if(void 0!==p[t])return p[t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+t+"'")}return 6403===(t=e)&&(5126===r&&(t=33326),5131===r&&(t=33325),5121===r&&(t=33321)),6407===e&&(5126===r&&(t=34837),5131===r&&(t=34843),5121===r&&(t=32849)),6408===e&&(5126===r&&(t=34836),5131===r&&(t=34842),5121===r&&(t=32856)),33325!==t&&33326!==t&&34842!==t&&34836!==t||n.get("EXT_color_buffer_float"),t}function o(t){return 1003===t||1004===t||1005===t?9728:9729}function r(t){(t=t.target).removeEventListener("dispose",r);var e=m.get(t);void 0!==e.__webglInit&&(p.deleteTexture(e.__webglTexture),m.remove(t)),t.isVideoTexture&&P.delete(t),s.memory.textures--}function l(t){(t=t.target).removeEventListener("dispose",l);var e=m.get(t),r=m.get(t.texture);if(t){if(void 0!==r.__webglTexture&&p.deleteTexture(r.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(r=0;r<6;r++)p.deleteFramebuffer(e.__webglFramebuffer[r]),e.__webglDepthbuffer&&p.deleteRenderbuffer(e.__webglDepthbuffer[r]);else p.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&p.deleteRenderbuffer(e.__webglDepthbuffer),e.__webglMultisampledFramebuffer&&p.deleteFramebuffer(e.__webglMultisampledFramebuffer),e.__webglColorRenderbuffer&&p.deleteRenderbuffer(e.__webglColorRenderbuffer),e.__webglDepthRenderbuffer&&p.deleteRenderbuffer(e.__webglDepthRenderbuffer);m.remove(t.texture),m.remove(t)}s.memory.textures--}function u(t,e){var r,n=m.get(t);if(t.isVideoTexture&&(r=s.render.frame,P.get(t)!==r&&(P.set(t,r),t.update())),0<t.version&&n.__version!==t.version)if(void 0===(r=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==r.complete)return void d(n,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}f.activeTexture(33984+e),f.bindTexture(3553,n.__webglTexture)}function c(t,e){if(6===t.image.length){var r=m.get(t);if(0<t.version&&r.__version!==t.version){w(r,t),f.activeTexture(33984+e),f.bindTexture(34067,r.__webglTexture),p.pixelStorei(37440,t.flipY);var n=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture);e=t.image[0]&&t.image[0].isDataTexture;for(var i=[],a=0;a<6;a++)i[a]=n||e?e?t.image[a].image:t.image[a]:v(t.image[a],!1,!0,I);var o=i[0],s=y(o)||E,l=g.convert(t.format),u=g.convert(t.type),c=_(t.internalFormat,l,u);if(A(34067,t,s),n){for(a=0;a<6;a++)for(var h=i[a].mipmaps,n=0;n<h.length;n++){var d=h[n];1023!==t.format&&1022!==t.format?null!==l?f.compressedTexImage2D(34069+a,n,c,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):f.texImage2D(34069+a,n,c,d.width,d.height,0,l,u,d.data)}r.__maxMipLevel=h.length-1}else{for(h=t.mipmaps,a=0;a<6;a++)if(e)for(f.texImage2D(34069+a,0,c,i[a].width,i[a].height,0,l,u,i[a].data),n=0;n<h.length;n++)d=(d=h[n]).image[a].image,f.texImage2D(34069+a,n+1,c,d.width,d.height,0,l,u,d.data);else for(f.texImage2D(34069+a,0,c,l,u,i[a]),n=0;n<h.length;n++)d=h[n],f.texImage2D(34069+a,n+1,c,l,u,d.image[a]);r.__maxMipLevel=h.length}x(t,s)&&b(34067,t,o.width,o.height),r.__version=t.version,t.onUpdate&&t.onUpdate(t)}else f.activeTexture(33984+e),f.bindTexture(34067,r.__webglTexture)}}function h(t,e){f.activeTexture(33984+e),f.bindTexture(34067,m.get(t).__webglTexture)}function A(t,e,r){r?(p.texParameteri(t,10242,F[e.wrapS]),p.texParameteri(t,10243,F[e.wrapT]),32879!==t&&35866!==t||p.texParameteri(t,32882,F[e.wrapR]),p.texParameteri(t,10240,B[e.magFilter]),p.texParameteri(t,10241,B[e.minFilter])):(p.texParameteri(t,10242,33071),p.texParameteri(t,10243,33071),32879!==t&&35866!==t||p.texParameteri(t,32882,33071),1001===e.wrapS&&1001===e.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),p.texParameteri(t,10240,o(e.magFilter)),p.texParameteri(t,10241,o(e.minFilter)),1003!==e.minFilter&&1006!==e.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(r=n.get("EXT_texture_filter_anisotropic"))||1015===e.type&&null===n.get("OES_texture_float_linear")||1016===e.type&&null===(E||n.get("OES_texture_half_float_linear"))||!(1<e.anisotropy||m.get(e).__currentAnisotropy)||(p.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,i.getMaxAnisotropy())),m.get(e).__currentAnisotropy=e.anisotropy)}function w(t,e){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",r),t.__webglTexture=p.createTexture(),s.memory.textures++)}function d(t,e,r){var n=3553;e.isDataTexture2DArray&&(n=35866),e.isDataTexture3D&&(n=32879),w(t,e),f.activeTexture(33984+r),f.bindTexture(n,t.__webglTexture),p.pixelStorei(37440,e.flipY),p.pixelStorei(37441,e.premultiplyAlpha),p.pixelStorei(3317,e.unpackAlignment),r=(r=!E&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter))&&!1===y(e.image);var i=y(r=v(e.image,r,!1,L))||E,a=g.convert(e.format),o=g.convert(e.type),s=_(e.internalFormat,a,o);A(n,e,i);var l=e.mipmaps;if(e.isDepthTexture)s=6402,E?s=1015===e.type?36012:1014===e.type?33190:1020===e.type?35056:33189:1015===e.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===e.format&&6402===s&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,o=g.convert(e.type)),1027===e.format&&6402===s&&(s=34041,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,o=g.convert(e.type))),f.texImage2D(3553,0,s,r.width,r.height,0,a,o,null);else if(e.isDataTexture)if(0<l.length&&i){for(var u=0,c=l.length;u<c;u++){var h=l[u];f.texImage2D(3553,u,s,h.width,h.height,0,a,o,h.data)}e.generateMipmaps=!1,t.__maxMipLevel=l.length-1}else f.texImage2D(3553,0,s,r.width,r.height,0,a,o,r.data),t.__maxMipLevel=0;else if(e.isCompressedTexture){for(u=0,c=l.length;u<c;u++)h=l[u],1023!==e.format&&1022!==e.format?null!==a?f.compressedTexImage2D(3553,u,s,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):f.texImage2D(3553,u,s,h.width,h.height,0,a,o,h.data);t.__maxMipLevel=l.length-1}else if(e.isDataTexture2DArray)f.texImage3D(35866,0,s,r.width,r.height,r.depth,0,a,o,r.data),t.__maxMipLevel=0;else if(e.isDataTexture3D)f.texImage3D(32879,0,s,r.width,r.height,r.depth,0,a,o,r.data),t.__maxMipLevel=0;else if(0<l.length&&i){for(u=0,c=l.length;u<c;u++)h=l[u],f.texImage2D(3553,u,s,a,o,h);e.generateMipmaps=!1,t.__maxMipLevel=l.length-1}else f.texImage2D(3553,0,s,a,o,r),t.__maxMipLevel=0;x(e,i)&&b(n,e,r.width,r.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function M(t,e,r,n){var i=g.convert(e.texture.format),a=g.convert(e.texture.type),o=_(e.texture.internalFormat,i,a);f.texImage2D(n,0,o,e.width,e.height,0,i,a,null),p.bindFramebuffer(36160,t),p.framebufferTexture2D(36160,r,n,m.get(e.texture).__webglTexture,0),p.bindFramebuffer(36160,null)}function C(t,e,r){var n;p.bindRenderbuffer(36161,t),e.depthBuffer&&!e.stencilBuffer?(n=33189,r?((r=e.depthTexture)&&r.isDepthTexture&&(1015===r.type?n=36012:1014===r.type&&(n=33190)),r=T(e),p.renderbufferStorageMultisample(36161,r,n,e.width,e.height)):p.renderbufferStorage(36161,n,e.width,e.height),p.framebufferRenderbuffer(36160,36096,36161,t)):e.depthBuffer&&e.stencilBuffer?(r?(r=T(e),p.renderbufferStorageMultisample(36161,r,35056,e.width,e.height)):p.renderbufferStorage(36161,34041,e.width,e.height),p.framebufferRenderbuffer(36160,33306,36161,t)):(t=g.convert(e.texture.format),n=g.convert(e.texture.type),n=_(e.texture.internalFormat,t,n),r?(r=T(e),p.renderbufferStorageMultisample(36161,r,n,e.width,e.height)):p.renderbufferStorage(36161,n,e.width,e.height)),p.bindRenderbuffer(36161,null)}function T(t){return E&&t.isWebGLMultisampleRenderTarget?Math.min(R,t.samples):0}var S,E=i.isWebGL2,e=i.maxTextures,I=i.maxCubemapSize,L=i.maxTextureSize,R=i.maxSamples,P=new Bu,D=!1;try{D="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}var O=0,F={1e3:10497,1001:33071,1002:33648},B={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987},N=!1,z=!1;this.allocateTextureUnit=function(){var t=O;return e<=t&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+e),O+=1,t},this.resetTextureUnits=function(){O=0},this.setTexture2D=u,this.setTexture2DArray=function(t,e){var r=m.get(t);0<t.version&&r.__version!==t.version?d(r,t,e):(f.activeTexture(33984+e),f.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){var r=m.get(t);0<t.version&&r.__version!==t.version?d(r,t,e):(f.activeTexture(33984+e),f.bindTexture(32879,r.__webglTexture))},this.setTextureCube=c,this.setTextureCubeDynamic=h,this.setupRenderTarget=function(t){var e=m.get(t),r=m.get(t.texture);t.addEventListener("dispose",l),r.__webglTexture=p.createTexture(),s.memory.textures++;var n,i=!0===t.isWebGLCubeRenderTarget,a=!0===t.isWebGLMultisampleRenderTarget,o=y(t)||E;if(!E||1022!==t.texture.format||1015!==t.texture.type&&1016!==t.texture.type||(t.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),i)for(e.__webglFramebuffer=[],a=0;a<6;a++)e.__webglFramebuffer[a]=p.createFramebuffer();else e.__webglFramebuffer=p.createFramebuffer(),a&&(E?(e.__webglMultisampledFramebuffer=p.createFramebuffer(),e.__webglColorRenderbuffer=p.createRenderbuffer(),p.bindRenderbuffer(36161,e.__webglColorRenderbuffer),a=g.convert(t.texture.format),n=g.convert(t.texture.type),a=_(t.texture.internalFormat,a,n),n=T(t),p.renderbufferStorageMultisample(36161,n,a,t.width,t.height),p.bindFramebuffer(36160,e.__webglMultisampledFramebuffer),p.framebufferRenderbuffer(36160,36064,36161,e.__webglColorRenderbuffer),p.bindRenderbuffer(36161,null),t.depthBuffer&&(e.__webglDepthRenderbuffer=p.createRenderbuffer(),C(e.__webglDepthRenderbuffer,t,!0)),p.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(i){for(f.bindTexture(34067,r.__webglTexture),A(34067,t.texture,o),a=0;a<6;a++)M(e.__webglFramebuffer[a],t,36064,34069+a);x(t.texture,o)&&b(34067,t.texture,t.width,t.height),f.bindTexture(34067,null)}else f.bindTexture(3553,r.__webglTexture),A(3553,t.texture,o),M(e.__webglFramebuffer,t,36064,3553),x(t.texture,o)&&b(3553,t.texture,t.width,t.height),f.bindTexture(3553,null);if(t.depthBuffer){if(e=m.get(t),r=!0===t.isWebGLCubeRenderTarget,t.depthTexture){if(r)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(p.bindFramebuffer(36160,e.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(m.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),u(t.depthTexture,0),e=m.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)p.framebufferTexture2D(36160,36096,3553,e,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");p.framebufferTexture2D(36160,33306,3553,e,0)}}else if(r)for(e.__webglDepthbuffer=[],r=0;r<6;r++)p.bindFramebuffer(36160,e.__webglFramebuffer[r]),e.__webglDepthbuffer[r]=p.createRenderbuffer(),C(e.__webglDepthbuffer[r],t,!1);else p.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=p.createRenderbuffer(),C(e.__webglDepthbuffer,t,!1);p.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(t){var e,r=t.texture,n=y(t)||E;x(r,n)&&(n=t.isWebGLCubeRenderTarget?34067:3553,e=m.get(r).__webglTexture,f.bindTexture(n,e),b(n,r,t.width,t.height),f.bindTexture(n,null))},this.updateMultisampleRenderTarget=function(t){var e,r,n,i;t.isWebGLMultisampleRenderTarget&&(E?(e=m.get(t),p.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),p.bindFramebuffer(36009,e.__webglFramebuffer),r=t.width,n=t.height,i=16384,t.depthBuffer&&(i|=256),t.stencilBuffer&&(i|=1024),p.blitFramebuffer(0,0,r,n,0,0,r,n,i,9728),p.bindFramebuffer(36160,e.__webglMultisampledFramebuffer)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),N=!0),t=t.texture),u(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),(t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?c:h)(t,e)}}function Ie(t,r,e){var n=e.isWebGL2;return{convert:function(t){if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t){if(n)return 5131;var e=r.get("OES_texture_half_float");return null!==e?e.HALF_FLOAT_OES:null}if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(e=r.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(e=r.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return null!==(e=r.get("WEBGL_compressed_texture_etc1"))?e.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(e=r.get("WEBGL_compressed_texture_etc"),null!==e)){if(37492===t)return e.COMPRESSED_RGB8_ETC2;if(37496===t)return e.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(e=r.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(e=r.get("EXT_texture_compression_bptc"))?t:null:1020===t?n?34042:null!==(e=r.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Le(t){W.call(this),this.cameras=t||[]}function Re(){p.call(this),this.type="Group"}function Pe(){this._grip=this._targetRay=null}function De(u,e){function r(t){var e=m.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function n(){m.forEach(function(t,e){t.disconnect(e)}),m.clear(),u.setFramebuffer(null),u.setRenderTarget(u.getRenderTarget()),C.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}function i(t){p=t,C.setContext(d),C.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}function a(t){for(var e=d.inputSources,r=0;r<f.length;r++)m.set(e[r],f[r]);for(r=0;r<t.removed.length;r++){var e=t.removed[r],n=m.get(e);n&&(n.dispatchEvent({type:"disconnected",data:e}),m.delete(e))}for(r=0;r<t.added.length;r++)e=t.added[r],(n=m.get(e))&&n.dispatchEvent({type:"connected",data:e})}function c(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}var h,o=this,d=null,s=1,p=null,l="local-floor",f=[],m=new Fu,g=new W;g.layers.enable(1),g.viewport=new wt;var v=new W;v.layers.enable(2),v.viewport=new wt;var y=[g,v],x=new Le;x.layers.enable(1),x.layers.enable(2);var b=null,_=null;this.isPresenting=this.enabled=!1,this.getController=function(t){var e=f[t];return void 0===e&&(e=new Pe,f[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=f[t];return void 0===e&&(e=new Pe,f[t]=e),e.getGripSpace()},this.setFramebufferScaleFactor=function(t){s=t,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){l=t,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p},this.getSession=function(){return d},this.setSession=function(t){null!==(d=t)&&(d.addEventListener("select",r),d.addEventListener("selectstart",r),d.addEventListener("selectend",r),d.addEventListener("squeeze",r),d.addEventListener("squeezestart",r),d.addEventListener("squeezeend",r),d.addEventListener("end",n),!0!==(t=e.getContextAttributes()).xrCompatible&&e.makeXRCompatible(),t=new XRWebGLLayer(d,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:s}),d.updateRenderState({baseLayer:t}),d.requestReferenceSpace(l).then(i),d.addEventListener("inputsourceschange",a))};var A=new Mt,w=new Mt;this.getCamera=function(t){x.near=v.near=g.near=t.near,x.far=v.far=g.far=t.far,b===x.near&&_===x.far||(d.updateRenderState({depthNear:x.near,depthFar:x.far}),b=x.near,_=x.far);var e=t.parent,r=x.cameras;c(x,e);for(var n,i,a,o,s,l=0;l<r.length;l++)c(r[l],e);for(t.matrixWorld.copy(x.matrixWorld),l=0,e=(t=t.children).length;l<e;l++)t[l].updateMatrixWorld(!0);return 2===r.length?(A.setFromMatrixPosition(g.matrixWorld),w.setFromMatrixPosition(v.matrixWorld),r=A.distanceTo(w),a=g.projectionMatrix.elements,i=v.projectionMatrix.elements,n=a[14]/(a[10]-1),l=a[14]/(a[10]+1),t=(a[9]+1)/a[5],e=(a[9]-1)/a[5],s=(a[8]-1)/a[0],o=(i[8]+1)/i[0],i=n*s,a=n*o,s=(o=r/(o-s))*-s,g.matrixWorld.decompose(x.position,x.quaternion,x.scale),x.translateX(s),x.translateZ(o),x.matrixWorld.compose(x.position,x.quaternion,x.scale),x.matrixWorldInverse.getInverse(x.matrixWorld),n+=o,o=l+o,x.projectionMatrix.makePerspective(i-s,r-s+a,t*l/o*n,e*l/o*n,n,o)):x.projectionMatrix.copy(g.projectionMatrix),x};var M=null,C=new It;C.setAnimationLoop(function(t,e){if(null!==(h=e.getViewerPose(p))){var r=h.views,n=d.renderState.baseLayer;u.setFramebuffer(n.framebuffer);var i=!1;r.length!==x.cameras.length&&(i=!(x.cameras.length=0));for(var a=0;a<r.length;a++){var o=r[a],s=n.getViewport(o),l=y[a];l.matrix.fromArray(o.transform.matrix),l.projectionMatrix.fromArray(o.projectionMatrix),l.viewport.set(s.x,s.y,s.width,s.height),0===a&&x.matrix.copy(l.matrix),!0===i&&x.cameras.push(l)}}for(r=d.inputSources,a=0;a<f.length;a++)f[a].update(r[a],e,p);M&&M(t,e)}),this.setAnimationLoop=function(t){M=t},this.dispose=function(){}}function Oe(a){function s(t,e,r){var n,i;t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),(r=e.envMap||r)&&(t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=a.get(r).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(!0===(i=i.isWebGLRenderTarget?i.texture:i).matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function l(t,e,r){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||r)&&(t.envMapIntensity.value=e.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,e,r,n,i){var a,o;e.isMeshBasicMaterial?s(t,e):e.isMeshLambertMaterial?(s(t,e),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)):e.isMeshToonMaterial?(s(t,e),t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshPhongMaterial?(s(t,e),t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshStandardMaterial?(s(t,e,r),e.isMeshPhysicalMaterial?(l(t,e,r),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transparency.value=e.transparency):l(t,e,r)):e.isMeshMatcapMaterial?(s(t,e),e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshDepthMaterial?(s(t,e),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isMeshDistanceMaterial?(s(t,e),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance):e.isMeshNormalMaterial?(s(t,e),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):e.isLineBasicMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.isLineDashedMaterial&&(t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale)):e.isPointsMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?a=e.map:e.alphaMap&&(a=e.alphaMap),void 0!==a&&(!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uvTransform.value.copy(a.matrix))):e.isSpriteMaterial?(t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?o=e.map:e.alphaMap&&(o=e.alphaMap),void 0!==o&&(!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uvTransform.value.copy(o.matrix))):e.isShadowMaterial?(t.color.value.copy(e.color),t.opacity.value=e.opacity):e.isShaderMaterial&&(e.uniformsNeedUpdate=!1)}}}function Fe(t){var A;function e(){M=new Ft(gt),!1===(C=new Dt(gt,M,t)).isWebGL2&&(M.get("WEBGL_depth_texture"),M.get("OES_texture_float"),M.get("OES_texture_half_float"),M.get("OES_texture_half_float_linear"),M.get("OES_standard_derivatives"),M.get("OES_element_index_uint"),M.get("ANGLE_instanced_arrays")),M.get("OES_texture_float_linear"),k=new Ie(0,M,C),(T=new Se(gt,M,C)).scissor(tt.copy(lt).multiplyScalar(it).floor()),T.viewport($.copy(st).multiplyScalar(it).floor()),_=new zt,S=new fe,E=new Ee(gt,M,T,S,C,k,_),I=new Lt(gt,C),L=new Bt(0,I,_),R=new kt(0,L,I,_),N=new Ut(gt),P=new pe(H,M,C),D=new Oe(S),O=new ye,F=new we,B=new Rt(H,T,R,p),z=new Pt(gt,M,_,C),U=new Nt(gt,M,_,C),_.programs=P.programs,H.capabilities=C,H.extensions=M,H.properties=S,H.renderLists=O,H.state=T,H.info=_}function r(t){t.preventDefault(),G=!0}function n(){G=!1,e()}function u(t){(t=t.target).removeEventListener("dispose",u),c(t),S.remove(t)}function c(t){var e=S.get(t).program;(t.program=void 0)!==e&&P.releaseProgram(e)}function o(t,e,r,n){for(var i=0,a=t.length;i<a;i++){var o=(u=t[i]).object,s=u.geometry,l=void 0===n?u.material:n,u=u.group;if(r.isArrayCamera)for(var c=(Q=r).cameras,h=0,d=c.length;h<d;h++){var p=c[h];o.layers.test(p.layers)&&(T.viewport($.copy(p.viewport)),b.setupLights(p),f(o,e,p,s,l,u))}else Q=null,f(o,e,r,s,l,u)}}function f(t,e,r,n,i,a){var o,s;t.onBeforeRender(H,e,r,n,i,a),b=F.get(e,Q||r),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(o=w(r,e,i,t),T.setMaterial(i),Z=A=null,J=!1,s=o,t.render(function(t){H.renderBufferImmediate(t,s)})):H.renderBufferDirect(r,e,n,i,t,a),t.onAfterRender(H,e,r,n,i,a),b=F.get(e,Q||r)}function m(t,e,r){var n=S.get(t),i=b.state.lights,a=i.state.version;r=P.getParameters(t,i.state,b.state.shadowsArray,e,ht.numPlanes,ht.numIntersection,r);var o=P.getProgramCacheKey(r),s=n.program,l=!0;if(void 0===s)t.addEventListener("dispose",u);else if(s.cacheKey!==o)c(t);else{if(n.lightsStateVersion!==a)n.lightsStateVersion=a;else if(void 0!==r.shaderID)return;l=!1}if(l&&(s=P.acquireProgram(r,o),n.program=s,n.uniforms=r.uniforms,n.outputEncoding=r.outputEncoding,t.program=s),r=s.getAttributes(),t.morphTargets)for(o=t.numSupportedMorphTargets=0;o<H.maxMorphTargets;o++)0<=r["morphTarget"+o]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(o=t.numSupportedMorphNormals=0;o<H.maxMorphNormals;o++)0<=r["morphNormal"+o]&&t.numSupportedMorphNormals++;r=n.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=ht.numPlanes,n.numIntersection=ht.numIntersection,r.clippingPlanes=ht.uniform),n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.needsLights=t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights,n.lightsStateVersion=a,n.needsLights&&(r.ambientLightColor.value=i.state.ambient,r.lightProbe.value=i.state.probe,r.directionalLights.value=i.state.directional,r.directionalLightShadows.value=i.state.directionalShadow,r.spotLights.value=i.state.spot,r.spotLightShadows.value=i.state.spotShadow,r.rectAreaLights.value=i.state.rectArea,r.pointLights.value=i.state.point,r.pointLightShadows.value=i.state.pointShadow,r.hemisphereLights.value=i.state.hemi,r.directionalShadowMap.value=i.state.directionalShadowMap,r.directionalShadowMatrix.value=i.state.directionalShadowMatrix,r.spotShadowMap.value=i.state.spotShadowMap,r.spotShadowMatrix.value=i.state.spotShadowMatrix,r.pointShadowMap.value=i.state.pointShadowMap,r.pointShadowMatrix.value=i.state.pointShadowMatrix),t=n.program.getUniforms(),t=te.seqWithValue(t.seq,r),n.uniformsList=t}function w(t,e,r,n){E.resetTextureUnits();var i=e.fog,a=r.isMeshStandardMaterial?e.environment:null,o=null===X?H.outputEncoding:X.texture.encoding,s=S.get(r),l=b.state.lights;dt&&(pt||t!==K)&&ht.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,t,s,t===K&&r.id===Y),r.version===s.__version?(void 0===s.program||r.fog&&s.fog!==i||s.environment!==a||s.needsLights&&s.lightsStateVersion!==l.state.version||void 0!==s.numClippingPlanes&&(s.numClippingPlanes!==ht.numPlanes||s.numIntersection!==ht.numIntersection)||s.outputEncoding!==o)&&m(r,e,n):(m(r,e,n),s.__version=r.version);var u,c,h=!1,d=!1,p=!1,o=(e=s.program).getUniforms(),l=s.uniforms;return T.useProgram(e.program)&&(p=d=h=!0),r.id!==Y&&(Y=r.id,d=!0),!h&&K===t||(o.setValue(gt,"projectionMatrix",t.projectionMatrix),C.logarithmicDepthBuffer&&o.setValue(gt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),K!==t&&(K=t,p=d=!0),!(r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap)||void 0!==(h=o.map.cameraPosition)&&h.setValue(gt,mt.setFromMatrixPosition(t.matrixWorld)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&o.setValue(gt,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&o.setValue(gt,"viewMatrix",t.matrixWorldInverse)),r.skinning&&(o.setOptional(gt,n,"bindMatrix"),o.setOptional(gt,n,"bindMatrixInverse"),t=n.skeleton)&&(h=t.bones,C.floatVertexTextures?(void 0===t.boneTexture&&(h=Math.sqrt(4*h.length),h=Sa.ceilPowerOfTwo(h),h=Math.max(h,4),(u=new Float32Array(h*h*4)).set(t.boneMatrices),c=new St(u,h,h,1023,1015),t.boneMatrices=u,t.boneTexture=c,t.boneTextureSize=h),o.setValue(gt,"boneTexture",t.boneTexture,E),o.setValue(gt,"boneTextureSize",t.boneTextureSize)):o.setOptional(gt,t,"boneMatrices")),!d&&s.receiveShadow===n.receiveShadow||(s.receiveShadow=n.receiveShadow,o.setValue(gt,"receiveShadow",n.receiveShadow)),d&&(o.setValue(gt,"toneMappingExposure",H.toneMappingExposure),o.setValue(gt,"toneMappingWhitePoint",H.toneMappingWhitePoint),s.needsLights&&(d=p,l.ambientLightColor.needsUpdate=d,l.lightProbe.needsUpdate=d,l.directionalLights.needsUpdate=d,l.directionalLightShadows.needsUpdate=d,l.pointLights.needsUpdate=d,l.pointLightShadows.needsUpdate=d,l.spotLights.needsUpdate=d,l.spotLightShadows.needsUpdate=d,l.rectAreaLights.needsUpdate=d,l.hemisphereLights.needsUpdate=d),i&&r.fog&&D.refreshFogUniforms(l,i),D.refreshMaterialUniforms(l,r,a,it,nt),void 0!==l.ltc_1&&(l.ltc_1.value=bs.LTC_1),void 0!==l.ltc_2&&(l.ltc_2.value=bs.LTC_2),te.upload(gt,s.uniformsList,l,E)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(te.upload(gt,s.uniformsList,l,E),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&o.setValue(gt,"center",n.center),o.setValue(gt,"modelViewMatrix",n.modelViewMatrix),o.setValue(gt,"normalMatrix",n.normalMatrix),o.setValue(gt,"modelMatrix",n.matrixWorld),e}var i=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),a=void 0!==t.context?t.context:null,s=void 0!==t.alpha&&t.alpha,l=void 0===t.depth||t.depth,h=void 0===t.stencil||t.stencil,d=void 0!==t.antialias&&t.antialias,p=void 0===t.premultipliedAlpha||t.premultipliedAlpha,g=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,v=void 0!==t.powerPreference?t.powerPreference:"default",y=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,x=null,b=null;this.domElement=i,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var M,C,T,_,S,E,I,L,R,P,D,O,F,B,N,z,U,k,H=this,G=!1,V=null,W=0,j=0,X=null,q=null,Y=-1,Z=A=null,J=!1,K=null,Q=null,$=new wt,tt=new wt,et=null,rt=i.width,nt=i.height,it=1,at=null,ot=null,st=new wt(0,0,rt,nt),lt=new wt(0,0,rt,nt),ut=!1,ct=new Et,ht=new Ot,dt=!1,pt=!1,ft=new Ct,mt=new Mt;try{s={alpha:s,depth:l,stencil:h,antialias:d,premultipliedAlpha:p,preserveDrawingBuffer:g,powerPreference:v,failIfMajorPerformanceCaveat:y},i.addEventListener("webglcontextlost",r,!1),i.addEventListener("webglcontextrestored",n,!1);var gt=a||i.getContext("webgl",s)||i.getContext("experimental-webgl",s);if(null===gt){if(null!==i.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===gt.getShaderPrecisionFormat&&(gt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}e();var vt=new De(H,gt);this.xr=vt;var yt=new Te(H,R,C.maxTextureSize);this.shadowMap=yt,this.getContext=function(){return gt},this.getContextAttributes=function(){return gt.getContextAttributes()},this.forceContextLoss=function(){var t=M.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=M.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return it},this.setPixelRatio=function(t){void 0!==t&&(it=t,this.setSize(rt,nt,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new At),t.set(rt,nt)},this.setSize=function(t,e,r){vt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(rt=t,nt=e,i.width=Math.floor(t*it),i.height=Math.floor(e*it),!1!==r&&(i.style.width=t+"px",i.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new At),t.set(rt*it,nt*it).floor()},this.setDrawingBufferSize=function(t,e,r){rt=t,nt=e,it=r,i.width=Math.floor(t*r),i.height=Math.floor(e*r),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new wt),t.copy($)},this.getViewport=function(t){return t.copy(st)},this.setViewport=function(t,e,r,n){t.isVector4?st.set(t.x,t.y,t.z,t.w):st.set(t,e,r,n),T.viewport($.copy(st).multiplyScalar(it).floor())},this.getScissor=function(t){return t.copy(lt)},this.setScissor=function(t,e,r,n){t.isVector4?lt.set(t.x,t.y,t.z,t.w):lt.set(t,e,r,n),T.scissor(tt.copy(lt).multiplyScalar(it).floor())},this.getScissorTest=function(){return ut},this.setScissorTest=function(t){T.setScissorTest(ut=t)},this.setOpaqueSort=function(t){at=t},this.setTransparentSort=function(t){ot=t},this.getClearColor=function(){return B.getClearColor()},this.setClearColor=function(){B.setClearColor.apply(B,arguments)},this.getClearAlpha=function(){return B.getClearAlpha()},this.setClearAlpha=function(){B.setClearAlpha.apply(B,arguments)},this.clear=function(t,e,r){var n=0;void 0!==t&&!t||(n|=16384),void 0!==e&&!e||(n|=256),void 0!==r&&!r||(n|=1024),gt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",r,!1),i.removeEventListener("webglcontextrestored",n,!1),O.dispose(),F.dispose(),S.dispose(),R.dispose(),vt.dispose(),_t.stop()},this.renderBufferImmediate=function(t,e){T.initAttributes();var r=S.get(t);t.hasPositions&&!r.position&&(r.position=gt.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=gt.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=gt.createBuffer()),t.hasColors&&!r.color&&(r.color=gt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(gt.bindBuffer(34962,r.position),gt.bufferData(34962,t.positionArray,35048),T.enableAttribute(e.position),gt.vertexAttribPointer(e.position,3,5126,!1,0,0)),t.hasNormals&&(gt.bindBuffer(34962,r.normal),gt.bufferData(34962,t.normalArray,35048),T.enableAttribute(e.normal),gt.vertexAttribPointer(e.normal,3,5126,!1,0,0)),t.hasUvs&&(gt.bindBuffer(34962,r.uv),gt.bufferData(34962,t.uvArray,35048),T.enableAttribute(e.uv),gt.vertexAttribPointer(e.uv,2,5126,!1,0,0)),t.hasColors&&(gt.bindBuffer(34962,r.color),gt.bufferData(34962,t.colorArray,35048),T.enableAttribute(e.color),gt.vertexAttribPointer(e.color,3,5126,!1,0,0)),T.disableUnusedAttributes(),gt.drawArrays(4,0,t.count),t.count=0};var xt=new Tt;this.renderBufferDirect=function(t,e,r,n,i,a){null===e&&(e=xt);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=w(t,e,n,i);T.setMaterial(n,o);var l=!1;if(A===r.id&&Z===s.id&&J===(!0===n.wireframe)||(A=r.id,Z=s.id,J=!0===n.wireframe,l=!0),(n.morphTargets||n.morphNormals)&&(N.update(i,r,n,s),l=!0),!0===i.isInstancedMesh&&(l=!0),t=r.index,e=r.attributes.position,null===t){if(void 0===e||0===e.count)return}else if(0===t.count)return;var u,c=1;if(!0===n.wireframe&&(t=L.getWireframeAttribute(r),c=2),o=z,null!==t&&(u=I.get(t),(o=U).setIndex(u)),l){if(!1!==C.isWebGL2||!i.isInstancedMesh&&!r.isInstancedBufferGeometry||null!==M.get("ANGLE_instanced_arrays")){T.initAttributes();var l=r.attributes,s=s.getAttributes(),h=n.defaultAttributeValues;for(_ in s){var d=s[_];if(0<=d)if(void 0!==(v=l[_])){var p,f,m,g,v,y=v.normalized,x=v.itemSize,b=I.get(v);void 0!==b&&(p=b.buffer,f=b.type,b=b.bytesPerElement,v.isInterleavedBufferAttribute?(g=(m=v.data).stride,v=v.offset,m&&m.isInstancedInterleavedBuffer?(T.enableAttributeAndDivisor(d,m.meshPerAttribute),void 0===r._maxInstanceCount&&(r._maxInstanceCount=m.meshPerAttribute*m.count)):T.enableAttribute(d),gt.bindBuffer(34962,p),T.vertexAttribPointer(d,x,f,y,g*b,v*b)):(v.isInstancedBufferAttribute?(T.enableAttributeAndDivisor(d,v.meshPerAttribute),void 0===r._maxInstanceCount&&(r._maxInstanceCount=v.meshPerAttribute*v.count)):T.enableAttribute(d),gt.bindBuffer(34962,p),T.vertexAttribPointer(d,x,f,y,0,0)))}else if("instanceMatrix"===_)void 0!==(b=I.get(i.instanceMatrix))&&(p=b.buffer,f=b.type,T.enableAttributeAndDivisor(d+0,1),T.enableAttributeAndDivisor(d+1,1),T.enableAttributeAndDivisor(d+2,1),T.enableAttributeAndDivisor(d+3,1),gt.bindBuffer(34962,p),gt.vertexAttribPointer(d+0,4,f,!1,64,0),gt.vertexAttribPointer(d+1,4,f,!1,64,16),gt.vertexAttribPointer(d+2,4,f,!1,64,32),gt.vertexAttribPointer(d+3,4,f,!1,64,48));else if(void 0!==h&&void 0!==(y=h[_]))switch(y.length){case 2:gt.vertexAttrib2fv(d,y);break;case 3:gt.vertexAttrib3fv(d,y);break;case 4:gt.vertexAttrib4fv(d,y);break;default:gt.vertexAttrib1fv(d,y)}}T.disableUnusedAttributes()}null!==t&&gt.bindBuffer(34963,u.buffer)}var _=r.drawRange.start*c;l=null!==a?a.start*c:0,u=Math.max(_,l),0!==(a=Math.max(0,Math.min((null!==t?t:e).count,_+r.drawRange.count*c,l+(null!==a?a.count*c:1/0))-1-u+1))&&(i.isMesh?!0===n.wireframe?(T.setLineWidth(n.wireframeLinewidth*(null===X?it:1)),o.setMode(1)):o.setMode(4):i.isLine?(void 0===(n=n.linewidth)&&(n=1),T.setLineWidth(n*(null===X?it:1)),i.isLineSegments?o.setMode(1):i.isLineLoop?o.setMode(2):o.setMode(3)):i.isPoints?o.setMode(0):i.isSprite&&o.setMode(4),i.isInstancedMesh?o.renderInstances(r,u,a,i.count):r.isInstancedBufferGeometry?o.renderInstances(r,u,a,Math.min(r.instanceCount,r._maxInstanceCount)):o.render(u,a))},this.compile=function(i,t){(b=F.get(i,t)).init(),i.traverse(function(t){t.isLight&&(b.pushLight(t),t.castShadow&&b.pushShadow(t))}),b.setupLights(t);var a={};i.traverse(function(t){var e=t.material;if(e)if(Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];!1==n.uuid in a&&(m(n,i,t),a[n.uuid]=!0)}else!1==e.uuid in a&&(m(e,i,t),a[e.uuid]=!0)})};var bt=null,_t=new It;_t.setAnimationLoop(function(t){vt.isPresenting||bt&&bt(t)}),"undefined"!=typeof window&&_t.setContext(window),this.setAnimationLoop=function(t){bt=t,vt.setAnimationLoop(t),_t.start()},this.render=function(t,e,r,n){var i,a;void 0!==r&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=r),void 0!==n&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),a=n),e&&e.isCamera?G||(Z=A=null,J=!1,Y=-1,!(K=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),vt.enabled&&vt.isPresenting&&(e=vt.getCamera(e)),t.onBeforeRender(H,t,e,i||X),(b=F.get(t,e)).init(),ft.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ct.setFromProjectionMatrix(ft),pt=this.localClippingEnabled,dt=ht.init(this.clippingPlanes,pt,e),(x=O.get(t,e)).init(),function t(e,r,n,i){if(!1!==e.visible){if(e.layers.test(r.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(r);else if(e.isLight)b.pushLight(e),e.castShadow&&b.pushShadow(e);else if(e.isSprite){var a,o;e.frustumCulled&&!ct.intersectsSprite(e)||(i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),a=R.update(e),(o=e.material).visible&&x.push(e,a,o,n,mt.z,null))}else if(e.isImmediateRenderObject)i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),x.push(e,null,e.material,n,mt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==_.render.frame&&(e.skeleton.update(),e.skeleton.frame=_.render.frame),!e.frustumCulled||ct.intersectsObject(e)))if(i&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),a=R.update(e),o=e.material,Array.isArray(o))for(var s=a.groups,l=0,u=s.length;l<u;l++){var c=s[l],h=o[c.materialIndex];h&&h.visible&&x.push(e,a,h,n,mt.z,c)}else o.visible&&x.push(e,a,o,n,mt.z,null);for(l=0,u=(e=e.children).length;l<u;l++)t(e[l],r,n,i)}}(t,e,0,H.sortObjects),x.finish(),!0===H.sortObjects&&x.sort(at,ot),dt&&ht.beginShadows(),yt.render(b.state.shadowsArray,t,e),b.setupLights(e),dt&&ht.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),B.render(x,t,e,a),r=x.opaque,n=x.transparent,t.overrideMaterial?(i=t.overrideMaterial,r.length&&o(r,t,e,i),n.length&&o(n,t,e,i)):(r.length&&o(r,t,e),n.length&&o(n,t,e)),t.onAfterRender(H,t,e),null!==X&&(E.updateRenderTargetMipmap(X),E.updateMultisampleRenderTarget(X)),T.buffers.depth.setTest(!0),T.buffers.depth.setMask(!0),T.buffers.color.setMask(!0),T.setPolygonOffset(!1),b=x=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){V!==t&&null===X&&gt.bindFramebuffer(36160,t),V=t},this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return X},this.setRenderTarget=function(t,e,r){W=e,j=r,(X=t)&&void 0===S.get(t).__webglFramebuffer&&E.setupRenderTarget(t);var n=V,i=!1;et=t?(n=S.get(t).__webglFramebuffer,t.isWebGLCubeRenderTarget?(n=n[e||0],i=!0):n=t.isWebGLMultisampleRenderTarget?S.get(t).__webglMultisampledFramebuffer:n,$.copy(t.viewport),tt.copy(t.scissor),t.scissorTest):($.copy(st).multiplyScalar(it).floor(),tt.copy(lt).multiplyScalar(it).floor(),ut),q!==n&&(gt.bindFramebuffer(36160,n),q=n),T.viewport($),T.scissor(tt),T.setScissorTest(et),i&&(t=S.get(t.texture),gt.framebufferTexture2D(36160,36064,34069+(e||0),t.__webglTexture,r||0))},this.readRenderTargetPixels=function(t,e,r,n,i,a,o){if(t&&t.isWebGLRenderTarget){var s=S.get(t).__webglFramebuffer;if(s=t.isWebGLCubeRenderTarget&&void 0!==o?s[o]:s){o=!1,s!==q&&(gt.bindFramebuffer(36160,s),o=!0);try{var l=t.texture,u=l.format,l=l.type;1023!==u&&k.convert(u)!==gt.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===l||k.convert(l)===gt.getParameter(35738)||1015===l&&(C.isWebGL2||M.get("OES_texture_float")||M.get("WEBGL_color_buffer_float"))||1016===l&&(C.isWebGL2?M.get("EXT_color_buffer_float"):M.get("EXT_color_buffer_half_float"))?36053===gt.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=r&&r<=t.height-i&&gt.readPixels(e,r,n,i,k.convert(u),k.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{o&&gt.bindFramebuffer(36160,q)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,r){void 0===r&&(r=0);var n=Math.pow(2,-r),i=Math.floor(e.image.width*n),n=Math.floor(e.image.height*n),a=k.convert(e.format);E.setTexture2D(e,0),gt.copyTexImage2D(3553,r,a,t.x,t.y,i,n,0),T.unbindTexture()},this.copyTextureToTexture=function(t,e,r,n){void 0===n&&(n=0);var i=e.image.width,a=e.image.height,o=k.convert(r.format),s=k.convert(r.type);E.setTexture2D(r,0),e.isDataTexture?gt.texSubImage2D(3553,n,t.x,t.y,i,a,o,s,e.image.data):e.isCompressedTexture?gt.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):gt.texSubImage2D(3553,n,t.x,t.y,o,s,e.image),0===n&&r.generateMipmaps&&gt.generateMipmap(3553),T.unbindTexture()},this.initTexture=function(t){E.setTexture2D(t,0),T.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Be(t,e){this.name="",this.color=new m(t),this.density=void 0!==e?e:25e-5}function Ne(t,e,r){this.name="",this.color=new m(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3}function ze(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Ue(t,e,r,n){this.name="",this.data=t,this.itemSize=e,this.offset=r,this.normalized=!0===n}function ke(t){x.call(this),this.type="SpriteMaterial",this.color=new m(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function He(t){var e;p.call(this),this.type="Sprite",void 0===Us&&(Us=new F,e=new ze(e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),Us.setIndex([0,1,2,0,2,3]),Us.setAttribute("position",new Ue(e,3,0,!1)),Us.setAttribute("uv",new Ue(e,2,3,!1))),this.geometry=Us,this.material=void 0!==t?t:new ke,this.center=new At(.5,.5)}function Ge(t,e,r,n,i,a){Vs.subVectors(t,r).addScalar(.5).multiply(n),void 0!==i?(Ws.x=a*Vs.x-i*Vs.y,Ws.y=i*Vs.x+a*Vs.y):Ws.copy(Vs),t.copy(e),t.x+=Ws.x,t.y+=Ws.y,t.applyMatrix4(js)}function Ve(){p.call(this),this._currentLevel=0,this.type="LOD",ku(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function We(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),B.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct}function je(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Ct)}function Xe(){p.call(this),this.type="Bone"}function qe(t,e,r){B.call(this,t,e),this.instanceMatrix=new S(new Float32Array(16*r),16),this.count=r,this.frustumCulled=!1}function Ye(t){x.call(this),this.type="LineBasicMaterial",this.color=new m(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function Ze(t,e,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),p.call(this),this.type="Line",this.geometry=void 0!==t?t:new F,this.material=void 0!==e?e:new Ye,this.updateMorphTargets()}function Je(t,e){Ze.call(this,t,e),this.type="LineSegments"}function Ke(t,e){Ze.call(this,t,e),this.type="LineLoop"}function Qe(t){x.call(this),this.type="PointsMaterial",this.color=new m(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function $e(t,e){p.call(this),this.type="Points",this.geometry=void 0!==t?t:new F,this.material=void 0!==e?e:new Qe,this.updateMorphTargets()}function tr(t,e,r,n,i,a,o){var s=fl.distanceSqToPoint(t);s<r&&(r=new Mt,fl.closestPointToPoint(t,r),r.applyMatrix4(n),(t=i.ray.origin.distanceTo(r))<i.near||t>i.far||a.push({distance:t,distanceToRay:Math.sqrt(s),point:r,index:e,face:null,object:o}))}function er(t,e,r,n,i,a,o,s,l){d.call(this,t,e,r,n,i,a,o,s,l),this.format=void 0!==o?o:1022,this.minFilter=void 0!==a?a:1006,this.magFilter=void 0!==i?i:1006,this.generateMipmaps=!1}function rr(t,e,r,n,i,a,o,s,l,u,c,h){d.call(this,null,a,o,s,l,u,n,i,c,h),this.image={width:e,height:r},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function nr(t,e,r,n,i,a,o,s,l){d.call(this,t,e,r,n,i,a,o,s,l),this.needsUpdate=!0}function ir(t,e,r,n,i,a,o,s,l,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d.call(this,null,n,i,a,o,s,u,r=void 0===(r=void 0===r&&1026===u?1012:r)&&1027===u?1020:r,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==s?s:1003,this.generateMipmaps=this.flipY=!1}function ar(t){F.call(this),this.type="WireframeGeometry";var e=[],r=[0,0],n={},i=["a","b","c"];if(t&&t.isGeometry){for(var a=t.faces,o=0,s=a.length;o<s;o++)for(var l=a[o],u=0;u<3;u++){var c=l[i[u]],h=l[i[(u+1)%3]];r[0]=Math.min(c,h),r[1]=Math.max(c,h),void 0===n[c=r[0]+","+r[1]]&&(n[c]={index1:r[0],index2:r[1]})}for(c in n)o=n[c],i=t.vertices[o.index1],e.push(i.x,i.y,i.z),i=t.vertices[o.index2],e.push(i.x,i.y,i.z)}else if(t&&t.isBufferGeometry)if(i=new Mt,null!==t.index){for(var a=t.attributes.position,l=t.index,d=t.groups,p=(d=(t=0)===d.length?[{start:0,count:l.count,materialIndex:0}]:d).length;t<p;++t)for(u=(o=d[t]).start,s=o.count,s=(o=u)+s;o<s;o+=3)for(u=0;u<3;u++)c=l.getX(o+u),h=l.getX(o+(u+1)%3),r[0]=Math.min(c,h),r[1]=Math.max(c,h),void 0===n[c=r[0]+","+r[1]]&&(n[c]={index1:r[0],index2:r[1]});for(c in n)o=n[c],i.fromBufferAttribute(a,o.index1),e.push(i.x,i.y,i.z),i.fromBufferAttribute(a,o.index2),e.push(i.x,i.y,i.z)}else for(o=0,s=(a=t.attributes.position).count/3;o<s;o++)for(u=0;u<3;u++)n=3*o+u,i.fromBufferAttribute(a,n),e.push(i.x,i.y,i.z),n=3*o+(u+1)%3,i.fromBufferAttribute(a,n),e.push(i.x,i.y,i.z);this.setAttribute("position",new R(e,3))}function or(t,e,r){U.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r},this.fromBufferGeometry(new sr(t,e,r)),this.mergeVertices()}function sr(t,e,r){F.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:r};var n=[],i=[],a=[],o=[],s=new Mt,l=new Mt,u=new Mt,c=new Mt,h=new Mt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=e+1,p=0;p<=r;p++)for(var f=p/r,m=0;m<=e;m++){var g=m/e;t(g,f,l),i.push(l.x,l.y,l.z),0<=g-1e-5?(t(g-1e-5,f,u),c.subVectors(l,u)):(t(1e-5+g,f,u),c.subVectors(u,l)),0<=f-1e-5?(t(g,f-1e-5,u),h.subVectors(l,u)):(t(g,1e-5+f,u),h.subVectors(u,l)),s.crossVectors(c,h).normalize(),a.push(s.x,s.y,s.z),o.push(g,f)}for(p=0;p<r;p++)for(m=0;m<e;m++)t=p*d+m+1,s=(p+1)*d+m+1,l=(p+1)*d+m,n.push(p*d+m,t,l),n.push(t,s,l);this.setIndex(n),this.setAttribute("position",new R(i,3)),this.setAttribute("normal",new R(a,3)),this.setAttribute("uv",new R(o,2))}function lr(t,e,r,n){U.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},this.fromBufferGeometry(new ur(t,e,r,n)),this.mergeVertices()}function ur(r,m,t,e){function g(t){h.push(t.x,t.y,t.z)}function v(t,e){t*=3,e.x=r[t+0],e.y=r[t+1],e.z=r[t+2]}function c(t,e,r,n){n<0&&1===t.x&&(d[e]=t.x-1),0===r.x&&0===r.z&&(d[e]=n/2/Math.PI+.5)}F.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:r,indices:m,radius:t,detail:e},t=t||1;var h=[],d=[];!function(t){for(var e=new Mt,r=new Mt,n=new Mt,i=0;i<m.length;i+=3){v(m[i+0],e),v(m[i+1],r),v(m[i+2],n);for(var a=e,o=r,s=n,l=Math.pow(2,t),u=[],c=0;c<=l;c++){u[c]=[];for(var h=a.clone().lerp(s,c/l),d=o.clone().lerp(s,c/l),p=l-c,f=0;f<=p;f++)u[c][f]=0===f&&c===l?h:h.clone().lerp(d,f/p)}for(c=0;c<l;c++)for(f=0;f<2*(l-c)-1;f++)a=Math.floor(f/2),0==f%2?(g(u[c][a+1]),g(u[c+1][a]),g(u[c][a])):(g(u[c][a+1]),g(u[c+1][a+1]),g(u[c+1][a]))}}(e=e||0),function(t){for(var e=new Mt,r=0;r<h.length;r+=3)e.x=h[r+0],e.y=h[r+1],e.z=h[r+2],e.normalize().multiplyScalar(t),h[r+0]=e.x,h[r+1]=e.y,h[r+2]=e.z}(t),function(){for(var t=new Mt,e=0;e<h.length;e+=3)t.x=h[e+0],t.y=h[e+1],t.z=h[e+2],d.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));for(var t=new Mt,e=new Mt,r=new Mt,n=new Mt,i=new At,a=new At,o=new At,s=0,l=0;s<h.length;s+=9,l+=6){t.set(h[s+0],h[s+1],h[s+2]),e.set(h[s+3],h[s+4],h[s+5]),r.set(h[s+6],h[s+7],h[s+8]),i.set(d[l+0],d[l+1]),a.set(d[l+2],d[l+3]),o.set(d[l+4],d[l+5]),n.copy(t).add(e).add(r).divideScalar(3);var u=Math.atan2(n.z,-n.x);c(i,l+0,t,u),c(a,l+2,e,u),c(o,l+4,r,u)}for(t=0;t<d.length;t+=6)e=d[t+0],r=d[t+2],n=d[t+4],i=Math.min(e,r,n),.9<Math.max(e,r,n)&&i<.1&&(e<.2&&(d[t+0]+=1),r<.2&&(d[t+2]+=1),n<.2&&(d[t+4]+=1))}(),this.setAttribute("position",new R(h,3)),this.setAttribute("normal",new R(h.slice(),3)),this.setAttribute("uv",new R(d,2)),0===e?this.computeVertexNormals():this.normalizeNormals()}function cr(t,e){U.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new hr(t,e)),this.mergeVertices()}function hr(t,e){ur.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function dr(t,e){U.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new pr(t,e)),this.mergeVertices()}function pr(t,e){ur.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function fr(t,e){U.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new mr(t,e)),this.mergeVertices()}function mr(t,e){var r=(1+Math.sqrt(5))/2;ur.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function gr(t,e){U.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new vr(t,e)),this.mergeVertices()}function vr(t,e){var r=(1+Math.sqrt(5))/2,n=1/r;ur.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function yr(t,e,r,n,i,a){U.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new xr(t,e,r,n,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function xr(i,a,o,s,t){function e(t){d=i.getPointAt(t/a,d);var e=l.normals[t];for(t=l.binormals[t],u=0;u<=s;u++){var r=u/s*Math.PI*2,n=Math.sin(r),r=-Math.cos(r);h.x=r*e.x+n*t.x,h.y=r*e.y+n*t.y,h.z=r*e.z+n*t.z,h.normalize(),f.push(h.x,h.y,h.z),c.x=d.x+o*h.x,c.y=d.y+o*h.y,c.z=d.z+o*h.z,p.push(c.x,c.y,c.z)}}F.call(this),this.type="TubeBufferGeometry",this.parameters={path:i,tubularSegments:a,radius:o,radialSegments:s,closed:t},a=a||64,o=o||1,s=s||8,t=t||!1;var l=i.computeFrenetFrames(a,t);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;for(var u,c=new Mt,h=new Mt,r=new At,d=new Mt,p=[],f=[],n=[],m=[],g=0;g<a;g++)e(g);for(e(!1===t?a:0),g=0;g<=a;g++)for(u=0;u<=s;u++)r.x=g/a,r.y=u/s,n.push(r.x,r.y);!function(){for(u=1;u<=a;u++)for(g=1;g<=s;g++){var t=(s+1)*u+(g-1),e=(s+1)*u+g,r=(s+1)*(u-1)+g;m.push((s+1)*(u-1)+(g-1),t,r),m.push(t,e,r)}}(),this.setIndex(m),this.setAttribute("position",new R(p,3)),this.setAttribute("normal",new R(f,3)),this.setAttribute("uv",new R(n,2))}function br(t,e,r,n,i,a,o){U.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new _r(t,e,r,n,i,a)),this.mergeVertices()}function _r(t,e,r,n,i,a){function o(t,e,r,n,i){var a=Math.sin(t);e=r/e*t,r=Math.cos(e),i.x=n*(2+r)*.5*Math.cos(t),i.y=n*(2+r)*a*.5,i.z=n*Math.sin(e)*.5}F.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a},t=t||1,e=e||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,a=a||3;for(var s=[],l=[],u=[],c=[],h=new Mt,d=new Mt,p=new Mt,f=new Mt,m=new Mt,g=new Mt,v=new Mt,y=0;y<=r;++y){var x=y/r*i*Math.PI*2;for(o(x,i,a,t,p),o(x+.01,i,a,t,f),g.subVectors(f,p),v.addVectors(f,p),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize(),x=0;x<=n;++x){var b=x/n*Math.PI*2,_=-e*Math.cos(b),b=e*Math.sin(b);h.x=p.x+(_*v.x+b*m.x),h.y=p.y+(_*v.y+b*m.y),h.z=p.z+(_*v.z+b*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),u.push(d.x,d.y,d.z),c.push(y/r),c.push(x/n)}}for(x=1;x<=r;x++)for(y=1;y<=n;y++)t=(n+1)*x+(y-1),e=(n+1)*x+y,i=(n+1)*(x-1)+y,s.push((n+1)*(x-1)+(y-1),t,i),s.push(t,e,i);this.setIndex(s),this.setAttribute("position",new R(l,3)),this.setAttribute("normal",new R(u,3)),this.setAttribute("uv",new R(c,2))}function Ar(t,e,r,n,i){U.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new wr(t,e,r,n,i)),this.mergeVertices()}function wr(t,e,r,n,i){F.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},t=t||1,e=e||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;for(var a,o=[],s=[],l=[],u=[],c=new Mt,h=new Mt,d=new Mt,p=0;p<=r;p++)for(a=0;a<=n;a++){var f=a/n*i,m=p/r*Math.PI*2;h.x=(t+e*Math.cos(m))*Math.cos(f),h.y=(t+e*Math.cos(m))*Math.sin(f),h.z=e*Math.sin(m),s.push(h.x,h.y,h.z),c.x=t*Math.cos(f),c.y=t*Math.sin(f),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(a/n),u.push(p/r)}for(p=1;p<=r;p++)for(a=1;a<=n;a++)t=(n+1)*(p-1)+a-1,e=(n+1)*(p-1)+a,i=(n+1)*p+a,o.push((n+1)*p+a-1,t,i),o.push(t,e,i);this.setIndex(o),this.setAttribute("position",new R(s,3)),this.setAttribute("normal",new R(l,3)),this.setAttribute("uv",new R(u,2))}function Mr(t,e,r,n,i){for(var a,o=0,s=e,l=r-n;s<r;s+=n)o+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;if(i===0<o)for(i=e;i<r;i+=n)a=Nr(i,t[i],t[i+1],a);else for(i=r-n;e<=i;i-=n)a=Nr(i,t[i],t[i+1],a);return a&&Rr(a,a.next)&&(zr(a),a=a.next),a}function Cr(t,e){if(!t)return t;e=e||t;do{var r=!1;if(t.steiner||!Rr(t,t.next)&&0!==Lr(t.prev,t,t.next))t=t.next;else{if(zr(t),(t=e=t.prev)===t.next)break;r=!0}}while(r||t!==e);return e}function Tr(t,e,r,n,i,a,o){if(t){if(!o&&a){for(var s=t,l=s;null===l.z&&(l.z=Er(l.x,l.y,n,i,a)),l.prevZ=l.prev,l=l.nextZ=l.next,l!==s;);l.prevZ.nextZ=null,l.prevZ=null;var u,c,s=l,h=1;do{for(var l=s,d=s=null,p=0;l;){p++;for(var f=l,m=u=0;m<h&&(u++,f=f.nextZ);m++);for(c=h;0<u||0<c&&f;)0!==u&&(0===c||!f||l.z<=f.z)?(l=(m=l).nextZ,u--):(f=(m=f).nextZ,c--),d?d.nextZ=m:s=m,m.prevZ=d,d=m;l=f}}while(d.nextZ=null,h*=2,1<p)}for(s=t;t.prev!==t.next;){if(l=t.prev,f=t.next,a)d=function(t,e,r,n){var i=t.prev,a=t.next;if(0<=Lr(i,t,a))return!1;var o=(i.x>t.x?i.x>a.x?i:a:t.x>a.x?t:a).x,s=(i.y>t.y?i.y>a.y?i:a:t.y>a.y?t:a).y,l=Er((i.x<t.x?i.x<a.x?i:a:t.x<a.x?t:a).x,(i.y<t.y?i.y<a.y?i:a:t.y<a.y?t:a).y,e,r,n);for(e=Er(o,s,e,r,n),r=t.prevZ,n=t.nextZ;r&&r.z>=l&&n&&n.z<=e;){if(r!==t.prev&&r!==t.next&&Ir(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=Lr(r.prev,r,r.next))return!1;if(r=r.prevZ,n!==t.prev&&n!==t.next&&Ir(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=Lr(n.prev,n,n.next))return!1;n=n.nextZ}for(;r&&r.z>=l;){if(r!==t.prev&&r!==t.next&&Ir(i.x,i.y,t.x,t.y,a.x,a.y,r.x,r.y)&&0<=Lr(r.prev,r,r.next))return!1;r=r.prevZ}for(;n&&n.z<=e;){if(n!==t.prev&&n!==t.next&&Ir(i.x,i.y,t.x,t.y,a.x,a.y,n.x,n.y)&&0<=Lr(n.prev,n,n.next))return!1;n=n.nextZ}return!0}(t,n,i,a);else t:if(d=t,p=d.prev,u=d,h=d.next,0<=Lr(p,u,h))d=!1;else{for(m=d.next.next;m!==d.prev;){if(Ir(p.x,p.y,u.x,u.y,h.x,h.y,m.x,m.y)&&0<=Lr(m.prev,m,m.next)){d=!1;break t}m=m.next}d=!0}if(d)e.push(l.i/r),e.push(t.i/r),e.push(f.i/r),zr(t),s=t=f.next;else if((t=f)===s){if(o){if(1===o){for(t=Cr(t),o=e,s=r,l=t;f=l.prev,d=l.next.next,!Rr(f,d)&&Pr(f,l,l.next,d)&&Fr(f,d)&&Fr(d,f)&&(o.push(f.i/s),o.push(l.i/s),o.push(d.i/s),zr(l),zr(l.next),l=t=d),l=l.next,l!==t;);Tr(t=Cr(l),e,r,n,i,a,2)}else if(2===o)t:{o=t;do{for(s=o.next.next;s!==o.prev;){if(l=o.i!==s.i){if(f=s,d=(l=o).next.i!==f.i&&l.prev.i!==f.i){e:{d=l;do{if(d.i!==l.i&&d.next.i!==l.i&&d.i!==f.i&&d.next.i!==f.i&&Pr(d,d.next,l,f)){d=!0;break e}}while((d=d.next)!==l);d=!1}d=!d}if(d){if(d=Fr(l,f)&&Fr(f,l)){for(d=l,p=!1,u=(l.x+f.x)/2,h=(l.y+f.y)/2;d.y>h!=d.next.y>h&&d.next.y!==d.y&&u<(d.next.x-d.x)*(h-d.y)/(d.next.y-d.y)+d.x&&(p=!p),d=d.next,d!==l;);d=p}d=d&&(Lr(l.prev,l,f.prev)||Lr(l,f.prev,f))||Rr(l,f)&&0<Lr(l.prev,l,l.next)&&0<Lr(f.prev,f,f.next)}l=d}if(l){t=Br(o,s),o=Cr(o,o.next),t=Cr(t,t.next),Tr(o,e,r,n,i,a),Tr(t,e,r,n,i,a);break t}s=s.next}}while((o=o.next)!==t)}}else Tr(Cr(t),e,r,n,i,a,1);break}}}}function Sr(t,e){return t.x-e.x}function Er(t,e,r,n,i){return 1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1)|(1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ir(t,e,r,n,i,a,o,s){return 0<=(i-o)*(e-s)-(t-o)*(a-s)&&0<=(t-o)*(n-s)-(r-o)*(e-s)&&0<=(r-o)*(a-s)-(i-o)*(n-s)}function Lr(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Rr(t,e){return t.x===e.x&&t.y===e.y}function Pr(t,e,r,n){var i=Or(Lr(t,e,r)),a=Or(Lr(t,e,n)),o=Or(Lr(r,n,t)),s=Or(Lr(r,n,e));return!!(i!==a&&o!==s||0===i&&Dr(t,r,e)||0===a&&Dr(t,n,e)||0===o&&Dr(r,t,n)||0===s&&Dr(r,e,n))}function Dr(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Or(t){return 0<t?1:t<0?-1:0}function Fr(t,e){return Lr(t.prev,t,t.next)<0?0<=Lr(t,e,t.next)&&0<=Lr(t,t.prev,e):Lr(t,e,t.prev)<0||Lr(t,t.next,e)<0}function Br(t,e){var r=new Ur(t.i,t.x,t.y),n=new Ur(e.i,e.x,e.y),i=t.next,a=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(a.next=n).prev=a,n}function Nr(t,e,r,n){return t=new Ur(t,e,r),n?(t.next=n.next,(t.prev=n).next.prev=t,n.next=t):(t.prev=t).next=t,t}function zr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ur(t,e,r){this.i=t,this.x=e,this.y=r,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function kr(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function Hr(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}function Gr(t,e){U.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Vr(t,e)),this.mergeVertices()}function Vr(t,G){F.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:G},t=Array.isArray(t)?t:[t];for(var V=this,W=[],j=[],e=0,r=t.length;e<r;e++)!function(t){function e(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}function r(t,e,r){var n=t.x-e.x,i=t.y-e.y,a=r.x-t.x,o=r.y-t.y,s=n*n+i*i;if(Math.abs(n*o-i*a)>Wu){var l=Math.sqrt(s),u=Math.sqrt(a*a+o*o),s=e.x-i/l;if(e=e.y+n/l,(i=(a=s+n*(o=((r.x-o/u-s)*o-(r.y+a/u-e)*a)/(n*o-i*a))-t.x)*a+(n=e+i*o-t.y)*n)<=2)return new At(a,n);i=Math.sqrt(i/2)}else t=!1,Wu<n?Wu<a&&(t=!0):n<-Wu?a<-Wu&&(t=!0):Gu(i)===Gu(o)&&(t=!0),i=t?(a=-i,Math.sqrt(s)):(a=n,n=i,Math.sqrt(s/2));return new At(a/i,n/i)}function n(t,e){for(O=t.length;0<=--O;){var r=O,n=O-1;n<0&&(n=t.length-1);for(var i=d+2*g,a=0;a<i;a++){var o=P*a,s=e+n+o,l=e+n+(u=P*(a+1)),u=e+r+u;c(e+r+o),c(s),c(u),c(s),c(l),c(u),o=W.length/3,h((o=y.generateSideWallUV(V,W,o-6,o-3,o-2,o-1))[0]),h(o[1]),h(o[3]),h(o[1]),h(o[2]),h(o[3])}}}function i(t,e,r){o.push(t),o.push(e),o.push(r)}function a(t,e,r){c(t),c(e),c(r),t=W.length/3,h((t=y.generateTopUV(V,W,t-3,t-2,t-1))[0]),h(t[1]),h(t[2])}function c(t){W.push(o[3*t]),W.push(o[3*t+1]),W.push(o[3*t+2])}function h(t){j.push(t.x),j.push(t.y)}var o=[],s=void 0!==G.curveSegments?G.curveSegments:12,d=void 0!==G.steps?G.steps:1,l=void 0!==G.depth?G.depth:100,u=void 0===G.bevelEnabled||G.bevelEnabled,p=void 0!==G.bevelThickness?G.bevelThickness:6,f=void 0!==G.bevelSize?G.bevelSize:p-2,m=void 0!==G.bevelOffset?G.bevelOffset:0,g=void 0!==G.bevelSegments?G.bevelSegments:3,v=G.extrudePath,y=void 0!==G.UVGenerator?G.UVGenerator:xl;void 0!==G.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=G.amount);var x,b,_,A,w,M=!1;v&&(x=v.getSpacedPoints(d),u=!(M=!0),b=v.computeFrenetFrames(d,!1),_=new Mt,A=new Mt,w=new Mt),u||(m=f=p=g=0),t=(s=t.extractPoints(s)).shape;var C=s.holes;if(!yl.isClockWise(t)){t=t.reverse();for(var T=0,S=C.length;T<S;T++){var E=C[T];yl.isClockWise(E)&&(C[T]=E.reverse())}}var I=yl.triangulateShape(t,C),L=t,T=0;for(S=C.length;T<S;T++)E=C[T],t=t.concat(E);var R,P=t.length,D=I.length,s=[],O=0,F=(N=L.length)-1;for(U=O+1;O<N;O++,F++,U++)F===N&&(F=0),U===N&&(U=0),s[O]=r(L[O],L[F],L[U]);var v=[],B=s.concat();for(T=0,S=C.length;T<S;T++){for(var N,E=C[T],z=[],O=0,F=(N=E.length)-1,U=O+1;O<N;O++,F++,U++)F===N&&(F=0),U===N&&(U=0),z[O]=r(E[O],E[F],E[U]);v.push(z),B=B.concat(z)}for(F=0;F<g;F++){N=F/g;var k=p*Math.cos(N*Math.PI/2);for(U=f*Math.sin(N*Math.PI/2)+m,O=0,N=L.length;O<N;O++){var H=e(L[O],s[O],U);i(H.x,H.y,-k)}for(T=0,S=C.length;T<S;T++)for(E=C[T],z=v[T],O=0,N=E.length;O<N;O++)i((H=e(E[O],z[O],U)).x,H.y,-k)}for(U=f+m,O=0;O<P;O++)H=u?e(t[O],B[O],U):t[O],M?(A.copy(b.normals[0]).multiplyScalar(H.x),_.copy(b.binormals[0]).multiplyScalar(H.y),w.copy(x[0]).add(A).add(_),i(w.x,w.y,w.z)):i(H.x,H.y,0);for(N=1;N<=d;N++)for(O=0;O<P;O++)H=u?e(t[O],B[O],U):t[O],M?(A.copy(b.normals[N]).multiplyScalar(H.x),_.copy(b.binormals[N]).multiplyScalar(H.y),w.copy(x[N]).add(A).add(_),i(w.x,w.y,w.z)):i(H.x,H.y,l/d*N);for(F=g-1;0<=F;F--){for(N=F/g,k=p*Math.cos(N*Math.PI/2),U=f*Math.sin(N*Math.PI/2)+m,O=0,N=L.length;O<N;O++)i((H=e(L[O],s[O],U)).x,H.y,l+k);for(T=0,S=C.length;T<S;T++)for(E=C[T],z=v[T],O=0,N=E.length;O<N;O++)H=e(E[O],z[O],U),M?i(H.x,H.y+x[d-1].y,x[d-1].x+k):i(H.x,H.y,l+k)}!function(){var t=W.length/3;if(u){var e=0*P;for(O=0;O<D;O++)a((R=I[O])[2]+e,R[1]+e,R[0]+e);for(e=P*(d+2*g),O=0;O<D;O++)a((R=I[O])[0]+e,R[1]+e,R[2]+e)}else{for(O=0;O<D;O++)a((R=I[O])[2],R[1],R[0]);for(O=0;O<D;O++)a((R=I[O])[0]+P*d,R[1]+P*d,R[2]+P*d)}V.addGroup(t,W.length/3-t,0)}(),function(){var t=W.length/3,e=0;for(n(L,e),e+=L.length,T=0,S=C.length;T<S;T++)n(E=C[T],e),e+=E.length;V.addGroup(t,W.length/3-t,1)}()}(t[e]);this.setAttribute("position",new R(W,3)),this.setAttribute("uv",new R(j,2)),this.computeVertexNormals()}function Wr(t,e,r){if(r.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++)r.shapes.push(t[n].uuid);else r.shapes.push(t.uuid);return void 0!==e.extrudePath&&(r.options.extrudePath=e.extrudePath.toJSON()),r}function jr(t,e){U.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Xr(t,e)),this.mergeVertices()}function Xr(t,e){var r=(e=e||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new U;t=r.generateShapes(t,e.size),e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Vr.call(this,t,e),this.type="TextBufferGeometry"}function qr(t,e,r,n,i,a,o){U.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Yr(t,e,r,n,i,a,o)),this.mergeVertices()}function Yr(t,e,r,n,i,a,o){F.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;for(var s,l=Math.min(a+o,Math.PI),u=0,c=[],h=new Mt,d=new Mt,p=[],f=[],m=[],g=[],v=0;v<=r;v++){var y=[],x=v/r,b=0;for(0==v&&0==a?b=.5/e:v==r&&l==Math.PI&&(b=-.5/e),s=0;s<=e;s++){var _=s/e;h.x=-t*Math.cos(n+_*i)*Math.sin(a+x*o),h.y=t*Math.cos(a+x*o),h.z=t*Math.sin(n+_*i)*Math.sin(a+x*o),f.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(_+b,1-x),y.push(u++)}c.push(y)}for(v=0;v<r;v++)for(s=0;s<e;s++)t=c[v][s+1],n=c[v][s],i=c[v+1][s],o=c[v+1][s+1],(0!==v||0<a)&&p.push(t,n,o),(v!==r-1||l<Math.PI)&&p.push(n,i,o);this.setIndex(p),this.setAttribute("position",new R(f,3)),this.setAttribute("normal",new R(m,3)),this.setAttribute("uv",new R(g,2))}function Zr(t,e,r,n,i,a){U.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Jr(t,e,r,n,i,a)),this.mergeVertices()}function Jr(t,e,r,n,i,a){F.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},t=t||.5,e=e||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8;for(var o,s=[],l=[],u=[],c=[],h=t,d=(e-t)/(n=void 0!==n?Math.max(1,n):1),p=new Mt,f=new At,m=0;m<=n;m++){for(o=0;o<=r;o++)t=i+o/r*a,p.x=h*Math.cos(t),p.y=h*Math.sin(t),l.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,c.push(f.x,f.y);h+=d}for(m=0;m<n;m++)for(e=m*(r+1),o=0;o<r;o++)i=(t=o+e)+r+1,a=t+r+2,h=t+1,s.push(t,i,h),s.push(i,a,h);this.setIndex(s),this.setAttribute("position",new R(l,3)),this.setAttribute("normal",new R(u,3)),this.setAttribute("uv",new R(c,2))}function Kr(t,e,r,n){U.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},this.fromBufferGeometry(new Qr(t,e,r,n)),this.mergeVertices()}function Qr(t,e,r,n){F.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},e=Math.floor(e)||12,r=r||0,n=n||2*Math.PI,n=Sa.clamp(n,0,2*Math.PI);for(var i=[],a=[],o=[],s=1/e,l=new Mt,u=new At,c=0;c<=e;c++)for(var h=r+c*s*n,d=Math.sin(h),p=Math.cos(h),h=0;h<=t.length-1;h++)l.x=t[h].x*d,l.y=t[h].y,l.z=t[h].x*p,a.push(l.x,l.y,l.z),u.x=c/e,u.y=h/(t.length-1),o.push(u.x,u.y);for(c=0;c<e;c++)for(h=0;h<t.length-1;h++)s=(r=h+c*t.length)+t.length,l=r+t.length+1,u=r+1,i.push(r,s,u),i.push(s,l,u);if(this.setIndex(i),this.setAttribute("position",new R(a,3)),this.setAttribute("uv",new R(o,2)),this.computeVertexNormals(),n===2*Math.PI)for(n=this.attributes.normal.array,i=new Mt,a=new Mt,o=new Mt,r=e*t.length*3,h=c=0;c<t.length;c++,h+=3)i.x=n[h+0],i.y=n[h+1],i.z=n[h+2],a.x=n[r+h+0],a.y=n[r+h+1],a.z=n[r+h+2],o.addVectors(i,a).normalize(),n[h+0]=n[r+h+0]=o.x,n[h+1]=n[r+h+1]=o.y,n[h+2]=n[r+h+2]=o.z}function $r(t,e){U.call(this),this.type="ShapeGeometry","object"===(void 0===e?"undefined":Ou(e))&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new tn(t,e)),this.mergeVertices()}function tn(t,s){function e(t){var e,r=u.length/3,n=(t=t.extractPoints(s)).shape,i=t.holes;for(!1===yl.isClockWise(n)&&(n=n.reverse()),t=0,e=i.length;t<e;t++){var a=i[t];!0===yl.isClockWise(a)&&(i[t]=a.reverse())}var o=yl.triangulateShape(n,i);for(t=0,e=i.length;t<e;t++)a=i[t],n=n.concat(a);for(t=0,e=n.length;t<e;t++)a=n[t],u.push(a.x,a.y,0),c.push(0,0,1),h.push(a.x,a.y);for(t=0,e=o.length;t<e;t++)n=o[t],l.push(n[0]+r,n[1]+r,n[2]+r),d+=3}F.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:s},s=s||12;var l=[],u=[],c=[],h=[],r=0,d=0;if(!1===Array.isArray(t))e(t);else for(var n=0;n<t.length;n++)e(t[n]),this.addGroup(r,d,n),r+=d,d=0;this.setIndex(l),this.setAttribute("position",new R(u,3)),this.setAttribute("normal",new R(c,3)),this.setAttribute("uv",new R(h,2))}function en(t,e){if(e.shapes=[],Array.isArray(t))for(var r=0,n=t.length;r<n;r++)e.shapes.push(t[r].uuid);else e.shapes.push(t.uuid);return e}function rn(t,e){F.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var r=[];e=Math.cos(Sa.DEG2RAD*(void 0!==e?e:1));var n=[0,0],i={},a=["a","b","c"];t.isBufferGeometry?(o=new U).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals(),t=o.vertices;for(var o,s=0,l=(o=o.faces).length;s<l;s++)for(var u=o[s],c=0;c<3;c++){var h=u[a[c]],d=u[a[(c+1)%3]];n[0]=Math.min(h,d),n[1]=Math.max(h,d),void 0===i[h=n[0]+","+n[1]]?i[h]={index1:n[0],index2:n[1],face1:s,face2:void 0}:i[h].face2=s}for(h in i)(void 0===(n=i[h]).face2||o[n.face1].normal.dot(o[n.face2].normal)<=e)&&(a=t[n.index1],r.push(a.x,a.y,a.z),a=t[n.index2],r.push(a.x,a.y,a.z));this.setAttribute("position",new R(r,3))}function nn(t,e,r,n,i,a,o,s){U.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new an(t,e,r,n,i,a,o,s)),this.mergeVertices()}function an(d,p,f,m,g,t,v,y){function e(t){for(var e=new At,r=new Mt,n=0,i=!0===t?d:p,a=!0===t?1:-1,o=M,s=1;s<=m;s++)_.push(0,T*a,0),A.push(0,a,0),w.push(.5,.5),M++;var l=M;for(s=0;s<=m;s++){var u=s/m*y+v,c=Math.cos(u),u=Math.sin(u);r.x=i*u,r.y=T*a,r.z=i*c,_.push(r.x,r.y,r.z),A.push(0,a,0),e.x=.5*c+.5,e.y=.5*u*a+.5,w.push(e.x,e.y),M++}for(s=0;s<m;s++)e=o+s,r=l+s,!0===t?b.push(r,r+1,e):b.push(r+1,r,e),n+=3;x.addGroup(S,n,!0===t?1:2),S+=n}F.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:d,radiusBottom:p,height:f,radialSegments:m,heightSegments:g,openEnded:t,thetaStart:v,thetaLength:y};var x=this;d=void 0!==d?d:1,p=void 0!==p?p:1,f=f||1,m=Math.floor(m)||8,g=Math.floor(g)||1,t=void 0!==t&&t,v=void 0!==v?v:0,y=void 0!==y?y:2*Math.PI;var b=[],_=[],A=[],w=[],M=0,C=[],T=f/2,S=0;!function(){for(var t=new Mt,e=new Mt,r=0,n=(p-d)/f,i=0;i<=g;i++){for(var a=[],o=i/g,s=o*(p-d)+d,l=0;l<=m;l++){var u=l/m,c=u*y+v,h=Math.sin(c),c=Math.cos(c);e.x=s*h,e.y=-o*f+T,e.z=s*c,_.push(e.x,e.y,e.z),t.set(h,n,c).normalize(),A.push(t.x,t.y,t.z),w.push(u,1-o),a.push(M++)}C.push(a)}for(l=0;l<m;l++)for(i=0;i<g;i++)t=C[i+1][l],e=C[i+1][l+1],n=C[i][l+1],b.push(C[i][l],t,n),b.push(t,e,n),r+=6;x.addGroup(S,r,0),S+=r}(),!1===t&&(0<d&&e(!0),0<p&&e(!1)),this.setIndex(b),this.setAttribute("position",new R(_,3)),this.setAttribute("normal",new R(A,3)),this.setAttribute("uv",new R(w,2))}function on(t,e,r,n,i,a,o){nn.call(this,0,t,e,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function sn(t,e,r,n,i,a,o){an.call(this,0,t,e,r,n,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function ln(t,e,r,n){U.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new un(t,e,r,n)),this.mergeVertices()}function un(t,e,r,n){F.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i=[],a=[],o=[],s=[],l=new Mt,u=new At;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(var c=0,h=3;c<=e;c++,h+=3){var d=r+c/e*n;l.x=t*Math.cos(d),l.y=t*Math.sin(d),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[h]/t+1)/2,u.y=(a[h+1]/t+1)/2,s.push(u.x,u.y)}for(h=1;h<=e;h++)i.push(h,h+1,0);this.setIndex(i),this.setAttribute("position",new R(a,3)),this.setAttribute("normal",new R(o,3)),this.setAttribute("uv",new R(s,2))}function cn(t){x.call(this),this.type="ShadowMaterial",this.color=new m(0),this.transparent=!0,this.setValues(t)}function hn(t){G.call(this,t),this.type="RawShaderMaterial"}function dn(t){x.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new m(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function pn(t){dn.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new At(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function fn(t){x.call(this),this.type="MeshPhongMaterial",this.color=new m(16777215),this.specular=new m(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function mn(t){x.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new m(16777215),this.specular=new m(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function gn(t){x.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function vn(t){x.call(this),this.type="MeshLambertMaterial",this.color=new m(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function yn(t){x.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new m(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function xn(t){Ye.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function bn(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function _n(t,e,r,n){bn.call(this,t,e,r,n),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function An(t,e,r,n){bn.call(this,t,e,r,n)}function wn(t,e,r,n){bn.call(this,t,e,r,n)}function Mn(t,e,r,n){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Al.convertArray(e,this.TimeBufferType),this.values=Al.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function Cn(t,e,r){Mn.call(this,t,e,r)}function Tn(t,e,r,n){Mn.call(this,t,e,r,n)}function Sn(t,e,r,n){Mn.call(this,t,e,r,n)}function En(t,e,r,n){bn.call(this,t,e,r,n)}function In(t,e,r,n){Mn.call(this,t,e,r,n)}function Ln(t,e,r,n){Mn.call(this,t,e,r,n)}function Rn(t,e,r,n){Mn.call(this,t,e,r,n)}function Pn(t,e,r,n){this.name=t,this.tracks=r,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==n?n:2500,this.uuid=Sa.generateUUID(),this.duration<0&&this.resetDuration()}function Dn(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e,r,n=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sn;case"vector":case"vector2":case"vector3":case"vector4":return Rn;case"color":return Tn;case"quaternion":return In;case"bool":case"boolean":return Cn;case"string":return Ln}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);return void 0===t.times&&(e=[],r=[],Al.flattenJSON(t.keys,e,r,"value"),t.times=e,t.values=r),void 0!==n.parse?n.parse(t):new n(t.name,t.times,t.values,t.interpolation)}function On(t,e,r){var n=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){o++,!1===i&&void 0!==n.onStart&&n.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(i=!1,void 0!==n.onLoad)&&n.onLoad()},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){return-1!==(t=l.indexOf(t))&&l.splice(t,2),this},this.getHandler=function(t){for(var e=0,r=l.length;e<r;e+=2){var n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}function Fn(t){this.manager=void 0!==t?t:Ml,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function Bn(t){Fn.call(this,t)}function Nn(t){Fn.call(this,t)}function zn(t){Fn.call(this,t)}function Un(t){Fn.call(this,t)}function kn(t){Fn.call(this,t)}function Hn(t){Fn.call(this,t)}function Gn(t){Fn.call(this,t)}function Vn(){this.type="Curve",this.arcLengthDivisions=200}function Wn(t,e,r,n,i,a,o,s){Vn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function jn(t,e,r,n,i,a){Wn.call(this,t,e,r,r,n,i,a),this.type="ArcCurve"}function Xn(){var s=0,l=0,u=0,c=0;return{initCatmullRom:function(t,e,r,n,i){u=-3*(s=e)+3*r-2*(l=t=i*(r-t))-(n=i*(n-e)),c=2*e-2*r+t+n},initNonuniformCatmullRom:function(t,e,r,n,i,a,o){u=-3*(s=e)+3*r-2*(l=t=((e-t)/i-(r-t)/(i+a)+(r-e)/a)*a)-(n=((r-e)/a-(n-e)/(a+o)+(n-r)/o)*a),c=2*e-2*r+t+n},calc:function(t){var e=t*t;return s+l*t+u*e+c*e*t}}}function qn(t,e,r,n){Vn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Yn(t,e,r,n,i){var a=t*t;return(2*r-2*n+(e=.5*(n-e))+(i=.5*(i-r)))*t*a+(-3*r+3*n-2*e-i)*a+e*t+r}function Zn(t,e,r,n){var i=1-t;return i*i*e+2*(1-t)*t*r+t*t*n}function Jn(t,e,r,n,i){var a=1-t,o=1-t;return a*a*a*e+3*o*o*t*r+3*(1-t)*t*t*n+t*t*t*i}function Kn(t,e,r,n){Vn.call(this),this.type="CubicBezierCurve",this.v0=t||new At,this.v1=e||new At,this.v2=r||new At,this.v3=n||new At}function Qn(t,e,r,n){Vn.call(this),this.type="CubicBezierCurve3",this.v0=t||new Mt,this.v1=e||new Mt,this.v2=r||new Mt,this.v3=n||new Mt}function $n(t,e){Vn.call(this),this.type="LineCurve",this.v1=t||new At,this.v2=e||new At}function ti(t,e){Vn.call(this),this.type="LineCurve3",this.v1=t||new Mt,this.v2=e||new Mt}function ei(t,e,r){Vn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new At,this.v1=e||new At,this.v2=r||new At}function ri(t,e,r){Vn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Mt,this.v1=e||new Mt,this.v2=r||new Mt}function ni(t){Vn.call(this),this.type="SplineCurve",this.points=t||[]}function ii(){Vn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ai(t){ii.call(this),this.type="Path",this.currentPoint=new At,t&&this.setFromPoints(t)}function oi(t){ai.call(this,t),this.uuid=Sa.generateUUID(),this.type="Shape",this.holes=[]}function si(t,e){p.call(this),this.type="Light",this.color=new m(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function li(t,e,r){si.call(this,t,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(p.DefaultUp),this.updateMatrix(),this.groundColor=new m(e)}function ui(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new At(512,512),this.mapPass=this.map=null,this.matrix=new Ct,this._frustum=new Et,this._frameExtents=new At(1,1),this._viewportCount=1,this._viewports=[new wt(0,0,1,1)]}function ci(){ui.call(this,new W(50,1,.5,500))}function hi(t,e,r,n,i,a){si.call(this,t,e),this.type="SpotLight",this.position.copy(p.DefaultUp),this.updateMatrix(),this.target=new p,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new ci}function di(){ui.call(this,new W(90,1,.5,500)),this._frameExtents=new At(4,2),this._viewportCount=6,this._viewports=[new wt(2,1,1,1),new wt(0,1,1,1),new wt(3,1,1,1),new wt(1,1,1,1),new wt(3,0,1,1),new wt(1,0,1,1)],this._cubeDirections=[new Mt(1,0,0),new Mt(-1,0,0),new Mt(0,0,1),new Mt(0,0,-1),new Mt(0,1,0),new Mt(0,-1,0)],this._cubeUps=[new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,0,1),new Mt(0,0,-1)]}function pi(t,e,r,n){si.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new di}function fi(t,e,r,n,i,a){V.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==r?r:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function mi(){ui.call(this,new fi(-5,5,5,-5,.5,500))}function gi(t,e){si.call(this,t,e),this.type="DirectionalLight",this.position.copy(p.DefaultUp),this.updateMatrix(),this.target=new p,this.shadow=new mi}function vi(t,e){si.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function yi(t,e,r,n){si.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function xi(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Mt)}function bi(t,e){si.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new xi}function _i(t){Fn.call(this,t),this.textures={}}function Ai(){F.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function wi(t,e,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),S.call(this,t,e,r),this.meshPerAttribute=n||1}function Mi(t){Fn.call(this,t)}function Ci(t){Fn.call(this,t)}function Ti(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Fn.call(this,t),this.options=void 0}function Si(){this.type="ShapePath",this.color=new m,this.subPaths=[],this.currentPath=null}function Ei(t){this.type="Font",this.data=t}function Ii(t){Fn.call(this,t)}function Li(t){Fn.call(this,t)}function Ri(t,e,r){bi.call(this,void 0,r),t=(new m).set(t),r=(new m).set(e),e=new Mt(t.r,t.g,t.b),t=new Mt(r.r,r.g,r.b);var n=(r=Math.sqrt(Math.PI))*Math.sqrt(.75);this.sh.coefficients[0].copy(e).add(t).multiplyScalar(r),this.sh.coefficients[1].copy(e).sub(t).multiplyScalar(n)}function Pi(t,e){bi.call(this,void 0,e),t=(new m).set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Di(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new W,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new W,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Oi(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Fi(){p.call(this),this.type="AudioListener",this.context=Nl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Oi}function Bi(t){p.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function Ni(t){Bi.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function zi(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Ui(t,e,r){switch(this.binding=t,this.valueSize=r,e){case"quaternion":t=this._slerp,e=this._slerpAdditive;var n=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":e=t=this._select,n=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:t=this._lerp,e=this._lerpAdditive,n=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=e,this._setIdentity=n,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function ki(t,e,r){r=r||Hi.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Hi(t,e,r){this.path=e,this.parsedPath=r||Hi.parseTrackName(e),this.node=Hi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Gi(){this.uuid=Sa.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,r=arguments.length;e!==r;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Vi(t,e,r,n){this._mixer=t,this._clip=e,this._localRoot=r||null,this.blendMode=n||e.blendMode,e=(t=e.tracks).length,r=Array(e),n={endingStart:2400,endingEnd:2400};for(var i=0;i!==e;++i){var a=t[i].createInterpolant(null);(r[i]=a).settings=n}this._interpolantSettings=n,this._interpolants=r,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Wi(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function ji(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function Xi(t,e,r){ze.call(this,t,e),this.meshPerAttribute=r||1}function qi(t,e,r,n){this.ray=new s(t,e),this.near=r||0,this.far=n||1/0,this.camera=null,this.layers=new a,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},ku(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Yi(t,e){return t.distance-e.distance}function Zi(t,e,r,n){if(t.layers.test(e.layers)&&t.raycast(e,r),!0===n){n=0;for(var i=(t=t.children).length;n<i;n++)Zi(t[n],e,r,!0)}}function Ji(t,e,r){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==r?r:0,this}function Ki(t,e,r){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==r?r:0,this}function Qi(t,e){this.min=void 0!==t?t:new At(1/0,1/0),this.max=void 0!==e?e:new At(-1/0,-1/0)}function $i(t,e){this.start=void 0!==t?t:new Mt,this.end=void 0!==e?e:new Mt}function ta(t){p.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function ea(t,e){p.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new F,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var r=0,n=1;r<32;r++,n++){var i=r/32*Math.PI*2,a=n/32*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(a),Math.sin(a),1)}t.setAttribute("position",new R(e,3)),e=new Ye({fog:!1,toneMapped:!1}),this.cone=new Je(t,e),this.add(this.cone),this.update()}function ra(t){for(var e=function t(e){var r=[];e&&e.isBone&&r.push(e);for(var n=0;n<e.children.length;n++)r.push.apply(r,t(e.children[n]));return r}(t),r=new F,n=[],i=[],a=new m(0,0,1),o=new m(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}r.setAttribute("position",new R(n,3)),r.setAttribute("color",new R(i,3)),n=new Ye({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),Je.call(this,r,n),this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function na(t,e,r){this.light=t,this.light.updateMatrixWorld(),this.color=r,t=new Yr(e,4,2),e=new _({wireframe:!0,fog:!1,toneMapped:!1}),B.call(this,t,e),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function ia(t,e,r){p.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,(t=new pr(e)).rotateY(.5*Math.PI),this.material=new _({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.setAttribute("color",new S(e,3)),this.add(new B(t,this.material)),this.update()}function aa(t,e,r,n){t=t||10,e=e||10,r=new m(void 0!==r?r:4473924),n=new m(void 0!==n?n:8947848);var i=e/2,a=t/e,o=t/2;t=[];for(var s=[],l=0,u=0,c=-o;l<=e;l++,c+=a){t.push(-o,0,c,o,0,c),t.push(c,0,-o,c,0,o);var h=l===i?r:n;h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3}(e=new F).setAttribute("position",new R(t,3)),e.setAttribute("color",new R(s,3)),r=new Ye({vertexColors:!0,toneMapped:!1}),Je.call(this,e,r),this.type="GridHelper"}function oa(t,e,r,n,i,a){t=t||10,e=e||16,r=r||8,n=n||64,i=new m(void 0!==i?i:4473924),a=new m(void 0!==a?a:8947848);for(var o=[],s=[],l=0;l<=e;l++){var u=l/e*2*Math.PI,c=Math.sin(u)*t,u=Math.cos(u)*t;o.push(0,0,0),o.push(c,0,u);var h=1&l?i:a;s.push(h.r,h.g,h.b),s.push(h.r,h.g,h.b)}for(l=0;l<=r;l++){var h=1&l?i:a,d=t-t/r*l;for(e=0;e<n;e++)u=e/n*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,o.push(c,0,u),s.push(h.r,h.g,h.b),u=(e+1)/n*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,o.push(c,0,u),s.push(h.r,h.g,h.b)}(t=new F).setAttribute("position",new R(o,3)),t.setAttribute("color",new R(s,3)),o=new Ye({vertexColors:!0,toneMapped:!1}),Je.call(this,t,o),this.type="PolarGridHelper"}function sa(t,e,r){p.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===e&&(e=1),(t=new F).setAttribute("position",new R([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new Ye({fog:!1,toneMapped:!1}),this.lightPlane=new Ze(t,e),this.add(this.lightPlane),(t=new F).setAttribute("position",new R([0,0,0,0,0,1],3)),this.targetLine=new Ze(t,e),this.add(this.targetLine),this.update()}function la(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){a.push(0,0,0),o.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(a.length/3-1)}var r=new F,i=new Ye({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],s={},l=new m(16755200),u=new m(16711680),c=new m(43775),h=new m(16777215),d=new m(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",h),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),r.setAttribute("position",new R(a,3)),r.setAttribute("color",new R(o,3)),Je.call(this,r,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function ua(t,e,r,n,i,a,o){if(fu.set(i,a,o).unproject(n),void 0!==(t=e[t]))for(r=r.getAttribute("position"),e=0,n=t.length;e<n;e++)r.setXYZ(t[e],fu.x,fu.y,fu.z)}function ca(t,e){this.object=t,void 0===e&&(e=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new Float32Array(24),n=new F;n.setIndex(new S(t,1)),n.setAttribute("position",new S(r,3)),Je.call(this,n,new Ye({color:e,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function ha(t,e){this.type="Box3Helper",this.box=t,e=e||16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new F;r.setIndex(new S(t,1)),r.setAttribute("position",new R([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Je.call(this,r,new Ye({color:e,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function da(t,e,r){this.plane=t,this.size=void 0===e?1:e,t=void 0!==r?r:16776960,(e=new F).setAttribute("position",new R([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),Ze.call(this,e,new Ye({color:t,toneMapped:!1})),this.type="PlaneHelper",(e=new F).setAttribute("position",new R([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new B(e,new _({color:t,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function pa(t,e,r,n,i,a){p.call(this),this.type="ArrowHelper",void 0===t&&(t=new Mt(0,0,1)),void 0===e&&(e=new Mt(0,0,0)),void 0===r&&(r=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*r),void 0===a&&(a=.2*i),void 0===vu&&((vu=new F).setAttribute("position",new R([0,0,0,0,1,0],3)),(yu=new an(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Ze(vu,new Ye({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new B(yu,new _({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(r,i,a)}function fa(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new F).setAttribute("position",new R(e,3)),t.setAttribute("color",new R([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new Ye({vertexColors:!0,toneMapped:!1}),Je.call(this,t,e),this.type="AxesHelper"}function ma(t){this._renderer=t,(t=new hn({defines:{n:20},uniforms:{envMap:{value:this._pingPongRenderTarget=null},samples:{value:1},weights:{value:t=new Float32Array(20)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new Mt(0,1,0)},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:ba(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n"+_a()+"\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",this._blurMaterial=t,this._cubemapShader=this._equirectShader=null,this._compileMaterial(this._blurMaterial)}function ga(t){return(t=new T(3*bu,3*bu,t)).texture.mapping=306,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function va(t,e,r,n,i){t.viewport.set(e,r,n,i),t.scissor.set(e,r,n,i)}function ya(){var t=new At(1,1);return(t=new hn({uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:ba(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n"+_a()+"\n\n#include <common>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv = equirectUv( outputDirection );\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})).type="EquirectangularToCubeUV",t}function xa(){var t=new hn({uniforms:{envMap:{value:null},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:ba(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n"+_a()+"\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function ba(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function _a(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function Aa(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),qn.call(this,t),this.type="catmullrom",this.closed=!0}function wa(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),qn.call(this,t),this.type="catmullrom"}function Ma(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),qn.call(this,t),this.type="catmullrom"}void 0===Wu&&(Number.EPSILON=Math.pow(2,-52)),void 0===Vu&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Gu&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Hu&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),Hu(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&(void 0!==(t=this._listeners[t])&&(-1!==(e=t.indexOf(e))&&t.splice(e,1)))},dispatchEvent:function(t){if(void 0!==this._listeners&&void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,r=0,n=(e=e.slice(0)).length;r<n;r++)e[r].call(this,t)}}});for(var Ca=[],Ta=0;Ta<256;Ta++)Ca[Ta]=(Ta<16?"0":"")+Ta.toString(16);var Sa={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ca[255&t]+Ca[t>>8&255]+Ca[t>>16&255]+Ca[t>>24&255]+"-"+Ca[255&e]+Ca[e>>8&255]+"-"+Ca[e>>16&15|64]+Ca[e>>24&255]+"-"+Ca[63&r|128]+Ca[r>>8&255]+"-"+Ca[r>>16&255]+Ca[r>>24&255]+Ca[255&n]+Ca[n>>8&255]+Ca[n>>16&255]+Ca[n>>24&255]).toUpperCase()},clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},smoothstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Sa.DEG2RAD},radToDeg:function(t){return t*Sa.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,r,n,i){var a=Math.cos,o=Math.sin,s=a(r/2);r=o(r/2);var l=a((e+n)/2),u=o((e+n)/2),c=a((e-n)/2),h=o((e-n)/2),a=a((n-e)/2);switch(e=o((n-e)/2),i){case"XYX":t.set(s*u,r*c,r*h,s*l);break;case"YZY":t.set(r*h,s*u,r*c,s*l);break;case"ZXZ":t.set(r*c,r*h,s*u,s*l);break;case"XZX":t.set(s*u,r*e,r*a,s*l);break;case"YXY":t.set(r*a,s*u,r*e,s*l);break;case"ZYZ":t.set(r*e,r*a,s*u,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};ku(At.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Hu(At.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,r=this.y;return t=t.elements,this.x=t[0]*e+t[3]*r+t[6],this.y=t[1]*e+t[4]*r+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var r=Math.cos(e);e=Math.sin(e);var n=this.x-t.x,i=this.y-t.y;return this.x=n*r-i*e+t.x,this.y=n*e+i*r+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Hu(g.prototype,{isMatrix3:!0,set:function(t,e,r,n,i,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=n,u[2]=o,u[3]=e,u[4]=i,u[5]=s,u[6]=r,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},extractBasis:function(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements;e=this.elements,t=r[0];var i=r[3],a=r[6],o=r[1],s=r[4],l=r[7],u=r[2],c=r[5],r=r[8],h=n[0],d=n[3],p=n[6],f=n[1],m=n[4],g=n[7],v=n[2],y=n[5],n=n[8];return e[0]=t*h+i*f+a*v,e[3]=t*d+i*m+a*y,e[6]=t*p+i*g+a*n,e[1]=o*h+s*f+l*v,e[4]=o*d+s*m+l*y,e[7]=o*p+s*g+l*n,e[2]=u*h+c*f+r*v,e[5]=u*d+c*m+r*y,e[8]=u*p+c*g+r*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7];return e*a*(t=t[8])-e*o*l-r*i*t+r*o*s+n*i*l-n*a*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var r=t.elements;t=this.elements,e=r[0];var n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],c=(r=r[8])*o-s*u,h=s*l-r*a,d=u*a-o*l,p=e*c+n*h+i*d;return 0==p?this.set(0,0,0,0,0,0,0,0,0):(p=1/p,t[0]=c*p,t[1]=(i*u-r*n)*p,t[2]=(s*n-i*o)*p,t[3]=h*p,t[4]=(r*e-i*l)*p,t[5]=(i*a-s*e)*p,t[6]=d*p,t[7]=(n*l-u*e)*p,t[8]=(o*e-n*a)*p,this)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,r,n,i,a,o){var s=Math.cos(i);i=Math.sin(i),this.set(r*s,r*i,-r*(s*a+i*o)+a+t,-n*i,n*s,-n*(-i*a+s*o)+o+e,0,0,1)},scale:function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var r=this.elements,n=r[0],i=r[3],a=r[6],o=r[1],s=r[4],l=r[7];return r[0]=e*n+t*o,r[3]=e*i+t*s,r[6]=e*a+t*l,r[1]=-t*n+e*o,r[4]=-t*i+e*s,r[7]=-t*a+e*l,this},translate:function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var r=0;r<9;r++)if(e[r]!==t[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}});var Ea,Ia={getDataURL:function(t){return"undefined"==typeof HTMLCanvasElement?t.src:(t instanceof HTMLCanvasElement||((Ea=void 0===Ea?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):Ea).width=t.width,Ea.height=t.height,e=Ea.getContext("2d"),t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),t=Ea),2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png"));var e}},La=0;d.DEFAULT_IMAGE=void 0,d.DEFAULT_MAPPING=300,d.prototype=Hu(Uu(e.prototype),{constructor:d,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=Sa.generateUUID()),!e&&void 0===t.images[n.uuid]){if(Array.isArray(n))for(var i=[],a=0,o=n.length;a<o;a++)i.push(Ia.getDataURL(n[a]));else i=Ia.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return e||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(d.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),ku(wt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Hu(wt.prototype,{isVector4:!0,set:function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=this.w;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*n+t[12]*i,this.y=t[1]*e+t[5]*r+t[9]*n+t[13]*i,this.z=t[2]*e+t[6]*r+t[10]*n+t[14]*i,this.w=t[3]*e+t[7]*r+t[11]*n+t[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],r=t[4],n=t[8],i=t[1],a=t[5],o=t[9],s=t[2],l=t[6],u=t[10];return Math.abs(r-i)<.01&&Math.abs(n-s)<.01&&Math.abs(o-l)<.01?Math.abs(r+i)<.1&&Math.abs(n+s)<.1&&Math.abs(o+l)<.1&&Math.abs(e+a+u-3)<.1?this.set(1,0,0,0):(t=Math.PI,u=(u+1)/2,r=(r+i)/4,n=(n+s)/4,o=(o+l)/4,(a=(a+1)/2)<(e=(e+1)/2)&&u<e?r=e<.01?(l=0,s=.707106781):(s=r/(l=Math.sqrt(e)),n/l):u<a?r=a<.01?(s=0,l=.707106781):(l=r/(s=Math.sqrt(a)),o/s):u<.01?(s=l=.707106781,r=0):(l=n/(r=Math.sqrt(u)),s=o/r),this.set(l,s,r,t)):(t=Math.sqrt((l-o)*(l-o)+(n-s)*(n-s)+(i-r)*(i-r)),Math.abs(t)<.001&&(t=1),this.x=(l-o)/t,this.y=(n-s)/t,this.z=(i-r)/t,this.w=Math.acos((e+a+u-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),T.prototype=Hu(Uu(e.prototype),{constructor:T,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),r.prototype=Hu(Uu(T.prototype),{constructor:r,isWebGLMultisampleRenderTarget:!0,copy:function(t){return T.prototype.copy.call(this,t),this.samples=t.samples,this}}),Hu(f,{slerp:function(t,e,r,n){return r.copy(t).slerp(e,n)},slerpFlat:function(t,e,r,n,i,a,o){var s=r[n+0],l=r[n+1],u=r[n+2];r=r[n+3],n=i[a+0];var c,h,d,p=i[a+1],f=i[a+2];r===(i=i[a+3])&&s===n&&l===p&&u===f||(a=1-o,h=0<=(c=s*n+l*p+u*f+r*i)?1:-1,Wu<(d=1-c*c)&&(d=Math.sqrt(d),c=Math.atan2(d,c*h),a=Math.sin(a*c)/d,o=Math.sin(o*c)/d),s=s*a+n*(h*=o),l=l*a+p*h,u=u*a+f*h,r=r*a+i*h,a===1-o&&(s*=o=1/Math.sqrt(s*s+l*l+u*u+r*r),l*=o,u*=o,r*=o)),t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=r},multiplyQuaternionsFlat:function(t,e,r,n,i,a){var o=r[n],s=r[n+1],l=r[n+2];r=r[n+3],n=i[a];var u=i[a+1],c=i[a+2];return i=i[a+3],t[e]=o*i+r*n+s*c-l*u,t[e+1]=s*i+r*u+l*n-o*c,t[e+2]=l*i+r*c+o*u-s*n,t[e+3]=r*i-o*n-s*u-l*c,t}}),ku(f.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Hu(f.prototype,{isQuaternion:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,n=t._y,i=t._z;t=t.order;var a=Math.cos,o=Math.sin,s=a(r/2),l=a(n/2),a=a(i/2),r=o(r/2),n=o(n/2),i=o(i/2);switch(t){case"XYZ":this._x=r*l*a+s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a-r*n*i;break;case"YXZ":this._x=r*l*a+s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a+r*n*i;break;case"ZXY":this._x=r*l*a-s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a-r*n*i;break;case"ZYX":this._x=r*l*a-s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a+r*n*i;break;case"YZX":this._x=r*l*a+s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a-r*n*i;break;case"XZY":this._x=r*l*a-s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a+r*n*i;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){e/=2;var r=Math.sin(e);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(e),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,r=e[0];t=e[4];var n=e[8],i=e[1],a=e[5],o=e[9],s=e[2],l=e[6],u=r+a+(e=e[10]);return 0<u?(r=.5/Math.sqrt(u+1),this._w=.25/r,this._x=(l-o)*r,this._y=(n-s)*r,this._z=(i-t)*r):a<r&&e<r?(r=2*Math.sqrt(1+r-a-e),this._w=(l-o)/r,this._x=.25*r,this._y=(t+i)/r,this._z=(n+s)/r):e<a?(r=2*Math.sqrt(1+a-r-e),this._w=(n-s)/r,this._x=(t+i)/r,this._y=.25*r,this._z=(o+l)/r):(r=2*Math.sqrt(1+e-r-a),this._w=(i-t)/r,this._x=(n+s)/r,this._y=(o+l)/r,this._z=.25*r),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=r,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Sa.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var r=this.angleTo(t);return 0===r||this.slerp(t,Math.min(1,e/r)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var r=t._x,n=t._y,i=t._z;t=t._w;var a=e._x,o=e._y,s=e._z;return e=e._w,this._x=r*e+t*a+n*s-i*o,this._y=n*e+t*o+i*a-r*s,this._z=i*e+t*s+r*o-n*a,this._w=t*e-r*a-n*o-i*s,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,a=this._w;if((s=a*t._w+r*t._x+n*t._y+i*t._z)<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=a,this._x=r,this._y=n,this._z=i,this;if((t=1-s*s)<=Wu)return s=1-e,this._w=s*a+e*this._w,this._x=s*r+e*this._x,this._y=s*n+e*this._y,this._z=s*i+e*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var o=Math.atan2(t,s),s=Math.sin((1-e)*o)/t;return e=Math.sin(e*o)/t,this._w=a*s+this._w*e,this._x=r*s+this._x*e,this._y=n*s+this._y*e,this._z=i*s+this._z*e,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Ra=new Mt,Pa=new f;Hu(Mt.prototype,{isVector3:!0,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Pa.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Pa.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,r=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*r+t[6]*n,this.y=t[1]*e+t[4]*r+t[7]*n,this.z=t[2]*e+t[5]*r+t[8]*n,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=1/((t=t.elements)[3]*e+t[7]*r+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*r+t[8]*n+t[12])*i,this.y=(t[1]*e+t[5]*r+t[9]*n+t[13])*i,this.z=(t[2]*e+t[6]*r+t[10]*n+t[14])*i,this},applyQuaternion:function(t){var e=this.x,r=this.y,n=this.z,i=t.x,a=t.y,o=t.z,s=(t=t.w)*e+a*n-o*r,l=t*r+o*e-i*n,u=t*n+i*r-a*e,e=-i*e-a*r-o*n;return this.x=s*t+e*-i+l*-o-u*-a,this.y=l*t+e*-a+u*-i-s*-o,this.z=u*t+e*-o+s*-a-l*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,r=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*n,this.y=t[1]*e+t[5]*r+t[9]*n,this.z=t[2]*e+t[6]*r+t[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var r=t.x,n=t.y;t=t.z;var i=e.x,a=e.y;return e=e.z,this.x=n*e-t*a,this.y=t*i-r*e,this.z=r*a-n*i,this},projectOnVector:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},projectOnPlane:function(t){return Ra.copy(this).projectOnVector(t),this.sub(Ra)},reflect:function(t){return this.sub(Ra.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(Sa.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,r){var n=Math.sin(e)*t;return this.x=n*Math.sin(r),this.y=Math.cos(e)*t,this.z=n*Math.cos(r),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=r,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var Da=new Mt,Oa=new Ct,Fa=new Mt(0,0,0),Ba=new Mt(1,1,1),Na=new Mt,za=new Mt,Ua=new Mt;Hu(Ct.prototype,{isMatrix4:!0,set:function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ct).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,r=t.elements,n=1/Da.setFromMatrixColumn(t,0).length(),i=1/Da.setFromMatrixColumn(t,1).length();return t=1/Da.setFromMatrixColumn(t,2).length(),e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=0,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=0,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,r,n,i=this.elements,a=t.x,o=t.y,s=t.z,l=Math.cos(a),a=Math.sin(a),u=Math.cos(o),o=Math.sin(o),c=Math.cos(s),s=Math.sin(s);return"XYZ"===t.order?(t=l*c,e=l*s,r=a*c,n=a*s,i[0]=u*c,i[4]=-u*s,i[8]=o,i[1]=e+r*o,i[5]=t-n*o,i[9]=-a*u,i[2]=n-t*o,i[6]=r+e*o,i[10]=l*u):"YXZ"===t.order?(t=u*c,e=u*s,r=o*c,n=o*s,i[0]=t+n*a,i[4]=r*a-e,i[8]=l*o,i[1]=l*s,i[5]=l*c,i[9]=-a,i[2]=e*a-r,i[6]=n+t*a,i[10]=l*u):"ZXY"===t.order?(t=u*c,e=u*s,r=o*c,n=o*s,i[0]=t-n*a,i[4]=-l*s,i[8]=r+e*a,i[1]=e+r*a,i[5]=l*c,i[9]=n-t*a,i[2]=-l*o,i[6]=a,i[10]=l*u):"ZYX"===t.order?(t=l*c,e=l*s,r=a*c,n=a*s,i[0]=u*c,i[4]=r*o-e,i[8]=t*o+n,i[1]=u*s,i[5]=n*o+t,i[9]=e*o-r,i[2]=-o,i[6]=a*u,i[10]=l*u):"YZX"===t.order?(t=l*u,e=l*o,r=a*u,n=a*o,i[0]=u*c,i[4]=n-t*s,i[8]=r*s+e,i[1]=s,i[5]=l*c,i[9]=-a*c,i[2]=-o*c,i[6]=e*s+r,i[10]=t-n*s):"XZY"===t.order&&(t=l*u,e=l*o,r=a*u,n=a*o,i[0]=u*c,i[4]=-s,i[8]=o*c,i[1]=t*s+n,i[5]=l*c,i[9]=e*s-r,i[2]=r*s-e,i[6]=a*c,i[10]=n*s+t),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Fa,t,Ba)},lookAt:function(t,e,r){var n=this.elements;return Ua.subVectors(t,e),0===Ua.lengthSq()&&(Ua.z=1),Ua.normalize(),Na.crossVectors(r,Ua),0===Na.lengthSq()&&(1===Math.abs(r.z)?Ua.x+=1e-4:Ua.z+=1e-4,Ua.normalize(),Na.crossVectors(r,Ua)),Na.normalize(),za.crossVectors(Ua,Na),n[0]=Na.x,n[4]=za.x,n[8]=Ua.x,n[1]=Na.y,n[5]=za.y,n[9]=Ua.y,n[2]=Na.z,n[6]=za.z,n[10]=Ua.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements;e=this.elements,t=r[0];var i=r[4],a=r[8],o=r[12],s=r[1],l=r[5],u=r[9],c=r[13],h=r[2],d=r[6],p=r[10],f=r[14],m=r[3],g=r[7],v=r[11],r=r[15],y=n[0],x=n[4],b=n[8],_=n[12],A=n[1],w=n[5],M=n[9],C=n[13],T=n[2],S=n[6],E=n[10],I=n[14],L=n[3],R=n[7],P=n[11],n=n[15];return e[0]=t*y+i*A+a*T+o*L,e[4]=t*x+i*w+a*S+o*R,e[8]=t*b+i*M+a*E+o*P,e[12]=t*_+i*C+a*I+o*n,e[1]=s*y+l*A+u*T+c*L,e[5]=s*x+l*w+u*S+c*R,e[9]=s*b+l*M+u*E+c*P,e[13]=s*_+l*C+u*I+c*n,e[2]=h*y+d*A+p*T+f*L,e[6]=h*x+d*w+p*S+f*R,e[10]=h*b+d*M+p*E+f*P,e[14]=h*_+d*C+p*I+f*n,e[3]=m*y+g*A+v*T+r*L,e[7]=m*x+g*w+v*S+r*R,e[11]=m*b+g*M+v*E+r*P,e[15]=m*_+g*C+v*I+r*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+i*s*c-n*l*c-i*o*h+r*l*h+n*o*d-r*s*d)+t[7]*(+e*s*d-e*l*h+i*a*h-n*a*d+n*l*u-i*s*u)+t[11]*(+e*l*c-e*o*d-i*a*c+r*a*d+i*o*u-r*l*u)+t[15]*(-n*o*u-e*s*c+e*o*h+n*a*c-r*a*h+r*s*u)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,r){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=r),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),e=this.elements;var r=t.elements;t=r[0];var n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],c=r[8],h=r[9],d=r[10],p=r[11],f=r[12],m=r[13],g=r[14],v=h*g*u-m*d*u+m*l*p-s*g*p-h*l*(r=r[15])+s*d*r,y=f*d*u-c*g*u-f*l*p+o*g*p+c*l*r-o*d*r,x=c*m*u-f*h*u+f*s*p-o*m*p-c*s*r+o*h*r,b=f*h*l-c*m*l-f*s*d+o*m*d+c*s*g-o*h*g,_=t*v+n*y+i*x+a*b;return 0==_?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(_=1/_,e[0]=v*_,e[1]=(m*d*a-h*g*a-m*i*p+n*g*p+h*i*r-n*d*r)*_,e[2]=(s*g*a-m*l*a+m*i*u-n*g*u-s*i*r+n*l*r)*_,e[3]=(h*l*a-s*d*a-h*i*u+n*d*u+s*i*p-n*l*p)*_,e[4]=y*_,e[5]=(c*g*a-f*d*a+f*i*p-t*g*p-c*i*r+t*d*r)*_,e[6]=(f*l*a-o*g*a-f*i*u+t*g*u+o*i*r-t*l*r)*_,e[7]=(o*d*a-c*l*a+c*i*u-t*d*u-o*i*p+t*l*p)*_,e[8]=x*_,e[9]=(f*h*a-c*m*a-f*n*p+t*m*p+c*n*r-t*h*r)*_,e[10]=(o*m*a-f*s*a+f*n*u-t*m*u-o*n*r+t*s*r)*_,e[11]=(c*s*a-o*h*a-c*n*u+t*h*u+o*n*p-t*s*p)*_,e[12]=b*_,e[13]=(c*m*i-f*h*i+f*n*d-t*m*d-c*n*g+t*h*g)*_,e[14]=(f*s*i-o*m*i-f*n*l+t*m*l+o*n*g-t*s*g)*_,e[15]=(o*h*i-c*s*i+c*n*l-t*h*l-o*n*d+t*s*d)*_,this)},scale:function(t){var e=this.elements,r=t.x,n=t.y;return t=t.z,e[0]*=r,e[4]*=n,e[8]*=t,e[1]*=r,e[5]*=n,e[9]*=t,e[2]*=r,e[6]*=n,e[10]*=t,e[3]*=r,e[7]*=n,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e);e=Math.sin(e);var n=1-r,i=t.x,a=t.y;t=t.z;var o=n*i,s=n*a;return this.set(o*i+r,o*a-e*t,o*t+e*a,0,o*a+e*t,s*a+r,s*t-e*i,0,o*t-e*a,s*t+e*i,n*t*t+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,r){var n=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,u=a+a;e=i*l;var c=i*u;i*=d=o+o;var h=a*u;a*=d,o*=d,l*=s,u*=s,s*=d;var d=r.x,p=r.y;return r=r.z,n[0]=(1-(h+o))*d,n[1]=(c+s)*d,n[2]=(i-u)*d,n[3]=0,n[4]=(c-s)*p,n[5]=(1-(e+o))*p,n[6]=(a+l)*p,n[7]=0,n[8]=(i+u)*r,n[9]=(a-l)*r,n[10]=(1-(e+h))*r,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:function(t,e,r){var n=this.elements,i=Da.set(n[0],n[1],n[2]).length(),a=Da.set(n[4],n[5],n[6]).length(),o=Da.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],Oa.copy(this),t=1/i;var n=1/a,s=1/o;return Oa.elements[0]*=t,Oa.elements[1]*=t,Oa.elements[2]*=t,Oa.elements[4]*=n,Oa.elements[5]*=n,Oa.elements[6]*=n,Oa.elements[8]*=s,Oa.elements[9]*=s,Oa.elements[10]*=s,e.setFromRotationMatrix(Oa),r.x=i,r.y=a,r.z=o,this},makePerspective:function(t,e,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;return o[0]=2*i/(e-t),o[4]=0,o[8]=(e+t)/(e-t),o[12]=0,o[1]=0,o[5]=2*i/(r-n),o[9]=(r+n)/(r-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(a+i)/(a-i),o[14]=-2*a*i/(a-i),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,r,n,i,a){var o=this.elements,s=1/(e-t),l=1/(r-n),u=1/(a-i);return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-(e+t)*s,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-(r+n)*l,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-(a+i)*u,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var r=0;r<16;r++)if(e[r]!==t[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}});var ka=new Ct,Ha=new f;i.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),i.DefaultOrder="XYZ",ku(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Hu(i.prototype,{isEuler:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var n=Sa.clamp;t=(h=t.elements)[0];var i=h[4],a=h[8],o=h[1],s=h[5],l=h[9],u=h[2],c=h[6],h=h[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-i,t)):(this._x=Math.atan2(c,s),this._z=0);break;case"YXZ":this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,s)):(this._y=Math.atan2(-u,t),this._z=0);break;case"ZXY":this._x=Math.asin(n(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-i,s)):(this._y=0,this._z=Math.atan2(o,t));break;case"ZYX":this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(c,h),this._z=Math.atan2(o,t)):(this._x=0,this._z=Math.atan2(-i,s));break;case"YZX":this._z=Math.asin(n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,s),this._y=Math.atan2(-u,t)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-n(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(c,s),this._y=Math.atan2(a,t)):(this._x=Math.atan2(-l,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,r){return ka.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ka,e,r)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return Ha.setFromEuler(this),this.setFromQuaternion(Ha,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Mt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Hu(a.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var Ga=0,Va=new Mt,Wa=new f,ja=new Ct,Xa=new Mt,qa=new Mt,Ya=new Mt,Za=new f,Ja=new Mt(1,0,0),Ka=new Mt(0,1,0),Qa=new Mt(0,0,1),$a={type:"added"},to={type:"removed"};p.DefaultUp=new Mt(0,1,0),p.DefaultMatrixAutoUpdate=!0,p.prototype=Hu(Uu(e.prototype),{constructor:p,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Wa.setFromAxisAngle(t,e),this.quaternion.multiply(Wa),this},rotateOnWorldAxis:function(t,e){return Wa.setFromAxisAngle(t,e),this.quaternion.premultiply(Wa),this},rotateX:function(t){return this.rotateOnAxis(Ja,t)},rotateY:function(t){return this.rotateOnAxis(Ka,t)},rotateZ:function(t){return this.rotateOnAxis(Qa,t)},translateOnAxis:function(t,e){return Va.copy(t).applyQuaternion(this.quaternion),this.position.add(Va.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Ja,t)},translateY:function(t){return this.translateOnAxis(Ka,t)},translateZ:function(t){return this.translateOnAxis(Qa,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(ja.getInverse(this.matrixWorld))},lookAt:function(t,e,r){t.isVector3?Xa.copy(t):Xa.set(t,e,r),t=this.parent,this.updateWorldMatrix(!0,!1),qa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ja.lookAt(qa,Xa,this.up):ja.lookAt(Xa,qa,this.up),this.quaternion.setFromRotationMatrix(ja),t&&(ja.extractRotation(t.matrixWorld),Wa.setFromRotationMatrix(ja),this.quaternion.premultiply(Wa.inverse()))},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent($a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(to)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),ja.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ja.multiply(t.parent.matrixWorld)),t.applyMatrix4(ja),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Mt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new f),this.updateMatrixWorld(!0),this.matrixWorld.decompose(qa,t,Ya),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Mt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(qa,Za,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Mt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(e=0,r=(t=this.children).length;e<r;e++)t[e].updateWorldMatrix(!1,!0)},toJSON:function(r){function t(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(r)),e.uuid}function e(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}var n=void 0===r||"string"==typeof r,i={};n&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a,o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==zu(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){o.geometry=t(r.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var l=0,u=s.length;l<u;l++)t(r.shapes,s[l]);else t(r.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],l=0,u=this.material.length;l<u;l++)s.push(t(r.materials,this.material[l]));o.material=s}else o.material=t(r.materials,this.material);if(0<this.children.length)for(o.children=[],l=0;l<this.children.length;l++)o.children.push(this.children[l].toJSON(r).object);return n&&(n=e(r.geometries),l=e(r.materials),u=e(r.textures),a=e(r.images),s=e(r.shapes),0<n.length&&(i.geometries=n),0<l.length&&(i.materials=l),0<u.length&&(i.textures=u),0<a.length&&(i.images=a),0<s.length&&(i.shapes=s)),i.object=o,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(zu(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}}),Tt.prototype=Hu(Uu(p.prototype),{constructor:Tt,isScene:!0,copy:function(t,e){return p.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=p.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var eo=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],ro=new Mt,no=new n,io=new Mt,ao=new Mt,oo=new Mt,so=new Mt,lo=new Mt,uo=new Mt,co=new Mt,ho=new Mt,po=new Mt,fo=new Mt;Hu(n.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=ro.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1),void 0!==(e=t.geometry)&&(null===e.boundingBox&&e.computeBoundingBox(),no.copy(e.boundingBox),no.applyMatrix4(t.matrixWorld),this.union(no));for(var e=0,r=(t=t.children).length;e<r;e++)this.expandByObject(t[e]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Mt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,ro),ro.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,r=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(co),ho.subVectors(this.max,co),io.subVectors(t.a,co),ao.subVectors(t.b,co),oo.subVectors(t.c,co),so.subVectors(ao,io),lo.subVectors(oo,ao),uo.subVectors(io,oo),!!o(t=[0,-so.z,so.y,0,-lo.z,lo.y,0,-uo.z,uo.y,so.z,0,-so.x,lo.z,0,-lo.x,uo.z,0,-uo.x,-so.y,so.x,0,-lo.y,lo.x,0,-uo.y,uo.x,0],io,ao,oo,ho)&&(!!o(t=[1,0,0,0,1,0,0,0,1],io,ao,oo,ho)&&(po.crossVectors(so,lo),o(t=[po.x,po.y,po.z],io,ao,oo,ho))))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Mt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return ro.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(ro).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(eo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),eo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),eo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),eo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),eo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),eo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),eo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),eo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(eo)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var mo=new n;Hu(c.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var r=this.center;void 0!==e?r.copy(e):mo.setFromPoints(t).getCenter(r);for(var n=e=0,i=t.length;n<i;n++)e=Math.max(e,r.distanceToSquared(t[n]));return this.radius=Math.sqrt(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Mt),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new n),this.isEmpty()?t.makeEmpty():(t.set(this.center,this.center),t.expandByScalar(this.radius)),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var go=new Mt,vo=new Mt,yo=new Mt,xo=new Mt,bo=new Mt,_o=new Mt,Ao=new Mt;Hu(s.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Mt),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,go)),this},closestPointToPoint:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Mt),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=go.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(go.copy(this.direction).multiplyScalar(e).add(this.origin),go.distanceToSquared(t))},distanceSqToSegment:function(t,e,r,n){vo.copy(t).add(e).multiplyScalar(.5),yo.copy(e).sub(t).normalize(),xo.copy(this.origin).sub(vo);var i,a=.5*t.distanceTo(e),o=-this.direction.dot(yo),s=xo.dot(this.direction),l=-xo.dot(yo),u=xo.lengthSq(),c=Math.abs(1-o*o);return o=0<c?(e=o*s-l,i=a*c,0<=(t=o*l-s)?-i<=e?e<=i?(t*=a=1/c)*(t+o*(e*=a)+2*s)+e*(o*t+e+2*l)+u:(e=a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u):(e=-a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u):e<=-i?-(t=Math.max(0,-(-o*a+s)))*t+(e=0<t?-a:Math.min(Math.max(-a,-l),a))*(e+2*l)+u:e<=i?(t=0,(e=Math.min(Math.max(-a,-l),a))*(e+2*l)+u):-(t=Math.max(0,-(o*a+s)))*t+(e=0<t?a:Math.min(Math.max(-a,-l),a))*(e+2*l)+u):(e=0<o?-a:a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u),r&&r.copy(this.direction).multiplyScalar(t).add(this.origin),n&&n.copy(yo).multiplyScalar(e).add(vo),o},intersectSphere:function(t,e){go.subVectors(t.center,this.origin);var r=go.dot(this.direction),n=go.dot(go)-r*r;return(t=t.radius*t.radius)<n?null:(n=r-(t=Math.sqrt(t-n)),r+=t,n<0&&r<0?null:n<0?this.at(r,e):this.at(n,e))},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var r,n,i=1/this.direction.x,a=1/this.direction.y,o=1/this.direction.z,s=this.origin;return 0<=i?(r=(t.min.x-s.x)*i,i*=t.max.x-s.x):(r=(t.max.x-s.x)*i,i*=t.min.x-s.x),0<=a?(n=(t.min.y-s.y)*a,a*=t.max.y-s.y):(n=(t.max.y-s.y)*a,a*=t.min.y-s.y),a<r||i<n?null:((r<n||r!=r)&&(r=n),(a<i||i!=i)&&(i=a),(t=0<=o?(n=(t.min.z-s.z)*o,(t.max.z-s.z)*o):(n=(t.max.z-s.z)*o,(t.min.z-s.z)*o))<r||i<n?null:((r<n||r!=r)&&(r=n),(i=t<i||i!=i?t:i)<0?null:this.at(0<=r?r:i,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,go)},intersectTriangle:function(t,e,r,n,i){if(bo.subVectors(e,t),_o.subVectors(r,t),Ao.crossVectors(bo,_o),0<(e=this.direction.dot(Ao))){if(n)return null;n=1}else{if(!(e<0))return null;n=-1,e=-e}return xo.subVectors(this.origin,t),(t=n*this.direction.dot(_o.crossVectors(xo,_o)))<0||(r=n*this.direction.dot(bo.cross(xo)))<0||e<t+r||(t=-n*xo.dot(Ao))<0?null:this.at(t/e,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var wo=new Mt,Mo=new Mt,Co=new g;Hu(v.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,r){return e=wo.subVectors(r,e).cross(Mo.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(e,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Mt),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Mt);var r=t.delta(wo),n=this.normal.dot(r);if(0===n){if(0===this.distanceToPoint(t.start))return e.copy(t.start)}else if(!((n=-(t.start.dot(this.normal)+this.constant)/n)<0||1<n))return e.copy(r).multiplyScalar(n).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Mt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){return e=e||Co.getNormalMatrix(t),t=this.coplanarPoint(wo).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var To=new Mt,So=new Mt,Eo=new Mt,Io=new Mt,Lo=new Mt,Ro=new Mt,Po=new Mt,Do=new Mt,Oo=new Mt,Fo=new Mt;Hu(b,{getNormal:function(t,e,r,n){return void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Mt),n.subVectors(r,e),To.subVectors(t,e),n.cross(To),0<(t=n.lengthSq())?n.multiplyScalar(1/Math.sqrt(t)):n.set(0,0,0)},getBarycoord:function(t,e,r,n,i){To.subVectors(n,e),So.subVectors(r,e),Eo.subVectors(t,e),t=To.dot(To),e=To.dot(So),r=To.dot(Eo);var a=So.dot(So);n=So.dot(Eo);var o=t*a-e*e;return void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Mt),0==o?i.set(-2,-1,-1):(a=(a*r-e*n)*(o=1/o),t=(t*n-e*r)*o,i.set(1-a-t,t,a))},containsPoint:function(t,e,r,n){return b.getBarycoord(t,e,r,n,Io),0<=Io.x&&0<=Io.y&&Io.x+Io.y<=1},getUV:function(t,e,r,n,i,a,o,s){return this.getBarycoord(t,e,r,n,Io),s.set(0,0),s.addScaledVector(i,Io.x),s.addScaledVector(a,Io.y),s.addScaledVector(o,Io.z),s},isFrontFacing:function(t,e,r,n){return To.subVectors(r,e),So.subVectors(t,e),To.cross(So).dot(n)<0}}),Hu(b.prototype,{set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return To.subVectors(this.c,this.b),So.subVectors(this.a,this.b),.5*To.cross(So).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Mt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return b.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new v),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return b.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,r,n,i){return b.getUV(t,this.a,this.b,this.c,e,r,n,i)},containsPoint:function(t){return b.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return b.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Mt);var r=this.a,n=this.b,i=this.c;Lo.subVectors(n,r),Ro.subVectors(i,r),Do.subVectors(t,r);var a=Lo.dot(Do),o=Ro.dot(Do);if(a<=0&&o<=0)return e.copy(r);Oo.subVectors(t,n);var s=Lo.dot(Oo),l=Ro.dot(Oo);if(0<=s&&l<=s)return e.copy(n);var u=a*l-s*o;if(u<=0&&0<=a&&s<=0)return n=a/(a-s),e.copy(r).addScaledVector(Lo,n);Fo.subVectors(t,i),t=Lo.dot(Fo);var c=Ro.dot(Fo);return 0<=c&&t<=c?e.copy(i):(a=t*o-a*c)<=0&&0<=o&&c<=0?(u=o/(o-c),e.copy(r).addScaledVector(Ro,u)):(o=s*c-t*l)<=0&&0<=l-s&&0<=t-c?(Po.subVectors(i,n),u=(l-s)/(l-s+(t-c)),e.copy(n).addScaledVector(Po,u)):(n=a*(i=1/(o+a+u)),u*=i,e.copy(r).addScaledVector(Lo,n).addScaledVector(Ro,u))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Bo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},No={h:0,s:0,l:0},zo={h:0,s:0,l:0};Hu(m.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(t,e,r){return t=Sa.euclideanModulo(t,1),e=Sa.clamp(e,0,1),r=Sa.clamp(r,0,1),0===e?this.r=this.g=this.b=r:(r=2*r-(e=r<=.5?r*(1+e):r+e-r*e),this.r=l(r,e,t+1/3),this.g=l(r,e,t),this.b=l(r,e,t-1/3)),this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=r[2];switch(r[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){var n=parseFloat(r[1])/360,i=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(n,i,a)}}}else if(r=/^#([A-Fa-f0-9]+)$/.exec(e)){if(3===(n=(r=r[1]).length))return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(t){var e=Bo[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=u(t.r),this.g=u(t.g),this.b=u(t.b),this},copyLinearToSRGB:function(t){return this.r=h(t.r),this.g=h(t.g),this.b=h(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,r=this.r,n=this.g,i=this.b,a=Math.max(r,n,i),o=((l=Math.min(r,n,i))+a)/2;if(l===a)l=e=0;else{var s=a-l,l=o<=.5?s/(a+l):s/(2-a-l);switch(a){case r:e=(n-i)/s+(n<i?6:0);break;case n:e=(i-r)/s+2;break;case i:e=(r-n)/s+4}e/=6}return t.h=e,t.s=l,t.l=o,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,r){return this.getHSL(No),No.h+=t,No.s+=e,No.l+=r,this.setHSL(No.h,No.s,No.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(No),t.getHSL(zo),t=Sa.lerp(No.h,zo.h,e);var r=Sa.lerp(No.s,zo.s,e);return e=Sa.lerp(No.l,zo.l,e),this.setHSL(t,r,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),m.NAMES=Bo,Hu(y.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Uo=0;x.prototype=Hu(Uu(e.prototype),{constructor:x,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var r,n=t[e];void 0===n?console.warn("THREE.Material: '"+e+"' parameter is undefined."):"shading"===e?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n):void 0===(r=this[e])?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n}},toJSON:function(t){function e(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}var r=void 0===t||"string"==typeof t;r&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==zu(this.userData)&&(n.userData=this.userData),r&&(r=e(t.textures),t=e(t.images),0<r.length&&(n.textures=r),0<t.length&&(n.images=t)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,r=null;if(null!==e)for(var n=e.length,r=Array(n),i=0;i!==n;++i)r[i]=e[i].clone();return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(zu(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(x.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((_.prototype=Uu(x.prototype)).constructor=_).prototype.isMeshBasicMaterial=!0,_.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var ko=new Mt;Object.defineProperty(S.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Hu(S.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new m),e[r++]=a.r,e[r++]=a.g,e[r++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new At),e[r++]=a.x,e[r++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Mt),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new wt),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z,e[r++]=a.w}return this},applyMatrix3:function(t){for(var e=0,r=this.count;e<r;e++)ko.x=this.getX(e),ko.y=this.getY(e),ko.z=this.getZ(e),ko.applyMatrix3(t),this.setXYZ(e,ko.x,ko.y,ko.z);return this},applyMatrix4:function(t){for(var e=0,r=this.count;e<r;e++)ko.x=this.getX(e),ko.y=this.getY(e),ko.z=this.getZ(e),ko.applyMatrix4(t),this.setXYZ(e,ko.x,ko.y,ko.z);return this},applyNormalMatrix:function(t){for(var e=0,r=this.count;e<r;e++)ko.x=this.getX(e),ko.y=this.getY(e),ko.z=this.getZ(e),ko.applyNormalMatrix(t),this.setXYZ(e,ko.x,ko.y,ko.z);return this},transformDirection:function(t){for(var e=0,r=this.count;e<r;e++)ko.x=this.getX(e),ko.y=this.getY(e),ko.z=this.getZ(e),ko.transformDirection(t),this.setXYZ(e,ko.x,ko.y,ko.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(A.prototype=Uu(S.prototype)).constructor=A,(w.prototype=Uu(S.prototype)).constructor=w,(M.prototype=Uu(S.prototype)).constructor=M,(C.prototype=Uu(S.prototype)).constructor=C,(E.prototype=Uu(S.prototype)).constructor=E,(I.prototype=Uu(S.prototype)).constructor=I,(L.prototype=Uu(S.prototype)).constructor=L,(R.prototype=Uu(S.prototype)).constructor=R,(P.prototype=Uu(S.prototype)).constructor=P,Hu(D.prototype,{computeGroups:function(t){var e=[],r=void 0;t=t.faces;for(var n=0;n<t.length;n++){var i,a=t[n];a.materialIndex!==r&&(r=a.materialIndex,void 0!==i&&(i.count=3*n-i.start,e.push(i)),i={start:3*n,materialIndex:r})}void 0!==i&&(i.count=3*n-i.start,e.push(i)),this.groups=e},fromGeometry:function(t){var e=t.faces,r=t.vertices,n=t.faceVertexUvs,i=n[0]&&0<n[0].length,a=n[1]&&0<n[1].length,o=t.morphTargets,s=o.length;if(0<s){for(var l=[],u=0;u<s;u++)l[u]={name:o[u].name,data:[]};this.morphTargets.position=l}var c=t.morphNormals,h=c.length;if(0<h){for(var d=[],u=0;u<h;u++)d[u]={name:c[u].name,data:[]};this.morphTargets.normal=d}var p=t.skinIndices,f=t.skinWeights,m=p.length===r.length,g=f.length===r.length;for(0<r.length&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),u=0;u<e.length;u++){var v=e[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;for(3===y.length?this.normals.push(y[0],y[1],y[2]):(y=v.normal,this.normals.push(y,y,y)),3===(y=v.vertexColors).length?this.colors.push(y[0],y[1],y[2]):(y=v.color,this.colors.push(y,y,y)),!0===i&&(void 0!==(y=n[0][u])?this.uvs.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new At,new At,new At))),!0===a&&(void 0!==(y=n[1][u])?this.uvs2.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new At,new At,new At))),y=0;y<s;y++){var x=o[y].vertices;l[y].data.push(x[v.a],x[v.b],x[v.c])}for(y=0;y<h;y++)x=c[y].vertexNormals[u],d[y].data.push(x.a,x.b,x.c);m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var Ho=1,Go=new Ct,Vo=new p,Wo=new Mt,jo=new n,Xo=new n,qo=new Mt;F.prototype=Hu(Uu(e.prototype),{constructor:F,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<O(t)?L:E)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e,r=this.attributes.position;return void 0!==r&&(r.applyMatrix4(t),r.needsUpdate=!0),void 0!==(r=this.attributes.normal)&&(e=(new g).getNormalMatrix(t),r.applyNormalMatrix(e),r.needsUpdate=!0),void 0!==(r=this.attributes.tangent)&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Go.makeRotationX(t),this.applyMatrix4(Go),this},rotateY:function(t){return Go.makeRotationY(t),this.applyMatrix4(Go),this},rotateZ:function(t){return Go.makeRotationZ(t),this.applyMatrix4(Go),this},translate:function(t,e,r){return Go.makeTranslation(t,e,r),this.applyMatrix4(Go),this},scale:function(t,e,r){return Go.makeScale(t,e,r),this.applyMatrix4(Go),this},lookAt:function(t){return Vo.lookAt(t),Vo.updateMatrix(),this.applyMatrix4(Vo.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wo).negate(),this.translate(Wo.x,Wo.y,Wo.z),this},setFromObject:function(t){var e,r=t.geometry;return t.isPoints||t.isLine?(t=new R(3*r.vertices.length,3),e=new R(3*r.colors.length,3),this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",e.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(t=new R(r.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(r.lineDistances))),null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone())):t.isMesh&&r&&r.isGeometry&&this.fromGeometry(r),this},setFromPoints:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new R(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var r=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(r=void 0,e.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(e);r.verticesNeedUpdate=e.verticesNeedUpdate,r.normalsNeedUpdate=e.normalsNeedUpdate,r.colorsNeedUpdate=e.colorsNeedUpdate,r.uvsNeedUpdate=e.uvsNeedUpdate,r.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=r}return!0===e.verticesNeedUpdate&&(void 0!==(r=this.attributes.position)&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(r=this.attributes.normal)&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(r=this.attributes.color)&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(r=this.attributes.uv)&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(r=this.attributes.lineDistance)&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new D).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e,r=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new S(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.setAttribute("normal",new S(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.setAttribute("color",new S(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new S(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new S(r,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var r=[],n=t.morphTargets[e],i=0,a=n.length;i<a;i++){var o=n[i],s=new R(3*o.data.length,3);s.name=o.name,r.push(s.copyVector3sArray(o.data))}this.morphAttributes[e]=r}return 0<t.skinIndices.length&&(e=new R(4*t.skinIndices.length,4),this.setAttribute("skinIndex",e.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(e=new R(4*t.skinWeights.length,4),this.setAttribute("skinWeight",e.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new n);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var t=0,r=e.length;t<r;t++)jo.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(qo.addVectors(this.boundingBox.min,jo.min),this.boundingBox.expandByPoint(qo),qo.addVectors(this.boundingBox.max,jo.max),this.boundingBox.expandByPoint(qo)):(this.boundingBox.expandByPoint(jo.min),this.boundingBox.expandByPoint(jo.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new c);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var r=this.boundingSphere.center;if(jo.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var a=e[n];Xo.setFromBufferAttribute(a),this.morphTargetsRelative?(qo.addVectors(jo.min,Xo.min),jo.expandByPoint(qo),qo.addVectors(jo.max,Xo.max),jo.expandByPoint(qo)):(jo.expandByPoint(Xo.min),jo.expandByPoint(Xo.max))}jo.getCenter(r);for(var o=0,n=0,i=t.count;n<i;n++)qo.fromBufferAttribute(t,n),o=Math.max(o,r.distanceToSquared(qo));if(e)for(n=0,i=e.length;n<i;n++)for(var a=e[n],s=this.morphTargetsRelative,l=0,u=a.count;l<u;l++)qo.fromBufferAttribute(a,l),s&&(Wo.fromBufferAttribute(t,l),qo.add(Wo)),o=Math.max(o,r.distanceToSquared(qo));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var r=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new S(new Float32Array(r.length),3));else for(var n=0,i=(a=e.normal.array).length;n<i;n++)a[n]=0;var a=e.normal.array,o=new Mt,s=new Mt,l=new Mt,u=new Mt,c=new Mt;if(t)for(var h=t.array,n=0,i=t.count;n<i;n+=3){var t=3*h[n+0],d=3*h[n+1],p=3*h[n+2];o.fromArray(r,t),s.fromArray(r,d),l.fromArray(r,p),u.subVectors(l,s),c.subVectors(o,s),u.cross(c),a[t]+=u.x,a[t+1]+=u.y,a[t+2]+=u.z,a[d]+=u.x,a[1+d]+=u.y,a[2+d]+=u.z,a[p]+=u.x,a[1+p]+=u.y,a[2+p]+=u.z}else for(n=0,i=r.length;n<i;n+=9)o.fromArray(r,n),s.fromArray(r,n+3),l.fromArray(r,n+6),u.subVectors(l,s),c.subVectors(o,s),u.cross(c),a[n]=u.x,a[n+1]=u.y,a[n+2]=u.z,a[n+3]=u.x,a[n+4]=u.y,a[n+5]=u.z,a[n+6]=u.x,a[n+7]=u.y,a[n+8]=u.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r,n=this.attributes;for(r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=(s=t.attributes[r]).array,o=s.itemSize*e,s=Math.min(a.length,i.length-o),l=0;l<s;l++,o++)i[o]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,r=t.count;e<r;e++)qo.x=t.getX(e),qo.y=t.getY(e),qo.z=t.getZ(e),qo.normalize(),t.setXYZ(e,qo.x,qo.y,qo.z)},toNonIndexed:function(){function t(t,e){var r=t.array,n=t.itemSize;t=t.normalized;for(var i=new r.constructor(e.length*n),a=0,o=0,s=e.length;o<s;o++)for(var l=e[o]*n,u=0;u<n;u++)i[a++]=r[l++];return new S(i,n,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e,r=new F,n=this.index.array;for(e in l=this.attributes){var i=t(i=l[e],n);r.setAttribute(e,i)}var a=this.morphAttributes;for(e in a){for(var o=[],s=a[e],l=0,u=s.length;l<u;l++)i=t(i=s[l],n),o.push(i);r.morphAttributes[e]=o}for(r.morphTargetsRelative=this.morphTargetsRelative,l=0,e=(n=this.groups).length;l<e;l++)i=n[l],r.addGroup(i.start,i.count,i.materialIndex);return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Nu(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(u in e)void 0!==e[u]&&(t[u]=e[u]);return t}for(u in t.data={attributes:{}},null!==(e=this.index)&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)}),n=this.attributes){var r=(e=n[u]).toJSON();""!==e.name&&(r.name=e.name),t.data.attributes[u]=r}var n={},i=!1;for(u in this.morphAttributes){for(var a=this.morphAttributes[u],o=[],s=0,l=a.length;s<l;s++)r=(e=a[s]).toJSON(),""!==e.name&&(r.name=e.name),o.push(r);0<o.length&&(n[u]=o,i=!0)}i&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);var u=this.groups;return 0<u.length&&(t.data.groups=JSON.parse(zu(u))),null!==(u=this.boundingSphere)&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new F).copy(this)},copy:function(t){for(o in this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,null!==(i=t.index)&&this.setIndex(i.clone()),i=t.attributes)this.setAttribute(o,i[o].clone());var e=t.morphAttributes;for(o in e){for(var r=[],n=e[o],i=0,a=n.length;i<a;i++)r.push(n[i].clone());this.morphAttributes[o]=r}this.morphTargetsRelative=t.morphTargetsRelative;var o=t.groups;for(i=0,a=o.length;i<a;i++)e=o[i],this.addGroup(e.start,e.count,e.materialIndex);return null!==(o=t.boundingBox)&&(this.boundingBox=o.clone()),null!==(o=t.boundingSphere)&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Yo=new Ct,Zo=new s,Jo=new c,Ko=new Mt,Qo=new Mt,$o=new Mt,ts=new Mt,es=new Mt,rs=new Mt,ns=new Mt,is=new Mt,as=new Mt,os=new At,ss=new At,ls=new At,us=new Mt,cs=new Mt;B.prototype=Hu(Uu(p.prototype),{constructor:B,isMesh:!0,copy:function(t){return p.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Hu({},t.morphTargetDictionary)),this},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,e){var r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),Jo.copy(r.boundingSphere),Jo.applyMatrix4(i),!1!==t.ray.intersectsSphere(Jo)&&(Yo.getInverse(i),Zo.copy(t.ray).applyMatrix4(Yo),null===r.boundingBox||!1!==Zo.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,i=r.attributes.position,o=r.morphAttributes.position,s=r.morphTargetsRelative,l=r.attributes.uv,u=r.attributes.uv2,c=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(n))for(var d=0,p=c.length;d<p;d++)for(var f=c[d],m=n[f.materialIndex],g=Math.max(f.start,h.start),v=r=Math.min(f.start+f.count,h.start+h.count);g<v;g+=3){var r=a.getX(g),y=a.getX(g+1),x=a.getX(g+2);(r=z(this,m,t,Zo,i,o,s,l,u,r,y,x))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=f.materialIndex,e.push(r))}else for(d=g=Math.max(0,h.start),p=r=Math.min(a.count,h.start+h.count);d<p;d+=3)r=a.getX(d),y=a.getX(d+1),x=a.getX(d+2),(r=z(this,n,t,Zo,i,o,s,l,u,r,y,x))&&(r.faceIndex=Math.floor(d/3),e.push(r));else if(void 0!==i)if(Array.isArray(n))for(d=0,p=c.length;d<p;d++)for(m=n[(f=c[d]).materialIndex],g=Math.max(f.start,h.start),v=r=Math.min(f.start+f.count,h.start+h.count);g<v;g+=3)(r=z(this,m,t,Zo,i,o,s,l,u,r=g,y=g+1,x=g+2))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=f.materialIndex,e.push(r));else for(d=g=Math.max(0,h.start),p=r=Math.min(i.count,h.start+h.count);d<p;d+=3)(r=z(this,n,t,Zo,i,o,s,l,u,r=d,y=d+1,x=d+2))&&(r.faceIndex=Math.floor(d/3),e.push(r))}else if(r.isGeometry)for(i=Array.isArray(n),o=r.vertices,s=r.faces,0<(r=r.faceVertexUvs[0]).length&&(a=r),h=0,d=s.length;h<d;h++)p=s[h],void 0!==(r=i?n[p.materialIndex]:n)&&(l=o[p.a],u=o[p.b],c=o[p.c],r=N(this,r,t,Zo,l,u,c,us))&&(a&&a[h]&&(f=a[h],os.copy(f[0]),ss.copy(f[1]),ls.copy(f[2]),r.uv=b.getUV(us,l,u,c,os,ss,ls,new At)),r.face=p,r.faceIndex=h,e.push(r))},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var hs=0,ds=new Ct,ps=new p,fs=new Mt;U.prototype=Hu(Uu(e.prototype),{constructor:U,isGeometry:!0,applyMatrix4:function(t){for(var e=(new g).getNormalMatrix(t),r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(t);for(r=0,n=this.faces.length;r<n;r++){(t=this.faces[r]).normal.applyMatrix3(e).normalize();for(var i=0,a=t.vertexNormals.length;i<a;i++)t.vertexNormals[i].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return ds.makeRotationX(t),this.applyMatrix4(ds),this},rotateY:function(t){return ds.makeRotationY(t),this.applyMatrix4(ds),this},rotateZ:function(t){return ds.makeRotationZ(t),this.applyMatrix4(ds),this},translate:function(t,e,r){return ds.makeTranslation(t,e,r),this.applyMatrix4(ds),this},scale:function(t,e,r){return ds.makeScale(t,e,r),this.applyMatrix4(ds),this},lookAt:function(t){return ps.lookAt(t),ps.updateMatrix(),this.applyMatrix4(ps.matrix),this},fromBufferGeometry:function(t){function e(t,e,r,n){var i=void 0===s?[]:[a.colors[t].clone(),a.colors[e].clone(),a.colors[r].clone()];n=new y(t,e,r,void 0===o?[]:[(new Mt).fromArray(o,3*t),(new Mt).fromArray(o,3*e),(new Mt).fromArray(o,3*r)],i,n),a.faces.push(n),void 0!==l&&a.faceVertexUvs[0].push([(new At).fromArray(l,2*t),(new At).fromArray(l,2*e),(new At).fromArray(l,2*r)]),void 0!==u&&a.faceVertexUvs[1].push([(new At).fromArray(u,2*t),(new At).fromArray(u,2*e),(new At).fromArray(u,2*r)])}var a=this,r=null!==t.index?t.index.array:void 0,n=t.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;for(void 0!==u&&(this.faceVertexUvs[1]=[]),n=0;n<i.length;n+=3)a.vertices.push((new Mt).fromArray(i,n)),void 0!==s&&a.colors.push((new m).fromArray(s,n));var c=t.groups;if(0<c.length)for(n=0;n<c.length;n++){var h=(i=c[n]).start,d=h;for(h+=i.count;d<h;d+=3)void 0!==r?e(r[d],r[d+1],r[d+2],i.materialIndex):e(d,d+1,d+2,i.materialIndex)}else if(void 0!==r)for(n=0;n<r.length;n+=3)e(r[n],r[n+1],r[n+2]);else for(n=0;n<i.length/3;n+=3)e(n,n+1,n+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(fs).negate(),this.translate(fs.x,fs.y,fs.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,r=new Ct;return r.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new Mt,e=new Mt,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],a=this.vertices[i.a],o=this.vertices[i.b];t.subVectors(this.vertices[i.c],o),e.subVectors(a,o),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e=Array(this.vertices.length),r=0;for(a=this.vertices.length;r<a;r++)e[r]=new Mt;if(t){var n=new Mt,i=new Mt;for(t=0,r=this.faces.length;t<r;t++){var a=this.faces[t],o=this.vertices[a.a],s=this.vertices[a.b],l=this.vertices[a.c];n.subVectors(l,s),i.subVectors(o,s),n.cross(i),e[a.a].add(n),e[a.b].add(n),e[a.c].add(n)}}else for(this.computeFaceNormals(),t=0,r=this.faces.length;t<r;t++)e[(a=this.faces[t]).a].add(a.normal),e[a.b].add(a.normal),e[a.c].add(a.normal);for(r=0,a=this.vertices.length;r<a;r++)e[r].normalize();for(t=0,r=this.faces.length;t<r;t++)3===(o=(a=this.faces[t]).vertexNormals).length?(o[0].copy(e[a.a]),o[1].copy(e[a.b]),o[2].copy(e[a.c])):(o[0]=e[a.a].clone(),o[1]=e[a.b].clone(),o[2]=e[a.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var t=0,e=this.faces.length;t<e;t++){var r=this.faces[t],n=r.vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t=0;for(o=this.faces.length;t<o;t++){var e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(var r=0,n=e.vertexNormals.length;r<n;r++)e.__originalVertexNormals[r]?e.__originalVertexNormals[r].copy(e.vertexNormals[r]):e.__originalVertexNormals[r]=e.vertexNormals[r].clone()}var i=new U;for(i.faces=this.faces,r=0,n=this.morphTargets.length;r<n;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[];for(var e=this.morphNormals[r].faceNormals,a=this.morphNormals[r].vertexNormals,t=0,o=this.faces.length;t<o;t++){var s=new Mt,l={a:new Mt,b:new Mt,c:new Mt};e.push(s),a.push(l)}}for(a=this.morphNormals[r],i.vertices=this.morphTargets[r].vertices,i.computeFaceNormals(),i.computeVertexNormals(),t=0,o=this.faces.length;t<o;t++)e=this.faces[t],s=a.faceNormals[t],l=a.vertexNormals[t],s.copy(e.normal),l.a.copy(e.vertexNormals[0]),l.b.copy(e.vertexNormals[1]),l.c.copy(e.vertexNormals[2])}for(t=0,o=this.faces.length;t<o;t++)(e=this.faces[t]).normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new n),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new c),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,r){if(t&&t.isGeometry){var n,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,u=this.colors,c=t.colors;void 0===r&&(r=0),void 0!==e&&(n=(new g).getNormalMatrix(e));for(var h=0,d=o.length;h<d;h++){var p=o[h].clone();void 0!==e&&p.applyMatrix4(e),a.push(p)}for(h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(h=0,d=l.length;h<d;h++){var f=(o=l[h]).vertexNormals,c=o.vertexColors;for((u=new y(o.a+i,o.b+i,o.c+i)).normal.copy(o.normal),void 0!==n&&u.normal.applyMatrix3(n).normalize(),e=0,a=f.length;e<a;e++)p=f[e].clone(),void 0!==n&&p.applyMatrix3(n).normalize(),u.vertexNormals.push(p);for(u.color.copy(o.color),e=0,a=c.length;e<a;e++)p=c[e],u.vertexColors.push(p.clone());u.materialIndex=o.materialIndex+r,s.push(u)}for(h=0,d=t.faceVertexUvs.length;h<d;h++)for(r=t.faceVertexUvs[h],void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]),e=0,a=r.length;e<a;e++){for(i=[],s=0,l=(n=r[e]).length;s<l;s++)i.push(n[s].clone());this.faceVertexUvs[h].push(i)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){for(var t={},e=[],r=[],n=Math.pow(10,4),i=0,a=this.vertices.length;i<a;i++){var o=this.vertices[i];void 0===t[o=Math.round(o.x*n)+"_"+Math.round(o.y*n)+"_"+Math.round(o.z*n)]?(t[o]=i,e.push(this.vertices[i]),r[i]=e.length-1):r[i]=r[t[o]]}for(t=[],i=0,a=this.faces.length;i<a;i++)for((n=this.faces[i]).a=r[n.a],n.b=r[n.b],n.c=r[n.c],n=[n.a,n.b,n.c],o=0;o<3;o++)if(n[o]===n[(o+1)%3]){t.push(i);break}for(i=t.length-1;0<=i;i--)for(n=t[i],this.faces.splice(n,1),r=0,a=this.faceVertexUvs.length;r<a;r++)this.faceVertexUvs[r].splice(n,1);return i=this.vertices.length-e.length,this.vertices=e,i},setFromPoints:function(t){this.vertices=[];for(var e=0,r=t.length;e<r;e++){var n=t[e];this.vertices.push(new Mt(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,r=0;r<e;r++)t[r]._id=r;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];for(a&&a.length===e&&(n=[]),o&&o.length===e&&(i=[]),r=0;r<e;r++){var s=t[r]._id;n&&n.push(a[s]),i&&i.push(o[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function t(t,e,r){return r?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function r(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=u.length,u.push(t.getHex())),c[e]}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var a=this.parameters;for(p in a)void 0!==a[p]&&(i[p]=a[p]);return i}for(a=[],p=0;p<this.vertices.length;p++){var o=this.vertices[p];a.push(o.x,o.y,o.z)}for(var o=[],s=[],l={},u=[],c={},h=[],d={},p=0;p<this.faces.length;p++){var f,m=this.faces[p],g=void 0!==this.faceVertexUvs[0][p],v=0<m.normal.length(),y=0<m.vertexNormals.length,x=1!==m.color.r||1!==m.color.g||1!==m.color.b,b=0<m.vertexColors.length;f=t(2,3,g),f=t(f,4,v),f=t(f,5,y),f=t(f,6,x),f=t(f,7,b),o.push(f),o.push(m.a,m.b,m.c),o.push(m.materialIndex),g&&(g=this.faceVertexUvs[0][p],o.push(n(g[0]),n(g[1]),n(g[2]))),v&&o.push(e(m.normal)),y&&(v=m.vertexNormals,o.push(e(v[0]),e(v[1]),e(v[2]))),x&&o.push(r(m.color)),b&&(m=m.vertexColors,o.push(r(m[0]),r(m[1]),r(m[2])))}return i.data={},i.data.vertices=a,i.data.normals=s,0<u.length&&(i.data.colors=u),0<h.length&&(i.data.uvs=[h]),i.data.faces=o,i},clone:function(){return(new U).copy(this)},copy:function(t){var e;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;for(var r=t.vertices,n=0,i=r.length;n<i;n++)this.vertices.push(r[n].clone());for(n=0,i=(r=t.colors).length;n<i;n++)this.colors.push(r[n].clone());for(n=0,i=(r=t.faces).length;n<i;n++)this.faces.push(r[n].clone());for(n=0,i=t.faceVertexUvs.length;n<i;n++){var a=t.faceVertexUvs[n];for(void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]),r=0,e=a.length;r<e;r++){for(var o=a[r],s=[],l=0,u=o.length;l<u;l++)s.push(o[l].clone());this.faceVertexUvs[n].push(s)}}for(n=0,i=(l=t.morphTargets).length;n<i;n++){if((u={}).name=l[n].name,void 0!==l[n].vertices)for(u.vertices=[],r=0,e=l[n].vertices.length;r<e;r++)u.vertices.push(l[n].vertices[r].clone());if(void 0!==l[n].normals)for(u.normals=[],r=0,e=l[n].normals.length;r<e;r++)u.normals.push(l[n].normals[r].clone());this.morphTargets.push(u)}for(n=0,i=(l=t.morphNormals).length;n<i;n++){if(u={},void 0!==l[n].vertexNormals)for(u.vertexNormals=[],r=0,e=l[n].vertexNormals.length;r<e;r++)a=l[n].vertexNormals[r],(o={}).a=a.a.clone(),o.b=a.b.clone(),o.c=a.c.clone(),u.vertexNormals.push(o);if(void 0!==l[n].faceNormals)for(u.faceNormals=[],r=0,e=l[n].faceNormals.length;r<e;r++)u.faceNormals.push(l[n].faceNormals[r].clone());this.morphNormals.push(u)}for(n=0,i=(r=t.skinWeights).length;n<i;n++)this.skinWeights.push(r[n].clone());for(n=0,i=(r=t.skinIndices).length;n<i;n++)this.skinIndices.push(r[n].clone());for(n=0,i=(r=t.lineDistances).length;n<i;n++)this.lineDistances.push(r[n]);return null!==(n=t.boundingBox)&&(this.boundingBox=n.clone()),null!==(n=t.boundingSphere)&&(this.boundingSphere=n.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ms=function(o){function t(t,e,r,n,i,a){o.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new gs(t,e,r,n,i,a)),this.mergeVertices()}return o&&(t.__proto__=o),(t.prototype=Uu(o&&o.prototype)).constructor=t}(U),gs=function(s){function t(t,e,r,n,i,a){function o(t,e,r,n,i,a,o,s,l,u,c){var h=a/l,d=o/u,p=a/2,f=o/2,m=s/2;o=l+1;for(var g=u+1,v=a=0,y=new Mt,x=0;x<g;x++)for(var b=x*d-f,_=0;_<o;_++)y[t]=(_*h-p)*n,y[e]=b*i,y[r]=m,M.push(y.x,y.y,y.z),y[t]=0,y[e]=0,y[r]=0<s?1:-1,C.push(y.x,y.y,y.z),T.push(_/l),T.push(1-x/u),a+=1;for(t=0;t<u;t++)for(e=0;e<l;e++)r=S+e+o*(t+1),n=S+(e+1)+o*(t+1),i=S+(e+1)+o*t,w.push(S+e+o*t,r,i),w.push(r,n,i),v+=6;A.addGroup(E,v,c),E+=v,S+=a}s.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var A=this;t=t||1,e=e||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var w=[],M=[],C=[],T=[],S=0,E=0;o("z","y","x",-1,-1,r,e,t,a,i,0),o("z","y","x",1,-1,r,e,-t,a,i,1),o("x","z","y",1,1,t,r,e,n,a,2),o("x","z","y",1,-1,t,r,-e,n,a,3),o("x","y","z",1,-1,t,e,r,n,i,4),o("x","y","z",-1,-1,t,e,-r,n,i,5),this.setIndex(w),this.setAttribute("position",new R(M,3)),this.setAttribute("normal",new R(C,3)),this.setAttribute("uv",new R(T,2))}return s&&(t.__proto__=s),(t.prototype=Uu(s&&s.prototype)).constructor=t}(F),vs={clone:k,merge:H};((G.prototype=Uu(x.prototype)).constructor=G).prototype.isShaderMaterial=!0,G.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=k(t.uniforms),this.defines=Hu({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Hu({},t.extensions),this},G.prototype.toJSON=function(t){var e,r,n=x.prototype.toJSON.call(this,t);for(e in n.uniforms={},this.uniforms){var i=this.uniforms[e].value;n.uniforms[e]=i&&i.isTexture?{type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?{type:"c",value:i.getHex()}:i&&i.isVector2?{type:"v2",value:i.toArray()}:i&&i.isVector3?{type:"v3",value:i.toArray()}:i&&i.isVector4?{type:"v4",value:i.toArray()}:i&&i.isMatrix3?{type:"m3",value:i.toArray()}:i&&i.isMatrix4?{type:"m4",value:i.toArray()}:{value:i}}for(r in 0<Nu(this.defines).length&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,t={},this.extensions)!0===this.extensions[r]&&(t[r]=!0);return 0<Nu(t).length&&(n.extensions=t),n},V.prototype=Hu(Uu(p.prototype),{constructor:V,isCamera:!0,copy:function(t,e){return p.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Mt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){p.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){p.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),W.prototype=Hu(Uu(V.prototype),{constructor:W,isPerspectiveCamera:!0,copy:function(t,e){return V.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Hu({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*Sa.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Sa.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Sa.RAD2DEG*Math.atan(Math.tan(.5*Sa.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,r,n,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e,r=this.near,n=r*Math.tan(.5*Sa.DEG2RAD*this.fov)/this.zoom,i=2*n,a=this.aspect*i,o=-.5*a,s=this.view;null!==this.view&&this.view.enabled&&(t=s.fullWidth,e=s.fullHeight,o+=s.offsetX*a/t,n-=s.offsetY*i/e,a*=s.width/t,i*=s.height/e),0!==(s=this.filmOffset)&&(o+=r*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+a,n,n-i,r,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=p.prototype.toJSON.call(this,t)).object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Hu({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),(j.prototype=Uu(p.prototype)).constructor=j,((X.prototype=Uu(T.prototype)).constructor=X).prototype.isWebGLCubeRenderTarget=!0,X.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var r=new Tt,n=new G({type:"CubemapFromEquirect",uniforms:k({tEquirect:{value:null}}),vertexShader:"varying vec3 vWorldDirection;\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",fragmentShader:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}",side:1,blending:0});return n.uniforms.tEquirect.value=e,e=new B(new gs(5,5,5),n),r.add(e),new j(1,10,this).update(t,r),e.geometry.dispose(),e.material.dispose(),this},((St.prototype=Uu(d.prototype)).constructor=St).prototype.isDataTexture=!0;var ys=new c,xs=new Mt;Hu(Et.prototype,{set:function(t,e,r,n,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this},setFromProjectionMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var r=g[1],n=g[2],i=g[3],a=g[4],o=g[5],s=g[6],l=g[7],u=g[8],c=g[9],h=g[10],d=g[11],p=g[12],f=g[13],m=g[14],g=g[15];return e[0].setComponents(i-t,l-a,d-u,g-p).normalize(),e[1].setComponents(i+t,l+a,d+u,g+p).normalize(),e[2].setComponents(i+r,l+o,d+c,g+f).normalize(),e[3].setComponents(i-r,l-o,d-c,g-f).normalize(),e[4].setComponents(i-n,l-s,d-h,g-m).normalize(),e[5].setComponents(i+n,l+s,d+h,g+m).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),ys.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(ys)},intersectsSprite:function(t){return ys.center.set(0,0,0),ys.radius=.7071067811865476,ys.applyMatrix4(t.matrixWorld),this.intersectsSphere(ys)},intersectsSphere:function(t){var e=this.planes,r=t.center;t=-t.radius;for(var n=0;n<6;n++)if(e[n].distanceToPoint(r)<t)return!1;return!0},intersectsBox:function(t){for(var e=this.planes,r=0;r<6;r++){var n=e[r];if(xs.x=(0<n.normal.x?t.max:t.min).x,xs.y=(0<n.normal.y?t.max:t.min).y,xs.z=(0<n.normal.z?t.max:t.min).z,n.distanceToPoint(xs)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}});var bs={common:{diffuse:{value:new m(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new g},uv2Transform:{value:new g},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new At(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new m(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new m(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new g}},sprite:{diffuse:{value:new m(15658734)},opacity:{value:1},center:{value:new At(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new g}}};(q.prototype=Uu(U.prototype)).constructor=q,(Y.prototype=Uu(F.prototype)).constructor=Y;var _s={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},As={basic:{uniforms:H([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.fog]),vertexShader:_s.meshbasic_vert,fragmentShader:_s.meshbasic_frag},lambert:{uniforms:H([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.fog,bs.lights,{emissive:{value:new m(0)}}]),vertexShader:_s.meshlambert_vert,fragmentShader:_s.meshlambert_frag},phong:{uniforms:H([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.fog,bs.lights,{emissive:{value:new m(0)},specular:{value:new m(1118481)},shininess:{value:30}}]),vertexShader:_s.meshphong_vert,fragmentShader:_s.meshphong_frag},standard:{uniforms:H([bs.common,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.roughnessmap,bs.metalnessmap,bs.fog,bs.lights,{emissive:{value:new m(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_s.meshphysical_vert,fragmentShader:_s.meshphysical_frag},toon:{uniforms:H([bs.common,bs.specularmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.gradientmap,bs.fog,bs.lights,{emissive:{value:new m(0)},specular:{value:new m(1118481)},shininess:{value:30}}]),vertexShader:_s.meshtoon_vert,fragmentShader:_s.meshtoon_frag},matcap:{uniforms:H([bs.common,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.fog,{matcap:{value:null}}]),vertexShader:_s.meshmatcap_vert,fragmentShader:_s.meshmatcap_frag},points:{uniforms:H([bs.points,bs.fog]),vertexShader:_s.points_vert,fragmentShader:_s.points_frag},dashed:{uniforms:H([bs.common,bs.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_s.linedashed_vert,fragmentShader:_s.linedashed_frag},depth:{uniforms:H([bs.common,bs.displacementmap]),vertexShader:_s.depth_vert,fragmentShader:_s.depth_frag},normal:{uniforms:H([bs.common,bs.bumpmap,bs.normalmap,bs.displacementmap,{opacity:{value:1}}]),vertexShader:_s.normal_vert,fragmentShader:_s.normal_frag},sprite:{uniforms:H([bs.sprite,bs.fog]),vertexShader:_s.sprite_vert,fragmentShader:_s.sprite_frag},background:{uniforms:{uvTransform:{value:new g},t2D:{value:null}},vertexShader:_s.background_vert,fragmentShader:_s.background_frag},cube:{uniforms:H([bs.envmap,{opacity:{value:1}}]),vertexShader:_s.cube_vert,fragmentShader:_s.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_s.equirect_vert,fragmentShader:_s.equirect_frag},distanceRGBA:{uniforms:H([bs.common,bs.displacementmap,{referencePosition:{value:new Mt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_s.distanceRGBA_vert,fragmentShader:_s.distanceRGBA_frag},shadow:{uniforms:H([bs.lights,bs.fog,{color:{value:new m(0)},opacity:{value:1}}]),vertexShader:_s.shadow_vert,fragmentShader:_s.shadow_frag}};As.physical={uniforms:H([As.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new At(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new m(0)},transparency:{value:0}}]),vertexShader:_s.meshphysical_vert,fragmentShader:_s.meshphysical_frag},((J.prototype=Uu(d.prototype)).constructor=J).prototype.isCubeTexture=!0,Object.defineProperty(J.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),((K.prototype=Uu(d.prototype)).constructor=K).prototype.isDataTexture2DArray=!0,((Q.prototype=Uu(d.prototype)).constructor=Q).prototype.isDataTexture3D=!0;var ws=new d,Ms=new K,Cs=new Q,Ts=new J,Ss=[],Es=[],Is=new Float32Array(16),Ls=new Float32Array(9),Rs=new Float32Array(4);Qt.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),et(e,t)},$t.prototype.setValue=function(t,e,r){for(var n=this.seq,i=0,a=n.length;i!==a;++i){var o=n[i];o.setValue(t,e[o.id],r)}};var Ps=/([\w\d_]+)(\])?(\[|\.)?/g;te.prototype.setValue=function(t,e,r,n){void 0!==(e=this.map[e])&&e.setValue(t,r,n)},te.prototype.setOptional=function(t,e,r){void 0!==(e=e[r])&&this.setValue(t,r,e)},te.upload=function(t,e,r,n){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=r[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},te.seqWithValue=function(t,e){for(var r=[],n=0,i=t.length;n!==i;++n){var a=t[n];a.id in e&&r.push(a)}return r};var Ds=0,Os=/^[ \t]*#include +<([\w\d./]+)>/gm,Fs=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Bs=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,Ns=0;((Me.prototype=Uu(x.prototype)).constructor=Me).prototype.isMeshDepthMaterial=!0,Me.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((Ce.prototype=Uu(x.prototype)).constructor=Ce).prototype.isMeshDistanceMaterial=!0,Ce.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Le.prototype=Hu(Uu(W.prototype),{constructor:Le,isArrayCamera:!0}),Re.prototype=Hu(Uu(p.prototype),{constructor:Re,isGroup:!0}),Hu(Pe.prototype,{constructor:Pe,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Re,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Re,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(t,e,r){var n=null,i=null,a=this._targetRay,o=this._grip;return t&&(null!==a&&(null!==(n=e.getPose(t.targetRaySpace,r))&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale))),null!==o&&t.gripSpace&&(null!==(i=e.getPose(t.gripSpace,r))&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)))),null!==a&&(a.visible=null!==n),null!==o&&(o.visible=null!==i),this}}),Hu(De.prototype,e.prototype),Hu(Be.prototype,{isFogExp2:!0,clone:function(){return new Be(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Hu(Ne.prototype,{isFog:!0,clone:function(){return new Ne(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(ze.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Hu(ze.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var zs=new Mt;ku(Ue.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Hu(Ue.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,r=this.data.count;e<r;e++)zs.x=this.getX(e),zs.y=this.getY(e),zs.z=this.getZ(e),zs.applyMatrix4(t),this.setXYZ(e,zs.x,zs.y,zs.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this},clone:function(){for(var t=[],e=0;e<this.count;e++)for(var r=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[r+n]);return new S(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(){for(var t=[],e=0;e<this.count;e++)for(var r=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[r+n]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}),((ke.prototype=Uu(x.prototype)).constructor=ke).prototype.isSpriteMaterial=!0,ke.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Us,ks=new Mt,Hs=new Mt,Gs=new Mt,Vs=new At,Ws=new At,js=new Ct,Xs=new Mt,qs=new Mt,Ys=new Mt,Zs=new At,Js=new At,Ks=new At;He.prototype=Hu(Uu(p.prototype),{constructor:He,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hs.setFromMatrixScale(this.matrixWorld),js.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Gs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Hs.multiplyScalar(-Gs.z);var r,n,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i)),i=this.center,Ge(Xs.set(-.5,-.5,0),Gs,i,Hs,n,r),Ge(qs.set(.5,-.5,0),Gs,i,Hs,n,r),Ge(Ys.set(.5,.5,0),Gs,i,Hs,n,r),Zs.set(0,0),Js.set(1,0),Ks.set(1,1);var a=t.ray.intersectTriangle(Xs,qs,Ys,!1,ks);null===a&&(Ge(qs.set(-.5,.5,0),Gs,i,Hs,n,r),Js.set(0,1),null===t.ray.intersectTriangle(Xs,Ys,qs,!1,ks))||(n=t.ray.origin.distanceTo(ks))<t.near||n>t.far||e.push({distance:n,point:ks.clone(),uv:b.getUV(ks,Xs,qs,Ys,Zs,Js,Ks,new At),face:null,object:this})},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return p.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var Qs=new Mt,$s=new Mt;Ve.prototype=Hu(Uu(p.prototype),{constructor:Ve,isLOD:!0,copy:function(t){p.prototype.copy.call(this,t,!1);for(var e=t.levels,r=0,n=e.length;r<n;r++){var i=e[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,n=0;n<r.length&&!(e<r[n].distance);n++);return r.splice(n,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(0<e.length){for(var r=1,n=e.length;r<n&&!(t<e[r].distance);r++);return e[r-1].object}return null},raycast:function(t,e){var r;0<this.levels.length&&(Qs.setFromMatrixPosition(this.matrixWorld),r=t.ray.origin.distanceTo(Qs),this.getObjectForDistance(r).raycast(t,e))},update:function(t){var e=this.levels;if(1<e.length){Qs.setFromMatrixPosition(t.matrixWorld),$s.setFromMatrixPosition(this.matrixWorld),t=Qs.distanceTo($s)/t.zoom,e[0].object.visible=!0;for(var r=1,n=e.length;r<n&&t>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<n;r++)e[r].object.visible=!1}},toJSON:function(t){t=p.prototype.toJSON.call(this,t),!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var e=this.levels,r=0,n=e.length;r<n;r++){var i=e[r];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),We.prototype=Hu(Uu(B.prototype),{constructor:We,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new wt,e=this.geometry.attributes.skinWeight,r=0,n=e.count;r<n;r++){t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.w=e.getW(r);var i=1/t.manhattanLength();1/0!=i?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){B.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var a=new Mt,o=new wt,s=new wt,l=new Mt,u=new Ct;return function(t,e){var r,n=this.skeleton,i=this.geometry;for(o.fromBufferAttribute(i.attributes.skinIndex,t),s.fromBufferAttribute(i.attributes.skinWeight,t),a.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0),t=0;t<4;t++)0!==(i=s.getComponent(t))&&(r=o.getComponent(t),u.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(l.copy(a).applyMatrix4(u),i));return e.applyMatrix4(this.bindMatrixInverse)}}()});var tl=new Ct,el=new Ct;Hu(je.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var r=new Ct;this.bones[t]&&r.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(r)}},pose:function(){for(var t,e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,i=0,a=t.length;i<a;i++)tl.multiplyMatrices(t[i]?t[i].matrixWorld:el,e[i]),tl.toArray(r,16*i);void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new je(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,r=this.bones.length;e<r;e++){var n=this.bones[e];if(n.name===t)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Xe.prototype=Hu(Uu(p.prototype),{constructor:Xe,isBone:!0});var rl=new Ct,nl=new Ct,il=[],al=new B;qe.prototype=Hu(Uu(B.prototype),{constructor:qe,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var r=this.matrixWorld,n=this.count;if(al.geometry=this.geometry,al.material=this.material,void 0!==al.material)for(var i=0;i<n;i++){this.getMatrixAt(i,rl),nl.multiplyMatrices(r,rl),al.matrixWorld=nl,al.raycast(t,il);for(var a=0,o=il.length;a<o;a++){var s=il[a];s.instanceId=i,s.object=this,e.push(s)}il.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),((Ye.prototype=Uu(x.prototype)).constructor=Ye).prototype.isLineBasicMaterial=!0,Ye.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var ol=new Mt,sl=new Mt,ll=new Ct,ul=new s,cl=new c;Ze.prototype=Hu(Uu(p.prototype),{constructor:Ze,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[0],n=1,i=e.count;n<i;n++)ol.fromBufferAttribute(e,n-1),sl.fromBufferAttribute(e,n),r[n]=r[n-1],r[n]+=ol.distanceTo(sl);t.setAttribute("lineDistance",new R(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,(r=t.lineDistances)[0]=0,n=1,i=e.length;n<i;n++)r[n]=r[n-1],r[n]+=e[n-1].distanceTo(e[n]);return this},raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),cl.copy(r.boundingSphere),cl.applyMatrix4(n),cl.radius+=i,!1!==t.ray.intersectsSphere(cl)){ll.getInverse(n),ul.copy(t.ray).applyMatrix4(ll),n=i/((this.scale.x+this.scale.y+this.scale.z)/3),n*=n;var a=new Mt,o=new Mt,i=new Mt,s=new Mt,l=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var u=r.index,c=r.attributes.position.array;if(null!==u)for(var r=0,h=(u=u.array).length-1;r<h;r+=l){var d=u[r+1];a.fromArray(c,3*u[r]),o.fromArray(c,3*d),n<(d=ul.distanceSqToSegment(a,o,s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else for(r=0,h=c.length/3-1;r<h;r+=l)a.fromArray(c,3*r),o.fromArray(c,3*r+3),n<(d=ul.distanceSqToSegment(a,o,s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else if(r.isGeometry)for(o=(a=r.vertices).length,r=0;r<o-1;r+=l)n<(d=ul.distanceSqToSegment(a[r],a[r+1],s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var hl=new Mt,dl=new Mt;Je.prototype=Hu(Uu(Ze.prototype),{constructor:Je,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[],n=0,i=e.count;n<i;n+=2)hl.fromBufferAttribute(e,n),dl.fromBufferAttribute(e,n+1),r[n]=0===n?0:r[n-1],r[n+1]=r[n]+hl.distanceTo(dl);t.setAttribute("lineDistance",new R(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,r=t.lineDistances,n=0,i=e.length;n<i;n+=2)hl.copy(e[n]),dl.copy(e[n+1]),r[n]=0===n?0:r[n-1],r[n+1]=r[n]+hl.distanceTo(dl);return this}}),Ke.prototype=Hu(Uu(Ze.prototype),{constructor:Ke,isLineLoop:!0}),((Qe.prototype=Uu(x.prototype)).constructor=Qe).prototype.isPointsMaterial=!0,Qe.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var pl=new Ct,fl=new s,ml=new c,gl=new Mt;$e.prototype=Hu(Uu(p.prototype),{constructor:$e,isPoints:!0,raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),ml.copy(r.boundingSphere),ml.applyMatrix4(n),ml.radius+=i,!1!==t.ray.intersectsSphere(ml))if(pl.getInverse(n),fl.copy(t.ray).applyMatrix4(pl),i/=(this.scale.x+this.scale.y+this.scale.z)/3,i*=i,r.isBufferGeometry){var a=r.index,r=r.attributes.position.array;if(null!==a)for(var o=a.array,a=0,s=o.length;a<s;a++){var l=o[a];gl.fromArray(r,3*l),tr(gl,l,i,n,t,e,this)}else for(a=0,o=r.length/3;a<o;a++)gl.fromArray(r,3*a),tr(gl,a,i,n,t,e,this)}else for(a=0,o=(r=r.vertices).length;a<o;a++)tr(r[a],a,i,n,t,e,this)},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),er.prototype=Hu(Uu(d.prototype),{constructor:er,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((rr.prototype=Uu(d.prototype)).constructor=rr).prototype.isCompressedTexture=!0,((nr.prototype=Uu(d.prototype)).constructor=nr).prototype.isCanvasTexture=!0,((ir.prototype=Uu(d.prototype)).constructor=ir).prototype.isDepthTexture=!0,(ar.prototype=Uu(F.prototype)).constructor=ar,(or.prototype=Uu(U.prototype)).constructor=or,(sr.prototype=Uu(F.prototype)).constructor=sr,(lr.prototype=Uu(U.prototype)).constructor=lr,(ur.prototype=Uu(F.prototype)).constructor=ur,(cr.prototype=Uu(U.prototype)).constructor=cr,(hr.prototype=Uu(ur.prototype)).constructor=hr,(dr.prototype=Uu(U.prototype)).constructor=dr,(pr.prototype=Uu(ur.prototype)).constructor=pr,(fr.prototype=Uu(U.prototype)).constructor=fr,(mr.prototype=Uu(ur.prototype)).constructor=mr,(gr.prototype=Uu(U.prototype)).constructor=gr,(vr.prototype=Uu(ur.prototype)).constructor=vr,(yr.prototype=Uu(U.prototype)).constructor=yr,((xr.prototype=Uu(F.prototype)).constructor=xr).prototype.toJSON=function(){var t=F.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(br.prototype=Uu(U.prototype)).constructor=br,(_r.prototype=Uu(F.prototype)).constructor=_r,(Ar.prototype=Uu(U.prototype)).constructor=Ar,(wr.prototype=Uu(F.prototype)).constructor=wr;var vl=function(t,e,r){r=r||2;var n,i=(l=e&&e.length)?e[0]*r:t.length,a=Mr(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;if(l){for(var s=r,l=[],u=0,c=e.length;u<c;u++){var h=e[u]*s;(h=Mr(t,h,u<c-1?e[u+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),l.push(function(t){for(var e=t,r=t;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next,e!==t;);return r}(h))}for(l.sort(Sr),u=0;u<l.length;u++)(e=function(t,e){var r=e,n=t.x,i=t.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&a<o){if((a=o)===n){if(i===r.y)return r;if(i===r.next.y)return r.next}var s=r.x<r.next.x?r:r.next}}}while((r=r.next)!==e);if(!s)return null;if(n===a)return s;var l,u,o=(e=s).x,c=s.y,h=1/0,r=s;do{}while(n>=r.x&&r.x>=o&&n!==r.x&&Ir(i<c?n:a,i,o,c,i<c?a:n,i,r.x,r.y)&&(l=Math.abs(i-r.y)/(n-r.x),(u=(u=Fr(r,t))&&!(u=l<h)&&(u=l===h)&&!(u=r.x>s.x)&&(u=r.x===s.x)?Lr((u=s).prev,u,r.prev)<0&&Lr(r.next,u,u.next)<0:u)&&(s=r,h=l)),(r=r.next)!==e);return s}(s=l[u],e=a))&&(s=Br(e,s),Cr(e,e.next),Cr(s,s.next)),a=Cr(a,a.next)}if(t.length>80*r){for(var d=n=t[0],p=l=t[1],s=r;s<i;s+=r)(u=t[s])<d&&(d=u),(e=t[s+1])<p&&(p=e),n<u&&(n=u),l<e&&(l=e);n=0!==(n=Math.max(n-d,l-p))?1/n:0}return Tr(a,o,r,d,p,n),o},yl={area:function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},isClockWise:function(t){return yl.area(t)<0},triangulateShape:function(t,e){var r=[],n=[],i=[];kr(t),Hr(r,t);var a=t.length;for(e.forEach(kr),t=0;t<e.length;t++)n.push(a),a+=e[t].length,Hr(r,e[t]);for(e=vl(r,n),t=0;t<e.length;t+=3)i.push(e.slice(t,t+3));return i}};((Gr.prototype=Uu(U.prototype)).constructor=Gr).prototype.toJSON=function(){var t=U.prototype.toJSON.call(this);return Wr(this.parameters.shapes,this.parameters.options,t)},((Vr.prototype=Uu(F.prototype)).constructor=Vr).prototype.toJSON=function(){var t=F.prototype.toJSON.call(this);return Wr(this.parameters.shapes,this.parameters.options,t)};var xl={generateTopUV:function(t,e,r,n,i){t=e[3*n],n=e[3*n+1];var a=e[3*i];return i=e[3*i+1],[new At(e[3*r],e[3*r+1]),new At(t,n),new At(a,i)]},generateSideWallUV:function(t,e,r,n,i,a){t=e[3*r];var o=e[3*r+1];r=e[3*r+2];var s=e[3*n],l=e[3*n+1];n=e[3*n+2];var u=e[3*i],c=e[3*i+1];i=e[3*i+2];var h=e[3*a],d=e[3*a+1];return e=e[3*a+2],Math.abs(o-l)<.01?[new At(t,1-r),new At(s,1-n),new At(u,1-i),new At(h,1-e)]:[new At(o,1-r),new At(l,1-n),new At(c,1-i),new At(d,1-e)]}};(jr.prototype=Uu(U.prototype)).constructor=jr,(Xr.prototype=Uu(Vr.prototype)).constructor=Xr,(qr.prototype=Uu(U.prototype)).constructor=qr,(Yr.prototype=Uu(F.prototype)).constructor=Yr,(Zr.prototype=Uu(U.prototype)).constructor=Zr,(Jr.prototype=Uu(F.prototype)).constructor=Jr,(Kr.prototype=Uu(U.prototype)).constructor=Kr,(Qr.prototype=Uu(F.prototype)).constructor=Qr,(($r.prototype=Uu(U.prototype)).constructor=$r).prototype.toJSON=function(){var t=U.prototype.toJSON.call(this);return en(this.parameters.shapes,t)},((tn.prototype=Uu(F.prototype)).constructor=tn).prototype.toJSON=function(){var t=F.prototype.toJSON.call(this);return en(this.parameters.shapes,t)},(rn.prototype=Uu(F.prototype)).constructor=rn,(nn.prototype=Uu(U.prototype)).constructor=nn,(an.prototype=Uu(F.prototype)).constructor=an,(on.prototype=Uu(nn.prototype)).constructor=on,(sn.prototype=Uu(an.prototype)).constructor=sn,(ln.prototype=Uu(U.prototype)).constructor=ln,un.prototype=Uu(F.prototype);var bl=Du({__proto__:null,WireframeGeometry:ar,ParametricGeometry:or,ParametricBufferGeometry:sr,TetrahedronGeometry:cr,TetrahedronBufferGeometry:hr,OctahedronGeometry:dr,OctahedronBufferGeometry:pr,IcosahedronGeometry:fr,IcosahedronBufferGeometry:mr,DodecahedronGeometry:gr,DodecahedronBufferGeometry:vr,PolyhedronGeometry:lr,PolyhedronBufferGeometry:ur,TubeGeometry:yr,TubeBufferGeometry:xr,TorusKnotGeometry:br,TorusKnotBufferGeometry:_r,TorusGeometry:Ar,TorusBufferGeometry:wr,TextGeometry:jr,TextBufferGeometry:Xr,SphereGeometry:qr,SphereBufferGeometry:Yr,RingGeometry:Zr,RingBufferGeometry:Jr,PlaneGeometry:q,PlaneBufferGeometry:Y,LatheGeometry:Kr,LatheBufferGeometry:Qr,ShapeGeometry:$r,ShapeBufferGeometry:tn,ExtrudeGeometry:Gr,ExtrudeBufferGeometry:Vr,EdgesGeometry:rn,ConeGeometry:on,ConeBufferGeometry:sn,CylinderGeometry:nn,CylinderBufferGeometry:an,CircleGeometry:ln,CircleBufferGeometry:un.prototype.constructor=un,BoxGeometry:ms,BoxBufferGeometry:gs});((cn.prototype=Uu(x.prototype)).constructor=cn).prototype.isShadowMaterial=!0,cn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this},((hn.prototype=Uu(G.prototype)).constructor=hn).prototype.isRawShaderMaterial=!0,((dn.prototype=Uu(x.prototype)).constructor=dn).prototype.isMeshStandardMaterial=!0,dn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},((pn.prototype=Uu(dn.prototype)).constructor=pn).prototype.isMeshPhysicalMaterial=!0,pn.prototype.copy=function(t){return dn.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new m).copy(t.sheen):null,this.transparency=t.transparency,this},((fn.prototype=Uu(x.prototype)).constructor=fn).prototype.isMeshPhongMaterial=!0,fn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((mn.prototype=Uu(x.prototype)).constructor=mn).prototype.isMeshToonMaterial=!0,mn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((gn.prototype=Uu(x.prototype)).constructor=gn).prototype.isMeshNormalMaterial=!0,gn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((vn.prototype=Uu(x.prototype)).constructor=vn).prototype.isMeshLambertMaterial=!0,vn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((yn.prototype=Uu(x.prototype)).constructor=yn).prototype.isMeshMatcapMaterial=!0,yn.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((xn.prototype=Uu(Ye.prototype)).constructor=xn).prototype.isLineDashedMaterial=!0,xn.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var _l=Du({__proto__:null,ShadowMaterial:cn,SpriteMaterial:ke,RawShaderMaterial:hn,ShaderMaterial:G,PointsMaterial:Qe,MeshPhysicalMaterial:pn,MeshStandardMaterial:dn,MeshPhongMaterial:fn,MeshToonMaterial:mn,MeshNormalMaterial:gn,MeshLambertMaterial:vn,MeshDepthMaterial:Me,MeshDistanceMaterial:Ce,MeshBasicMaterial:_,MeshMatcapMaterial:yn,LineDashedMaterial:xn,LineBasicMaterial:Ye,Material:x}),Al={arraySlice:function(t,e,r){return Al.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(r){for(var t=r.length,e=Array(t),n=0;n!==t;++n)e[n]=n;return e.sort(function(t,e){return r[t]-r[e]}),e},sortedArray:function(t,e,r){for(var n=t.length,i=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=r[a]*e,l=0;l!==e;++l)i[o++]=t[s+l];return i},flattenJSON:function(t,e,r,n){for(var i=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[i++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))for(;o=a[n],void 0!==o&&(e.push(a.time),r.push.apply(r,o)),a=t[i++],void 0!==a;);else if(void 0!==o.toArray)for(;o=a[n],void 0!==o&&(e.push(a.time),o.toArray(r,r.length)),a=t[i++],void 0!==a;);else for(;o=a[n],void 0!==o&&(e.push(a.time),r.push(o)),a=t[i++],void 0!==a;);}},subclip:function(t,e,r,n,i){i=i||30,(t=t.clone()).name=e;var a=[];for(e=0;e<t.tracks.length;++e){for(var o=t.tracks[e],s=o.getValueSize(),l=[],u=[],c=0;c<o.times.length;++c){var h=o.times[c]*i;if(!(h<r||n<=h))for(l.push(o.times[c]),h=0;h<s;++h)u.push(o.values[c*s+h])}0!==l.length&&(o.times=Al.convertArray(l,o.times.constructor),o.values=Al.convertArray(u,o.values.constructor),a.push(o))}for(t.tracks=a,r=1/0,e=0;e<t.tracks.length;++e)r>t.tracks[e].times[0]&&(r=t.tracks[e].times[0]);for(e=0;e<t.tracks.length;++e)t.tracks[e].shift(-1*r);return t.resetDuration(),t},makeClipAdditive:function(t,e,r,n){void 0===e&&(e=0),void 0===r&&(r=t),(void 0===n||n<=0)&&(n=30);var i=t.tracks.length;for(e/=n,n=0;n<i;++n){var a=r.tracks[n],o=a.ValueTypeName;if("bool"!==o&&"string"!==o){var s=t.tracks.find(function(t){return t.name===a.name&&t.ValueTypeName===o});if(void 0!==s){var l=a.getValueSize(),u=a.times.length-1,u=e<=a.times[0]?Al.arraySlice(a.values,0,a.valueSize):e>=a.times[u]?Al.arraySlice(a.values,u*l):((u=a.createInterpolant()).evaluate(e),u.resultBuffer);"quaternion"===o&&new f(u[0],u[1],u[2],u[3]).normalize().conjugate().toArray(u);for(var c=s.times.length,h=0;h<c;++h){var d=h*l;if("quaternion"===o)f.multiplyQuaternionsFlat(s.values,d,u,0,s.values,d);else for(var p=0;p<l;++p)s.values[d+p]-=u[p]}}}}return t.blendMode=2501,t}};Hu(bn.prototype,{evaluate:function(t){var e=this.parameterPositions,r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{r:{n:if(!(t<n)){for(var a=r+2;;){if(void 0===n){if(t<i)break n;return this._cachedIndex=r=e.length,this.afterEnd_(r-1,t,i)}if(r===a)break;if(i=n,t<(n=e[++r]))break e}n=e.length;break r}if(i<=t)break t;for(t<(a=e[1])&&(r=2,i=a),a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===a)break;if(n=i,(i=e[--r-1])<=t)break e}n=r,r=0}for(;r<n;)t<e[i=r+n>>>1]?n=i:r=i+1;if(n=e[r],void 0===(i=e[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return this._cachedIndex=r=e.length,this.afterEnd_(r-1,i,t)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize;t*=n;for(var i=0;i!==n;++i)e[i]=r[t+i];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Hu(bn.prototype,{beforeStart_:bn.prototype.copySampleValue_,afterEnd_:bn.prototype.copySampleValue_}),_n.prototype=Hu(Uu(bn.prototype),{constructor:_n,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,r){var n=this.parameterPositions,i=t-2,a=t+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-r;break;case 2402:o=e+n[i=n.length-2]-n[i+1];break;default:i=t,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*r-e;break;case 2402:s=r+n[a=1]-n[0];break;default:a=t-1,s=e}t=.5*(r-e),n=this.valueSize,this._weightPrev=t/(e-o),this._weightNext=t/(s-r),this._offsetPrev=i*n,this._offsetNext=a*n},interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(t*=o)-o,l=this._offsetPrev,u=this._offsetNext,c=this._weightPrev,h=this._weightNext,d=(r-e)/(n-e);for(e=-c*(n=(r=d*d)*d)+2*c*r-c*d,c=(1+c)*n+(-1.5-2*c)*r+(-.5+c)*d+1,d=(-1-h)*n+(1.5+h)*r+.5*d,h=h*n-h*r,r=0;r!==o;++r)i[r]=e*a[l+r]+c*a[s+r]+d*a[t+r]+h*a[u+r];return i}}),An.prototype=Hu(Uu(bn.prototype),{constructor:An,interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(t*=o)-o;for(r=1-(e=(r-e)/(n-e)),n=0;n!==o;++n)i[n]=a[s+n]*r+a[t+n]*e;return i}}),wn.prototype=Hu(Uu(bn.prototype),{constructor:wn,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Hu(Mn,{toJSON:function(t){var e,r=t.constructor;return void 0!==r.toJSON?r=r.toJSON(t):(r={name:t.name,times:Al.convertArray(t.times,Array),values:Al.convertArray(t.values,Array)},(e=t.getInterpolation())!==t.DefaultInterpolation&&(r.interpolation=e)),r.type=t.ValueTypeName,r}}),Hu(Mn.prototype,{constructor:Mn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new wn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new An(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new _n(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)return this.createInterpolant=e,this;if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]*=t;return this},trim:function(t,e){for(var r=this.times,n=r.length,i=0,a=n-1;i!==n&&r[i]<t;)++i;for(;-1!==a&&r[a]>e;)--a;return++a,0===i&&a===n||(a<=i&&(i=(a=Math.max(a,1))-1),t=this.getValueSize(),this.times=Al.arraySlice(r,i,a),this.values=Al.arraySlice(this.values,i*t,a*t)),this},validate:function(){var t=!0;0!=(r=this.getValueSize())-Math.floor(r)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,r=this.values,n=e.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var i=null,a=0;a!==n;a++){var o=e[a];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),t=!1;break}if(null!==i&&o<i){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,i),t=!1;break}i=o}if(void 0!==r&&Al.isTypedArray(r))for(a=0,e=r.length;a!==e;++a)if(n=r[a],isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,n),t=!1;break}return t},optimize:function(){for(var t=Al.arraySlice(this.times),e=Al.arraySlice(this.values),r=this.getValueSize(),n=2302===this.getInterpolation(),i=1,a=t.length-1,o=1;o<a;++o){var s=!1;if((h=t[o])!==t[o+1]&&(1!==o||h!==h[0]))if(n)s=!0;else for(var l=o*r,u=l-r,c=l+r,h=0;h!==r;++h){var d=e[l+h];if(d!==e[u+h]||d!==e[c+h]){s=!0;break}}if(s){if(o!==i)for(t[i]=t[o],s=o*r,l=i*r,h=0;h!==r;++h)e[l+h]=e[s+h];++i}}if(0<a){for(t[i]=t[a],s=a*r,l=i*r,h=0;h!==r;++h)e[l+h]=e[s+h];++i}return i!==t.length?(this.times=Al.arraySlice(t,0,i),this.values=Al.arraySlice(e,0,i*r)):(this.times=t,this.values=e),this},clone:function(){var t=Al.arraySlice(this.times,0),e=Al.arraySlice(this.values,0);return(t=new this.constructor(this.name,t,e)).createInterpolant=this.createInterpolant,t}}),Cn.prototype=Hu(Uu(Mn.prototype),{constructor:Cn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Tn.prototype=Hu(Uu(Mn.prototype),{constructor:Tn,ValueTypeName:"color"}),Sn.prototype=Hu(Uu(Mn.prototype),{constructor:Sn,ValueTypeName:"number"}),En.prototype=Hu(Uu(bn.prototype),{constructor:En,interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize;for(e=(r-e)/(n-e),r=(t*=o)+o;t!==r;t+=4)f.slerpFlat(i,0,a,t-o,a,t,e);return i}}),In.prototype=Hu(Uu(Mn.prototype),{constructor:In,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new En(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Ln.prototype=Hu(Uu(Mn.prototype),{constructor:Ln,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Rn.prototype=Hu(Uu(Mn.prototype),{constructor:Rn,ValueTypeName:"vector"}),Hu(Pn,{parse:function(t){for(var e=[],r=t.tracks,n=1/(t.fps||1),i=0,a=r.length;i!==a;++i)e.push(Dn(r[i]).scale(n));return new Pn(t.name,t.duration,e,t.blendMode)},toJSON:function(t){var e=[],r=t.tracks;t={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(var n=0,i=r.length;n!==i;++n)e.push(Mn.toJSON(r[n]));return t},CreateFromMorphTargetSequence:function(t,e,r,n){for(var i=e.length,a=[],o=0;o<i;o++){var s=[];(u=[]).push((o+i-1)%i,o,(o+1)%i),s.push(0,1,0);var l=Al.getKeyframeOrder(u),u=Al.sortedArray(u,1,l),s=Al.sortedArray(s,1,l);n||0!==u[0]||(u.push(i),s.push(s[0])),a.push(new Sn(".morphTargetInfluences["+e[o].name+"]",u,s).scale(1/r))}return new Pn(t,-1,a)},findByName:function(t,e){var r=t;for(Array.isArray(t)||(r=t.geometry&&t.geometry.animations||t.animations),t=0;t<r.length;t++)if(r[t].name===e)return r[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s,l=t[a],u=l.name.match(i);u&&1<u.length&&((u=n[s=u[1]])||(n[s]=u=[]),u.push(l))}for(s in t=[],n)t.push(Pn.CreateFromMorphTargetSequence(s,n[s],e,r));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;function r(t,e,r,n,i){var a,o;0!==r.length&&(a=[],o=[],Al.flattenJSON(r,a,o,n),0!==a.length&&i.push(new t(e,a,o)))}var n=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.blendMode;t=t.hierarchy||[];for(var l=0;l<t.length;l++){var u=t[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c,a={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)a[u[h].morphTargets[d]]=-1;for(c in a){for(var p=[],f=[],d=0;d!==u[h].morphTargets.length;++d){var m=u[h];p.push(m.time),f.push(m.morphTarget===c?1:0)}n.push(new Sn(".morphTargetInfluence["+c+"]",p,f))}a=a.length*(o||1)}else r(Rn,(h=".bones["+e[l].name+"]")+".position",u,"pos",n),r(In,h+".quaternion",u,"rot",n),r(Rn,h+".scale",u,"scl",n)}return 0===n.length?null:new Pn(i,a,n,s)}}),Hu(Pn.prototype,{resetDuration:function(){for(var t=0,e=0,r=this.tracks.length;e!==r;++e)var n=this.tracks[e],t=Math.max(t,n.times[n.times.length-1]);return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Pn(this.name,this.duration,t,this.blendMode)}});var wl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Ml=new On;Hu(Fn.prototype,{load:function(){},loadAsync:function(r,n){var i=this;return new Pu(function(t,e){i.load(r,t,n,e)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Cl={};Bn.prototype=Hu(Uu(Fn.prototype),{constructor:Bn,load:function(o,t,e,r){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);var s=this,n=wl.get(o);if(void 0!==n)return s.manager.itemStart(o),setTimeout(function(){t&&t(n),s.manager.itemEnd(o)},0),n;if(void 0===Cl[o]){if(a=o.match(/^data:(.*?)(;base64)?,(.*)$/)){e=a[1];var i=!!a[2],a=a[3];a=decodeURIComponent(a),i&&(a=atob(a));try{var l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":for(var u=new Uint8Array(a.length),i=0;i<a.length;i++)u[i]=a.charCodeAt(i);var c="blob"===l?new Blob([u.buffer],{type:e}):u.buffer;break;case"document":c=(new DOMParser).parseFromString(a,e);break;case"json":c=JSON.parse(a);break;default:c=a}setTimeout(function(){t&&t(c),s.manager.itemEnd(o)},0)}catch(t){setTimeout(function(){r&&r(t),s.manager.itemError(o),s.manager.itemEnd(o)},0)}}else{Cl[o]=[],Cl[o].push({onLoad:t,onProgress:e,onError:r});var h=new XMLHttpRequest;for(i in h.open("GET",o,!0),h.addEventListener("load",function(t){var e=this.response,r=Cl[o];if(delete Cl[o],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),wl.add(o,e);for(var n=0,i=r.length;n<i;n++){var a=r[n];a.onLoad&&a.onLoad(e)}}else{for(n=0,i=r.length;n<i;n++)(a=r[n]).onError&&a.onError(t);s.manager.itemError(o)}s.manager.itemEnd(o)},!1),h.addEventListener("progress",function(t){for(var e=Cl[o],r=0,n=e.length;r<n;r++){var i=e[r];i.onProgress&&i.onProgress(t)}},!1),h.addEventListener("error",function(t){var e=Cl[o];delete Cl[o];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),h.addEventListener("abort",function(t){var e=Cl[o];delete Cl[o];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),void 0!==this.responseType&&(h.responseType=this.responseType),void 0!==this.withCredentials&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)h.setRequestHeader(i,this.requestHeader[i]);h.send(null)}return s.manager.itemStart(o),h}Cl[o].push({onLoad:t,onProgress:e,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Nn.prototype=Hu(Uu(Fn.prototype),{constructor:Nn,load:function(e,r,t,n){var i=this,a=new Bn(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){for(var e=[],r=0;r<t.length;r++){var n=Pn.parse(t[r]);e.push(n)}return e}}),zn.prototype=Hu(Uu(Fn.prototype),{constructor:zn,load:function(t,i,r,n){var a=this,o=[],s=new rr;s.image=o;var l=new Bn(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,e=0,c=t.length;e<c;++e)!function(e){l.load(t[e],function(t){t=a.parse(t,!0),o[e]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(u+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,i&&i(s))},r,n)}(e);else l.load(t,function(t){if((t=a.parse(t,!0)).isCubemap)for(var e=t.mipmaps.length/t.mipmapCount,r=0;r<e;r++){o[r]={mipmaps:[]};for(var n=0;n<t.mipmapCount;n++)o[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+n]),o[r].format=t.format,o[r].width=t.width,o[r].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,i&&i(s)},r,n);return s}}),Un.prototype=Hu(Uu(Fn.prototype),{constructor:Un,load:function(t,e,r,n){var i=this,a=new St,o=new Bn(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,function(t){(t=i.parse(t))&&(void 0!==t.image?a.image=t.image:void 0!==t.data&&(a.image.width=t.width,a.image.height=t.height,a.image.data=t.data),a.wrapS=void 0!==t.wrapS?t.wrapS:1001,a.wrapT=void 0!==t.wrapT?t.wrapT:1001,a.magFilter=void 0!==t.magFilter?t.magFilter:1006,a.minFilter=void 0!==t.minFilter?t.minFilter:1006,a.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(a.format=t.format),void 0!==t.type&&(a.type=t.type),void 0!==t.mipmaps&&(a.mipmaps=t.mipmaps,a.minFilter=1008),1===t.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,e&&e(a,t))},r,n),a}}),kn.prototype=Hu(Uu(Fn.prototype),{constructor:kn,load:function(e,t,r,n){function i(){l.removeEventListener("load",i,!1),l.removeEventListener("error",a,!1),wl.add(e,this),t&&t(this),o.manager.itemEnd(e)}function a(t){l.removeEventListener("load",i,!1),l.removeEventListener("error",a,!1),n&&n(t),o.manager.itemError(e),o.manager.itemEnd(e)}void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,s=wl.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;var l=document.createElementNS("http://www.w3.org/1999/xhtml","img");return l.addEventListener("load",i,!1),l.addEventListener("error",a,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}),Hn.prototype=Hu(Uu(Fn.prototype),{constructor:Hn,load:function(t,r,e,n){var i=new J,a=new kn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;for(e=0;e<t.length;++e)!function(e){a.load(t[e],function(t){i.images[e]=t,6===++o&&(i.needsUpdate=!0,r&&r(i))},void 0,n)}(e);return i}}),Gn.prototype=Hu(Uu(Fn.prototype),{constructor:Gn,load:function(e,r,t,n){var i=new d,a=new kn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(t){i.image=t,t=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data:image\/jpeg/),i.format=t?1022:1023,i.needsUpdate=!0,void 0!==r&&r(i)},t,n),i}}),Hu(Vn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r=[],n=this.getPoint(0),i=0;for(r.push(0),e=1;e<=t;e++){var a=this.getPoint(e/t);i+=a.distanceTo(n),r.push(i),n=a}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var r=this.getLengths(),n=r.length;e=e||t*r[n-1];for(var i,a=0,o=n-1;a<=o;)if((i=r[t=Math.floor(a+(o-a)/2)]-e)<0)a=t+1;else{if(!(0<i)){o=t;break}o=t-1}return r[t=o]===e?t/(n-1):(t+(e-(a=r[t]))/(r[t+1]-a))/(n-1)},getTangent:function(t,e){var r=t-1e-4;return r<0&&(r=0),1<(t+=1e-4)&&(t=1),r=this.getPoint(r),t=this.getPoint(t),(e=e||new(r.isVector2?At:Mt)).copy(t).sub(r).normalize(),e},getTangentAt:function(t,e){return t=this.getUtoTmapping(t),this.getTangent(t,e)},computeFrenetFrames:function(t,e){for(var r=new Mt,n=[],i=[],a=[],o=new Mt,s=new Ct,l=0;l<=t;l++){var u=l/t;n[l]=this.getTangentAt(u,new Mt),n[l].normalize()}i[0]=new Mt,a[0]=new Mt,l=Number.MAX_VALUE;var u=Math.abs(n[0].x),c=Math.abs(n[0].y),h=Math.abs(n[0].z);for(u<=l&&(l=u,r.set(1,0,0)),c<=l&&(l=c,r.set(0,1,0)),h<=l&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),a[0].crossVectors(n[0],i[0]),l=1;l<=t;l++)i[l]=i[l-1].clone(),a[l]=a[l-1].clone(),o.crossVectors(n[l-1],n[l]),o.length()>Wu&&(o.normalize(),r=Math.acos(Sa.clamp(n[l-1].dot(n[l]),-1,1)),i[l].applyMatrix4(s.makeRotationAxis(o,r))),a[l].crossVectors(n[l],i[l]);if(!0===e)for(r=Math.acos(Sa.clamp(i[0].dot(i[t]),-1,1)),r/=t,0<n[0].dot(o.crossVectors(i[0],i[t]))&&(r=-r),l=1;l<=t;l++)i[l].applyMatrix4(s.makeRotationAxis(n[l],r*l)),a[l].crossVectors(n[l],i[l]);return{tangents:n,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((Wn.prototype=Uu(Vn.prototype)).constructor=Wn).prototype.isEllipseCurve=!0,Wn.prototype.getPoint=function(t,e){e=e||new At;for(var r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,i=Math.abs(n)<Wu;n<0;)n+=r;for(;r<n;)n-=r;n<Wu&&(n=i?0:r),!0!==this.aClockwise||i||(n=n===r?-r:n-r),r=this.aStartAngle+t*n,t=this.aX+this.xRadius*Math.cos(r);var a=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(r=Math.cos(this.aRotation),n=Math.sin(this.aRotation),t=(i=t-this.aX)*r-(a-=this.aY)*n+this.aX,a=i*n+a*r+this.aY),e.set(t,a)},Wn.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Wn.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Wn.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((jn.prototype=Uu(Wn.prototype)).constructor=jn).prototype.isArcCurve=!0;var Tl=new Mt,Sl=new Xn,El=new Xn,Il=new Xn;((qn.prototype=Uu(Vn.prototype)).constructor=qn).prototype.isCatmullRomCurve3=!0,qn.prototype.getPoint=function(t,e){e=e||new Mt;var r=(l=this.points).length;t*=r-(this.closed?0:1);var n=Math.floor(t);t-=n,this.closed?n+=0<n?0:(Math.floor(Math.abs(n)/r)+1)*r:0===t&&n===r-1&&(n=r-2,t=1);var i,a=this.closed||0<n?l[(n-1)%r]:(Tl.subVectors(l[0],l[1]).add(l[0]),Tl),o=l[n%r],s=l[(n+1)%r],l=this.closed||n+2<r?l[(n+2)%r]:(Tl.subVectors(l[r-1],l[r-2]).add(l[r-1]),Tl);return"centripetal"===this.curveType||"chordal"===this.curveType?(i="chordal"===this.curveType?.5:.25,r=Math.pow(a.distanceToSquared(o),i),(n=Math.pow(o.distanceToSquared(s),i))<1e-4&&(n=1),r<1e-4&&(r=n),(i=Math.pow(s.distanceToSquared(l),i))<1e-4&&(i=n),Sl.initNonuniformCatmullRom(a.x,o.x,s.x,l.x,r,n,i),El.initNonuniformCatmullRom(a.y,o.y,s.y,l.y,r,n,i),Il.initNonuniformCatmullRom(a.z,o.z,s.z,l.z,r,n,i)):"catmullrom"===this.curveType&&(Sl.initCatmullRom(a.x,o.x,s.x,l.x,this.tension),El.initCatmullRom(a.y,o.y,s.y,l.y,this.tension),Il.initCatmullRom(a.z,o.z,s.z,l.z,this.tension)),e.set(Sl.calc(t),El.calc(t),Il.calc(t)),e},qn.prototype.copy=function(t){Vn.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},qn.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},qn.prototype.fromJSON=function(t){Vn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Mt).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((Kn.prototype=Uu(Vn.prototype)).constructor=Kn).prototype.isCubicBezierCurve=!0,Kn.prototype.getPoint=function(t,e){e=e||new At;var r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set(Jn(t,r.x,n.x,i.x,a.x),Jn(t,r.y,n.y,i.y,a.y)),e},Kn.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Kn.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Kn.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((Qn.prototype=Uu(Vn.prototype)).constructor=Qn).prototype.isCubicBezierCurve3=!0,Qn.prototype.getPoint=function(t,e){e=e||new Mt;var r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set(Jn(t,r.x,n.x,i.x,a.x),Jn(t,r.y,n.y,i.y,a.y),Jn(t,r.z,n.z,i.z,a.z)),e},Qn.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Qn.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Qn.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(($n.prototype=Uu(Vn.prototype)).constructor=$n).prototype.isLineCurve=!0,$n.prototype.getPoint=function(t,e){return e=e||new At,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},$n.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},$n.prototype.getTangent=function(t,e){return(e||new At).copy(this.v2).sub(this.v1).normalize()},$n.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$n.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$n.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ti.prototype=Uu(Vn.prototype)).constructor=ti).prototype.isLineCurve3=!0,ti.prototype.getPoint=function(t,e){return e=e||new Mt,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},ti.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ti.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ti.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ti.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ei.prototype=Uu(Vn.prototype)).constructor=ei).prototype.isQuadraticBezierCurve=!0,ei.prototype.getPoint=function(t,e){e=e||new At;var r=this.v0,n=this.v1,i=this.v2;return e.set(Zn(t,r.x,n.x,i.x),Zn(t,r.y,n.y,i.y)),e},ei.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ei.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ei.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ri.prototype=Uu(Vn.prototype)).constructor=ri).prototype.isQuadraticBezierCurve3=!0,ri.prototype.getPoint=function(t,e){e=e||new Mt;var r=this.v0,n=this.v1,i=this.v2;return e.set(Zn(t,r.x,n.x,i.x),Zn(t,r.y,n.y,i.y),Zn(t,r.z,n.z,i.z)),e},ri.prototype.copy=function(t){return Vn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ri.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ri.prototype.fromJSON=function(t){return Vn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ni.prototype=Uu(Vn.prototype)).constructor=ni).prototype.isSplineCurve=!0,ni.prototype.getPoint=function(t,e){e=e||new At;var r=((o=this.points).length-1)*t;r-=t=Math.floor(r);var n=o[0===t?t:t-1],i=o[t],a=o[t>o.length-2?o.length-1:t+1],o=o[t>o.length-3?o.length-1:t+2];return e.set(Yn(r,n.x,i.x,a.x,o.x),Yn(r,n.y,i.y,a.y,o.y)),e},ni.prototype.copy=function(t){Vn.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++)this.points.push(t.points[e].clone());return this},ni.prototype.toJSON=function(){var t=Vn.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++)t.points.push(this.points[e].toArray());return t},ni.prototype.fromJSON=function(t){Vn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new At).fromArray(n))}return this};var Ll=Du({__proto__:null,ArcCurve:jn,CatmullRomCurve3:qn,CubicBezierCurve:Kn,CubicBezierCurve3:Qn,EllipseCurve:Wn,LineCurve:$n,LineCurve3:ti,QuadraticBezierCurve:ei,QuadraticBezierCurve3:ri,SplineCurve:ni});ii.prototype=Hu(Uu(Vn.prototype),{constructor:ii,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new $n(e,t))},getPoint:function(t){var e=t*this.getLength(),r=this.getCurveLengths();for(t=0;t<r.length;){if(r[t]>=e)return e=r[t]-e,r=(t=this.curves[t]).getLength(),t.getPointAt(0===r?0:1-e/r);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,r=[],n=0,i=this.curves;n<i.length;n++)for(var a=(a=i[n]).getPoints(a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t),o=0;o<a.length;o++){var s=a[o];e&&e.equals(s)||(r.push(s),e=s)}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Vn.prototype.copy.call(this,t),this.curves=[];for(var e=0,r=t.curves.length;e<r;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Vn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,r=this.curves.length;e<r;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){Vn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push((new Ll[n.type]).fromJSON(n))}return this}}),ai.prototype=Hu(Uu(ii.prototype),{constructor:ai,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var r=new $n(this.currentPoint.clone(),new At(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,r,n){return t=new ei(this.currentPoint.clone(),new At(t,e),new At(r,n)),this.curves.push(t),this.currentPoint.set(r,n),this},bezierCurveTo:function(t,e,r,n,i,a){return t=new Kn(this.currentPoint.clone(),new At(t,e),new At(r,n),new At(i,a)),this.curves.push(t),this.currentPoint.set(i,a),this},splineThru:function(t){var e=new ni(e=[this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,r,n,i,a){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,r,n,i,a),this},absarc:function(t,e,r,n,i,a){return this.absellipse(t,e,r,r,n,i,a),this},ellipse:function(t,e,r,n,i,a,o,s){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,r,n,i,a,o,s),this},absellipse:function(t,e,r,n,i,a,o,s){return t=new Wn(t,e,r,n,i,a,o,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return ii.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=ii.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return ii.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),oi.prototype=Hu(Uu(ai.prototype),{constructor:oi,getPointsHoles:function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ai.prototype.copy.call(this,t),this.holes=[];for(var e=0,r=t.holes.length;e<r;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=ai.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,r=this.holes.length;e<r;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){ai.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push((new ai).fromJSON(n))}return this}}),si.prototype=Hu(Uu(p.prototype),{constructor:si,isLight:!0,copy:function(t){return p.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return(t=p.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),li.prototype=Hu(Uu(si.prototype),{constructor:li,isHemisphereLight:!0,copy:function(t){return si.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Hu(ui.prototype,{_projScreenMatrix:new Ct,_lightPositionWorld:new Mt,_lookTarget:new Mt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,r=this.matrix,n=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),n.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(e.projectionMatrix),r.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ci.prototype=Hu(Uu(ui.prototype),{constructor:ci,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,r=2*Sa.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix()),ui.prototype.updateMatrices.call(this,t)}}),hi.prototype=Hu(Uu(si.prototype),{constructor:hi,isSpotLight:!0,copy:function(t){return si.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),di.prototype=Hu(Uu(ui.prototype),{constructor:di,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var r=this.camera,n=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),r.position.copy(i),a.copy(r.position),a.add(this._cubeDirections[e]),r.up.copy(this._cubeUps[e]),r.lookAt(a),r.updateMatrixWorld(),n.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),pi.prototype=Hu(Uu(si.prototype),{constructor:pi,isPointLight:!0,copy:function(t){return si.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),fi.prototype=Hu(Uu(V.prototype),{constructor:fi,isOrthographicCamera:!0,copy:function(t,e){return V.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Hu({},t.view),this},setViewOffset:function(t,e,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t;r+=t,t=n+e,e=n-e,null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,r=(i+=n*this.view.offsetX)+n*this.view.width,e=(t-=e*this.view.offsetY)-e*this.view.height),this.projectionMatrix.makeOrthographic(i,r,t,e,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=p.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Hu({},this.view)),t}}),mi.prototype=Hu(Uu(ui.prototype),{constructor:mi,isDirectionalLightShadow:!0,updateMatrices:function(t){ui.prototype.updateMatrices.call(this,t)}}),gi.prototype=Hu(Uu(si.prototype),{constructor:gi,isDirectionalLight:!0,copy:function(t){return si.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),vi.prototype=Hu(Uu(si.prototype),{constructor:vi,isAmbientLight:!0}),yi.prototype=Hu(Uu(si.prototype),{constructor:yi,isRectAreaLight:!0,copy:function(t){return si.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return(t=si.prototype.toJSON.call(this,t)).object.width=this.width,t.object.height=this.height,t}}),Hu(xi.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var r=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.282095),e.addScaledVector(i[1],.488603*n),e.addScaledVector(i[2],.488603*t),e.addScaledVector(i[3],.488603*r),e.addScaledVector(i[4],1.092548*r*n),e.addScaledVector(i[5],1.092548*n*t),e.addScaledVector(i[6],.315392*(3*t*t-1)),e.addScaledVector(i[7],1.092548*r*t),e.addScaledVector(i[8],.546274*(r*r-n*n)),e},getIrradianceAt:function(t,e){var r=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.886227),e.addScaledVector(i[1],1.023328*n),e.addScaledVector(i[2],1.023328*t),e.addScaledVector(i[3],1.023328*r),e.addScaledVector(i[4],.858086*r*n),e.addScaledVector(i[5],.858086*n*t),e.addScaledVector(i[6],.743125*t*t-.247708),e.addScaledVector(i[7],.858086*r*t),e.addScaledVector(i[8],.429043*(r*r-n*n)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var r=0;r<9;r++)this.coefficients[r].addScaledVector(t.coefficients[r],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var r=0;r<9;r++)this.coefficients[r].lerp(t.coefficients[r],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var r=this.coefficients,n=0;n<9;n++)r[n].fromArray(t,e+3*n);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var r=this.coefficients,n=0;n<9;n++)r[n].toArray(t,e+3*n);return t}}),Hu(xi,{getBasisAt:function(t,e){var r=t.x,n=t.y;t=t.z,e[0]=.282095,e[1]=.488603*n,e[2]=.488603*t,e[3]=.488603*r,e[4]=1.092548*r*n,e[5]=1.092548*n*t,e[6]=.315392*(3*t*t-1),e[7]=1.092548*r*t,e[8]=.546274*(r*r-n*n)}}),bi.prototype=Hu(Uu(si.prototype),{constructor:bi,isLightProbe:!0,copy:function(t){return si.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return(t=si.prototype.toJSON.call(this,t)).object.sh=this.sh.toArray(),t}}),_i.prototype=Hu(Uu(Fn.prototype),{constructor:_i,load:function(e,r,t,n){var i=this,a=new Bn(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){function e(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var r=this.textures,n=new _l[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.sheen&&(n.sheen=(new m).setHex(t.sheen)),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearcoat&&(n.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(n.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(n.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(n.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(n.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(n.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(n.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(n.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(n.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(n.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(n.morphNormals=t.morphNormals),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.vertexTangents&&(n.vertexTangents=t.vertexTangents),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.toneMapped&&(n.toneMapped=t.toneMapped),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.vertexColors&&(n.vertexColors="number"==typeof t.vertexColors?0<t.vertexColors:t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var a=t.uniforms[i];switch(n.uniforms[i]={},a.type){case"t":n.uniforms[i].value=e(a.value);break;case"c":n.uniforms[i].value=(new m).setHex(a.value);break;case"v2":n.uniforms[i].value=(new At).fromArray(a.value);break;case"v3":n.uniforms[i].value=(new Mt).fromArray(a.value);break;case"v4":n.uniforms[i].value=(new wt).fromArray(a.value);break;case"m3":n.uniforms[i].value=(new g).fromArray(a.value);case"m4":n.uniforms[i].value=(new Ct).fromArray(a.value);break;default:n.uniforms[i].value=a.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)n.extensions[o]=t.extensions[o];return void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=e(t.map)),void 0!==t.matcap&&(n.matcap=e(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=e(t.alphaMap)),void 0!==t.bumpMap&&(n.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=e(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale&&(i=t.normalScale,!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new At).fromArray(i)),void 0!==t.displacementMap&&(n.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=e(t.specularMap)),void 0!==t.envMap&&(n.envMap=e(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(n.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(n.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=e(t.gradientMap)),void 0!==t.clearcoatMap&&(n.clearcoatMap=e(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=e(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(n.clearcoatNormalMap=e(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(n.clearcoatNormalScale=(new At).fromArray(t.clearcoatNormalScale)),n},setTextures:function(t){return this.textures=t,this}});var Rl={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",r=0,n=t.length;r<n;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};Ai.prototype=Hu(Uu(F.prototype),{constructor:Ai,isInstancedBufferGeometry:!0,copy:function(t){return F.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=F.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),wi.prototype=Hu(Uu(S.prototype),{constructor:wi,isInstancedBufferAttribute:!0,copy:function(t){return S.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=S.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Mi.prototype=Hu(Uu(Fn.prototype),{constructor:Mi,load:function(e,r,t,n){var i=this,a=new Bn(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){var e,r=new(t.isInstancedBufferGeometry?Ai:F);for(e in void 0!==(l=t.data.index)&&(i=new Pl[l.type](l.array),r.setIndex(new S(i,1))),l=t.data.attributes){var n=l[e],i=new Pl[n.type](n.array);i=new(n.isInstancedBufferAttribute?wi:S)(i,n.itemSize,n.normalized),void 0!==n.name&&(i.name=n.name),r.setAttribute(e,i)}var a=t.data.morphAttributes;if(a)for(e in a){for(var o=a[e],s=[],l=0,u=o.length;l<u;l++)n=o[l],i=new S(i=new Pl[n.type](n.array),n.itemSize,n.normalized),void 0!==n.name&&(i.name=n.name),s.push(i);r.morphAttributes[e]=s}if(t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0),void 0!==(e=t.data.groups||t.data.drawcalls||t.data.offsets))for(l=0,n=e.length;l!==n;++l)i=e[l],r.addGroup(i.start,i.count,i.materialIndex);return void 0!==(l=t.data.boundingSphere)&&(e=new Mt,void 0!==l.center&&e.fromArray(l.center),r.boundingSphere=new c(e,l.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});var Pl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Ci.prototype=Hu(Uu(Fn.prototype),{constructor:Ci,load:function(r,n,t,i){var a=this,e=""===this.path?Rl.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||e,(e=new Bn(a.manager)).setPath(this.path),e.load(r,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+r+".",t.message)}void 0===(t=e.metadata)||void 0===t.type||"geometry"===t.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+r):a.parse(e,n)},t,i)},parse:function(t,e){var r=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,r),n=this.parseImages(t.images,function(){void 0!==e&&e(i)}),n=this.parseTextures(t.textures,n);n=this.parseMaterials(t.materials,n);var i=this.parseObject(t.object,r,n);return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(i),i},parseShape:function(t){var e={};if(void 0!==t)for(var r=0,n=t.length;r<n;r++){var i=(new oi).fromJSON(t[r]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var r={};if(void 0!==t)for(var n=new Mi,i=0,a=t.length;i<a;i++){var o=t[i];switch(o.type){case"PlaneGeometry":case"PlaneBufferGeometry":var s=new bl[o.type](o.width,o.height,o.widthSegments,o.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new bl[o.type](o.width,o.height,o.depth,o.widthSegments,o.heightSegments,o.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new bl[o.type](o.radius,o.segments,o.thetaStart,o.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new bl[o.type](o.radiusTop,o.radiusBottom,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new bl[o.type](o.radius,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new bl[o.type](o.radius,o.widthSegments,o.heightSegments,o.phiStart,o.phiLength,o.thetaStart,o.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new bl[o.type](o.radius,o.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new bl[o.type](o.innerRadius,o.outerRadius,o.thetaSegments,o.phiSegments,o.thetaStart,o.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new bl[o.type](o.radius,o.tube,o.radialSegments,o.tubularSegments,o.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new bl[o.type](o.radius,o.tube,o.tubularSegments,o.radialSegments,o.p,o.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new bl[o.type]((new Ll[o.path.type]).fromJSON(o.path),o.tubularSegments,o.radius,o.radialSegments,o.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new bl[o.type](o.points,o.segments,o.phiStart,o.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new bl[o.type](o.vertices,o.indices,o.radius,o.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var s=[],l=0,u=o.shapes.length;l<u;l++){var c=e[o.shapes[l]];s.push(c)}s=new bl[o.type](s,o.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(s=[],l=0,u=o.shapes.length;l<u;l++)c=e[o.shapes[l]],s.push(c);void 0!==(l=o.options.extrudePath)&&(o.options.extrudePath=(new Ll[l.type]).fromJSON(l)),s=new bl[o.type](s,o.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(o);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+o.type+'"');continue}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}return r},parseMaterials:function(t,e){var r={},n={};if(void 0!==t){var i=new _i;i.setTextures(e),e=0;for(var a=t.length;e<a;e++){var o=t[e];if("MultiMaterial"===o.type){for(var s=[],l=0;l<o.materials.length;l++){var u=o.materials[l];void 0===r[u.uuid]&&(r[u.uuid]=i.parse(u)),s.push(r[u.uuid])}n[o.uuid]=s}else void 0===r[o.uuid]&&(r[o.uuid]=i.parse(o)),n[o.uuid]=r[o.uuid]}}return n},parseAnimations:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],i=Pn.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),e.push(i)}return e},parseImages:function(t,e){function r(t){return n.manager.itemStart(t),a.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}var n=this,i={};if(void 0!==t&&0<t.length){var a=new kn(e=new On(e));a.setCrossOrigin(this.crossOrigin),e=0;for(var o=t.length;e<o;e++){var s=t[e],l=s.url;if(Array.isArray(l)){i[s.uuid]=[];for(var u=0,c=l.length;u<c;u++){var h=l[u],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;i[s.uuid].push(r(h))}}else h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.resourcePath+s.url,i[s.uuid]=r(h)}}return i},parseTextures:function(t,e){function r(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o=t[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new(Array.isArray(e[o.image])?J:d)(e[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=r(o.mapping,Dl)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=r(o.wrap[0],Ol),s.wrapT=r(o.wrap[1],Ol)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=r(o.minFilter,Fl)),void 0!==o.magFilter&&(s.magFilter=r(o.magFilter,Fl)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),n[o.uuid]=s}return n},parseObject:function(t,e,a){function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function n(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];void 0===a[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(a[i])}return e}return void 0===a[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),a[t]}}switch(t.type){case"Scene":var i=new Tt;void 0!==t.background&&Vu(t.background)&&(i.background=new m(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new Ne(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new Be(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new W(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Hu({},t.view));break;case"OrthographicCamera":i=new fi(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.view&&(i.view=Hu({},t.view));break;case"AmbientLight":i=new vi(t.color,t.intensity);break;case"DirectionalLight":i=new gi(t.color,t.intensity);break;case"PointLight":i=new pi(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new yi(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new hi(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new li(t.color,t.groundColor,t.intensity);break;case"LightProbe":i=(new bi).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var i=r(t.geometry),o=n(t.material);i=new B(i,o);break;case"InstancedMesh":i=r(t.geometry);var o=n(t.material),s=t.instanceMatrix;(i=new qe(i,o,t.count)).instanceMatrix=new S(new Float32Array(s.array),16);break;case"LOD":i=new Ve;break;case"Line":i=new Ze(r(t.geometry),n(t.material),t.mode);break;case"LineLoop":i=new Ke(r(t.geometry),n(t.material));break;case"LineSegments":i=new Je(r(t.geometry),n(t.material));break;case"PointCloud":case"Points":i=new $e(r(t.geometry),n(t.material));break;case"Sprite":i=new He(n(t.material));break;case"Group":i=new Re;break;default:i=new p}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(i.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.frustumCulled&&(i.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(i.renderOrder=t.renderOrder),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.layers&&(i.layers.mask=t.layers),void 0!==t.children)for(s=t.children,o=0;o<s.length;o++)i.add(this.parseObject(s[o],e,a));if("LOD"===t.type)for(void 0!==t.autoUpdate&&(i.autoUpdate=t.autoUpdate),t=t.levels,s=0;s<t.length;s++){o=t[s];var l=i.getObjectByProperty("uuid",o.object);void 0!==l&&i.addLevel(l,o.distance)}return i}});var Dl={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Ol={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Fl={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};Ti.prototype=Hu(Uu(Fn.prototype),{constructor:Ti,setOptions:function(t){return this.options=t,this},load:function(e,r,t,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=wl.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){r&&r(a),i.manager.itemEnd(e)},0),a;fetch(e).then(function(t){return t.blob()}).then(function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)}).then(function(t){wl.add(e,t),r&&r(t),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}}),Hu(Si.prototype,{moveTo:function(t,e){return this.currentPath=new ai,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,r,n){return this.currentPath.quadraticCurveTo(t,e,r,n),this},bezierCurveTo:function(t,e,r,n,i,a){return this.currentPath.bezierCurveTo(t,e,r,n,i,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],a=new oi;a.curves=i.curves,e.push(a)}return e}var n=yl.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===e)return r(i);if(e=[],1===i.length){var a=i[0],o=new oi;return o.curves=a.curves,e.push(o),e}var s=!n(i[0].getPoints()),s=t?!s:s,o=[],l=[],u=[],c=0;l[c]=void 0,u[c]=[];for(var h=0,d=i.length;h<d;h++){var p=(a=i[h]).getPoints(),f=n(p);(f=t?!f:f)?(!s&&l[c]&&c++,l[c]={s:new oi,p:p},l[c].s.curves=a.curves,s&&c++,u[c]=[]):u[c].push({h:a,p:p[0]})}if(!l[0])return r(i);if(1<l.length){for(h=!1,t=[],n=0,i=l.length;n<i;n++)o[n]=[];for(n=0,i=l.length;n<i;n++)for(a=u[n],f=0;f<a.length;f++){for(s=a[f],c=!0,p=0;p<l.length;p++)!function(t,e){for(var r=e.length,n=!1,i=r-1,a=0;a<r;i=a++){var o=e[i],s=e[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Wu){if(u<0&&(o=e[a],l=-l,s=e[i],u=-u),!(t.y<o.y||t.y>s.y))if(t.y===o.y){if(t.x===o.x)return 1}else{if(0===(i=u*(t.x-o.x)-l*(t.y-o.y)))return 1;i<0||(n=!n)}}else if(t.y===o.y&&(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x))return 1}return n}(s.p,l[p].p)||(n!==p&&t.push({froms:n,tos:p,hole:f}),c?(c=!1,o[p].push(s)):h=!0);c&&o[n].push(s)}0<t.length&&(h||(u=o))}for(h=0,n=l.length;h<n;h++)for(o=l[h].s,e.push(o),i=0,a=(t=u[h]).length;i<a;i++)o.holes.push(t[i].h);return e}}),Hu(Ei.prototype,{isFont:!0,generateShapes:function(t,e){var r=[],n=e=void 0===e?100:e;e=this.data;var i=Ru?Ru(t):String(t).split("");n/=e.resolution;var a=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*n;t=[];for(var o=0,s=0,l=0;l<i.length;l++)if("\n"===(c=i[l]))o=0,s-=a;else{var u=c,c=n,h=o,d=s,p=(f=e).glyphs[u]||f.glyphs["?"];if(p){if(u=new Si,p.o)for(var f,m=0,g=(f=p._cachedOutline||(p._cachedOutline=p.o.split(" "))).length;m<g;)switch(f[m++]){case"m":var v=f[m++]*c+h,y=f[m++]*c+d;u.moveTo(v,y);break;case"l":v=f[m++]*c+h,y=f[m++]*c+d,u.lineTo(v,y);break;case"q":var x=f[m++]*c+h,b=f[m++]*c+d,_=f[m++]*c+h,A=f[m++]*c+d;u.quadraticCurveTo(_,A,x,b);break;case"b":x=f[m++]*c+h,b=f[m++]*c+d,_=f[m++]*c+h,A=f[m++]*c+d,v=f[m++]*c+h,y=f[m++]*c+d,u.bezierCurveTo(_,A,v,y,x,b)}c={offsetX:p.ha*c,path:u}}else console.error('THREE.Font: character "'+u+'" does not exists in font family '+f.familyName+"."),c=void 0;o+=c.offsetX,t.push(c.path)}for(e=0,i=t.length;e<i;e++)Array.prototype.push.apply(r,t[e].toShapes());return r}}),Ii.prototype=Hu(Uu(Fn.prototype),{constructor:Ii,load:function(t,n,e,r){var i=this,a=new Bn(this.manager);a.setPath(this.path),a.load(t,function(e){try{var r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}e=i.parse(r),n&&n(e)},e,r)},parse:function(t){return new Ei(t)}});var Bl,Nl={getContext:function(){return Bl=void 0===Bl?new(window.AudioContext||window.webkitAudioContext):Bl},setContext:function(t){Bl=t}};Li.prototype=Hu(Uu(Fn.prototype),{constructor:Li,load:function(r,n,t,i){var a=this,e=new Bn(a.manager);e.setResponseType("arraybuffer"),e.setPath(a.path),e.load(r,function(t){try{var e=t.slice(0);Nl.getContext().decodeAudioData(e,function(t){n(t)})}catch(t){i?i(t):console.error(t),a.manager.itemError(r)}},t,i)}}),Ri.prototype=Hu(Uu(bi.prototype),{constructor:Ri,isHemisphereLightProbe:!0,copy:function(t){return bi.prototype.copy.call(this,t),this},toJSON:function(t){return bi.prototype.toJSON.call(this,t)}}),Pi.prototype=Hu(Uu(bi.prototype),{constructor:Pi,isAmbientLightProbe:!0,copy:function(t){return bi.prototype.copy.call(this,t),this},toJSON:function(t){return bi.prototype.toJSON.call(this,t)}});var zl=new Ct,Ul=new Ct;Hu(Di.prototype,{update:function(t){var e,r,n,i,a,o=this._cache;o.focus===t.focus&&o.fov===t.fov&&o.aspect===t.aspect*this.aspect&&o.near===t.near&&o.far===t.far&&o.zoom===t.zoom&&o.eyeSep===this.eyeSep||(o.focus=t.focus,o.fov=t.fov,o.aspect=t.aspect*this.aspect,o.near=t.near,o.far=t.far,o.zoom=t.zoom,o.eyeSep=this.eyeSep,e=t.projectionMatrix.clone(),r=(i=o.eyeSep/2)*o.near/o.focus,n=o.near*Math.tan(Sa.DEG2RAD*o.fov*.5)/o.zoom,Ul.elements[12]=-i,zl.elements[12]=i,i=-n*o.aspect+r,a=n*o.aspect+r,e.elements[0]=2*o.near/(a-i),e.elements[8]=(a+i)/(a-i),this.cameraL.projectionMatrix.copy(e),i=-n*o.aspect-r,a=n*o.aspect-r,e.elements[0]=2*o.near/(a-i),e.elements[8]=(a+i)/(a-i),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Ul),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(zl)}}),Hu(Oi.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}});var kl=new Mt,Hl=new f,Gl=new Mt,Vl=new Mt;Fi.prototype=Hu(Uu(p.prototype),{constructor:Fi,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){p.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var e,r=this.up;this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(kl,Hl,Gl),Vl.set(0,0,-1).applyQuaternion(Hl),t.positionX?(e=this.context.currentTime+this.timeDelta,t.positionX.linearRampToValueAtTime(kl.x,e),t.positionY.linearRampToValueAtTime(kl.y,e),t.positionZ.linearRampToValueAtTime(kl.z,e),t.forwardX.linearRampToValueAtTime(Vl.x,e),t.forwardY.linearRampToValueAtTime(Vl.y,e),t.forwardZ.linearRampToValueAtTime(Vl.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)):(t.setPosition(kl.x,kl.y,kl.z),t.setOrientation(Vl.x,Vl.y,Vl.z,r.x,r.y,r.z))}}),Bi.prototype=Hu(Uu(p.prototype),{constructor:Bi,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+t,(t=this.context.createBufferSource()).buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t=t||[],!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Wl=new Mt,jl=new f,Xl=new Mt,ql=new Mt;Ni.prototype=Hu(Uu(Bi.prototype),{constructor:Ni,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,r){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(t){var e;p.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(Wl,jl,Xl),ql.set(0,0,1).applyQuaternion(jl),(t=this.panner).positionX?(e=this.context.currentTime+this.listener.timeDelta,t.positionX.linearRampToValueAtTime(Wl.x,e),t.positionY.linearRampToValueAtTime(Wl.y,e),t.positionZ.linearRampToValueAtTime(Wl.z,e),t.orientationX.linearRampToValueAtTime(ql.x,e),t.orientationY.linearRampToValueAtTime(ql.y,e),t.orientationZ.linearRampToValueAtTime(ql.z,e)):(t.setPosition(Wl.x,Wl.y,Wl.z),t.setOrientation(ql.x,ql.y,ql.z)))}}),Hu(zi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),r=0;r<e.length;r++)t+=e[r];return t/e.length}}),Hu(Ui.prototype,{accumulate:function(t,e){var r=this.buffer,n=this.valueSize;t=t*n+n;var i=this.cumulativeWeight;if(0===i){for(i=0;i!==n;++i)r[t+i]=r[i];i=e}else i+=e,this._mixBufferRegion(r,t,0,e/i,n);this.cumulativeWeight=i},accumulateAdditive:function(t){var e=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,r),this.cumulativeWeightAdditive+=t},apply:function(t){var e=this.valueSize,r=this.buffer;t=t*e+e;var n=this.cumulativeWeight,i=this.cumulativeWeightAdditive,a=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,n<1&&this._mixBufferRegion(r,t,e*this._origIndex,1-n,e),0<i&&this._mixBufferRegionAdditive(r,t,this._addIndex*e,1,e),i=(n=e)+e;n!==i;++n)if(r[n]!==r[n+e]){a.setValue(r,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,r=e*this._origIndex;this.binding.getValue(t,r);for(var n=e;n!==r;++n)t[n]=t[r+n%e];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,e=t+this.valueSize;t<e;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[e+r]=this.buffer[t+r]},_select:function(t,e,r,n,i){if(.5<=n)for(n=0;n!==i;++n)t[e+n]=t[r+n]},_slerp:function(t,e,r,n){f.slerpFlat(t,e,t,e,t,r,n)},_slerpAdditive:function(t,e,r,n,i){i*=this._workIndex,f.multiplyQuaternionsFlat(t,i,t,e,t,r),f.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,r,n,i){for(var a=1-n,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[r+o]*n}},_lerpAdditive:function(t,e,r,n,i){for(var a=0;a!==i;++a)t[e+a]+=t[r+a]*n}});var Yl=/[\[\]\.:\/]/g,Zl="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Jl=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Kl=/(WCOD+)?/.source.replace("WCOD",Zl),Ql=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Zl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),$l=new RegExp("^"+Jl+Kl+Ql+Zl+"$"),tu=["material","materials","bones"];Hu(ki.prototype,{getValue:function(t,e){this.bind();var r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Hu(Hi,{Composite:ki,create:function(t,e,r){return new(t&&t.isAnimationObjectGroup?Hi.Composite:Hi)(t,e,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Yl,"")},parseTrackName:function(t){var e=$l.exec(t);if(!e)throw Error("PropertyBinding: Cannot parse trackName: "+t);var r,n=(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]}).nodeName&&e.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n&&(r=e.nodeName.substring(n+1),-1!==tu.indexOf(r)&&(e.nodeName=e.nodeName.substring(0,n),e.objectName=r)),null===e.propertyName||0===e.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e},findNode:function(t,i){if(!i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(i);if(void 0!==e)return e}return t.children&&(t=function t(e){for(var r=0;r<e.length;r++){var n=e[r];if(n.name===i||n.uuid===i||(n=t(n.children)))return n}return null}(t.children))?t:null}}),Hu(Hi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,r=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(this.node=t=Hi.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var a=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,r=0;r<t.length;r++)if(t[r].name===a){a=r;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}if(void 0===(a=t[n]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+n+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==(this.targetObject=t).needsUpdate?e=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate),r=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}r=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(r=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(r=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[r],this.setValue=this.SetterByBindingTypeAndVersioning[r][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Hu(Hi.prototype,{_getValue_unbound:Hi.prototype.getValue,_setValue_unbound:Hi.prototype.setValue}),Hu(Gi.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=n[p=h.uuid];if(void 0===d){d=e++,n[p]=d,t.push(h);for(var p=0,f=s;p!==f;++p)o[p].push(new Hi(h,i[p],a[p]))}else if(d<r){var l=t[d],m=--r;for(t[n[(f=t[m]).uuid]=d]=f,t[n[p]=m]=h,p=0,f=s;p!==f;++p){var g=o[p],v=g[d];g[d]=g[m],void 0===v&&(v=new Hi(h,i[p],a[p])),g[m]=v}}else t[d]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=r[l];if(void 0!==u&&e<=u){var c=e++;for(t[r[(h=t[c]).uuid]=u]=h,t[r[l]=c]=s,s=0,l=i;s!==l;++s){var h,d=(h=n[s])[u];h[u]=h[c],h[c]=d}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var l=n[u=arguments[o].uuid];if(void 0!==l)if(delete n[u],l<r){var u,c=t[u=--r],h=--e,d=t[h];for(t[n[c.uuid]=l]=c,t[n[d.uuid]=u]=d,t.pop(),c=0,d=a;c!==d;++c){var p=i[c],f=p[h];p[l]=p[u],p[u]=f,p.pop()}}else for(t[n[(d=t[h=--e]).uuid]=l]=d,t.pop(),c=0,d=a;c!==d;++c)(p=i[c])[l]=p[h],p.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var r=this._bindingsIndicesByPath,n=r[t],i=this._bindings;if(void 0!==n)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,l=this.nCachedObjects_,u=Array(s.length),n=i.length;for(r[t]=n,a.push(t),o.push(e),i.push(u),r=l,n=s.length;r!==n;++r)u[r]=new Hi(s[r],t,e);return u},unsubscribe_:function(t){var e,r,n,i,a,o=this._bindingsIndicesByPath,s=o[t];void 0!==s&&(e=this._paths,r=this._parsedPaths,a=(n=this._bindings)[i=n.length-1],n[o[t[i]]=s]=a,n.pop(),r[s]=r[i],r.pop(),e[s]=e[i],e.pop())}}),Hu(Vi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,r){var n,i;return t.fadeOut(e),this.fadeIn(e),r&&(i=(r=this._clip.duration)/(n=t._clip.duration),t.warp(1,n/r,e),this.warp(i,1,e)),this},crossFadeTo:function(t,e,r){return t.crossFadeFrom(this,e,r)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,r){var n=this._mixer,i=n.time,a=this._timeScaleInterpolant,o=this.timeScale;return null===a&&(this._timeScaleInterpolant=a=n._lendControlInterpolant()),n=a.parameterPositions,a=a.sampleValues,n[0]=i,n[1]=i+r,a[0]=t/o,a[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,r,n){if(this.enabled){var i=this._startTime;if(null!==i){if((e=(t-i)*r)<0||0===r)return;this._startTime=null,e*=r}if(e*=this._updateTimeScale(t),r=this._updateTime(e),0<(t=this._updateWeight(t)))if(2501===(e=this._interpolants,i=this._propertyBindings,this.blendMode))for(var a=0,o=e.length;a!==o;++a)e[a].evaluate(r),i[a].accumulateAdditive(t);else for(a=0,o=e.length;a!==o;++a)e[a].evaluate(r),i[a].accumulate(n,t)}else this._updateWeight(t)},_updateWeight:function(t){var e,r,n=0;return this.enabled&&(n=this.weight,null!==(e=this._weightInterpolant)&&(n*=r=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1)))),this._effectiveWeight=n},_updateTimeScale:function(t){var e,r=0;return this.paused||(r=this.timeScale,null!==(e=this._timeScaleInterpolant)&&(r*=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopWarping(),0===r?this.paused=!0:this.timeScale=r))),this._effectiveTimeScale=r},_updateTime:function(t){var e,r=this.time+t,n=this._clip.duration,i=this.loop,a=this._loopCount,o=2202===i;if(0===t)return-1!==a&&o&&1==(1&a)?n-r:r;if(2200===i)t:{if(-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1)),n<=r)r=n;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}else if(-1===a&&(0<=t?(a=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),n<=r||r<0?(r-=n*(i=Math.floor(r/n)),a+=Math.abs(i),(e=this.repetitions-a)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1==e?(t=t<0,this._setEndings(t,!t,o)):this._setEndings(!1,!1,o),this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i}))):this.time=r,o&&1==(1&a))return n-r;return r},_setEndings:function(t,e,r){var n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;return null===a&&(this._weightInterpolant=a=n._lendControlInterpolant()),n=a.parameterPositions,a=a.sampleValues,n[0]=i,a[0]=e,n[1]=i+t,a[1]=r,this}}),Wi.prototype=Hu(Uu(e.prototype),{constructor:Wi,_bindAction:function(t,e){var r=t._localRoot||this._root,n=t._clip.tracks,i=n.length,a=t._propertyBindings;t=t._interpolants;var o=r.uuid,s=this._bindingsByRootAndName,l=s[o];for(void 0===l&&(l={},s[o]=l),s=0;s!==i;++s){var u=n[s],c=u.name,h=l[c];if(void 0===h){if(void 0!==(h=a[s])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,o,c));continue}++(h=new Ui(Hi.create(r,c,e&&e._propertyBindings[s].binding.parsedPath),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(h,o,c)}a[s]=h,t[s].resultBuffer=h.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){var e,r,n;for(null===t._cacheIndex&&(e=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r],this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,e)),r=0,n=(e=t._propertyBindings).length;r!==n;++r){var i=e[r];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,r){var n=this._actions,i=this._actionsByClip,a=i[e];void 0===a?(a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a):(e=a.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),a.actionByRoot[r]=t},_removeInactiveAction:function(t){var e=(n=this._actions)[n.length-1],r=t._cacheIndex;n[e._cacheIndex=r]=e,n.pop(),t._cacheIndex=null;var n=t._clip.uuid,i=(r=(e=this._actionsByClip)[n]).knownActions,a=i[i.length-1],o=t._byClipCacheIndex;i[a._byClipCacheIndex=o]=a,i.pop(),t._byClipCacheIndex=null,delete r.actionByRoot[(t._localRoot||this._root).uuid],0===i.length&&delete e[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,r=(t=t._propertyBindings).length;e!==r;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,r=t._cacheIndex,n=this._nActiveActions++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_takeBackAction:function(t){var e=this._actions,r=t._cacheIndex,n=--this._nActiveActions,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_addInactiveBinding:function(t,e,r){var n=this._bindingsByRootAndName,i=n[e],a=this._bindings;void 0===i&&(i={},n[e]=i),(i[r]=t)._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,r=(n=t.binding).rootNode.uuid,n=n.path,i=this._bindingsByRootAndName,a=i[r],o=e[e.length-1];t=t._cacheIndex,e[o._cacheIndex=t]=o,e.pop(),delete a[n],0===Nu(a).length&&delete i[r]},_lendBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_takeBackBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&(t[(r=new An(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=r),r},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];e[t.__cacheIndex=n]=t,e[i.__cacheIndex=r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,r){var n=e||this._root,i=n.uuid;t=null!==(n="string"==typeof t?Pn.findByName(n,t):t)?n.uuid:t;var a=this._actionsByClip[t],o=null;if(void 0===r&&(r=null!==n?n.blendMode:2500),void 0!==a){if(void 0!==(o=a.actionByRoot[i])&&o.blendMode===r)return o;o=a.knownActions[0],null===n&&(n=o._clip)}return null===n?null:(e=new Vi(this,n,e,r),this._bindAction(e,o),this._addInactiveAction(e,t,i),e)},existingAction:function(t,e){var r=e||this._root;return e=r.uuid,r="string"==typeof t?Pn.findByName(r,t):t,void 0!==(t=this._actionsByClip[r?r.uuid:t])&&t.actionByRoot[e]||null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions-1;0<=e;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,n=this.time+=t,i=Gu(t),a=this._accuIndex^=1,o=0;o!==r;++o)e[o]._update(n,t,i,a);for(t=this._bindings,e=this._nActiveBindings,o=0;o!==e;++o)t[o].apply(a);return this},setTime:function(t){for(var e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var r=this._actionsByClip;if(void 0!==(n=r[t])){for(var n,i=0,a=(n=n.knownActions).length;i!==a;++i){var o=n[i];this._deactivateAction(o);var s=o._cacheIndex,l=e[e.length-1];o._cacheIndex=null,o._byClipCacheIndex=null,e[l._cacheIndex=s]=l,e.pop(),this._removeInactiveBindingsForAction(o)}delete r[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(n in e){var r=e[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var i in n)t=n[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),ji.prototype.clone=function(){return new ji(void 0===this.value.clone?this.value:this.value.clone())},Xi.prototype=Hu(Uu(ze.prototype),{constructor:Xi,isInstancedInterleavedBuffer:!0,copy:function(t){return ze.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Hu(qi.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,r){return Zi(t,this,r=r||[],e),r.sort(Yi),r},intersectObjects:function(t,e,r){if(r=r||[],!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,i=t.length;n<i;n++)Zi(t[n],this,r,e);return r.sort(Yi),r}}),Hu(Ji.prototype,{set:function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,r){return this.radius=Math.sqrt(t*t+e*e+r*r),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t,r),this.phi=Math.acos(Sa.clamp(e/this.radius,-1,1))),this}}),Hu(Ki.prototype,{set:function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,r){return this.radius=Math.sqrt(t*t+r*r),this.theta=Math.atan2(t,r),this.y=e,this}});var eu=new At;Hu(Qi.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=eu.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new At),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new At),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new At),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new At),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return eu.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var ru=new Mt,nu=new Mt;Hu($i.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Mt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Mt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Mt),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){return ru.subVectors(t,this.start),nu.subVectors(this.end,this.start),t=nu.dot(nu),t=nu.dot(ru)/t,t=e?Sa.clamp(t,0,1):t},closestPointToPoint:function(t,e,r){return t=this.closestPointToPointParameter(t,e),void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Mt),this.delta(r).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),((ta.prototype=Uu(p.prototype)).constructor=ta).prototype.isImmediateRenderObject=!0;var iu=new Mt;((ea.prototype=Uu(p.prototype)).constructor=ea).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ea.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance||1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),iu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(iu),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var au=new Mt,ou=new Ct,su=new Ct;((ra.prototype=Uu(Je.prototype)).constructor=ra).prototype.isSkeletonHelper=!0,ra.prototype.updateMatrixWorld=function(t){var e=this.bones,r=this.geometry,n=r.getAttribute("position");su.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<e.length;i++){var o=e[i];o.parent&&o.parent.isBone&&(ou.multiplyMatrices(su,o.matrixWorld),au.setFromMatrixPosition(ou),n.setXYZ(a,au.x,au.y,au.z),ou.multiplyMatrices(su,o.parent.matrixWorld),au.setFromMatrixPosition(ou),n.setXYZ(a+1,au.x,au.y,au.z),a+=2)}r.getAttribute("position").needsUpdate=!0,p.prototype.updateMatrixWorld.call(this,t)},((na.prototype=Uu(B.prototype)).constructor=na).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},na.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var lu=new Mt,uu=new m,cu=new m;((ia.prototype=Uu(p.prototype)).constructor=ia).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ia.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");uu.copy(this.light.color),cu.copy(this.light.groundColor);for(var r=0,n=e.count;r<n;r++){var i=r<n/2?uu:cu;e.setXYZ(r,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(lu.setFromMatrixPosition(this.light.matrixWorld).negate())},aa.prototype=Hu(Uu(Je.prototype),{constructor:aa,copy:function(t){return Je.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),(oa.prototype=Uu(Je.prototype)).constructor=oa;var hu=new Mt,du=new Mt,pu=new Mt;((sa.prototype=Uu(p.prototype)).constructor=sa).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},sa.prototype.update=function(){hu.setFromMatrixPosition(this.light.matrixWorld),du.setFromMatrixPosition(this.light.target.matrixWorld),pu.subVectors(du,hu),this.lightPlane.lookAt(du),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(du),this.targetLine.scale.z=pu.length()};var fu=new Mt,mu=new V;((la.prototype=Uu(Je.prototype)).constructor=la).prototype.update=function(){var t=this.geometry,e=this.pointMap;mu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ua("c",e,t,mu,0,0,-1),ua("t",e,t,mu,0,0,1),ua("n1",e,t,mu,-1,-1,-1),ua("n2",e,t,mu,1,-1,-1),ua("n3",e,t,mu,-1,1,-1),ua("n4",e,t,mu,1,1,-1),ua("f1",e,t,mu,-1,-1,1),ua("f2",e,t,mu,1,-1,1),ua("f3",e,t,mu,-1,1,1),ua("f4",e,t,mu,1,1,1),ua("u1",e,t,mu,.7,1.1,-1),ua("u2",e,t,mu,-.7,1.1,-1),ua("u3",e,t,mu,0,2,-1),ua("cf1",e,t,mu,-1,0,1),ua("cf2",e,t,mu,1,0,1),ua("cf3",e,t,mu,0,-1,1),ua("cf4",e,t,mu,0,1,1),ua("cn1",e,t,mu,-1,0,-1),ua("cn2",e,t,mu,1,0,-1),ua("cn3",e,t,mu,0,-1,-1),ua("cn4",e,t,mu,0,1,-1),t.getAttribute("position").needsUpdate=!0};var gu=new n;((ca.prototype=Uu(Je.prototype)).constructor=ca).prototype.update=function(t){var e,r,n;void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&gu.setFromObject(this.object),gu.isEmpty()||(t=gu.min,e=gu.max,(n=(r=this.geometry.attributes.position).array)[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=t.x,n[4]=e.y,n[5]=e.z,n[6]=t.x,n[7]=t.y,n[8]=e.z,n[9]=e.x,n[10]=t.y,n[11]=e.z,n[12]=e.x,n[13]=e.y,n[14]=t.z,n[15]=t.x,n[16]=e.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=e.x,n[22]=t.y,n[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere())},ca.prototype.setFromObject=function(t){return this.object=t,this.update(),this},ca.prototype.copy=function(t){return Je.prototype.copy.call(this,t),this.object=t.object,this},ca.prototype.clone=function(){return(new this.constructor).copy(this)},((ha.prototype=Uu(Je.prototype)).constructor=ha).prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),p.prototype.updateMatrixWorld.call(this,t))},((da.prototype=Uu(Ze.prototype)).constructor=da).prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),p.prototype.updateMatrixWorld.call(this,t)};var vu,yu,xu=new Mt;((pa.prototype=Uu(p.prototype)).constructor=pa).prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(xu.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(xu,Math.acos(t.y)))},pa.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},pa.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},pa.prototype.copy=function(t){return p.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},pa.prototype.clone=function(){return(new this.constructor).copy(this)},(fa.prototype=Uu(Je.prototype)).constructor=fa;var bu=Math.pow(2,8),_u=[.125,.215,.35,.446,.526,.582],Au=5+_u.length,wu={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},Mu=new fi,Cu=(Ql=function(){for(var t=[],e=[],r=[],n=8,i=0;i<Au;i++){var a=Math.pow(2,n);e.push(a);var o=1/a;4<i?o=_u[i-8+4-1]:0==i&&(o=0),r.push(o);var s=[a=-(o=1/(a-1))/2,a,o=1+o/2,a,o,o,a,a,o,o,a,o];a=new Float32Array(108),o=new Float32Array(72);for(var l=new Float32Array(36),u=0;u<6;u++){var c=u%3*2/3-1,h=2<u?0:-1;a.set([c,h,0,c+2/3,h,0,c+2/3,1+h,0,c,h,0,c+2/3,1+h,0,c,1+h,0],18*u),o.set(s,12*u),l.set([u,u,u,u,u,u],6*u)}(s=new F).setAttribute("position",new S(a,3)),s.setAttribute("uv",new S(o,2)),s.setAttribute("faceIndex",new S(l,1)),t.push(s),4<n&&n--}return{_lodPlanes:t,_sizeLods:e,_sigmas:r}}())._lodPlanes,Tu=Ql._sizeLods,Su=Ql._sigmas,Eu=null,Ql=1/(Zl=(1+Math.sqrt(5))/2),Iu=[new Mt(1,1,1),new Mt(-1,1,1),new Mt(1,1,-1),new Mt(-1,1,-1),new Mt(0,Zl,Ql),new Mt(0,Zl,-Ql),new Mt(Ql,0,Zl),new Mt(-Ql,0,Zl),new Mt(Zl,Ql,0),new Mt(-Zl,Ql,0)];ma.prototype={constructor:ma,fromScene:function(t,e,r,n){void 0===e&&(e=0),void 0===r&&(r=.1),void 0===n&&(n=100),Eu=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(t,r,n,i),0<e&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},fromEquirectangular:function(t){return t.magFilter=1003,t.minFilter=1003,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){Eu=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=xa(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=ya(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<Cu.length;t++)Cu[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Eu),t.scissorTest=!1,t.setSize(t.width,t.height)},_allocateTargets:function(t){var e=void 0!==t&&1009===t.type&&(3e3===t.encoding||3001===t.encoding||3007===t.encoding),r=ga(e={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:e?t.encoding:3002,depthBuffer:!1,stencilBuffer:!1});return r.depthBuffer=!t,this._pingPongRenderTarget=ga(e),r},_compileMaterial:function(t){t=new B(Cu[0],t),this._renderer.compile(t,Mu)},_sceneToCubeUV:function(t,e,r,n){e=new W(90,1,e,r),r=[1,-1,1,1,1,1];var i=[1,1,1,-1,-1,-1],a=this._renderer,o=a.outputEncoding,s=a.toneMapping,l=a.toneMappingExposure,u=a.getClearColor(),c=a.getClearAlpha();a.toneMapping=1,a.toneMappingExposure=1,a.outputEncoding=3e3;var h,d=t.background;for(d&&d.isColor&&(d.convertSRGBToLinear(),h=Math.min(Math.max(Math.ceil(Lu(Math.max(d.r,d.g,d.b))),-128),127),d=d.multiplyScalar(Math.pow(2,-h)),a.setClearColor(d,(h+128)/255),t.background=null),d=0;d<6;d++)0==(h=d%3)?(e.up.set(0,r[d],0),e.lookAt(i[d],0,0)):1==h?(e.up.set(0,0,r[d]),e.lookAt(0,i[d],0)):(e.up.set(0,r[d],0),e.lookAt(0,0,i[d])),va(n,h*bu,2<d?bu:0,bu,bu),a.setRenderTarget(n),a.render(t,e);a.toneMapping=s,a.toneMappingExposure=l,a.outputEncoding=o,a.setClearColor(u,c)},_textureToCubeUV:function(t,e){var r=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=xa()):null==this._equirectShader&&(this._equirectShader=ya());var n=t.isCubeTexture?this._cubemapShader:this._equirectShader,i=new B(Cu[0],n);((n=n.uniforms).envMap.value=t).isCubeTexture||n.texelSize.value.set(1/t.image.width,1/t.image.height),n.inputEncoding.value=wu[t.encoding],n.outputEncoding.value=wu[e.texture.encoding],va(e,0,0,3*bu,2*bu),r.setRenderTarget(e),r.render(i,Mu)},_applyPMREM:function(t){var e=this._renderer,r=e.autoClear;e.autoClear=!1;for(var n=1;n<Au;n++)this._blur(t,n-1,n,Math.sqrt(Su[n]*Su[n]-Su[n-1]*Su[n-1]),Iu[(n-1)%Iu.length]);e.autoClear=r},_blur:function(t,e,r,n,i){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,r,n,"latitudinal",i),this._halfBlur(a,t,r,r,n,"longitudinal",i)},_halfBlur:function(t,e,r,n,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new B(Cu[n],l),l=l.uniforms,c=Tu[r]-1,h=i/(c=isFinite(i)?Math.PI/(2*c):2*Math.PI/39),d=isFinite(i)?1+Math.floor(3*h):20;20<d&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+d+" samples when the maximum is set to 20"),i=[];for(var p=0,f=0;f<20;++f){var m=f/h,m=Math.exp(-m*m/2);i.push(m),0==f?p+=m:f<d&&(p+=2*m)}for(f=0;f<i.length;f++)i[f]/=p;l.envMap.value=t.texture,l.samples.value=d,l.weights.value=i,l.latitudinal.value="latitudinal"===a,o&&(l.poleAxis.value=o),l.dTheta.value=c,l.mipInt.value=8-r,l.inputEncoding.value=wu[t.texture.encoding],l.outputEncoding.value=wu[t.texture.encoding],t=Tu[n],va(e,m=3*Math.max(0,bu-2*t),(0===n?0:2*bu)+2*t*(4<n?n-8+4:0),3*t,2*t),s.setRenderTarget(e),s.render(u,Mu)}},Vn.create=function(t,e){return t.prototype=Uu(Vn.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Hu(ii.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new U,r=0,n=t.length;r<n;r++){var i=t[r];e.vertices.push(new Mt(i.x,i.y,i.z||0))}return e}}),Hu(ai.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Aa.prototype=Uu(qn.prototype),wa.prototype=Uu(qn.prototype),Ma.prototype=Uu(qn.prototype),Hu(Ma.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),aa.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ra.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Hu(Fn.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Rl.extractUrlBase(t)}}),Fn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Hu(Ci.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Hu(Qi.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Hu(n.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Hu(c.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Et.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},$i.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Hu(Sa,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Sa.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Sa.ceilPowerOfTwo(t)}}),Hu(g.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Hu(Ct.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Mt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,r,i,a)}}),v.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},f.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Hu(s.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Hu(b.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Hu(b,{barycoordFromPoint:function(t,e,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),b.getBarycoord(t,e,r,n,i)},normal:function(t,e,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),b.getNormal(t,e,r,n)}}),Hu(oi.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Gr(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new $r(this,t)}}),Hu(At.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(Mt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(wt.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(U.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Hu(p.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ku(p.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Hu(B.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),ku(B.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ku(Ve.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(je.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),We.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Vn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),W.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},ku(si.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),ku(S.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Hu(S.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Hu(F.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e,r){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new S(e,r)))},addDrawCall:function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ku(F.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ku(Ai.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),ku(qi.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),ku(ze.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Hu(ze.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Hu(Vr.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),ku(ji.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),ku(x.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new m}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),ku(fn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),ku(G.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Hu(Fe.prototype,{clearTarget:function(t,e,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,r,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),ku(Fe.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}}}),ku(Te.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),ku(T.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),ku(Bi.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Li).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),zi.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},j.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},Ia.crossOrigin=void 0,Ia.loadTexture=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Gn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,r,void 0,n),e&&(t.mapping=e),t},Ia.loadTextureCube=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Hn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,r,void 0,n),e&&(t.mapping=e),t},Ia.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ia.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}})),t.ACESFilmicToneMapping=5,t.AddEquation=100,t.AddOperation=2,t.AdditiveAnimationBlendMode=2501,t.AdditiveBlending=2,t.AlphaFormat=1021,t.AlwaysDepth=1,t.AlwaysStencilFunc=519,t.AmbientLight=vi,t.AmbientLightProbe=Pi,t.AnimationClip=Pn,t.AnimationLoader=Nn,t.AnimationMixer=Wi,t.AnimationObjectGroup=Gi,t.AnimationUtils=Al,t.ArcCurve=jn,t.ArrayCamera=Le,t.ArrowHelper=pa,t.Audio=Bi,t.AudioAnalyser=zi,t.AudioContext=Nl,t.AudioListener=Fi,t.AudioLoader=Li,t.AxesHelper=fa,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new fa(t)},t.BackSide=1,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Un(t)},t.Bone=Xe,t.BooleanKeyframeTrack=Cn,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ca(t,e)},t.Box2=Qi,t.Box3=n,t.Box3Helper=ha,t.BoxBufferGeometry=gs,t.BoxGeometry=ms,t.BoxHelper=ca,t.BufferAttribute=S,t.BufferGeometry=F,t.BufferGeometryLoader=Mi,t.ByteType=1010,t.Cache=wl,t.Camera=V,t.CameraHelper=la,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=nr,t.CatmullRomCurve3=qn,t.CineonToneMapping=4,t.CircleBufferGeometry=un,t.CircleGeometry=ln,t.ClampToEdgeWrapping=1001,t.Clock=Oi,t.ClosedSplineCurve3=Aa,t.Color=m,t.ColorKeyframeTrack=Tn,t.CompressedTexture=rr,t.CompressedTextureLoader=zn,t.ConeBufferGeometry=sn,t.ConeGeometry=on,t.CubeCamera=j,t.CubeGeometry=ms,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.CubeTexture=J,t.CubeTextureLoader=Hn,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.CubicBezierCurve=Kn,t.CubicBezierCurve3=Qn,t.CubicInterpolant=_n,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.CullFaceNone=0,t.Curve=Vn,t.CurvePath=ii,t.CustomBlending=5,t.CylinderBufferGeometry=an,t.CylinderGeometry=nn,t.Cylindrical=Ki,t.DataTexture=St,t.DataTexture2DArray=K,t.DataTexture3D=Q,t.DataTextureLoader=Un,t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=Ml,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.DepthTexture=ir,t.DirectionalLight=gi,t.DirectionalLightHelper=sa,t.DirectionalLightShadow=mi,t.DiscreteInterpolant=wn,t.DodecahedronBufferGeometry=vr,t.DodecahedronGeometry=gr,t.DoubleSide=2,t.DstAlphaFactor=206,t.DstColorFactor=208,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new S(t,e).setUsage(35048)},t.DynamicCopyUsage=35050,t.DynamicDrawUsage=35048,t.DynamicReadUsage=35049,t.EdgesGeometry=rn,t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Je(new rn(t.geometry),new Ye({color:void 0!==e?e:16777215}))},t.EllipseCurve=Wn,t.EqualDepth=4,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.Euler=i,t.EventDispatcher=e,t.ExtrudeBufferGeometry=Vr,t.ExtrudeGeometry=Gr,t.Face3=y,t.Face4=function(t,e,r,n,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new y(t,e,r,i,a,o)},t.FaceColors=1,t.FileLoader=Bn,t.FlatShading=1,t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new R(t,e)},t.Float32BufferAttribute=R,t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new P(t,e)},t.Float64BufferAttribute=P,t.FloatType=1015,t.Fog=Ne,t.FogExp2=Be,t.Font=Ei,t.FontLoader=Ii,t.FrontFaceDirectionCCW=1,t.FrontFaceDirectionCW=0,t.FrontSide=0,t.Frustum=Et,t.GammaEncoding=3007,t.Geometry=U,t.GeometryUtils={merge:function(t,e,r){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,r)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.GreaterDepth=6,t.GreaterEqualDepth=5,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=aa,t.Group=Re,t.HalfFloatType=1016,t.HemisphereLight=li,t.HemisphereLightHelper=ia,t.HemisphereLightProbe=Ri,t.IcosahedronBufferGeometry=mr,t.IcosahedronGeometry=fr,t.ImageBitmapLoader=Ti,t.ImageLoader=kn,t.ImageUtils=Ia,t.ImmediateRenderObject=ta,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=wi,t.InstancedBufferGeometry=Ai,t.InstancedInterleavedBuffer=Xi,t.InstancedMesh=qe,t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new C(t,e)},t.Int16BufferAttribute=C,t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new I(t,e)},t.Int32BufferAttribute=I,t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new A(t,e)},t.Int8BufferAttribute=A,t.IntType=1013,t.InterleavedBuffer=ze,t.InterleavedBufferAttribute=Ue,t.Interpolant=bn,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.InvertStencilOp=5386,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeepStencilOp=7680,t.KeyframeTrack=Mn,t.LOD=Ve,t.LatheBufferGeometry=Qr,t.LatheGeometry=Kr,t.Layers=a,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},t.LessDepth=2,t.LessEqualDepth=3,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=si,t.LightProbe=bi,t.LightShadow=ui,t.Line=Ze,t.Line3=$i,t.LineBasicMaterial=Ye,t.LineCurve=$n,t.LineCurve3=ti,t.LineDashedMaterial=xn,t.LineLoop=Ke,t.LinePieces=1,t.LineSegments=Je,t.LineStrip=0,t.LinearEncoding=3e3,t.LinearFilter=1006,t.LinearInterpolant=An,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=1008,t.LinearMipmapNearestFilter=1007,t.LinearToneMapping=1,t.Loader=Fn,t.LoaderUtils=Rl,t.LoadingManager=On,t.LogLuvEncoding=3003,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=1025,t.LuminanceFormat=1024,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=x,t.MaterialLoader=_i,t.Math=Sa,t.MathUtils=Sa,t.Matrix3=g,t.Matrix4=Ct,t.MaxEquation=104,t.Mesh=B,t.MeshBasicMaterial=_,t.MeshDepthMaterial=Me,t.MeshDistanceMaterial=Ce,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=vn,t.MeshMatcapMaterial=yn,t.MeshNormalMaterial=gn,t.MeshPhongMaterial=fn,t.MeshPhysicalMaterial=pn,t.MeshStandardMaterial=dn,t.MeshToonMaterial=mn,t.MinEquation=103,t.MirroredRepeatWrapping=1002,t.MixOperation=1,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,(t.materials=t).clone=function(){return t.slice()},t},t.MultiplyBlending=4,t.MultiplyOperation=0,t.NearestFilter=1003,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=1005,t.NearestMipmapNearestFilter=1004,t.NeverDepth=0,t.NeverStencilFunc=512,t.NoBlending=0,t.NoColors=0,t.NoToneMapping=0,t.NormalAnimationBlendMode=2500,t.NormalBlending=1,t.NotEqualDepth=7,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=Sn,t.Object3D=p,t.ObjectLoader=Ci,t.ObjectSpaceNormalMap=1,t.OctahedronBufferGeometry=pr,t.OctahedronGeometry=dr,t.OneFactor=201,t.OneMinusDstAlphaFactor=207,t.OneMinusDstColorFactor=209,t.OneMinusSrcAlphaFactor=205,t.OneMinusSrcColorFactor=203,t.OrthographicCamera=fi,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.PMREMGenerator=ma,t.ParametricBufferGeometry=sr,t.ParametricGeometry=or,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new He(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Qe(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new $e(t,e)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Qe(t)},t.Path=ai,t.PerspectiveCamera=W,t.Plane=v,t.PlaneBufferGeometry=Y,t.PlaneGeometry=q,t.PlaneHelper=da,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new $e(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Qe(t)},t.PointLight=pi,t.PointLightHelper=na,t.Points=$e,t.PointsMaterial=Qe,t.PolarGridHelper=oa,t.PolyhedronBufferGeometry=ur,t.PolyhedronGeometry=lr,t.PositionalAudio=Ni,t.PropertyBinding=Hi,t.PropertyMixer=Ui,t.QuadraticBezierCurve=ei,t.QuadraticBezierCurve3=ri,t.Quaternion=f,t.QuaternionKeyframeTrack=In,t.QuaternionLinearInterpolant=En,t.REVISION="117",t.RGBADepthPacking=3201,t.RGBAFormat=1023,t.RGBAIntegerFormat=1033,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_BPTC_Format=36492,t.RGBA_ETC2_EAC_Format=37496,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGBDEncoding=3006,t.RGBEEncoding=3002,t.RGBEFormat=1023,t.RGBFormat=1022,t.RGBIntegerFormat=1032,t.RGBM16Encoding=3005,t.RGBM7Encoding=3004,t.RGB_ETC1_Format=36196,t.RGB_ETC2_Format=37492,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_S3TC_DXT1_Format=33776,t.RGFormat=1030,t.RGIntegerFormat=1031,t.RawShaderMaterial=hn,t.Ray=s,t.Raycaster=qi,t.RectAreaLight=yi,t.RedFormat=1028,t.RedIntegerFormat=1029,t.ReinhardToneMapping=2,t.RepeatWrapping=1e3,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=102,t.RingBufferGeometry=Jr,t.RingGeometry=Zr,t.SRGB8_ALPHA8_ASTC_10x10_Format=37851,t.SRGB8_ALPHA8_ASTC_10x5_Format=37848,t.SRGB8_ALPHA8_ASTC_10x6_Format=37849,t.SRGB8_ALPHA8_ASTC_10x8_Format=37850,t.SRGB8_ALPHA8_ASTC_12x10_Format=37852,t.SRGB8_ALPHA8_ASTC_12x12_Format=37853,t.SRGB8_ALPHA8_ASTC_4x4_Format=37840,t.SRGB8_ALPHA8_ASTC_5x4_Format=37841,t.SRGB8_ALPHA8_ASTC_5x5_Format=37842,t.SRGB8_ALPHA8_ASTC_6x5_Format=37843,t.SRGB8_ALPHA8_ASTC_6x6_Format=37844,t.SRGB8_ALPHA8_ASTC_8x5_Format=37845,t.SRGB8_ALPHA8_ASTC_8x6_Format=37846,t.SRGB8_ALPHA8_ASTC_8x8_Format=37847,t.Scene=Tt,t.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},t.ShaderChunk=_s,t.ShaderLib=As,t.ShaderMaterial=G,t.ShadowMaterial=cn,t.Shape=oi,t.ShapeBufferGeometry=tn,t.ShapeGeometry=$r,t.ShapePath=Si,t.ShapeUtils=yl,t.ShortType=1011,t.Skeleton=je,t.SkeletonHelper=ra,t.SkinnedMesh=We,t.SmoothShading=2,t.Sphere=c,t.SphereBufferGeometry=Yr,t.SphereGeometry=qr,t.Spherical=Ji,t.SphericalHarmonics3=xi,t.SphericalReflectionMapping=305,t.Spline=Ma,t.SplineCurve=ni,t.SplineCurve3=wa,t.SpotLight=hi,t.SpotLightHelper=ea,t.SpotLightShadow=ci,t.Sprite=He,t.SpriteMaterial=ke,t.SrcAlphaFactor=204,t.SrcAlphaSaturateFactor=210,t.SrcColorFactor=202,t.StaticCopyUsage=35046,t.StaticDrawUsage=35044,t.StaticReadUsage=35045,t.StereoCamera=Di,t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=Ln,t.SubtractEquation=101,t.SubtractiveBlending=3,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=0,t.TetrahedronBufferGeometry=hr,t.TetrahedronGeometry=cr,t.TextBufferGeometry=Xr,t.TextGeometry=jr,t.Texture=d,t.TextureLoader=Gn,t.TorusBufferGeometry=wr,t.TorusGeometry=Ar,t.TorusKnotBufferGeometry=_r,t.TorusKnotGeometry=br,t.Triangle=b,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=xr,t.TubeGeometry=yr,t.UVMapping=300,t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new E(t,e)},t.Uint16BufferAttribute=E,t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new L(t,e)},t.Uint32BufferAttribute=L,t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new w(t,e)},t.Uint8BufferAttribute=w,t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new M(t,e)},t.Uint8ClampedBufferAttribute=M,t.Uncharted2ToneMapping=3,t.Uniform=ji,t.UniformsLib=bs,t.UniformsUtils=vs,t.UnsignedByteType=1009,t.UnsignedInt248Type=1020,t.UnsignedIntType=1014,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedShortType=1012,t.VSMShadowMap=3,t.Vector2=At,t.Vector3=Mt,t.Vector4=wt,t.VectorKeyframeTrack=Rn,t.Vertex=function(t,e,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Mt(t,e,r)},t.VertexColors=2,t.VideoTexture=er,t.WebGLCubeRenderTarget=X,t.WebGLMultisampleRenderTarget=r,t.WebGLRenderTarget=T,t.WebGLRenderTargetCube=function(t,e,r){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new X(t,r)},t.WebGLRenderer=Fe,t.WebGLUtils=Ie,t.WireframeGeometry=ar,t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Je(new ar(t.geometry),new Ye({color:void 0!==e?e:16777215}))},t.WrapAroundEnding=2402,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Bn(t)},t.ZeroCurvatureEnding=2400,t.ZeroFactor=200,t.ZeroSlopeEnding=2401,t.ZeroStencilOp=0,t.sRGBEncoding=3001,Object.defineProperty(t,"__esModule",{value:!0})}(e)}),Rl=e(Au);function wu(t,e,r){return Mu.defineProperty(t,e,r)}qa(qa.S+qa.F*!za,"Object",{defineProperty:Va.f});var Mu=Na.Object,Cu=r(function(t){t.exports={default:wu,__esModule:!0}}),Tu=e(Cu),Su=e(r(function(t,e){e.__esModule=!0;var n=Cu&&Cu.__esModule?Cu:{default:Cu};e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}}));gs("getPrototypeOf",function(){return function(t){return Oo(Object(Za(t)))}});var Eu=Na.Object.getPrototypeOf,Iu=e(r(function(t){t.exports={default:Eu,__esModule:!0}})),ju=e(r(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),Xu=e(r(function(t,e){e.__esModule=!0;var r=Vl&&Vl.__esModule?Vl:{default:Vl};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}})),ds=Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{(n=Ea(Function.call,pl.f(Object.prototype,"__proto__").set,2))(t,[]),r=!(t instanceof Array)}catch(t){r=!0}return function(t,e){if(La(t),!Ia(e)&&null!==e)throw TypeError(e+": can't set as prototype!");return r?t.__proto__=e:n(t,e),t}}({},!1):void 0);qa(qa.S,"Object",{setPrototypeOf:ds});var qu=Na.Object.setPrototypeOf,Yu=r(function(t){t.exports={default:qu,__esModule:!0}});e(Yu);var Zu=e(r(function(t,e){function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var n=r(Yu),i=r(fu),a=r(Vl);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,a.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}}));void 0===Wu&&(Number.EPSILON=Math.pow(2,-52)),void 0===Vu&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Gu&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Hu&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),Hu(i.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&(void 0!==(t=this._listeners[t])&&(-1!==(e=t.indexOf(e))&&t.splice(e,1)))},dispatchEvent:function(t){if(void 0!==this._listeners&&void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,r=0,n=(e=e.slice(0)).length;r<n;r++)e[r].call(this,t)}}});for(var Ju=[],Ku=0;Ku<256;Ku++)Ju[Ku]=(Ku<16?"0":"")+Ku.toString(16);var Qu={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ju[255&t]+Ju[t>>8&255]+Ju[t>>16&255]+Ju[t>>24&255]+"-"+Ju[255&e]+Ju[e>>8&255]+"-"+Ju[e>>16&15|64]+Ju[e>>24&255]+"-"+Ju[63&r|128]+Ju[r>>8&255]+"-"+Ju[r>>16&255]+Ju[r>>24&255]+Ju[255&n]+Ju[n>>8&255]+Ju[n>>16&255]+Ju[n>>24&255]).toUpperCase()},clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},smoothstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:r<=t?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Qu.DEG2RAD},radToDeg:function(t){return t*Qu.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,r,n,i){var a=Math.cos,o=Math.sin,s=a(r/2);r=o(r/2);var l=a((e+n)/2),u=o((e+n)/2),c=a((e-n)/2),h=o((e-n)/2),a=a((n-e)/2);switch(e=o((n-e)/2),i){case"XYX":t.set(s*u,r*c,r*h,s*l);break;case"YZY":t.set(r*h,s*u,r*c,s*l);break;case"ZXZ":t.set(r*c,r*h,s*u,s*l);break;case"XZX":t.set(s*u,r*e,r*a,s*l);break;case"YXY":t.set(r*a,s*u,r*e,s*l);break;case"ZYZ":t.set(r*e,r*a,s*u,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};ku(At.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Hu(At.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,r=this.y;return t=t.elements,this.x=t[0]*e+t[3]*r+t[6],this.y=t[1]*e+t[4]*r+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var r=Math.cos(e);e=Math.sin(e);var n=this.x-t.x,i=this.y-t.y;return this.x=n*r-i*e+t.x,this.y=n*e+i*r+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Hu(g.prototype,{isMatrix3:!0,set:function(t,e,r,n,i,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=n,u[2]=o,u[3]=e,u[4]=i,u[5]=s,u[6]=r,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},extractBasis:function(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements;e=this.elements,t=r[0];var i=r[3],a=r[6],o=r[1],s=r[4],l=r[7],u=r[2],c=r[5],r=r[8],h=n[0],d=n[3],p=n[6],f=n[1],m=n[4],g=n[7],v=n[2],y=n[5],n=n[8];return e[0]=t*h+i*f+a*v,e[3]=t*d+i*m+a*y,e[6]=t*p+i*g+a*n,e[1]=o*h+s*f+l*v,e[4]=o*d+s*m+l*y,e[7]=o*p+s*g+l*n,e[2]=u*h+c*f+r*v,e[5]=u*d+c*m+r*y,e[8]=u*p+c*g+r*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7];return e*a*(t=t[8])-e*o*l-r*i*t+r*o*s+n*i*l-n*a*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var r=t.elements;t=this.elements,e=r[0];var n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],c=(r=r[8])*o-s*u,h=s*l-r*a,d=u*a-o*l,p=e*c+n*h+i*d;return 0==p?this.set(0,0,0,0,0,0,0,0,0):(p=1/p,t[0]=c*p,t[1]=(i*u-r*n)*p,t[2]=(s*n-i*o)*p,t[3]=h*p,t[4]=(r*e-i*l)*p,t[5]=(i*a-s*e)*p,t[6]=d*p,t[7]=(n*l-u*e)*p,t[8]=(o*e-n*a)*p,this)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,r,n,i,a,o){var s=Math.cos(i);i=Math.sin(i),this.set(r*s,r*i,-r*(s*a+i*o)+a+t,-n*i,n*s,-n*(-i*a+s*o)+o+e,0,0,1)},scale:function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var r=this.elements,n=r[0],i=r[3],a=r[6],o=r[1],s=r[4],l=r[7];return r[0]=e*n+t*o,r[3]=e*i+t*s,r[6]=e*a+t*l,r[1]=-t*n+e*o,r[4]=-t*i+e*s,r[7]=-t*a+e*l,this},translate:function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var r=0;r<9;r++)if(e[r]!==t[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}});var $u,tc={getDataURL:function(t){return"undefined"==typeof HTMLCanvasElement?t.src:(t instanceof HTMLCanvasElement||(($u=void 0===$u?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):$u).width=t.width,$u.height=t.height,e=$u.getContext("2d"),t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),t=$u),2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png"));var e}},ec=0;d.DEFAULT_IMAGE=void 0,d.DEFAULT_MAPPING=300,d.prototype=Hu(Uu(i.prototype),{constructor:d,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=Qu.generateUUID()),!e&&void 0===t.images[n.uuid]){if(Array.isArray(n))for(var i=[],a=0,o=n.length;a<o;a++)i.push(tc.getDataURL(n[a]));else i=tc.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return e||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(d.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),ku(wt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Hu(wt.prototype,{isVector4:!0,set:function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=this.w;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*n+t[12]*i,this.y=t[1]*e+t[5]*r+t[9]*n+t[13]*i,this.z=t[2]*e+t[6]*r+t[10]*n+t[14]*i,this.w=t[3]*e+t[7]*r+t[11]*n+t[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],r=t[4],n=t[8],i=t[1],a=t[5],o=t[9],s=t[2],l=t[6],u=t[10];return Math.abs(r-i)<.01&&Math.abs(n-s)<.01&&Math.abs(o-l)<.01?Math.abs(r+i)<.1&&Math.abs(n+s)<.1&&Math.abs(o+l)<.1&&Math.abs(e+a+u-3)<.1?this.set(1,0,0,0):(t=Math.PI,u=(u+1)/2,r=(r+i)/4,n=(n+s)/4,o=(o+l)/4,(a=(a+1)/2)<(e=(e+1)/2)&&u<e?r=e<.01?(l=0,s=.707106781):(s=r/(l=Math.sqrt(e)),n/l):u<a?r=a<.01?(s=0,l=.707106781):(l=r/(s=Math.sqrt(a)),o/s):u<.01?(s=l=.707106781,r=0):(l=n/(r=Math.sqrt(u)),s=o/r),this.set(l,s,r,t)):(t=Math.sqrt((l-o)*(l-o)+(n-s)*(n-s)+(i-r)*(i-r)),Math.abs(t)<.001&&(t=1),this.x=(l-o)/t,this.y=(n-s)/t,this.z=(i-r)/t,this.w=Math.acos((e+a+u-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),T.prototype=Hu(Uu(i.prototype),{constructor:T,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),a.prototype=Hu(Uu(T.prototype),{constructor:a,isWebGLMultisampleRenderTarget:!0,copy:function(t){return T.prototype.copy.call(this,t),this.samples=t.samples,this}}),Hu(f,{slerp:function(t,e,r,n){return r.copy(t).slerp(e,n)},slerpFlat:function(t,e,r,n,i,a,o){var s=r[n+0],l=r[n+1],u=r[n+2];r=r[n+3],n=i[a+0];var c,h,d,p=i[a+1],f=i[a+2];r===(i=i[a+3])&&s===n&&l===p&&u===f||(a=1-o,h=0<=(c=s*n+l*p+u*f+r*i)?1:-1,Wu<(d=1-c*c)&&(d=Math.sqrt(d),c=Math.atan2(d,c*h),a=Math.sin(a*c)/d,o=Math.sin(o*c)/d),s=s*a+n*(h*=o),l=l*a+p*h,u=u*a+f*h,r=r*a+i*h,a===1-o&&(s*=o=1/Math.sqrt(s*s+l*l+u*u+r*r),l*=o,u*=o,r*=o)),t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=r},multiplyQuaternionsFlat:function(t,e,r,n,i,a){var o=r[n],s=r[n+1],l=r[n+2];r=r[n+3],n=i[a];var u=i[a+1],c=i[a+2];return i=i[a+3],t[e]=o*i+r*n+s*c-l*u,t[e+1]=s*i+r*u+l*n-o*c,t[e+2]=l*i+r*c+o*u-s*n,t[e+3]=r*i-o*n-s*u-l*c,t}}),ku(f.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Hu(f.prototype,{isQuaternion:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,n=t._y,i=t._z;t=t.order;var a=Math.cos,o=Math.sin,s=a(r/2),l=a(n/2),a=a(i/2),r=o(r/2),n=o(n/2),i=o(i/2);switch(t){case"XYZ":this._x=r*l*a+s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a-r*n*i;break;case"YXZ":this._x=r*l*a+s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a+r*n*i;break;case"ZXY":this._x=r*l*a-s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a-r*n*i;break;case"ZYX":this._x=r*l*a-s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a+r*n*i;break;case"YZX":this._x=r*l*a+s*n*i,this._y=s*n*a+r*l*i,this._z=s*l*i-r*n*a,this._w=s*l*a-r*n*i;break;case"XZY":this._x=r*l*a-s*n*i,this._y=s*n*a-r*l*i,this._z=s*l*i+r*n*a,this._w=s*l*a+r*n*i;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){e/=2;var r=Math.sin(e);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(e),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,r=e[0];t=e[4];var n=e[8],i=e[1],a=e[5],o=e[9],s=e[2],l=e[6],u=r+a+(e=e[10]);return 0<u?(r=.5/Math.sqrt(u+1),this._w=.25/r,this._x=(l-o)*r,this._y=(n-s)*r,this._z=(i-t)*r):a<r&&e<r?(r=2*Math.sqrt(1+r-a-e),this._w=(l-o)/r,this._x=.25*r,this._y=(t+i)/r,this._z=(n+s)/r):e<a?(r=2*Math.sqrt(1+a-r-e),this._w=(n-s)/r,this._x=(t+i)/r,this._y=.25*r,this._z=(o+l)/r):(r=2*Math.sqrt(1+e-r-a),this._w=(i-t)/r,this._x=(n+s)/r,this._y=(o+l)/r,this._z=.25*r),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=r,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Qu.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var r=this.angleTo(t);return 0===r||this.slerp(t,Math.min(1,e/r)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var r=t._x,n=t._y,i=t._z;t=t._w;var a=e._x,o=e._y,s=e._z;return e=e._w,this._x=r*e+t*a+n*s-i*o,this._y=n*e+t*o+i*a-r*s,this._z=i*e+t*s+r*o-n*a,this._w=t*e-r*a-n*o-i*s,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,a=this._w;if((s=a*t._w+r*t._x+n*t._y+i*t._z)<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=a,this._x=r,this._y=n,this._z=i,this;if((t=1-s*s)<=Wu)return s=1-e,this._w=s*a+e*this._w,this._x=s*r+e*this._x,this._y=s*n+e*this._y,this._z=s*i+e*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var o=Math.atan2(t,s),s=Math.sin((1-e)*o)/t;return e=Math.sin(e*o)/t,this._w=a*s+this._w*e,this._x=r*s+this._x*e,this._y=n*s+this._y*e,this._z=i*s+this._z*e,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var rc=new Mt,nc=new f;Hu(Mt.prototype,{isVector3:!0,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(nc.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(nc.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,r=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*r+t[6]*n,this.y=t[1]*e+t[4]*r+t[7]*n,this.z=t[2]*e+t[5]*r+t[8]*n,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=1/((t=t.elements)[3]*e+t[7]*r+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*r+t[8]*n+t[12])*i,this.y=(t[1]*e+t[5]*r+t[9]*n+t[13])*i,this.z=(t[2]*e+t[6]*r+t[10]*n+t[14])*i,this},applyQuaternion:function(t){var e=this.x,r=this.y,n=this.z,i=t.x,a=t.y,o=t.z,s=(t=t.w)*e+a*n-o*r,l=t*r+o*e-i*n,u=t*n+i*r-a*e,e=-i*e-a*r-o*n;return this.x=s*t+e*-i+l*-o-u*-a,this.y=l*t+e*-a+u*-i-s*-o,this.z=u*t+e*-o+s*-a-l*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,r=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*n,this.y=t[1]*e+t[5]*r+t[9]*n,this.z=t[2]*e+t[6]*r+t[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var r=t.x,n=t.y;t=t.z;var i=e.x,a=e.y;return e=e.z,this.x=n*e-t*a,this.y=t*i-r*e,this.z=r*a-n*i,this},projectOnVector:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},projectOnPlane:function(t){return rc.copy(this).projectOnVector(t),this.sub(rc)},reflect:function(t){return this.sub(rc.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(Qu.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,r){var n=Math.sin(e)*t;return this.x=n*Math.sin(r),this.y=Math.cos(e)*t,this.z=n*Math.cos(r),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=r,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var ic=new Mt,ac=new Ct,oc=new Mt(0,0,0),sc=new Mt(1,1,1),lc=new Mt,uc=new Mt,cc=new Mt;Hu(Ct.prototype,{isMatrix4:!0,set:function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ct).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,r=t.elements,n=1/ic.setFromMatrixColumn(t,0).length(),i=1/ic.setFromMatrixColumn(t,1).length();return t=1/ic.setFromMatrixColumn(t,2).length(),e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=0,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=0,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,r,n,i=this.elements,a=t.x,o=t.y,s=t.z,l=Math.cos(a),a=Math.sin(a),u=Math.cos(o),o=Math.sin(o),c=Math.cos(s),s=Math.sin(s);return"XYZ"===t.order?(t=l*c,e=l*s,r=a*c,n=a*s,i[0]=u*c,i[4]=-u*s,i[8]=o,i[1]=e+r*o,i[5]=t-n*o,i[9]=-a*u,i[2]=n-t*o,i[6]=r+e*o,i[10]=l*u):"YXZ"===t.order?(t=u*c,e=u*s,r=o*c,n=o*s,i[0]=t+n*a,i[4]=r*a-e,i[8]=l*o,i[1]=l*s,i[5]=l*c,i[9]=-a,i[2]=e*a-r,i[6]=n+t*a,i[10]=l*u):"ZXY"===t.order?(t=u*c,e=u*s,r=o*c,n=o*s,i[0]=t-n*a,i[4]=-l*s,i[8]=r+e*a,i[1]=e+r*a,i[5]=l*c,i[9]=n-t*a,i[2]=-l*o,i[6]=a,i[10]=l*u):"ZYX"===t.order?(t=l*c,e=l*s,r=a*c,n=a*s,i[0]=u*c,i[4]=r*o-e,i[8]=t*o+n,i[1]=u*s,i[5]=n*o+t,i[9]=e*o-r,i[2]=-o,i[6]=a*u,i[10]=l*u):"YZX"===t.order?(t=l*u,e=l*o,r=a*u,n=a*o,i[0]=u*c,i[4]=n-t*s,i[8]=r*s+e,i[1]=s,i[5]=l*c,i[9]=-a*c,i[2]=-o*c,i[6]=e*s+r,i[10]=t-n*s):"XZY"===t.order&&(t=l*u,e=l*o,r=a*u,n=a*o,i[0]=u*c,i[4]=-s,i[8]=o*c,i[1]=t*s+n,i[5]=l*c,i[9]=e*s-r,i[2]=r*s-e,i[6]=a*c,i[10]=n*s+t),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(oc,t,sc)},lookAt:function(t,e,r){var n=this.elements;return cc.subVectors(t,e),0===cc.lengthSq()&&(cc.z=1),cc.normalize(),lc.crossVectors(r,cc),0===lc.lengthSq()&&(1===Math.abs(r.z)?cc.x+=1e-4:cc.z+=1e-4,cc.normalize(),lc.crossVectors(r,cc)),lc.normalize(),uc.crossVectors(cc,lc),n[0]=lc.x,n[4]=uc.x,n[8]=cc.x,n[1]=lc.y,n[5]=uc.y,n[9]=cc.y,n[2]=lc.z,n[6]=uc.z,n[10]=cc.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements;e=this.elements,t=r[0];var i=r[4],a=r[8],o=r[12],s=r[1],l=r[5],u=r[9],c=r[13],h=r[2],d=r[6],p=r[10],f=r[14],m=r[3],g=r[7],v=r[11],r=r[15],y=n[0],x=n[4],b=n[8],_=n[12],A=n[1],w=n[5],M=n[9],C=n[13],T=n[2],S=n[6],E=n[10],I=n[14],L=n[3],R=n[7],P=n[11],n=n[15];return e[0]=t*y+i*A+a*T+o*L,e[4]=t*x+i*w+a*S+o*R,e[8]=t*b+i*M+a*E+o*P,e[12]=t*_+i*C+a*I+o*n,e[1]=s*y+l*A+u*T+c*L,e[5]=s*x+l*w+u*S+c*R,e[9]=s*b+l*M+u*E+c*P,e[13]=s*_+l*C+u*I+c*n,e[2]=h*y+d*A+p*T+f*L,e[6]=h*x+d*w+p*S+f*R,e[10]=h*b+d*M+p*E+f*P,e[14]=h*_+d*C+p*I+f*n,e[3]=m*y+g*A+v*T+r*L,e[7]=m*x+g*w+v*S+r*R,e[11]=m*b+g*M+v*E+r*P,e[15]=m*_+g*C+v*I+r*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+i*s*c-n*l*c-i*o*h+r*l*h+n*o*d-r*s*d)+t[7]*(+e*s*d-e*l*h+i*a*h-n*a*d+n*l*u-i*s*u)+t[11]*(+e*l*c-e*o*d-i*a*c+r*a*d+i*o*u-r*l*u)+t[15]*(-n*o*u-e*s*c+e*o*h+n*a*c-r*a*h+r*s*u)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,r){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=r),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),e=this.elements;var r=t.elements;t=r[0];var n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],c=r[8],h=r[9],d=r[10],p=r[11],f=r[12],m=r[13],g=r[14],v=h*g*u-m*d*u+m*l*p-s*g*p-h*l*(r=r[15])+s*d*r,y=f*d*u-c*g*u-f*l*p+o*g*p+c*l*r-o*d*r,x=c*m*u-f*h*u+f*s*p-o*m*p-c*s*r+o*h*r,b=f*h*l-c*m*l-f*s*d+o*m*d+c*s*g-o*h*g,_=t*v+n*y+i*x+a*b;return 0==_?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(_=1/_,e[0]=v*_,e[1]=(m*d*a-h*g*a-m*i*p+n*g*p+h*i*r-n*d*r)*_,e[2]=(s*g*a-m*l*a+m*i*u-n*g*u-s*i*r+n*l*r)*_,e[3]=(h*l*a-s*d*a-h*i*u+n*d*u+s*i*p-n*l*p)*_,e[4]=y*_,e[5]=(c*g*a-f*d*a+f*i*p-t*g*p-c*i*r+t*d*r)*_,e[6]=(f*l*a-o*g*a-f*i*u+t*g*u+o*i*r-t*l*r)*_,e[7]=(o*d*a-c*l*a+c*i*u-t*d*u-o*i*p+t*l*p)*_,e[8]=x*_,e[9]=(f*h*a-c*m*a-f*n*p+t*m*p+c*n*r-t*h*r)*_,e[10]=(o*m*a-f*s*a+f*n*u-t*m*u-o*n*r+t*s*r)*_,e[11]=(c*s*a-o*h*a-c*n*u+t*h*u+o*n*p-t*s*p)*_,e[12]=b*_,e[13]=(c*m*i-f*h*i+f*n*d-t*m*d-c*n*g+t*h*g)*_,e[14]=(f*s*i-o*m*i-f*n*l+t*m*l+o*n*g-t*s*g)*_,e[15]=(o*h*i-c*s*i+c*n*l-t*h*l-o*n*d+t*s*d)*_,this)},scale:function(t){var e=this.elements,r=t.x,n=t.y;return t=t.z,e[0]*=r,e[4]*=n,e[8]*=t,e[1]*=r,e[5]*=n,e[9]*=t,e[2]*=r,e[6]*=n,e[10]*=t,e[3]*=r,e[7]*=n,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e);e=Math.sin(e);var n=1-r,i=t.x,a=t.y;t=t.z;var o=n*i,s=n*a;return this.set(o*i+r,o*a-e*t,o*t+e*a,0,o*a+e*t,s*a+r,s*t-e*i,0,o*t-e*a,s*t+e*i,n*t*t+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,r){var n=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,u=a+a;e=i*l;var c=i*u;i*=d=o+o;var h=a*u;a*=d,o*=d,l*=s,u*=s,s*=d;var d=r.x,p=r.y;return r=r.z,n[0]=(1-(h+o))*d,n[1]=(c+s)*d,n[2]=(i-u)*d,n[3]=0,n[4]=(c-s)*p,n[5]=(1-(e+o))*p,n[6]=(a+l)*p,n[7]=0,n[8]=(i+u)*r,n[9]=(a-l)*r,n[10]=(1-(e+h))*r,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:function(t,e,r){var n=this.elements,i=ic.set(n[0],n[1],n[2]).length(),a=ic.set(n[4],n[5],n[6]).length(),o=ic.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],ac.copy(this),t=1/i;var n=1/a,s=1/o;return ac.elements[0]*=t,ac.elements[1]*=t,ac.elements[2]*=t,ac.elements[4]*=n,ac.elements[5]*=n,ac.elements[6]*=n,ac.elements[8]*=s,ac.elements[9]*=s,ac.elements[10]*=s,e.setFromRotationMatrix(ac),r.x=i,r.y=a,r.z=o,this},makePerspective:function(t,e,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;return o[0]=2*i/(e-t),o[4]=0,o[8]=(e+t)/(e-t),o[12]=0,o[1]=0,o[5]=2*i/(r-n),o[9]=(r+n)/(r-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(a+i)/(a-i),o[14]=-2*a*i/(a-i),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,r,n,i,a){var o=this.elements,s=1/(e-t),l=1/(r-n),u=1/(a-i);return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-(e+t)*s,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-(r+n)*l,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-(a+i)*u,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var r=0;r<16;r++)if(e[r]!==t[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}});var hc=new Ct,dc=new f;o.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),o.DefaultOrder="XYZ",ku(o.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Hu(o.prototype,{isEuler:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var n=Qu.clamp;t=(h=t.elements)[0];var i=h[4],a=h[8],o=h[1],s=h[5],l=h[9],u=h[2],c=h[6],h=h[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-i,t)):(this._x=Math.atan2(c,s),this._z=0);break;case"YXZ":this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,s)):(this._y=Math.atan2(-u,t),this._z=0);break;case"ZXY":this._x=Math.asin(n(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-i,s)):(this._y=0,this._z=Math.atan2(o,t));break;case"ZYX":this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(c,h),this._z=Math.atan2(o,t)):(this._x=0,this._z=Math.atan2(-i,s));break;case"YZX":this._z=Math.asin(n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,s),this._y=Math.atan2(-u,t)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-n(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(c,s),this._y=Math.atan2(a,t)):(this._x=Math.atan2(-l,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,r){return hc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(hc,e,r)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return dc.setFromEuler(this),this.setFromQuaternion(dc,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Mt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Hu(s.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var pc=0,fc=new Mt,mc=new f,gc=new Ct,vc=new Mt,yc=new Mt,xc=new Mt,bc=new f,_c=new Mt(1,0,0),Ac=new Mt(0,1,0),wc=new Mt(0,0,1),Mc={type:"added"},Cc={type:"removed"};B.DefaultUp=new Mt(0,1,0),B.DefaultMatrixAutoUpdate=!0,B.prototype=Hu(Uu(i.prototype),{constructor:B,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return mc.setFromAxisAngle(t,e),this.quaternion.multiply(mc),this},rotateOnWorldAxis:function(t,e){return mc.setFromAxisAngle(t,e),this.quaternion.premultiply(mc),this},rotateX:function(t){return this.rotateOnAxis(_c,t)},rotateY:function(t){return this.rotateOnAxis(Ac,t)},rotateZ:function(t){return this.rotateOnAxis(wc,t)},translateOnAxis:function(t,e){return fc.copy(t).applyQuaternion(this.quaternion),this.position.add(fc.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(_c,t)},translateY:function(t){return this.translateOnAxis(Ac,t)},translateZ:function(t){return this.translateOnAxis(wc,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(gc.getInverse(this.matrixWorld))},lookAt:function(t,e,r){t.isVector3?vc.copy(t):vc.set(t,e,r),t=this.parent,this.updateWorldMatrix(!0,!1),yc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?gc.lookAt(yc,vc,this.up):gc.lookAt(vc,yc,this.up),this.quaternion.setFromRotationMatrix(gc),t&&(gc.extractRotation(t.matrixWorld),mc.setFromRotationMatrix(gc),this.quaternion.premultiply(mc.inverse()))},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(Mc)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Cc)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),gc.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),gc.multiply(t.parent.matrixWorld)),t.applyMatrix4(gc),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Mt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new f),this.updateMatrixWorld(!0),this.matrixWorld.decompose(yc,t,xc),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Mt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(yc,bc,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Mt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(e=0,r=(t=this.children).length;e<r;e++)t[e].updateWorldMatrix(!1,!0)},toJSON:function(r){function t(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(r)),e.uuid}function e(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}var n=void 0===r||"string"==typeof r,i={};n&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a,o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==zu(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){o.geometry=t(r.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var l=0,u=s.length;l<u;l++)t(r.shapes,s[l]);else t(r.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],l=0,u=this.material.length;l<u;l++)s.push(t(r.materials,this.material[l]));o.material=s}else o.material=t(r.materials,this.material);if(0<this.children.length)for(o.children=[],l=0;l<this.children.length;l++)o.children.push(this.children[l].toJSON(r).object);return n&&(n=e(r.geometries),l=e(r.materials),u=e(r.textures),a=e(r.images),s=e(r.shapes),0<n.length&&(i.geometries=n),0<l.length&&(i.materials=l),0<u.length&&(i.textures=u),0<a.length&&(i.images=a),0<s.length&&(i.shapes=s)),i.object=o,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(zu(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}}),Tt.prototype=Hu(Uu(B.prototype),{constructor:Tt,isScene:!0,copy:function(t,e){return B.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=B.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Tc=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],Sc=new Mt,Ec=new N,Ic=new Mt,Lc=new Mt,Rc=new Mt,Pc=new Mt,Dc=new Mt,Oc=new Mt,Fc=new Mt,Bc=new Mt,Nc=new Mt,zc=new Mt;Hu(N.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<r&&(r=c),h<n&&(n=h),i<u&&(i=u),a<c&&(a=c),o<h&&(o=h)}return this.min.set(e,r,n),this.max.set(i,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=Sc.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1),void 0!==(e=t.geometry)&&(null===e.boundingBox&&e.computeBoundingBox(),Ec.copy(e.boundingBox),Ec.applyMatrix4(t.matrixWorld),this.union(Ec));for(var e=0,r=(t=t.children).length;e<r;e++)this.expandByObject(t[e]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Mt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Sc),Sc.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,r=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(Fc),Bc.subVectors(this.max,Fc),Ic.subVectors(t.a,Fc),Lc.subVectors(t.b,Fc),Rc.subVectors(t.c,Fc),Pc.subVectors(Lc,Ic),Dc.subVectors(Rc,Lc),Oc.subVectors(Ic,Rc),!!l(t=[0,-Pc.z,Pc.y,0,-Dc.z,Dc.y,0,-Oc.z,Oc.y,Pc.z,0,-Pc.x,Dc.z,0,-Dc.x,Oc.z,0,-Oc.x,-Pc.y,Pc.x,0,-Dc.y,Dc.x,0,-Oc.y,Oc.x,0],Ic,Lc,Rc,Bc)&&(!!l(t=[1,0,0,0,1,0,0,0,1],Ic,Lc,Rc,Bc)&&(Nc.crossVectors(Pc,Dc),l(t=[Nc.x,Nc.y,Nc.z],Ic,Lc,Rc,Bc))))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Mt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Sc.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Sc).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Tc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Tc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Tc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Tc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Tc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Tc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Tc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Tc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Tc)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Uc=new N;Hu(z.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var r=this.center;void 0!==e?r.copy(e):Uc.setFromPoints(t).getCenter(r);for(var n=e=0,i=t.length;n<i;n++)e=Math.max(e,r.distanceToSquared(t[n]));return this.radius=Math.sqrt(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Mt),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new N),this.isEmpty()?t.makeEmpty():(t.set(this.center,this.center),t.expandByScalar(this.radius)),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var kc=new Mt,Hc=new Mt,Gc=new Mt,Vc=new Mt,Wc=new Mt,jc=new Mt,Xc=new Mt;Hu(u.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Mt),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,kc)),this},closestPointToPoint:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Mt),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=kc.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(kc.copy(this.direction).multiplyScalar(e).add(this.origin),kc.distanceToSquared(t))},distanceSqToSegment:function(t,e,r,n){Hc.copy(t).add(e).multiplyScalar(.5),Gc.copy(e).sub(t).normalize(),Vc.copy(this.origin).sub(Hc);var i,a=.5*t.distanceTo(e),o=-this.direction.dot(Gc),s=Vc.dot(this.direction),l=-Vc.dot(Gc),u=Vc.lengthSq(),c=Math.abs(1-o*o);return o=0<c?(e=o*s-l,i=a*c,0<=(t=o*l-s)?-i<=e?e<=i?(t*=a=1/c)*(t+o*(e*=a)+2*s)+e*(o*t+e+2*l)+u:(e=a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u):(e=-a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u):e<=-i?-(t=Math.max(0,-(-o*a+s)))*t+(e=0<t?-a:Math.min(Math.max(-a,-l),a))*(e+2*l)+u:e<=i?(t=0,(e=Math.min(Math.max(-a,-l),a))*(e+2*l)+u):-(t=Math.max(0,-(o*a+s)))*t+(e=0<t?a:Math.min(Math.max(-a,-l),a))*(e+2*l)+u):(e=0<o?-a:a,-(t=Math.max(0,-(o*e+s)))*t+e*(e+2*l)+u),r&&r.copy(this.direction).multiplyScalar(t).add(this.origin),n&&n.copy(Gc).multiplyScalar(e).add(Hc),o},intersectSphere:function(t,e){kc.subVectors(t.center,this.origin);var r=kc.dot(this.direction),n=kc.dot(kc)-r*r;return(t=t.radius*t.radius)<n?null:(n=r-(t=Math.sqrt(t-n)),r+=t,n<0&&r<0?null:n<0?this.at(r,e):this.at(n,e))},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var r,n,i=1/this.direction.x,a=1/this.direction.y,o=1/this.direction.z,s=this.origin;return 0<=i?(r=(t.min.x-s.x)*i,i*=t.max.x-s.x):(r=(t.max.x-s.x)*i,i*=t.min.x-s.x),0<=a?(n=(t.min.y-s.y)*a,a*=t.max.y-s.y):(n=(t.max.y-s.y)*a,a*=t.min.y-s.y),a<r||i<n?null:((r<n||r!=r)&&(r=n),(a<i||i!=i)&&(i=a),(t=0<=o?(n=(t.min.z-s.z)*o,(t.max.z-s.z)*o):(n=(t.max.z-s.z)*o,(t.min.z-s.z)*o))<r||i<n?null:((r<n||r!=r)&&(r=n),(i=t<i||i!=i?t:i)<0?null:this.at(0<=r?r:i,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,kc)},intersectTriangle:function(t,e,r,n,i){if(Wc.subVectors(e,t),jc.subVectors(r,t),Xc.crossVectors(Wc,jc),0<(e=this.direction.dot(Xc))){if(n)return null;n=1}else{if(!(e<0))return null;n=-1,e=-e}return Vc.subVectors(this.origin,t),(t=n*this.direction.dot(jc.crossVectors(Vc,jc)))<0||(r=n*this.direction.dot(Wc.cross(Vc)))<0||e<t+r||(t=-n*Vc.dot(Xc))<0?null:this.at(t/e,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var qc=new Mt,Yc=new Mt,Zc=new g;Hu(v.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,r){return e=qc.subVectors(r,e).cross(Yc.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(e,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Mt),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Mt);var r=t.delta(qc),n=this.normal.dot(r);if(0===n){if(0===this.distanceToPoint(t.start))return e.copy(t.start)}else if(!((n=-(t.start.dot(this.normal)+this.constant)/n)<0||1<n))return e.copy(r).multiplyScalar(n).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Mt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){return e=e||Zc.getNormalMatrix(t),t=this.coplanarPoint(qc).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Jc=new Mt,Kc=new Mt,Qc=new Mt,$c=new Mt,th=new Mt,eh=new Mt,rh=new Mt,nh=new Mt,ih=new Mt,ah=new Mt;Hu(b,{getNormal:function(t,e,r,n){return void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Mt),n.subVectors(r,e),Jc.subVectors(t,e),n.cross(Jc),0<(t=n.lengthSq())?n.multiplyScalar(1/Math.sqrt(t)):n.set(0,0,0)},getBarycoord:function(t,e,r,n,i){Jc.subVectors(n,e),Kc.subVectors(r,e),Qc.subVectors(t,e),t=Jc.dot(Jc),e=Jc.dot(Kc),r=Jc.dot(Qc);var a=Kc.dot(Kc);n=Kc.dot(Qc);var o=t*a-e*e;return void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Mt),0==o?i.set(-2,-1,-1):(a=(a*r-e*n)*(o=1/o),t=(t*n-e*r)*o,i.set(1-a-t,t,a))},containsPoint:function(t,e,r,n){return b.getBarycoord(t,e,r,n,$c),0<=$c.x&&0<=$c.y&&$c.x+$c.y<=1},getUV:function(t,e,r,n,i,a,o,s){return this.getBarycoord(t,e,r,n,$c),s.set(0,0),s.addScaledVector(i,$c.x),s.addScaledVector(a,$c.y),s.addScaledVector(o,$c.z),s},isFrontFacing:function(t,e,r,n){return Jc.subVectors(r,e),Kc.subVectors(t,e),Jc.cross(Kc).dot(n)<0}}),Hu(b.prototype,{set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Jc.subVectors(this.c,this.b),Kc.subVectors(this.a,this.b),.5*Jc.cross(Kc).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Mt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return b.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new v),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return b.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,r,n,i){return b.getUV(t,this.a,this.b,this.c,e,r,n,i)},containsPoint:function(t){return b.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return b.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Mt);var r=this.a,n=this.b,i=this.c;th.subVectors(n,r),eh.subVectors(i,r),nh.subVectors(t,r);var a=th.dot(nh),o=eh.dot(nh);if(a<=0&&o<=0)return e.copy(r);ih.subVectors(t,n);var s=th.dot(ih),l=eh.dot(ih);if(0<=s&&l<=s)return e.copy(n);var u=a*l-s*o;if(u<=0&&0<=a&&s<=0)return n=a/(a-s),e.copy(r).addScaledVector(th,n);ah.subVectors(t,i),t=th.dot(ah);var c=eh.dot(ah);return 0<=c&&t<=c?e.copy(i):(a=t*o-a*c)<=0&&0<=o&&c<=0?(u=o/(o-c),e.copy(r).addScaledVector(eh,u)):(o=s*c-t*l)<=0&&0<=l-s&&0<=t-c?(rh.subVectors(i,n),u=(l-s)/(l-s+(t-c)),e.copy(n).addScaledVector(rh,u)):(n=a*(i=1/(o+a+u)),u*=i,e.copy(r).addScaledVector(th,n).addScaledVector(eh,u))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var oh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},sh={h:0,s:0,l:0},lh={h:0,s:0,l:0};Hu(U.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(t,e,r){return t=Qu.euclideanModulo(t,1),e=Qu.clamp(e,0,1),r=Qu.clamp(r,0,1),0===e?this.r=this.g=this.b=r:(r=2*r-(e=r<=.5?r*(1+e):r+e-r*e),this.r=c(r,e,t+1/3),this.g=c(r,e,t),this.b=c(r,e,t-1/3)),this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=r[2];switch(r[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){var n=parseFloat(r[1])/360,i=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(n,i,a)}}}else if(r=/^#([A-Fa-f0-9]+)$/.exec(e)){if(3===(n=(r=r[1]).length))return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(t){var e=oh[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=h(t.r),this.g=h(t.g),this.b=h(t.b),this},copyLinearToSRGB:function(t){return this.r=p(t.r),this.g=p(t.g),this.b=p(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,r=this.r,n=this.g,i=this.b,a=Math.max(r,n,i),o=((l=Math.min(r,n,i))+a)/2;if(l===a)l=e=0;else{var s=a-l,l=o<=.5?s/(a+l):s/(2-a-l);switch(a){case r:e=(n-i)/s+(n<i?6:0);break;case n:e=(i-r)/s+2;break;case i:e=(r-n)/s+4}e/=6}return t.h=e,t.s=l,t.l=o,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,r){return this.getHSL(sh),sh.h+=t,sh.s+=e,sh.l+=r,this.setHSL(sh.h,sh.s,sh.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(sh),t.getHSL(lh),t=Qu.lerp(sh.h,lh.h,e);var r=Qu.lerp(sh.s,lh.s,e);return e=Qu.lerp(sh.l,lh.l,e),this.setHSL(t,r,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),U.NAMES=oh,Hu(y.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var uh=0;k.prototype=Hu(Uu(i.prototype),{constructor:k,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var r,n=t[e];void 0===n?console.warn("THREE.Material: '"+e+"' parameter is undefined."):"shading"===e?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n):void 0===(r=this[e])?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n}},toJSON:function(t){function e(t){var e,r=[];for(e in t){var n=t[e];delete n.metadata,r.push(n)}return r}var r=void 0===t||"string"==typeof t;r&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==zu(this.userData)&&(n.userData=this.userData),r&&(r=e(t.textures),t=e(t.images),0<r.length&&(n.textures=r),0<t.length&&(n.images=t)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,r=null;if(null!==e)for(var n=e.length,r=Array(n),i=0;i!==n;++i)r[i]=e[i].clone();return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(zu(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(k.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((H.prototype=Uu(k.prototype)).constructor=H).prototype.isMeshBasicMaterial=!0,H.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var ch=new Mt;Object.defineProperty(G.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Hu(G.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new U),e[r++]=a.r,e[r++]=a.g,e[r++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new At),e[r++]=a.x,e[r++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Mt),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new wt),e[r++]=a.x,e[r++]=a.y,e[r++]=a.z,e[r++]=a.w}return this},applyMatrix3:function(t){for(var e=0,r=this.count;e<r;e++)ch.x=this.getX(e),ch.y=this.getY(e),ch.z=this.getZ(e),ch.applyMatrix3(t),this.setXYZ(e,ch.x,ch.y,ch.z);return this},applyMatrix4:function(t){for(var e=0,r=this.count;e<r;e++)ch.x=this.getX(e),ch.y=this.getY(e),ch.z=this.getZ(e),ch.applyMatrix4(t),this.setXYZ(e,ch.x,ch.y,ch.z);return this},applyNormalMatrix:function(t){for(var e=0,r=this.count;e<r;e++)ch.x=this.getX(e),ch.y=this.getY(e),ch.z=this.getZ(e),ch.applyNormalMatrix(t),this.setXYZ(e,ch.x,ch.y,ch.z);return this},transformDirection:function(t){for(var e=0,r=this.count;e<r;e++)ch.x=this.getX(e),ch.y=this.getY(e),ch.z=this.getZ(e),ch.transformDirection(t),this.setXYZ(e,ch.x,ch.y,ch.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(m.prototype=Uu(G.prototype)).constructor=m,(x.prototype=Uu(G.prototype)).constructor=x,(_.prototype=Uu(G.prototype)).constructor=_,(A.prototype=Uu(G.prototype)).constructor=A,(w.prototype=Uu(G.prototype)).constructor=w,(M.prototype=Uu(G.prototype)).constructor=M,(C.prototype=Uu(G.prototype)).constructor=C,(I.prototype=Uu(G.prototype)).constructor=I,(S.prototype=Uu(G.prototype)).constructor=S,Hu(E.prototype,{computeGroups:function(t){var e=[],r=void 0;t=t.faces;for(var n=0;n<t.length;n++){var i,a=t[n];a.materialIndex!==r&&(r=a.materialIndex,void 0!==i&&(i.count=3*n-i.start,e.push(i)),i={start:3*n,materialIndex:r})}void 0!==i&&(i.count=3*n-i.start,e.push(i)),this.groups=e},fromGeometry:function(t){var e=t.faces,r=t.vertices,n=t.faceVertexUvs,i=n[0]&&0<n[0].length,a=n[1]&&0<n[1].length,o=t.morphTargets,s=o.length;if(0<s){for(var l=[],u=0;u<s;u++)l[u]={name:o[u].name,data:[]};this.morphTargets.position=l}var c=t.morphNormals,h=c.length;if(0<h){for(var d=[],u=0;u<h;u++)d[u]={name:c[u].name,data:[]};this.morphTargets.normal=d}var p=t.skinIndices,f=t.skinWeights,m=p.length===r.length,g=f.length===r.length;for(0<r.length&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),u=0;u<e.length;u++){var v=e[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;for(3===y.length?this.normals.push(y[0],y[1],y[2]):(y=v.normal,this.normals.push(y,y,y)),3===(y=v.vertexColors).length?this.colors.push(y[0],y[1],y[2]):(y=v.color,this.colors.push(y,y,y)),!0===i&&(void 0!==(y=n[0][u])?this.uvs.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new At,new At,new At))),!0===a&&(void 0!==(y=n[1][u])?this.uvs2.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new At,new At,new At))),y=0;y<s;y++){var x=o[y].vertices;l[y].data.push(x[v.a],x[v.b],x[v.c])}for(y=0;y<h;y++)x=c[y].vertexNormals[u],d[y].data.push(x.a,x.b,x.c);m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var hh=1,dh=new Ct,ph=new B,fh=new Mt,mh=new N,gh=new N,vh=new Mt;X.prototype=Hu(Uu(i.prototype),{constructor:X,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<L(t)?C:w)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e,r=this.attributes.position;return void 0!==r&&(r.applyMatrix4(t),r.needsUpdate=!0),void 0!==(r=this.attributes.normal)&&(e=(new g).getNormalMatrix(t),r.applyNormalMatrix(e),r.needsUpdate=!0),void 0!==(r=this.attributes.tangent)&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return dh.makeRotationX(t),this.applyMatrix4(dh),this},rotateY:function(t){return dh.makeRotationY(t),this.applyMatrix4(dh),this},rotateZ:function(t){return dh.makeRotationZ(t),this.applyMatrix4(dh),this},translate:function(t,e,r){return dh.makeTranslation(t,e,r),this.applyMatrix4(dh),this},scale:function(t,e,r){return dh.makeScale(t,e,r),this.applyMatrix4(dh),this},lookAt:function(t){return ph.lookAt(t),ph.updateMatrix(),this.applyMatrix4(ph.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(fh).negate(),this.translate(fh.x,fh.y,fh.z),this},setFromObject:function(t){var e,r=t.geometry;return t.isPoints||t.isLine?(t=new I(3*r.vertices.length,3),e=new I(3*r.colors.length,3),this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",e.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(t=new I(r.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(r.lineDistances))),null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone())):t.isMesh&&r&&r.isGeometry&&this.fromGeometry(r),this},setFromPoints:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new I(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var r=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(r=void 0,e.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(e);r.verticesNeedUpdate=e.verticesNeedUpdate,r.normalsNeedUpdate=e.normalsNeedUpdate,r.colorsNeedUpdate=e.colorsNeedUpdate,r.uvsNeedUpdate=e.uvsNeedUpdate,r.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=r}return!0===e.verticesNeedUpdate&&(void 0!==(r=this.attributes.position)&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(r=this.attributes.normal)&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(r=this.attributes.color)&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(r=this.attributes.uv)&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(r=this.attributes.lineDistance)&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new E).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e,r=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new G(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.setAttribute("normal",new G(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.setAttribute("color",new G(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new G(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new G(r,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var r=[],n=t.morphTargets[e],i=0,a=n.length;i<a;i++){var o=n[i],s=new I(3*o.data.length,3);s.name=o.name,r.push(s.copyVector3sArray(o.data))}this.morphAttributes[e]=r}return 0<t.skinIndices.length&&(e=new I(4*t.skinIndices.length,4),this.setAttribute("skinIndex",e.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(e=new I(4*t.skinWeights.length,4),this.setAttribute("skinWeight",e.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new N);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var t=0,r=e.length;t<r;t++)mh.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(vh.addVectors(this.boundingBox.min,mh.min),this.boundingBox.expandByPoint(vh),vh.addVectors(this.boundingBox.max,mh.max),this.boundingBox.expandByPoint(vh)):(this.boundingBox.expandByPoint(mh.min),this.boundingBox.expandByPoint(mh.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new z);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var r=this.boundingSphere.center;if(mh.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var a=e[n];gh.setFromBufferAttribute(a),this.morphTargetsRelative?(vh.addVectors(mh.min,gh.min),mh.expandByPoint(vh),vh.addVectors(mh.max,gh.max),mh.expandByPoint(vh)):(mh.expandByPoint(gh.min),mh.expandByPoint(gh.max))}mh.getCenter(r);for(var o=0,n=0,i=t.count;n<i;n++)vh.fromBufferAttribute(t,n),o=Math.max(o,r.distanceToSquared(vh));if(e)for(n=0,i=e.length;n<i;n++)for(var a=e[n],s=this.morphTargetsRelative,l=0,u=a.count;l<u;l++)vh.fromBufferAttribute(a,l),s&&(fh.fromBufferAttribute(t,l),vh.add(fh)),o=Math.max(o,r.distanceToSquared(vh));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var r=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new G(new Float32Array(r.length),3));else for(var n=0,i=(a=e.normal.array).length;n<i;n++)a[n]=0;var a=e.normal.array,o=new Mt,s=new Mt,l=new Mt,u=new Mt,c=new Mt;if(t)for(var h=t.array,n=0,i=t.count;n<i;n+=3){var t=3*h[n+0],d=3*h[n+1],p=3*h[n+2];o.fromArray(r,t),s.fromArray(r,d),l.fromArray(r,p),u.subVectors(l,s),c.subVectors(o,s),u.cross(c),a[t]+=u.x,a[t+1]+=u.y,a[t+2]+=u.z,a[d]+=u.x,a[1+d]+=u.y,a[2+d]+=u.z,a[p]+=u.x,a[1+p]+=u.y,a[2+p]+=u.z}else for(n=0,i=r.length;n<i;n+=9)o.fromArray(r,n),s.fromArray(r,n+3),l.fromArray(r,n+6),u.subVectors(l,s),c.subVectors(o,s),u.cross(c),a[n]=u.x,a[n+1]=u.y,a[n+2]=u.z,a[n+3]=u.x,a[n+4]=u.y,a[n+5]=u.z,a[n+6]=u.x,a[n+7]=u.y,a[n+8]=u.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r,n=this.attributes;for(r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=(s=t.attributes[r]).array,o=s.itemSize*e,s=Math.min(a.length,i.length-o),l=0;l<s;l++,o++)i[o]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,r=t.count;e<r;e++)vh.x=t.getX(e),vh.y=t.getY(e),vh.z=t.getZ(e),vh.normalize(),t.setXYZ(e,vh.x,vh.y,vh.z)},toNonIndexed:function(){function t(t,e){var r=t.array,n=t.itemSize;t=t.normalized;for(var i=new r.constructor(e.length*n),a=0,o=0,s=e.length;o<s;o++)for(var l=e[o]*n,u=0;u<n;u++)i[a++]=r[l++];return new G(i,n,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e,r=new X,n=this.index.array;for(e in l=this.attributes){var i=t(i=l[e],n);r.setAttribute(e,i)}var a=this.morphAttributes;for(e in a){for(var o=[],s=a[e],l=0,u=s.length;l<u;l++)i=t(i=s[l],n),o.push(i);r.morphAttributes[e]=o}for(r.morphTargetsRelative=this.morphTargetsRelative,l=0,e=(n=this.groups).length;l<e;l++)i=n[l],r.addGroup(i.start,i.count,i.materialIndex);return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Nu(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(u in e)void 0!==e[u]&&(t[u]=e[u]);return t}for(u in t.data={attributes:{}},null!==(e=this.index)&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)}),n=this.attributes){var r=(e=n[u]).toJSON();""!==e.name&&(r.name=e.name),t.data.attributes[u]=r}var n={},i=!1;for(u in this.morphAttributes){for(var a=this.morphAttributes[u],o=[],s=0,l=a.length;s<l;s++)r=(e=a[s]).toJSON(),""!==e.name&&(r.name=e.name),o.push(r);0<o.length&&(n[u]=o,i=!0)}i&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);var u=this.groups;return 0<u.length&&(t.data.groups=JSON.parse(zu(u))),null!==(u=this.boundingSphere)&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new X).copy(this)},copy:function(t){for(o in this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,null!==(i=t.index)&&this.setIndex(i.clone()),i=t.attributes)this.setAttribute(o,i[o].clone());var e=t.morphAttributes;for(o in e){for(var r=[],n=e[o],i=0,a=n.length;i<a;i++)r.push(n[i].clone());this.morphAttributes[o]=r}this.morphTargetsRelative=t.morphTargetsRelative;var o=t.groups;for(i=0,a=o.length;i<a;i++)e=o[i],this.addGroup(e.start,e.count,e.materialIndex);return null!==(o=t.boundingBox)&&(this.boundingBox=o.clone()),null!==(o=t.boundingSphere)&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var yh=new Ct,xh=new u,bh=new z,_h=new Mt,Ah=new Mt,wh=new Mt,Mh=new Mt,Ch=new Mt,Th=new Mt,Sh=new Mt,Eh=new Mt,Ih=new Mt,Lh=new At,Rh=new At,Ph=new At,Dh=new Mt,Oh=new Mt;V.prototype=Hu(Uu(B.prototype),{constructor:V,isMesh:!0,copy:function(t){return B.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Hu({},t.morphTargetDictionary)),this},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,e){var r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),bh.copy(r.boundingSphere),bh.applyMatrix4(i),!1!==t.ray.intersectsSphere(bh)&&(yh.getInverse(i),xh.copy(t.ray).applyMatrix4(yh),null===r.boundingBox||!1!==xh.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,i=r.attributes.position,o=r.morphAttributes.position,s=r.morphTargetsRelative,l=r.attributes.uv,u=r.attributes.uv2,c=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(n))for(var d=0,p=c.length;d<p;d++)for(var f=c[d],m=n[f.materialIndex],g=Math.max(f.start,h.start),v=r=Math.min(f.start+f.count,h.start+h.count);g<v;g+=3){var r=a.getX(g),y=a.getX(g+1),x=a.getX(g+2);(r=P(this,m,t,xh,i,o,s,l,u,r,y,x))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=f.materialIndex,e.push(r))}else for(d=g=Math.max(0,h.start),p=r=Math.min(a.count,h.start+h.count);d<p;d+=3)r=a.getX(d),y=a.getX(d+1),x=a.getX(d+2),(r=P(this,n,t,xh,i,o,s,l,u,r,y,x))&&(r.faceIndex=Math.floor(d/3),e.push(r));else if(void 0!==i)if(Array.isArray(n))for(d=0,p=c.length;d<p;d++)for(m=n[(f=c[d]).materialIndex],g=Math.max(f.start,h.start),v=r=Math.min(f.start+f.count,h.start+h.count);g<v;g+=3)(r=P(this,m,t,xh,i,o,s,l,u,r=g,y=g+1,x=g+2))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=f.materialIndex,e.push(r));else for(d=g=Math.max(0,h.start),p=r=Math.min(i.count,h.start+h.count);d<p;d+=3)(r=P(this,n,t,xh,i,o,s,l,u,r=d,y=d+1,x=d+2))&&(r.faceIndex=Math.floor(d/3),e.push(r))}else if(r.isGeometry)for(i=Array.isArray(n),o=r.vertices,s=r.faces,0<(r=r.faceVertexUvs[0]).length&&(a=r),h=0,d=s.length;h<d;h++)p=s[h],void 0!==(r=i?n[p.materialIndex]:n)&&(l=o[p.a],u=o[p.b],c=o[p.c],r=R(this,r,t,xh,l,u,c,Dh))&&(a&&a[h]&&(f=a[h],Lh.copy(f[0]),Rh.copy(f[1]),Ph.copy(f[2]),r.uv=b.getUV(Dh,l,u,c,Lh,Rh,Ph,new At)),r.face=p,r.faceIndex=h,e.push(r))},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Fh=0,Bh=new Ct,Nh=new B,zh=new Mt;D.prototype=Hu(Uu(i.prototype),{constructor:D,isGeometry:!0,applyMatrix4:function(t){for(var e=(new g).getNormalMatrix(t),r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(t);for(r=0,n=this.faces.length;r<n;r++){(t=this.faces[r]).normal.applyMatrix3(e).normalize();for(var i=0,a=t.vertexNormals.length;i<a;i++)t.vertexNormals[i].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return Bh.makeRotationX(t),this.applyMatrix4(Bh),this},rotateY:function(t){return Bh.makeRotationY(t),this.applyMatrix4(Bh),this},rotateZ:function(t){return Bh.makeRotationZ(t),this.applyMatrix4(Bh),this},translate:function(t,e,r){return Bh.makeTranslation(t,e,r),this.applyMatrix4(Bh),this},scale:function(t,e,r){return Bh.makeScale(t,e,r),this.applyMatrix4(Bh),this},lookAt:function(t){return Nh.lookAt(t),Nh.updateMatrix(),this.applyMatrix4(Nh.matrix),this},fromBufferGeometry:function(t){function e(t,e,r,n){var i=void 0===s?[]:[a.colors[t].clone(),a.colors[e].clone(),a.colors[r].clone()];n=new y(t,e,r,void 0===o?[]:[(new Mt).fromArray(o,3*t),(new Mt).fromArray(o,3*e),(new Mt).fromArray(o,3*r)],i,n),a.faces.push(n),void 0!==l&&a.faceVertexUvs[0].push([(new At).fromArray(l,2*t),(new At).fromArray(l,2*e),(new At).fromArray(l,2*r)]),void 0!==u&&a.faceVertexUvs[1].push([(new At).fromArray(u,2*t),(new At).fromArray(u,2*e),(new At).fromArray(u,2*r)])}var a=this,r=null!==t.index?t.index.array:void 0,n=t.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;for(void 0!==u&&(this.faceVertexUvs[1]=[]),n=0;n<i.length;n+=3)a.vertices.push((new Mt).fromArray(i,n)),void 0!==s&&a.colors.push((new U).fromArray(s,n));var c=t.groups;if(0<c.length)for(n=0;n<c.length;n++){var h=(i=c[n]).start,d=h;for(h+=i.count;d<h;d+=3)void 0!==r?e(r[d],r[d+1],r[d+2],i.materialIndex):e(d,d+1,d+2,i.materialIndex)}else if(void 0!==r)for(n=0;n<r.length;n+=3)e(r[n],r[n+1],r[n+2]);else for(n=0;n<i.length/3;n+=3)e(n,n+1,n+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(zh).negate(),this.translate(zh.x,zh.y,zh.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,r=new Ct;return r.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new Mt,e=new Mt,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],a=this.vertices[i.a],o=this.vertices[i.b];t.subVectors(this.vertices[i.c],o),e.subVectors(a,o),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e=Array(this.vertices.length),r=0;for(a=this.vertices.length;r<a;r++)e[r]=new Mt;if(t){var n=new Mt,i=new Mt;for(t=0,r=this.faces.length;t<r;t++){var a=this.faces[t],o=this.vertices[a.a],s=this.vertices[a.b],l=this.vertices[a.c];n.subVectors(l,s),i.subVectors(o,s),n.cross(i),e[a.a].add(n),e[a.b].add(n),e[a.c].add(n)}}else for(this.computeFaceNormals(),t=0,r=this.faces.length;t<r;t++)e[(a=this.faces[t]).a].add(a.normal),e[a.b].add(a.normal),e[a.c].add(a.normal);for(r=0,a=this.vertices.length;r<a;r++)e[r].normalize();for(t=0,r=this.faces.length;t<r;t++)3===(o=(a=this.faces[t]).vertexNormals).length?(o[0].copy(e[a.a]),o[1].copy(e[a.b]),o[2].copy(e[a.c])):(o[0]=e[a.a].clone(),o[1]=e[a.b].clone(),o[2]=e[a.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var t=0,e=this.faces.length;t<e;t++){var r=this.faces[t],n=r.vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t=0;for(o=this.faces.length;t<o;t++){var e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(var r=0,n=e.vertexNormals.length;r<n;r++)e.__originalVertexNormals[r]?e.__originalVertexNormals[r].copy(e.vertexNormals[r]):e.__originalVertexNormals[r]=e.vertexNormals[r].clone()}var i=new D;for(i.faces=this.faces,r=0,n=this.morphTargets.length;r<n;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[];for(var e=this.morphNormals[r].faceNormals,a=this.morphNormals[r].vertexNormals,t=0,o=this.faces.length;t<o;t++){var s=new Mt,l={a:new Mt,b:new Mt,c:new Mt};e.push(s),a.push(l)}}for(a=this.morphNormals[r],i.vertices=this.morphTargets[r].vertices,i.computeFaceNormals(),i.computeVertexNormals(),t=0,o=this.faces.length;t<o;t++)e=this.faces[t],s=a.faceNormals[t],l=a.vertexNormals[t],s.copy(e.normal),l.a.copy(e.vertexNormals[0]),l.b.copy(e.vertexNormals[1]),l.c.copy(e.vertexNormals[2])}for(t=0,o=this.faces.length;t<o;t++)(e=this.faces[t]).normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new N),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new z),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,r){if(t&&t.isGeometry){var n,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,u=this.colors,c=t.colors;void 0===r&&(r=0),void 0!==e&&(n=(new g).getNormalMatrix(e));for(var h=0,d=o.length;h<d;h++){var p=o[h].clone();void 0!==e&&p.applyMatrix4(e),a.push(p)}for(h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(h=0,d=l.length;h<d;h++){var f=(o=l[h]).vertexNormals,c=o.vertexColors;for((u=new y(o.a+i,o.b+i,o.c+i)).normal.copy(o.normal),void 0!==n&&u.normal.applyMatrix3(n).normalize(),e=0,a=f.length;e<a;e++)p=f[e].clone(),void 0!==n&&p.applyMatrix3(n).normalize(),u.vertexNormals.push(p);for(u.color.copy(o.color),e=0,a=c.length;e<a;e++)p=c[e],u.vertexColors.push(p.clone());u.materialIndex=o.materialIndex+r,s.push(u)}for(h=0,d=t.faceVertexUvs.length;h<d;h++)for(r=t.faceVertexUvs[h],void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]),e=0,a=r.length;e<a;e++){for(i=[],s=0,l=(n=r[e]).length;s<l;s++)i.push(n[s].clone());this.faceVertexUvs[h].push(i)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){for(var t={},e=[],r=[],n=Math.pow(10,4),i=0,a=this.vertices.length;i<a;i++){var o=this.vertices[i];void 0===t[o=Math.round(o.x*n)+"_"+Math.round(o.y*n)+"_"+Math.round(o.z*n)]?(t[o]=i,e.push(this.vertices[i]),r[i]=e.length-1):r[i]=r[t[o]]}for(t=[],i=0,a=this.faces.length;i<a;i++)for((n=this.faces[i]).a=r[n.a],n.b=r[n.b],n.c=r[n.c],n=[n.a,n.b,n.c],o=0;o<3;o++)if(n[o]===n[(o+1)%3]){t.push(i);break}for(i=t.length-1;0<=i;i--)for(n=t[i],this.faces.splice(n,1),r=0,a=this.faceVertexUvs.length;r<a;r++)this.faceVertexUvs[r].splice(n,1);return i=this.vertices.length-e.length,this.vertices=e,i},setFromPoints:function(t){this.vertices=[];for(var e=0,r=t.length;e<r;e++){var n=t[e];this.vertices.push(new Mt(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,r=0;r<e;r++)t[r]._id=r;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];for(a&&a.length===e&&(n=[]),o&&o.length===e&&(i=[]),r=0;r<e;r++){var s=t[r]._id;n&&n.push(a[s]),i&&i.push(o[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function t(t,e,r){return r?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function r(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=u.length,u.push(t.getHex())),c[e]}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var a=this.parameters;for(p in a)void 0!==a[p]&&(i[p]=a[p]);return i}for(a=[],p=0;p<this.vertices.length;p++){var o=this.vertices[p];a.push(o.x,o.y,o.z)}for(var o=[],s=[],l={},u=[],c={},h=[],d={},p=0;p<this.faces.length;p++){var f,m=this.faces[p],g=void 0!==this.faceVertexUvs[0][p],v=0<m.normal.length(),y=0<m.vertexNormals.length,x=1!==m.color.r||1!==m.color.g||1!==m.color.b,b=0<m.vertexColors.length;f=t(2,3,g),f=t(f,4,v),f=t(f,5,y),f=t(f,6,x),f=t(f,7,b),o.push(f),o.push(m.a,m.b,m.c),o.push(m.materialIndex),g&&(g=this.faceVertexUvs[0][p],o.push(n(g[0]),n(g[1]),n(g[2]))),v&&o.push(e(m.normal)),y&&(v=m.vertexNormals,o.push(e(v[0]),e(v[1]),e(v[2]))),x&&o.push(r(m.color)),b&&(m=m.vertexColors,o.push(r(m[0]),r(m[1]),r(m[2])))}return i.data={},i.data.vertices=a,i.data.normals=s,0<u.length&&(i.data.colors=u),0<h.length&&(i.data.uvs=[h]),i.data.faces=o,i},clone:function(){return(new D).copy(this)},copy:function(t){var e;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;for(var r=t.vertices,n=0,i=r.length;n<i;n++)this.vertices.push(r[n].clone());for(n=0,i=(r=t.colors).length;n<i;n++)this.colors.push(r[n].clone());for(n=0,i=(r=t.faces).length;n<i;n++)this.faces.push(r[n].clone());for(n=0,i=t.faceVertexUvs.length;n<i;n++){var a=t.faceVertexUvs[n];for(void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]),r=0,e=a.length;r<e;r++){for(var o=a[r],s=[],l=0,u=o.length;l<u;l++)s.push(o[l].clone());this.faceVertexUvs[n].push(s)}}for(n=0,i=(l=t.morphTargets).length;n<i;n++){if((u={}).name=l[n].name,void 0!==l[n].vertices)for(u.vertices=[],r=0,e=l[n].vertices.length;r<e;r++)u.vertices.push(l[n].vertices[r].clone());if(void 0!==l[n].normals)for(u.normals=[],r=0,e=l[n].normals.length;r<e;r++)u.normals.push(l[n].normals[r].clone());this.morphTargets.push(u)}for(n=0,i=(l=t.morphNormals).length;n<i;n++){if(u={},void 0!==l[n].vertexNormals)for(u.vertexNormals=[],r=0,e=l[n].vertexNormals.length;r<e;r++)a=l[n].vertexNormals[r],(o={}).a=a.a.clone(),o.b=a.b.clone(),o.c=a.c.clone(),u.vertexNormals.push(o);if(void 0!==l[n].faceNormals)for(u.faceNormals=[],r=0,e=l[n].faceNormals.length;r<e;r++)u.faceNormals.push(l[n].faceNormals[r].clone());this.morphNormals.push(u)}for(n=0,i=(r=t.skinWeights).length;n<i;n++)this.skinWeights.push(r[n].clone());for(n=0,i=(r=t.skinIndices).length;n<i;n++)this.skinIndices.push(r[n].clone());for(n=0,i=(r=t.lineDistances).length;n<i;n++)this.lineDistances.push(r[n]);return null!==(n=t.boundingBox)&&(this.boundingBox=n.clone()),null!==(n=t.boundingSphere)&&(this.boundingSphere=n.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var cs=function(){function s(t,e,r,n,i,a){ju(this,s);var o=Xu(this,(s.__proto__||Iu(s)).call(this));return o.type="BoxGeometry",o.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a},o.fromBufferGeometry(new Uh(t,e,r,n,i,a)),o.mergeVertices(),o}return Zu(s,D),s}(),Uh=function(){function l(t,e,r,n,i,a){function o(t,e,r,n,i,a,o,s,l,u,c){var h=a/l,d=o/u,p=a/2,f=o/2,m=s/2;o=l+1;for(var g=u+1,v=a=0,y=new Mt,x=0;x<g;x++)for(var b=x*d-f,_=0;_<o;_++)y[t]=(_*h-p)*n,y[e]=b*i,y[r]=m,M.push(y.x,y.y,y.z),y[t]=0,y[e]=0,y[r]=0<s?1:-1,C.push(y.x,y.y,y.z),T.push(_/l),T.push(1-x/u),a+=1;for(t=0;t<u;t++)for(e=0;e<l;e++)r=S+e+o*(t+1),n=S+(e+1)+o*(t+1),i=S+(e+1)+o*t,w.push(S+e+o*t,r,i),w.push(r,n,i),v+=6;A.addGroup(E,v,c),E+=v,S+=a}ju(this,l);var s=Xu(this,(l.__proto__||Iu(l)).call(this));s.type="BoxBufferGeometry",s.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var A=s;t=t||1,e=e||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var w=[],M=[],C=[],T=[],S=0,E=0;return o("z","y","x",-1,-1,r,e,t,a,i,0),o("z","y","x",1,-1,r,e,-t,a,i,1),o("x","z","y",1,1,t,r,e,n,a,2),o("x","z","y",1,-1,t,r,-e,n,a,3),o("x","y","z",1,-1,t,e,r,n,i,4),o("x","y","z",-1,-1,t,e,-r,n,i,5),s.setIndex(w),s.setAttribute("position",new I(M,3)),s.setAttribute("normal",new I(C,3)),s.setAttribute("uv",new I(T,2)),s}return Zu(l,X),l}(),kh={clone:O,merge:F};((W.prototype=Uu(k.prototype)).constructor=W).prototype.isShaderMaterial=!0,W.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=O(t.uniforms),this.defines=Hu({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Hu({},t.extensions),this},W.prototype.toJSON=function(t){var e,r,n=k.prototype.toJSON.call(this,t);for(e in n.uniforms={},this.uniforms){var i=this.uniforms[e].value;n.uniforms[e]=i&&i.isTexture?{type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?{type:"c",value:i.getHex()}:i&&i.isVector2?{type:"v2",value:i.toArray()}:i&&i.isVector3?{type:"v3",value:i.toArray()}:i&&i.isVector4?{type:"v4",value:i.toArray()}:i&&i.isMatrix3?{type:"m3",value:i.toArray()}:i&&i.isMatrix4?{type:"m4",value:i.toArray()}:{value:i}}for(r in 0<Nu(this.defines).length&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,t={},this.extensions)!0===this.extensions[r]&&(t[r]=!0);return 0<Nu(t).length&&(n.extensions=t),n},j.prototype=Hu(Uu(B.prototype),{constructor:j,isCamera:!0,copy:function(t,e){return B.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Mt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){B.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){B.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),q.prototype=Hu(Uu(j.prototype),{constructor:q,isPerspectiveCamera:!0,copy:function(t,e){return j.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Hu({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*Qu.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Qu.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Qu.RAD2DEG*Math.atan(Math.tan(.5*Qu.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,r,n,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e,r=this.near,n=r*Math.tan(.5*Qu.DEG2RAD*this.fov)/this.zoom,i=2*n,a=this.aspect*i,o=-.5*a,s=this.view;null!==this.view&&this.view.enabled&&(t=s.fullWidth,e=s.fullHeight,o+=s.offsetX*a/t,n-=s.offsetY*i/e,a*=s.width/t,i*=s.height/e),0!==(s=this.filmOffset)&&(o+=r*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+a,n,n-i,r,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=B.prototype.toJSON.call(this,t)).object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Hu({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),(Y.prototype=Uu(B.prototype)).constructor=Y,((Z.prototype=Uu(T.prototype)).constructor=Z).prototype.isWebGLCubeRenderTarget=!0,Z.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var r=new Tt,n=new W({type:"CubemapFromEquirect",uniforms:O({tEquirect:{value:null}}),vertexShader:"varying vec3 vWorldDirection;\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",fragmentShader:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}",side:1,blending:0});return n.uniforms.tEquirect.value=e,e=new V(new Uh(5,5,5),n),r.add(e),new Y(1,10,this).update(t,r),e.geometry.dispose(),e.material.dispose(),this},((St.prototype=Uu(d.prototype)).constructor=St).prototype.isDataTexture=!0;var Hh=new z,Gh=new Mt;Hu(Et.prototype,{set:function(t,e,r,n,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this},setFromProjectionMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var r=g[1],n=g[2],i=g[3],a=g[4],o=g[5],s=g[6],l=g[7],u=g[8],c=g[9],h=g[10],d=g[11],p=g[12],f=g[13],m=g[14],g=g[15];return e[0].setComponents(i-t,l-a,d-u,g-p).normalize(),e[1].setComponents(i+t,l+a,d+u,g+p).normalize(),e[2].setComponents(i+r,l+o,d+c,g+f).normalize(),e[3].setComponents(i-r,l-o,d-c,g-f).normalize(),e[4].setComponents(i-n,l-s,d-h,g-m).normalize(),e[5].setComponents(i+n,l+s,d+h,g+m).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Hh.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Hh)},intersectsSprite:function(t){return Hh.center.set(0,0,0),Hh.radius=.7071067811865476,Hh.applyMatrix4(t.matrixWorld),this.intersectsSphere(Hh)},intersectsSphere:function(t){var e=this.planes,r=t.center;t=-t.radius;for(var n=0;n<6;n++)if(e[n].distanceToPoint(r)<t)return!1;return!0},intersectsBox:function(t){for(var e=this.planes,r=0;r<6;r++){var n=e[r];if(Gh.x=(0<n.normal.x?t.max:t.min).x,Gh.y=(0<n.normal.y?t.max:t.min).y,Gh.z=(0<n.normal.z?t.max:t.min).z,n.distanceToPoint(Gh)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}});var Vh={common:{diffuse:{value:new U(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new g},uv2Transform:{value:new g},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new At(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new U(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new U(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new g}},sprite:{diffuse:{value:new U(15658734)},opacity:{value:1},center:{value:new At(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new g}}};(J.prototype=Uu(D.prototype)).constructor=J,(K.prototype=Uu(X.prototype)).constructor=K;var Wh={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},jh={basic:{uniforms:F([Vh.common,Vh.specularmap,Vh.envmap,Vh.aomap,Vh.lightmap,Vh.fog]),vertexShader:Wh.meshbasic_vert,fragmentShader:Wh.meshbasic_frag},lambert:{uniforms:F([Vh.common,Vh.specularmap,Vh.envmap,Vh.aomap,Vh.lightmap,Vh.emissivemap,Vh.fog,Vh.lights,{emissive:{value:new U(0)}}]),vertexShader:Wh.meshlambert_vert,fragmentShader:Wh.meshlambert_frag},phong:{uniforms:F([Vh.common,Vh.specularmap,Vh.envmap,Vh.aomap,Vh.lightmap,Vh.emissivemap,Vh.bumpmap,Vh.normalmap,Vh.displacementmap,Vh.fog,Vh.lights,{emissive:{value:new U(0)},specular:{value:new U(1118481)},shininess:{value:30}}]),vertexShader:Wh.meshphong_vert,fragmentShader:Wh.meshphong_frag},standard:{uniforms:F([Vh.common,Vh.envmap,Vh.aomap,Vh.lightmap,Vh.emissivemap,Vh.bumpmap,Vh.normalmap,Vh.displacementmap,Vh.roughnessmap,Vh.metalnessmap,Vh.fog,Vh.lights,{emissive:{value:new U(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wh.meshphysical_vert,fragmentShader:Wh.meshphysical_frag},toon:{uniforms:F([Vh.common,Vh.specularmap,Vh.aomap,Vh.lightmap,Vh.emissivemap,Vh.bumpmap,Vh.normalmap,Vh.displacementmap,Vh.gradientmap,Vh.fog,Vh.lights,{emissive:{value:new U(0)},specular:{value:new U(1118481)},shininess:{value:30}}]),vertexShader:Wh.meshtoon_vert,fragmentShader:Wh.meshtoon_frag},matcap:{uniforms:F([Vh.common,Vh.bumpmap,Vh.normalmap,Vh.displacementmap,Vh.fog,{matcap:{value:null}}]),vertexShader:Wh.meshmatcap_vert,fragmentShader:Wh.meshmatcap_frag},points:{uniforms:F([Vh.points,Vh.fog]),vertexShader:Wh.points_vert,fragmentShader:Wh.points_frag},dashed:{uniforms:F([Vh.common,Vh.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wh.linedashed_vert,fragmentShader:Wh.linedashed_frag},depth:{uniforms:F([Vh.common,Vh.displacementmap]),vertexShader:Wh.depth_vert,fragmentShader:Wh.depth_frag},normal:{uniforms:F([Vh.common,Vh.bumpmap,Vh.normalmap,Vh.displacementmap,{opacity:{value:1}}]),vertexShader:Wh.normal_vert,fragmentShader:Wh.normal_frag},sprite:{uniforms:F([Vh.sprite,Vh.fog]),vertexShader:Wh.sprite_vert,fragmentShader:Wh.sprite_frag},background:{uniforms:{uvTransform:{value:new g},t2D:{value:null}},vertexShader:Wh.background_vert,fragmentShader:Wh.background_frag},cube:{uniforms:F([Vh.envmap,{opacity:{value:1}}]),vertexShader:Wh.cube_vert,fragmentShader:Wh.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wh.equirect_vert,fragmentShader:Wh.equirect_frag},distanceRGBA:{uniforms:F([Vh.common,Vh.displacementmap,{referencePosition:{value:new Mt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wh.distanceRGBA_vert,fragmentShader:Wh.distanceRGBA_frag},shadow:{uniforms:F([Vh.lights,Vh.fog,{color:{value:new U(0)},opacity:{value:1}}]),vertexShader:Wh.shadow_vert,fragmentShader:Wh.shadow_frag}};jh.physical={uniforms:F([jh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new At(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new U(0)},transparency:{value:0}}]),vertexShader:Wh.meshphysical_vert,fragmentShader:Wh.meshphysical_frag},(($.prototype=Uu(d.prototype)).constructor=$).prototype.isCubeTexture=!0,Object.defineProperty($.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),((tt.prototype=Uu(d.prototype)).constructor=tt).prototype.isDataTexture2DArray=!0,((et.prototype=Uu(d.prototype)).constructor=et).prototype.isDataTexture3D=!0;var Xh=new d,qh=new tt,Yh=new et,Zh=new $,Jh=[],Kh=[],Qh=new Float32Array(16),$h=new Float32Array(9),td=new Float32Array(4);ee.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),it(e,t)},re.prototype.setValue=function(t,e,r){for(var n=this.seq,i=0,a=n.length;i!==a;++i){var o=n[i];o.setValue(t,e[o.id],r)}};var ed=/([\w\d_]+)(\])?(\[|\.)?/g;ne.prototype.setValue=function(t,e,r,n){void 0!==(e=this.map[e])&&e.setValue(t,r,n)},ne.prototype.setOptional=function(t,e,r){void 0!==(e=e[r])&&this.setValue(t,r,e)},ne.upload=function(t,e,r,n){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=r[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},ne.seqWithValue=function(t,e){for(var r=[],n=0,i=t.length;n!==i;++n){var a=t[n];a.id in e&&r.push(a)}return r};var rd=0,nd=/^[ \t]*#include +<([\w\d./]+)>/gm,id=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ad=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,od=0;((Se.prototype=Uu(k.prototype)).constructor=Se).prototype.isMeshDepthMaterial=!0,Se.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((Ee.prototype=Uu(k.prototype)).constructor=Ee).prototype.isMeshDistanceMaterial=!0,Ee.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},De.prototype=Hu(Uu(q.prototype),{constructor:De,isArrayCamera:!0}),Oe.prototype=Hu(Uu(B.prototype),{constructor:Oe,isGroup:!0}),Hu(Fe.prototype,{constructor:Fe,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Oe,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Oe,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(t,e,r){var n=null,i=null,a=this._targetRay,o=this._grip;return t&&(null!==a&&(null!==(n=e.getPose(t.targetRaySpace,r))&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale))),null!==o&&t.gripSpace&&(null!==(i=e.getPose(t.gripSpace,r))&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)))),null!==a&&(a.visible=null!==n),null!==o&&(o.visible=null!==i),this}}),Hu(Be.prototype,i.prototype),Hu(Ue.prototype,{isFogExp2:!0,clone:function(){return new Ue(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Hu(ke.prototype,{isFog:!0,clone:function(){return new ke(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(He.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Hu(He.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var sd=new Mt;ku(Ge.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Hu(Ge.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,r=this.data.count;e<r;e++)sd.x=this.getX(e),sd.y=this.getY(e),sd.z=this.getZ(e),sd.applyMatrix4(t),this.setXYZ(e,sd.x,sd.y,sd.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this},clone:function(){for(var t=[],e=0;e<this.count;e++)for(var r=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[r+n]);return new G(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(){for(var t=[],e=0;e<this.count;e++)for(var r=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[r+n]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}),((Ve.prototype=Uu(k.prototype)).constructor=Ve).prototype.isSpriteMaterial=!0,Ve.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var ld,ud=new Mt,cd=new Mt,hd=new Mt,dd=new At,pd=new At,fd=new Ct,md=new Mt,gd=new Mt,vd=new Mt,yd=new At,xd=new At,bd=new At;We.prototype=Hu(Uu(B.prototype),{constructor:We,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),cd.setFromMatrixScale(this.matrixWorld),fd.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),hd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&cd.multiplyScalar(-hd.z);var r,n,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i)),i=this.center,je(md.set(-.5,-.5,0),hd,i,cd,n,r),je(gd.set(.5,-.5,0),hd,i,cd,n,r),je(vd.set(.5,.5,0),hd,i,cd,n,r),yd.set(0,0),xd.set(1,0),bd.set(1,1);var a=t.ray.intersectTriangle(md,gd,vd,!1,ud);null===a&&(je(gd.set(-.5,.5,0),hd,i,cd,n,r),xd.set(0,1),null===t.ray.intersectTriangle(md,vd,gd,!1,ud))||(n=t.ray.origin.distanceTo(ud))<t.near||n>t.far||e.push({distance:n,point:ud.clone(),uv:b.getUV(ud,md,gd,vd,yd,xd,bd,new At),face:null,object:this})},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return B.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var _d=new Mt,Ad=new Mt;Xe.prototype=Hu(Uu(B.prototype),{constructor:Xe,isLOD:!0,copy:function(t){B.prototype.copy.call(this,t,!1);for(var e=t.levels,r=0,n=e.length;r<n;r++){var i=e[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,n=0;n<r.length&&!(e<r[n].distance);n++);return r.splice(n,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(0<e.length){for(var r=1,n=e.length;r<n&&!(t<e[r].distance);r++);return e[r-1].object}return null},raycast:function(t,e){var r;0<this.levels.length&&(_d.setFromMatrixPosition(this.matrixWorld),r=t.ray.origin.distanceTo(_d),this.getObjectForDistance(r).raycast(t,e))},update:function(t){var e=this.levels;if(1<e.length){_d.setFromMatrixPosition(t.matrixWorld),Ad.setFromMatrixPosition(this.matrixWorld),t=_d.distanceTo(Ad)/t.zoom,e[0].object.visible=!0;for(var r=1,n=e.length;r<n&&t>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<n;r++)e[r].object.visible=!1}},toJSON:function(t){t=B.prototype.toJSON.call(this,t),!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var e=this.levels,r=0,n=e.length;r<n;r++){var i=e[r];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),qe.prototype=Hu(Uu(V.prototype),{constructor:qe,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new wt,e=this.geometry.attributes.skinWeight,r=0,n=e.count;r<n;r++){t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.w=e.getW(r);var i=1/t.manhattanLength();1/0!=i?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){V.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var a=new Mt,o=new wt,s=new wt,l=new Mt,u=new Ct;return function(t,e){var r,n=this.skeleton,i=this.geometry;for(o.fromBufferAttribute(i.attributes.skinIndex,t),s.fromBufferAttribute(i.attributes.skinWeight,t),a.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0),t=0;t<4;t++)0!==(i=s.getComponent(t))&&(r=o.getComponent(t),u.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(l.copy(a).applyMatrix4(u),i));return e.applyMatrix4(this.bindMatrixInverse)}}()});var wd=new Ct,Md=new Ct;Hu(Ye.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var r=new Ct;this.bones[t]&&r.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(r)}},pose:function(){for(var t,e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,i=0,a=t.length;i<a;i++)wd.multiplyMatrices(t[i]?t[i].matrixWorld:Md,e[i]),wd.toArray(r,16*i);void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new Ye(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,r=this.bones.length;e<r;e++){var n=this.bones[e];if(n.name===t)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Ze.prototype=Hu(Uu(B.prototype),{constructor:Ze,isBone:!0});var Cd=new Ct,Td=new Ct,Sd=[],Ed=new V;Je.prototype=Hu(Uu(V.prototype),{constructor:Je,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var r=this.matrixWorld,n=this.count;if(Ed.geometry=this.geometry,Ed.material=this.material,void 0!==Ed.material)for(var i=0;i<n;i++){this.getMatrixAt(i,Cd),Td.multiplyMatrices(r,Cd),Ed.matrixWorld=Td,Ed.raycast(t,Sd);for(var a=0,o=Sd.length;a<o;a++){var s=Sd[a];s.instanceId=i,s.object=this,e.push(s)}Sd.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),((Ke.prototype=Uu(k.prototype)).constructor=Ke).prototype.isLineBasicMaterial=!0,Ke.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var Id=new Mt,Ld=new Mt,Rd=new Ct,Pd=new u,Dd=new z;Qe.prototype=Hu(Uu(B.prototype),{constructor:Qe,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[0],n=1,i=e.count;n<i;n++)Id.fromBufferAttribute(e,n-1),Ld.fromBufferAttribute(e,n),r[n]=r[n-1],r[n]+=Id.distanceTo(Ld);t.setAttribute("lineDistance",new I(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,(r=t.lineDistances)[0]=0,n=1,i=e.length;n<i;n++)r[n]=r[n-1],r[n]+=e[n-1].distanceTo(e[n]);return this},raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),Dd.copy(r.boundingSphere),Dd.applyMatrix4(n),Dd.radius+=i,!1!==t.ray.intersectsSphere(Dd)){Rd.getInverse(n),Pd.copy(t.ray).applyMatrix4(Rd),n=i/((this.scale.x+this.scale.y+this.scale.z)/3),n*=n;var a=new Mt,o=new Mt,i=new Mt,s=new Mt,l=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var u=r.index,c=r.attributes.position.array;if(null!==u)for(var r=0,h=(u=u.array).length-1;r<h;r+=l){var d=u[r+1];a.fromArray(c,3*u[r]),o.fromArray(c,3*d),n<(d=Pd.distanceSqToSegment(a,o,s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else for(r=0,h=c.length/3-1;r<h;r+=l)a.fromArray(c,3*r),o.fromArray(c,3*r+3),n<(d=Pd.distanceSqToSegment(a,o,s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else if(r.isGeometry)for(o=(a=r.vertices).length,r=0;r<o-1;r+=l)n<(d=Pd.distanceSqToSegment(a[r],a[r+1],s,i))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:i.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Od=new Mt,Fd=new Mt;$e.prototype=Hu(Uu(Qe.prototype),{constructor:$e,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,r=[],n=0,i=e.count;n<i;n+=2)Od.fromBufferAttribute(e,n),Fd.fromBufferAttribute(e,n+1),r[n]=0===n?0:r[n-1],r[n+1]=r[n]+Od.distanceTo(Fd);t.setAttribute("lineDistance",new I(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,r=t.lineDistances,n=0,i=e.length;n<i;n+=2)Od.copy(e[n]),Fd.copy(e[n+1]),r[n]=0===n?0:r[n-1],r[n+1]=r[n]+Od.distanceTo(Fd);return this}}),tr.prototype=Hu(Uu(Qe.prototype),{constructor:tr,isLineLoop:!0}),((er.prototype=Uu(k.prototype)).constructor=er).prototype.isPointsMaterial=!0,er.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Bd=new Ct,Nd=new u,zd=new z,Ud=new Mt;rr.prototype=Hu(Uu(B.prototype),{constructor:rr,isPoints:!0,raycast:function(t,e){var r=this.geometry,n=this.matrixWorld,i=t.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),zd.copy(r.boundingSphere),zd.applyMatrix4(n),zd.radius+=i,!1!==t.ray.intersectsSphere(zd))if(Bd.getInverse(n),Nd.copy(t.ray).applyMatrix4(Bd),i/=(this.scale.x+this.scale.y+this.scale.z)/3,i*=i,r.isBufferGeometry){var a=r.index,r=r.attributes.position.array;if(null!==a)for(var o=a.array,a=0,s=o.length;a<s;a++){var l=o[a];Ud.fromArray(r,3*l),nr(Ud,l,i,n,t,e,this)}else for(a=0,o=r.length/3;a<o;a++)Ud.fromArray(r,3*a),nr(Ud,a,i,n,t,e,this)}else for(a=0,o=(r=r.vertices).length;a<o;a++)nr(r[a],a,i,n,t,e,this)},updateMorphTargets:function(){if((t=this.geometry).isBufferGeometry){var t=t.morphAttributes,e=Nu(t);if(0<e.length){var r=t[e[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=r.length;t<e;t++){var n=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ir.prototype=Hu(Uu(d.prototype),{constructor:ir,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((ar.prototype=Uu(d.prototype)).constructor=ar).prototype.isCompressedTexture=!0,((or.prototype=Uu(d.prototype)).constructor=or).prototype.isCanvasTexture=!0,((sr.prototype=Uu(d.prototype)).constructor=sr).prototype.isDepthTexture=!0,(lr.prototype=Uu(X.prototype)).constructor=lr,(ur.prototype=Uu(D.prototype)).constructor=ur,(cr.prototype=Uu(X.prototype)).constructor=cr,(hr.prototype=Uu(D.prototype)).constructor=hr,(dr.prototype=Uu(X.prototype)).constructor=dr,(pr.prototype=Uu(D.prototype)).constructor=pr,(fr.prototype=Uu(dr.prototype)).constructor=fr,(mr.prototype=Uu(D.prototype)).constructor=mr,(gr.prototype=Uu(dr.prototype)).constructor=gr,(vr.prototype=Uu(D.prototype)).constructor=vr,(yr.prototype=Uu(dr.prototype)).constructor=yr,(xr.prototype=Uu(D.prototype)).constructor=xr,(br.prototype=Uu(dr.prototype)).constructor=br,(_r.prototype=Uu(D.prototype)).constructor=_r,((Ar.prototype=Uu(X.prototype)).constructor=Ar).prototype.toJSON=function(){var t=X.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(wr.prototype=Uu(D.prototype)).constructor=wr,(Mr.prototype=Uu(X.prototype)).constructor=Mr,(Cr.prototype=Uu(D.prototype)).constructor=Cr,(Tr.prototype=Uu(X.prototype)).constructor=Tr;var kd=function(t,e,r){r=r||2;var n,i=(l=e&&e.length)?e[0]*r:t.length,a=Sr(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;if(l){for(var s=r,l=[],u=0,c=e.length;u<c;u++){var h=e[u]*s;(h=Sr(t,h,u<c-1?e[u+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),l.push(function(t){for(var e=t,r=t;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next,e!==t;);return r}(h))}for(l.sort(Lr),u=0;u<l.length;u++)(e=function(t,e){var r=e,n=t.x,i=t.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&a<o){if((a=o)===n){if(i===r.y)return r;if(i===r.next.y)return r.next}var s=r.x<r.next.x?r:r.next}}}while((r=r.next)!==e);if(!s)return null;if(n===a)return s;var l,u,o=(e=s).x,c=s.y,h=1/0,r=s;do{}while(n>=r.x&&r.x>=o&&n!==r.x&&Pr(i<c?n:a,i,o,c,i<c?a:n,i,r.x,r.y)&&(l=Math.abs(i-r.y)/(n-r.x),(u=(u=zr(r,t))&&!(u=l<h)&&(u=l===h)&&!(u=r.x>s.x)&&(u=r.x===s.x)?Dr((u=s).prev,u,r.prev)<0&&Dr(r.next,u,u.next)<0:u)&&(s=r,h=l)),(r=r.next)!==e);return s}(s=l[u],e=a))&&(s=Ur(e,s),Er(e,e.next),Er(s,s.next)),a=Er(a,a.next)}if(t.length>80*r){for(var d=n=t[0],p=l=t[1],s=r;s<i;s+=r)(u=t[s])<d&&(d=u),(e=t[s+1])<p&&(p=e),n<u&&(n=u),l<e&&(l=e);n=0!==(n=Math.max(n-d,l-p))?1/n:0}return Ir(a,o,r,d,p,n),o},Hd={area:function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},isClockWise:function(t){return Hd.area(t)<0},triangulateShape:function(t,e){var r=[],n=[],i=[];Vr(t),Wr(r,t);var a=t.length;for(e.forEach(Vr),t=0;t<e.length;t++)n.push(a),a+=e[t].length,Wr(r,e[t]);for(e=kd(r,n),t=0;t<e.length;t+=3)i.push(e.slice(t,t+3));return i}};((jr.prototype=Uu(D.prototype)).constructor=jr).prototype.toJSON=function(){var t=D.prototype.toJSON.call(this);return qr(this.parameters.shapes,this.parameters.options,t)},((Xr.prototype=Uu(X.prototype)).constructor=Xr).prototype.toJSON=function(){var t=X.prototype.toJSON.call(this);return qr(this.parameters.shapes,this.parameters.options,t)};var Gd={generateTopUV:function(t,e,r,n,i){t=e[3*n],n=e[3*n+1];var a=e[3*i];return i=e[3*i+1],[new At(e[3*r],e[3*r+1]),new At(t,n),new At(a,i)]},generateSideWallUV:function(t,e,r,n,i,a){t=e[3*r];var o=e[3*r+1];r=e[3*r+2];var s=e[3*n],l=e[3*n+1];n=e[3*n+2];var u=e[3*i],c=e[3*i+1];i=e[3*i+2];var h=e[3*a],d=e[3*a+1];return e=e[3*a+2],Math.abs(o-l)<.01?[new At(t,1-r),new At(s,1-n),new At(u,1-i),new At(h,1-e)]:[new At(o,1-r),new At(l,1-n),new At(c,1-i),new At(d,1-e)]}};(Yr.prototype=Uu(D.prototype)).constructor=Yr,(Zr.prototype=Uu(Xr.prototype)).constructor=Zr,(Jr.prototype=Uu(D.prototype)).constructor=Jr,(Kr.prototype=Uu(X.prototype)).constructor=Kr,(Qr.prototype=Uu(D.prototype)).constructor=Qr,($r.prototype=Uu(X.prototype)).constructor=$r,(tn.prototype=Uu(D.prototype)).constructor=tn,(en.prototype=Uu(X.prototype)).constructor=en,((rn.prototype=Uu(D.prototype)).constructor=rn).prototype.toJSON=function(){var t=D.prototype.toJSON.call(this);return an(this.parameters.shapes,t)},((nn.prototype=Uu(X.prototype)).constructor=nn).prototype.toJSON=function(){var t=X.prototype.toJSON.call(this);return an(this.parameters.shapes,t)},(on.prototype=Uu(X.prototype)).constructor=on,(sn.prototype=Uu(D.prototype)).constructor=sn,(ln.prototype=Uu(X.prototype)).constructor=ln,(un.prototype=Uu(sn.prototype)).constructor=un,(cn.prototype=Uu(ln.prototype)).constructor=cn,(hn.prototype=Uu(D.prototype)).constructor=hn,dn.prototype=Uu(X.prototype);var Vd=Du({__proto__:null,WireframeGeometry:lr,ParametricGeometry:ur,ParametricBufferGeometry:cr,TetrahedronGeometry:pr,TetrahedronBufferGeometry:fr,OctahedronGeometry:mr,OctahedronBufferGeometry:gr,IcosahedronGeometry:vr,IcosahedronBufferGeometry:yr,DodecahedronGeometry:xr,DodecahedronBufferGeometry:br,PolyhedronGeometry:hr,PolyhedronBufferGeometry:dr,TubeGeometry:_r,TubeBufferGeometry:Ar,TorusKnotGeometry:wr,TorusKnotBufferGeometry:Mr,TorusGeometry:Cr,TorusBufferGeometry:Tr,TextGeometry:Yr,TextBufferGeometry:Zr,SphereGeometry:Jr,SphereBufferGeometry:Kr,RingGeometry:Qr,RingBufferGeometry:$r,PlaneGeometry:J,PlaneBufferGeometry:K,LatheGeometry:tn,LatheBufferGeometry:en,ShapeGeometry:rn,ShapeBufferGeometry:nn,ExtrudeGeometry:jr,ExtrudeBufferGeometry:Xr,EdgesGeometry:on,ConeGeometry:un,ConeBufferGeometry:cn,CylinderGeometry:sn,CylinderBufferGeometry:ln,CircleGeometry:hn,CircleBufferGeometry:dn.prototype.constructor=dn,BoxGeometry:cs,BoxBufferGeometry:Uh});((pn.prototype=Uu(k.prototype)).constructor=pn).prototype.isShadowMaterial=!0,pn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this},((fn.prototype=Uu(W.prototype)).constructor=fn).prototype.isRawShaderMaterial=!0,((mn.prototype=Uu(k.prototype)).constructor=mn).prototype.isMeshStandardMaterial=!0,mn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},((gn.prototype=Uu(mn.prototype)).constructor=gn).prototype.isMeshPhysicalMaterial=!0,gn.prototype.copy=function(t){return mn.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new U).copy(t.sheen):null,this.transparency=t.transparency,this},((vn.prototype=Uu(k.prototype)).constructor=vn).prototype.isMeshPhongMaterial=!0,vn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((yn.prototype=Uu(k.prototype)).constructor=yn).prototype.isMeshToonMaterial=!0,yn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((xn.prototype=Uu(k.prototype)).constructor=xn).prototype.isMeshNormalMaterial=!0,xn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((bn.prototype=Uu(k.prototype)).constructor=bn).prototype.isMeshLambertMaterial=!0,bn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((_n.prototype=Uu(k.prototype)).constructor=_n).prototype.isMeshMatcapMaterial=!0,_n.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((An.prototype=Uu(Ke.prototype)).constructor=An).prototype.isLineDashedMaterial=!0,An.prototype.copy=function(t){return Ke.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Wd=Du({__proto__:null,ShadowMaterial:pn,SpriteMaterial:Ve,RawShaderMaterial:fn,ShaderMaterial:W,PointsMaterial:er,MeshPhysicalMaterial:gn,MeshStandardMaterial:mn,MeshPhongMaterial:vn,MeshToonMaterial:yn,MeshNormalMaterial:xn,MeshLambertMaterial:bn,MeshDepthMaterial:Se,MeshDistanceMaterial:Ee,MeshBasicMaterial:H,MeshMatcapMaterial:_n,LineDashedMaterial:An,LineBasicMaterial:Ke,Material:k}),jd={arraySlice:function(t,e,r){return jd.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(r){for(var t=r.length,e=Array(t),n=0;n!==t;++n)e[n]=n;return e.sort(function(t,e){return r[t]-r[e]}),e},sortedArray:function(t,e,r){for(var n=t.length,i=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=r[a]*e,l=0;l!==e;++l)i[o++]=t[s+l];return i},flattenJSON:function(t,e,r,n){for(var i=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[i++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))for(;o=a[n],void 0!==o&&(e.push(a.time),r.push.apply(r,o)),a=t[i++],void 0!==a;);else if(void 0!==o.toArray)for(;o=a[n],void 0!==o&&(e.push(a.time),o.toArray(r,r.length)),a=t[i++],void 0!==a;);else for(;o=a[n],void 0!==o&&(e.push(a.time),r.push(o)),a=t[i++],void 0!==a;);}},subclip:function(t,e,r,n,i){i=i||30,(t=t.clone()).name=e;var a=[];for(e=0;e<t.tracks.length;++e){for(var o=t.tracks[e],s=o.getValueSize(),l=[],u=[],c=0;c<o.times.length;++c){var h=o.times[c]*i;if(!(h<r||n<=h))for(l.push(o.times[c]),h=0;h<s;++h)u.push(o.values[c*s+h])}0!==l.length&&(o.times=jd.convertArray(l,o.times.constructor),o.values=jd.convertArray(u,o.values.constructor),a.push(o))}for(t.tracks=a,r=1/0,e=0;e<t.tracks.length;++e)r>t.tracks[e].times[0]&&(r=t.tracks[e].times[0]);for(e=0;e<t.tracks.length;++e)t.tracks[e].shift(-1*r);return t.resetDuration(),t},makeClipAdditive:function(t,e,r,n){void 0===e&&(e=0),void 0===r&&(r=t),(void 0===n||n<=0)&&(n=30);var i=t.tracks.length;for(e/=n,n=0;n<i;++n){var a=r.tracks[n],o=a.ValueTypeName;if("bool"!==o&&"string"!==o){var s=t.tracks.find(function(t){return t.name===a.name&&t.ValueTypeName===o});if(void 0!==s){var l=a.getValueSize(),u=a.times.length-1,u=e<=a.times[0]?jd.arraySlice(a.values,0,a.valueSize):e>=a.times[u]?jd.arraySlice(a.values,u*l):((u=a.createInterpolant()).evaluate(e),u.resultBuffer);"quaternion"===o&&new f(u[0],u[1],u[2],u[3]).normalize().conjugate().toArray(u);for(var c=s.times.length,h=0;h<c;++h){var d=h*l;if("quaternion"===o)f.multiplyQuaternionsFlat(s.values,d,u,0,s.values,d);else for(var p=0;p<l;++p)s.values[d+p]-=u[p]}}}}return t.blendMode=2501,t}};Hu(wn.prototype,{evaluate:function(t){var e=this.parameterPositions,r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{r:{n:if(!(t<n)){for(var a=r+2;;){if(void 0===n){if(t<i)break n;return this._cachedIndex=r=e.length,this.afterEnd_(r-1,t,i)}if(r===a)break;if(i=n,t<(n=e[++r]))break e}n=e.length;break r}if(i<=t)break t;for(t<(a=e[1])&&(r=2,i=a),a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===a)break;if(n=i,(i=e[--r-1])<=t)break e}n=r,r=0}for(;r<n;)t<e[i=r+n>>>1]?n=i:r=i+1;if(n=e[r],void 0===(i=e[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return this._cachedIndex=r=e.length,this.afterEnd_(r-1,i,t)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize;t*=n;for(var i=0;i!==n;++i)e[i]=r[t+i];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Hu(wn.prototype,{beforeStart_:wn.prototype.copySampleValue_,afterEnd_:wn.prototype.copySampleValue_}),Mn.prototype=Hu(Uu(wn.prototype),{constructor:Mn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,r){var n=this.parameterPositions,i=t-2,a=t+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-r;break;case 2402:o=e+n[i=n.length-2]-n[i+1];break;default:i=t,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*r-e;break;case 2402:s=r+n[a=1]-n[0];break;default:a=t-1,s=e}t=.5*(r-e),n=this.valueSize,this._weightPrev=t/(e-o),this._weightNext=t/(s-r),this._offsetPrev=i*n,this._offsetNext=a*n},interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(t*=o)-o,l=this._offsetPrev,u=this._offsetNext,c=this._weightPrev,h=this._weightNext,d=(r-e)/(n-e);for(e=-c*(n=(r=d*d)*d)+2*c*r-c*d,c=(1+c)*n+(-1.5-2*c)*r+(-.5+c)*d+1,d=(-1-h)*n+(1.5+h)*r+.5*d,h=h*n-h*r,r=0;r!==o;++r)i[r]=e*a[l+r]+c*a[s+r]+d*a[t+r]+h*a[u+r];return i}}),Cn.prototype=Hu(Uu(wn.prototype),{constructor:Cn,interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(t*=o)-o;for(r=1-(e=(r-e)/(n-e)),n=0;n!==o;++n)i[n]=a[s+n]*r+a[t+n]*e;return i}}),Tn.prototype=Hu(Uu(wn.prototype),{constructor:Tn,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Hu(Sn,{toJSON:function(t){var e,r=t.constructor;return void 0!==r.toJSON?r=r.toJSON(t):(r={name:t.name,times:jd.convertArray(t.times,Array),values:jd.convertArray(t.values,Array)},(e=t.getInterpolation())!==t.DefaultInterpolation&&(r.interpolation=e)),r.type=t.ValueTypeName,r}}),Hu(Sn.prototype,{constructor:Sn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Tn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Cn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Mn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)return this.createInterpolant=e,this;if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]*=t;return this},trim:function(t,e){for(var r=this.times,n=r.length,i=0,a=n-1;i!==n&&r[i]<t;)++i;for(;-1!==a&&r[a]>e;)--a;return++a,0===i&&a===n||(a<=i&&(i=(a=Math.max(a,1))-1),t=this.getValueSize(),this.times=jd.arraySlice(r,i,a),this.values=jd.arraySlice(this.values,i*t,a*t)),this},validate:function(){var t=!0;0!=(r=this.getValueSize())-Math.floor(r)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,r=this.values,n=e.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var i=null,a=0;a!==n;a++){var o=e[a];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),t=!1;break}if(null!==i&&o<i){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,i),t=!1;break}i=o}if(void 0!==r&&jd.isTypedArray(r))for(a=0,e=r.length;a!==e;++a)if(n=r[a],isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,n),t=!1;break}return t},optimize:function(){for(var t=jd.arraySlice(this.times),e=jd.arraySlice(this.values),r=this.getValueSize(),n=2302===this.getInterpolation(),i=1,a=t.length-1,o=1;o<a;++o){var s=!1;if((h=t[o])!==t[o+1]&&(1!==o||h!==h[0]))if(n)s=!0;else for(var l=o*r,u=l-r,c=l+r,h=0;h!==r;++h){var d=e[l+h];if(d!==e[u+h]||d!==e[c+h]){s=!0;break}}if(s){if(o!==i)for(t[i]=t[o],s=o*r,l=i*r,h=0;h!==r;++h)e[l+h]=e[s+h];++i}}if(0<a){for(t[i]=t[a],s=a*r,l=i*r,h=0;h!==r;++h)e[l+h]=e[s+h];++i}return i!==t.length?(this.times=jd.arraySlice(t,0,i),this.values=jd.arraySlice(e,0,i*r)):(this.times=t,this.values=e),this},clone:function(){var t=jd.arraySlice(this.times,0),e=jd.arraySlice(this.values,0);return(t=new this.constructor(this.name,t,e)).createInterpolant=this.createInterpolant,t}}),En.prototype=Hu(Uu(Sn.prototype),{constructor:En,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),In.prototype=Hu(Uu(Sn.prototype),{constructor:In,ValueTypeName:"color"}),Ln.prototype=Hu(Uu(Sn.prototype),{constructor:Ln,ValueTypeName:"number"}),Rn.prototype=Hu(Uu(wn.prototype),{constructor:Rn,interpolate_:function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize;for(e=(r-e)/(n-e),r=(t*=o)+o;t!==r;t+=4)f.slerpFlat(i,0,a,t-o,a,t,e);return i}}),Pn.prototype=Hu(Uu(Sn.prototype),{constructor:Pn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Rn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Dn.prototype=Hu(Uu(Sn.prototype),{constructor:Dn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),On.prototype=Hu(Uu(Sn.prototype),{constructor:On,ValueTypeName:"vector"}),Hu(Fn,{parse:function(t){for(var e=[],r=t.tracks,n=1/(t.fps||1),i=0,a=r.length;i!==a;++i)e.push(Bn(r[i]).scale(n));return new Fn(t.name,t.duration,e,t.blendMode)},toJSON:function(t){var e=[],r=t.tracks;t={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(var n=0,i=r.length;n!==i;++n)e.push(Sn.toJSON(r[n]));return t},CreateFromMorphTargetSequence:function(t,e,r,n){for(var i=e.length,a=[],o=0;o<i;o++){var s=[];(u=[]).push((o+i-1)%i,o,(o+1)%i),s.push(0,1,0);var l=jd.getKeyframeOrder(u),u=jd.sortedArray(u,1,l),s=jd.sortedArray(s,1,l);n||0!==u[0]||(u.push(i),s.push(s[0])),a.push(new Ln(".morphTargetInfluences["+e[o].name+"]",u,s).scale(1/r))}return new Fn(t,-1,a)},findByName:function(t,e){var r=t;for(Array.isArray(t)||(r=t.geometry&&t.geometry.animations||t.animations),t=0;t<r.length;t++)if(r[t].name===e)return r[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s,l=t[a],u=l.name.match(i);u&&1<u.length&&((u=n[s=u[1]])||(n[s]=u=[]),u.push(l))}for(s in t=[],n)t.push(Fn.CreateFromMorphTargetSequence(s,n[s],e,r));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;function r(t,e,r,n,i){var a,o;0!==r.length&&(a=[],o=[],jd.flattenJSON(r,a,o,n),0!==a.length&&i.push(new t(e,a,o)))}var n=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.blendMode;t=t.hierarchy||[];for(var l=0;l<t.length;l++){var u=t[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c,a={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)a[u[h].morphTargets[d]]=-1;for(c in a){for(var p=[],f=[],d=0;d!==u[h].morphTargets.length;++d){var m=u[h];p.push(m.time),f.push(m.morphTarget===c?1:0)}n.push(new Ln(".morphTargetInfluence["+c+"]",p,f))}a=a.length*(o||1)}else r(On,(h=".bones["+e[l].name+"]")+".position",u,"pos",n),r(Pn,h+".quaternion",u,"rot",n),r(On,h+".scale",u,"scl",n)}return 0===n.length?null:new Fn(i,a,n,s)}}),Hu(Fn.prototype,{resetDuration:function(){for(var t=0,e=0,r=this.tracks.length;e!==r;++e)var n=this.tracks[e],t=Math.max(t,n.times[n.times.length-1]);return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Fn(this.name,this.duration,t,this.blendMode)}});var Xd={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},qd=new Nn;Hu(zn.prototype,{load:function(){},loadAsync:function(r,n){var i=this;return new Pu(function(t,e){i.load(r,t,n,e)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Yd={};Un.prototype=Hu(Uu(zn.prototype),{constructor:Un,load:function(o,t,e,r){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);var s=this,n=Xd.get(o);if(void 0!==n)return s.manager.itemStart(o),setTimeout(function(){t&&t(n),s.manager.itemEnd(o)},0),n;if(void 0===Yd[o]){if(a=o.match(/^data:(.*?)(;base64)?,(.*)$/)){e=a[1];var i=!!a[2],a=a[3];a=decodeURIComponent(a),i&&(a=atob(a));try{var l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":for(var u=new Uint8Array(a.length),i=0;i<a.length;i++)u[i]=a.charCodeAt(i);var c="blob"===l?new Blob([u.buffer],{type:e}):u.buffer;break;case"document":c=(new DOMParser).parseFromString(a,e);break;case"json":c=JSON.parse(a);break;default:c=a}setTimeout(function(){t&&t(c),s.manager.itemEnd(o)},0)}catch(t){setTimeout(function(){r&&r(t),s.manager.itemError(o),s.manager.itemEnd(o)},0)}}else{Yd[o]=[],Yd[o].push({onLoad:t,onProgress:e,onError:r});var h=new XMLHttpRequest;for(i in h.open("GET",o,!0),h.addEventListener("load",function(t){var e=this.response,r=Yd[o];if(delete Yd[o],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Xd.add(o,e);for(var n=0,i=r.length;n<i;n++){var a=r[n];a.onLoad&&a.onLoad(e)}}else{for(n=0,i=r.length;n<i;n++)(a=r[n]).onError&&a.onError(t);s.manager.itemError(o)}s.manager.itemEnd(o)},!1),h.addEventListener("progress",function(t){for(var e=Yd[o],r=0,n=e.length;r<n;r++){var i=e[r];i.onProgress&&i.onProgress(t)}},!1),h.addEventListener("error",function(t){var e=Yd[o];delete Yd[o];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),h.addEventListener("abort",function(t){var e=Yd[o];delete Yd[o];for(var r=0,n=e.length;r<n;r++){var i=e[r];i.onError&&i.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),void 0!==this.responseType&&(h.responseType=this.responseType),void 0!==this.withCredentials&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)h.setRequestHeader(i,this.requestHeader[i]);h.send(null)}return s.manager.itemStart(o),h}Yd[o].push({onLoad:t,onProgress:e,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),kn.prototype=Hu(Uu(zn.prototype),{constructor:kn,load:function(e,r,t,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){for(var e=[],r=0;r<t.length;r++){var n=Fn.parse(t[r]);e.push(n)}return e}}),Hn.prototype=Hu(Uu(zn.prototype),{constructor:Hn,load:function(t,i,r,n){var a=this,o=[],s=new ar;s.image=o;var l=new Un(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,e=0,c=t.length;e<c;++e)!function(e){l.load(t[e],function(t){t=a.parse(t,!0),o[e]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(u+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,i&&i(s))},r,n)}(e);else l.load(t,function(t){if((t=a.parse(t,!0)).isCubemap)for(var e=t.mipmaps.length/t.mipmapCount,r=0;r<e;r++){o[r]={mipmaps:[]};for(var n=0;n<t.mipmapCount;n++)o[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+n]),o[r].format=t.format,o[r].width=t.width,o[r].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,i&&i(s)},r,n);return s}}),Gn.prototype=Hu(Uu(zn.prototype),{constructor:Gn,load:function(t,e,r,n){var i=this,a=new St,o=new Un(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,function(t){(t=i.parse(t))&&(void 0!==t.image?a.image=t.image:void 0!==t.data&&(a.image.width=t.width,a.image.height=t.height,a.image.data=t.data),a.wrapS=void 0!==t.wrapS?t.wrapS:1001,a.wrapT=void 0!==t.wrapT?t.wrapT:1001,a.magFilter=void 0!==t.magFilter?t.magFilter:1006,a.minFilter=void 0!==t.minFilter?t.minFilter:1006,a.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(a.format=t.format),void 0!==t.type&&(a.type=t.type),void 0!==t.mipmaps&&(a.mipmaps=t.mipmaps,a.minFilter=1008),1===t.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,e&&e(a,t))},r,n),a}}),Vn.prototype=Hu(Uu(zn.prototype),{constructor:Vn,load:function(e,t,r,n){function i(){l.removeEventListener("load",i,!1),l.removeEventListener("error",a,!1),Xd.add(e,this),t&&t(this),o.manager.itemEnd(e)}function a(t){l.removeEventListener("load",i,!1),l.removeEventListener("error",a,!1),n&&n(t),o.manager.itemError(e),o.manager.itemEnd(e)}void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,s=Xd.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;var l=document.createElementNS("http://www.w3.org/1999/xhtml","img");return l.addEventListener("load",i,!1),l.addEventListener("error",a,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}),Wn.prototype=Hu(Uu(zn.prototype),{constructor:Wn,load:function(t,r,e,n){var i=new $,a=new Vn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;for(e=0;e<t.length;++e)!function(e){a.load(t[e],function(t){i.images[e]=t,6===++o&&(i.needsUpdate=!0,r&&r(i))},void 0,n)}(e);return i}}),jn.prototype=Hu(Uu(zn.prototype),{constructor:jn,load:function(e,r,t,n){var i=new d,a=new Vn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(t){i.image=t,t=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data:image\/jpeg/),i.format=t?1022:1023,i.needsUpdate=!0,void 0!==r&&r(i)},t,n),i}}),Hu(Xn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r=[],n=this.getPoint(0),i=0;for(r.push(0),e=1;e<=t;e++){var a=this.getPoint(e/t);i+=a.distanceTo(n),r.push(i),n=a}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var r=this.getLengths(),n=r.length;e=e||t*r[n-1];for(var i,a=0,o=n-1;a<=o;)if((i=r[t=Math.floor(a+(o-a)/2)]-e)<0)a=t+1;else{if(!(0<i)){o=t;break}o=t-1}return r[t=o]===e?t/(n-1):(t+(e-(a=r[t]))/(r[t+1]-a))/(n-1)},getTangent:function(t,e){var r=t-1e-4;return r<0&&(r=0),1<(t+=1e-4)&&(t=1),r=this.getPoint(r),t=this.getPoint(t),(e=e||new(r.isVector2?At:Mt)).copy(t).sub(r).normalize(),e},getTangentAt:function(t,e){return t=this.getUtoTmapping(t),this.getTangent(t,e)},computeFrenetFrames:function(t,e){for(var r=new Mt,n=[],i=[],a=[],o=new Mt,s=new Ct,l=0;l<=t;l++){var u=l/t;n[l]=this.getTangentAt(u,new Mt),n[l].normalize()}i[0]=new Mt,a[0]=new Mt,l=Number.MAX_VALUE;var u=Math.abs(n[0].x),c=Math.abs(n[0].y),h=Math.abs(n[0].z);for(u<=l&&(l=u,r.set(1,0,0)),c<=l&&(l=c,r.set(0,1,0)),h<=l&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),a[0].crossVectors(n[0],i[0]),l=1;l<=t;l++)i[l]=i[l-1].clone(),a[l]=a[l-1].clone(),o.crossVectors(n[l-1],n[l]),o.length()>Wu&&(o.normalize(),r=Math.acos(Qu.clamp(n[l-1].dot(n[l]),-1,1)),i[l].applyMatrix4(s.makeRotationAxis(o,r))),a[l].crossVectors(n[l],i[l]);if(!0===e)for(r=Math.acos(Qu.clamp(i[0].dot(i[t]),-1,1)),r/=t,0<n[0].dot(o.crossVectors(i[0],i[t]))&&(r=-r),l=1;l<=t;l++)i[l].applyMatrix4(s.makeRotationAxis(n[l],r*l)),a[l].crossVectors(n[l],i[l]);return{tangents:n,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((qn.prototype=Uu(Xn.prototype)).constructor=qn).prototype.isEllipseCurve=!0,qn.prototype.getPoint=function(t,e){e=e||new At;for(var r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,i=Math.abs(n)<Wu;n<0;)n+=r;for(;r<n;)n-=r;n<Wu&&(n=i?0:r),!0!==this.aClockwise||i||(n=n===r?-r:n-r),r=this.aStartAngle+t*n,t=this.aX+this.xRadius*Math.cos(r);var a=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(r=Math.cos(this.aRotation),n=Math.sin(this.aRotation),t=(i=t-this.aX)*r-(a-=this.aY)*n+this.aX,a=i*n+a*r+this.aY),e.set(t,a)},qn.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},qn.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},qn.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((Yn.prototype=Uu(qn.prototype)).constructor=Yn).prototype.isArcCurve=!0;var Zd=new Mt,Jd=new Zn,Kd=new Zn,Qd=new Zn;((Jn.prototype=Uu(Xn.prototype)).constructor=Jn).prototype.isCatmullRomCurve3=!0,Jn.prototype.getPoint=function(t,e){e=e||new Mt;var r=(l=this.points).length;t*=r-(this.closed?0:1);var n=Math.floor(t);t-=n,this.closed?n+=0<n?0:(Math.floor(Math.abs(n)/r)+1)*r:0===t&&n===r-1&&(n=r-2,t=1);var i,a=this.closed||0<n?l[(n-1)%r]:(Zd.subVectors(l[0],l[1]).add(l[0]),Zd),o=l[n%r],s=l[(n+1)%r],l=this.closed||n+2<r?l[(n+2)%r]:(Zd.subVectors(l[r-1],l[r-2]).add(l[r-1]),Zd);return"centripetal"===this.curveType||"chordal"===this.curveType?(i="chordal"===this.curveType?.5:.25,r=Math.pow(a.distanceToSquared(o),i),(n=Math.pow(o.distanceToSquared(s),i))<1e-4&&(n=1),r<1e-4&&(r=n),(i=Math.pow(s.distanceToSquared(l),i))<1e-4&&(i=n),Jd.initNonuniformCatmullRom(a.x,o.x,s.x,l.x,r,n,i),Kd.initNonuniformCatmullRom(a.y,o.y,s.y,l.y,r,n,i),Qd.initNonuniformCatmullRom(a.z,o.z,s.z,l.z,r,n,i)):"catmullrom"===this.curveType&&(Jd.initCatmullRom(a.x,o.x,s.x,l.x,this.tension),Kd.initCatmullRom(a.y,o.y,s.y,l.y,this.tension),Qd.initCatmullRom(a.z,o.z,s.z,l.z,this.tension)),e.set(Jd.calc(t),Kd.calc(t),Qd.calc(t)),e},Jn.prototype.copy=function(t){Xn.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Jn.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Jn.prototype.fromJSON=function(t){Xn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Mt).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((ti.prototype=Uu(Xn.prototype)).constructor=ti).prototype.isCubicBezierCurve=!0,ti.prototype.getPoint=function(t,e){e=e||new At;var r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set($n(t,r.x,n.x,i.x,a.x),$n(t,r.y,n.y,i.y,a.y)),e},ti.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ti.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ti.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((ei.prototype=Uu(Xn.prototype)).constructor=ei).prototype.isCubicBezierCurve3=!0,ei.prototype.getPoint=function(t,e){e=e||new Mt;var r=this.v0,n=this.v1,i=this.v2,a=this.v3;return e.set($n(t,r.x,n.x,i.x,a.x),$n(t,r.y,n.y,i.y,a.y),$n(t,r.z,n.z,i.z,a.z)),e},ei.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ei.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ei.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((ri.prototype=Uu(Xn.prototype)).constructor=ri).prototype.isLineCurve=!0,ri.prototype.getPoint=function(t,e){return e=e||new At,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},ri.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ri.prototype.getTangent=function(t,e){return(e||new At).copy(this.v2).sub(this.v1).normalize()},ri.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ri.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ri.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ni.prototype=Uu(Xn.prototype)).constructor=ni).prototype.isLineCurve3=!0,ni.prototype.getPoint=function(t,e){return e=e||new Mt,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},ni.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ni.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ni.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ni.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ii.prototype=Uu(Xn.prototype)).constructor=ii).prototype.isQuadraticBezierCurve=!0,ii.prototype.getPoint=function(t,e){e=e||new At;var r=this.v0,n=this.v1,i=this.v2;return e.set(Qn(t,r.x,n.x,i.x),Qn(t,r.y,n.y,i.y)),e},ii.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ii.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ii.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ai.prototype=Uu(Xn.prototype)).constructor=ai).prototype.isQuadraticBezierCurve3=!0,ai.prototype.getPoint=function(t,e){e=e||new Mt;var r=this.v0,n=this.v1,i=this.v2;return e.set(Qn(t,r.x,n.x,i.x),Qn(t,r.y,n.y,i.y),Qn(t,r.z,n.z,i.z)),e},ai.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ai.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ai.prototype.fromJSON=function(t){return Xn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((oi.prototype=Uu(Xn.prototype)).constructor=oi).prototype.isSplineCurve=!0,oi.prototype.getPoint=function(t,e){e=e||new At;var r=((o=this.points).length-1)*t;r-=t=Math.floor(r);var n=o[0===t?t:t-1],i=o[t],a=o[t>o.length-2?o.length-1:t+1],o=o[t>o.length-3?o.length-1:t+2];return e.set(Kn(r,n.x,i.x,a.x,o.x),Kn(r,n.y,i.y,a.y,o.y)),e},oi.prototype.copy=function(t){Xn.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++)this.points.push(t.points[e].clone());return this},oi.prototype.toJSON=function(){var t=Xn.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++)t.points.push(this.points[e].toArray());return t},oi.prototype.fromJSON=function(t){Xn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new At).fromArray(n))}return this};var $d=Du({__proto__:null,ArcCurve:Yn,CatmullRomCurve3:Jn,CubicBezierCurve:ti,CubicBezierCurve3:ei,EllipseCurve:qn,LineCurve:ri,LineCurve3:ni,QuadraticBezierCurve:ii,QuadraticBezierCurve3:ai,SplineCurve:oi});si.prototype=Hu(Uu(Xn.prototype),{constructor:si,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ri(e,t))},getPoint:function(t){var e=t*this.getLength(),r=this.getCurveLengths();for(t=0;t<r.length;){if(r[t]>=e)return e=r[t]-e,r=(t=this.curves[t]).getLength(),t.getPointAt(0===r?0:1-e/r);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,r=[],n=0,i=this.curves;n<i.length;n++)for(var a=(a=i[n]).getPoints(a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t),o=0;o<a.length;o++){var s=a[o];e&&e.equals(s)||(r.push(s),e=s)}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Xn.prototype.copy.call(this,t),this.curves=[];for(var e=0,r=t.curves.length;e<r;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Xn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,r=this.curves.length;e<r;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){Xn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push((new $d[n.type]).fromJSON(n))}return this}}),li.prototype=Hu(Uu(si.prototype),{constructor:li,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var r=new ri(this.currentPoint.clone(),new At(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,r,n){return t=new ii(this.currentPoint.clone(),new At(t,e),new At(r,n)),this.curves.push(t),this.currentPoint.set(r,n),this},bezierCurveTo:function(t,e,r,n,i,a){return t=new ti(this.currentPoint.clone(),new At(t,e),new At(r,n),new At(i,a)),this.curves.push(t),this.currentPoint.set(i,a),this},splineThru:function(t){var e=new oi(e=[this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,r,n,i,a){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,r,n,i,a),this},absarc:function(t,e,r,n,i,a){return this.absellipse(t,e,r,r,n,i,a),this},ellipse:function(t,e,r,n,i,a,o,s){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,r,n,i,a,o,s),this},absellipse:function(t,e,r,n,i,a,o,s){return t=new qn(t,e,r,n,i,a,o,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return si.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=si.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return si.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ui.prototype=Hu(Uu(li.prototype),{constructor:ui,getPointsHoles:function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){li.prototype.copy.call(this,t),this.holes=[];for(var e=0,r=t.holes.length;e<r;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=li.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,r=this.holes.length;e<r;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){li.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push((new li).fromJSON(n))}return this}}),ci.prototype=Hu(Uu(B.prototype),{constructor:ci,isLight:!0,copy:function(t){return B.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return(t=B.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),hi.prototype=Hu(Uu(ci.prototype),{constructor:hi,isHemisphereLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Hu(di.prototype,{_projScreenMatrix:new Ct,_lightPositionWorld:new Mt,_lookTarget:new Mt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,r=this.matrix,n=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),n.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(e.projectionMatrix),r.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),pi.prototype=Hu(Uu(di.prototype),{constructor:pi,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,r=2*Qu.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix()),di.prototype.updateMatrices.call(this,t)}}),fi.prototype=Hu(Uu(ci.prototype),{constructor:fi,isSpotLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),mi.prototype=Hu(Uu(di.prototype),{constructor:mi,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var r=this.camera,n=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),r.position.copy(i),a.copy(r.position),a.add(this._cubeDirections[e]),r.up.copy(this._cubeUps[e]),r.lookAt(a),r.updateMatrixWorld(),n.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),gi.prototype=Hu(Uu(ci.prototype),{constructor:gi,isPointLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),vi.prototype=Hu(Uu(j.prototype),{constructor:vi,isOrthographicCamera:!0,copy:function(t,e){return j.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Hu({},t.view),this},setViewOffset:function(t,e,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t;r+=t,t=n+e,e=n-e,null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,r=(i+=n*this.view.offsetX)+n*this.view.width,e=(t-=e*this.view.offsetY)-e*this.view.height),this.projectionMatrix.makeOrthographic(i,r,t,e,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=B.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Hu({},this.view)),t}}),yi.prototype=Hu(Uu(di.prototype),{constructor:yi,isDirectionalLightShadow:!0,updateMatrices:function(t){di.prototype.updateMatrices.call(this,t)}}),xi.prototype=Hu(Uu(ci.prototype),{constructor:xi,isDirectionalLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),bi.prototype=Hu(Uu(ci.prototype),{constructor:bi,isAmbientLight:!0}),_i.prototype=Hu(Uu(ci.prototype),{constructor:_i,isRectAreaLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return(t=ci.prototype.toJSON.call(this,t)).object.width=this.width,t.object.height=this.height,t}}),Hu(Ai.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var r=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.282095),e.addScaledVector(i[1],.488603*n),e.addScaledVector(i[2],.488603*t),e.addScaledVector(i[3],.488603*r),e.addScaledVector(i[4],1.092548*r*n),e.addScaledVector(i[5],1.092548*n*t),e.addScaledVector(i[6],.315392*(3*t*t-1)),e.addScaledVector(i[7],1.092548*r*t),e.addScaledVector(i[8],.546274*(r*r-n*n)),e},getIrradianceAt:function(t,e){var r=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.886227),e.addScaledVector(i[1],1.023328*n),e.addScaledVector(i[2],1.023328*t),e.addScaledVector(i[3],1.023328*r),e.addScaledVector(i[4],.858086*r*n),e.addScaledVector(i[5],.858086*n*t),e.addScaledVector(i[6],.743125*t*t-.247708),e.addScaledVector(i[7],.858086*r*t),e.addScaledVector(i[8],.429043*(r*r-n*n)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var r=0;r<9;r++)this.coefficients[r].addScaledVector(t.coefficients[r],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var r=0;r<9;r++)this.coefficients[r].lerp(t.coefficients[r],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var r=this.coefficients,n=0;n<9;n++)r[n].fromArray(t,e+3*n);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var r=this.coefficients,n=0;n<9;n++)r[n].toArray(t,e+3*n);return t}}),Hu(Ai,{getBasisAt:function(t,e){var r=t.x,n=t.y;t=t.z,e[0]=.282095,e[1]=.488603*n,e[2]=.488603*t,e[3]=.488603*r,e[4]=1.092548*r*n,e[5]=1.092548*n*t,e[6]=.315392*(3*t*t-1),e[7]=1.092548*r*t,e[8]=.546274*(r*r-n*n)}}),wi.prototype=Hu(Uu(ci.prototype),{constructor:wi,isLightProbe:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return(t=ci.prototype.toJSON.call(this,t)).object.sh=this.sh.toArray(),t}}),Mi.prototype=Hu(Uu(zn.prototype),{constructor:Mi,load:function(e,r,t,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){function e(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var r=this.textures,n=new Wd[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.sheen&&(n.sheen=(new U).setHex(t.sheen)),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearcoat&&(n.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(n.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(n.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(n.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(n.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(n.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(n.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(n.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(n.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(n.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(n.morphNormals=t.morphNormals),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.vertexTangents&&(n.vertexTangents=t.vertexTangents),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.toneMapped&&(n.toneMapped=t.toneMapped),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.vertexColors&&(n.vertexColors="number"==typeof t.vertexColors?0<t.vertexColors:t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var a=t.uniforms[i];switch(n.uniforms[i]={},a.type){case"t":n.uniforms[i].value=e(a.value);break;case"c":n.uniforms[i].value=(new U).setHex(a.value);break;case"v2":n.uniforms[i].value=(new At).fromArray(a.value);break;case"v3":n.uniforms[i].value=(new Mt).fromArray(a.value);break;case"v4":n.uniforms[i].value=(new wt).fromArray(a.value);break;case"m3":n.uniforms[i].value=(new g).fromArray(a.value);case"m4":n.uniforms[i].value=(new Ct).fromArray(a.value);break;default:n.uniforms[i].value=a.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)n.extensions[o]=t.extensions[o];return void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=e(t.map)),void 0!==t.matcap&&(n.matcap=e(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=e(t.alphaMap)),void 0!==t.bumpMap&&(n.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=e(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale&&(i=t.normalScale,!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new At).fromArray(i)),void 0!==t.displacementMap&&(n.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=e(t.specularMap)),void 0!==t.envMap&&(n.envMap=e(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(n.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(n.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=e(t.gradientMap)),void 0!==t.clearcoatMap&&(n.clearcoatMap=e(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=e(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(n.clearcoatNormalMap=e(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(n.clearcoatNormalScale=(new At).fromArray(t.clearcoatNormalScale)),n},setTextures:function(t){return this.textures=t,this}});var tp=function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",r=0,n=t.length;r<n;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(t){return e}},ep=function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};Ci.prototype=Hu(Uu(X.prototype),{constructor:Ci,isInstancedBufferGeometry:!0,copy:function(t){return X.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=X.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Ti.prototype=Hu(Uu(G.prototype),{constructor:Ti,isInstancedBufferAttribute:!0,copy:function(t){return G.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=G.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Si.prototype=Hu(Uu(zn.prototype),{constructor:Si,load:function(e,r,t,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(t){try{r(i.parse(JSON.parse(t)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},parse:function(t){var e,r=new(t.isInstancedBufferGeometry?Ci:X);for(e in void 0!==(l=t.data.index)&&(i=new rp[l.type](l.array),r.setIndex(new G(i,1))),l=t.data.attributes){var n=l[e],i=new rp[n.type](n.array);i=new(n.isInstancedBufferAttribute?Ti:G)(i,n.itemSize,n.normalized),void 0!==n.name&&(i.name=n.name),r.setAttribute(e,i)}var a=t.data.morphAttributes;if(a)for(e in a){for(var o=a[e],s=[],l=0,u=o.length;l<u;l++)n=o[l],i=new G(i=new rp[n.type](n.array),n.itemSize,n.normalized),void 0!==n.name&&(i.name=n.name),s.push(i);r.morphAttributes[e]=s}if(t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0),void 0!==(e=t.data.groups||t.data.drawcalls||t.data.offsets))for(l=0,n=e.length;l!==n;++l)i=e[l],r.addGroup(i.start,i.count,i.materialIndex);return void 0!==(l=t.data.boundingSphere)&&(e=new Mt,void 0!==l.center&&e.fromArray(l.center),r.boundingSphere=new z(e,l.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});var rp={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Ei.prototype=Hu(Uu(zn.prototype),{constructor:Ei,load:function(r,n,t,i){var a=this,e=""===this.path?ep(r):this.path;this.resourcePath=this.resourcePath||e,(e=new Un(a.manager)).setPath(this.path),e.load(r,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+r+".",t.message)}void 0===(t=e.metadata)||void 0===t.type||"geometry"===t.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+r):a.parse(e,n)},t,i)},parse:function(t,e){var r=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,r),n=this.parseImages(t.images,function(){void 0!==e&&e(i)}),n=this.parseTextures(t.textures,n);n=this.parseMaterials(t.materials,n);var i=this.parseObject(t.object,r,n);return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(i),i},parseShape:function(t){var e={};if(void 0!==t)for(var r=0,n=t.length;r<n;r++){var i=(new ui).fromJSON(t[r]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var r={};if(void 0!==t)for(var n=new Si,i=0,a=t.length;i<a;i++){var o=t[i];switch(o.type){case"PlaneGeometry":case"PlaneBufferGeometry":var s=new Vd[o.type](o.width,o.height,o.widthSegments,o.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Vd[o.type](o.width,o.height,o.depth,o.widthSegments,o.heightSegments,o.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Vd[o.type](o.radius,o.segments,o.thetaStart,o.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Vd[o.type](o.radiusTop,o.radiusBottom,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Vd[o.type](o.radius,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Vd[o.type](o.radius,o.widthSegments,o.heightSegments,o.phiStart,o.phiLength,o.thetaStart,o.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Vd[o.type](o.radius,o.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Vd[o.type](o.innerRadius,o.outerRadius,o.thetaSegments,o.phiSegments,o.thetaStart,o.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Vd[o.type](o.radius,o.tube,o.radialSegments,o.tubularSegments,o.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Vd[o.type](o.radius,o.tube,o.tubularSegments,o.radialSegments,o.p,o.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Vd[o.type]((new $d[o.path.type]).fromJSON(o.path),o.tubularSegments,o.radius,o.radialSegments,o.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Vd[o.type](o.points,o.segments,o.phiStart,o.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Vd[o.type](o.vertices,o.indices,o.radius,o.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var s=[],l=0,u=o.shapes.length;l<u;l++){var c=e[o.shapes[l]];s.push(c)}s=new Vd[o.type](s,o.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(s=[],l=0,u=o.shapes.length;l<u;l++)c=e[o.shapes[l]],s.push(c);void 0!==(l=o.options.extrudePath)&&(o.options.extrudePath=(new $d[l.type]).fromJSON(l)),s=new Vd[o.type](s,o.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(o);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+o.type+'"');continue}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}return r},parseMaterials:function(t,e){var r={},n={};if(void 0!==t){var i=new Mi;i.setTextures(e),e=0;for(var a=t.length;e<a;e++){var o=t[e];if("MultiMaterial"===o.type){for(var s=[],l=0;l<o.materials.length;l++){var u=o.materials[l];void 0===r[u.uuid]&&(r[u.uuid]=i.parse(u)),s.push(r[u.uuid])}n[o.uuid]=s}else void 0===r[o.uuid]&&(r[o.uuid]=i.parse(o)),n[o.uuid]=r[o.uuid]}}return n},parseAnimations:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],i=Fn.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),e.push(i)}return e},parseImages:function(t,e){function r(t){return n.manager.itemStart(t),a.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}var n=this,i={};if(void 0!==t&&0<t.length){var a=new Vn(e=new Nn(e));a.setCrossOrigin(this.crossOrigin),e=0;for(var o=t.length;e<o;e++){var s=t[e],l=s.url;if(Array.isArray(l)){i[s.uuid]=[];for(var u=0,c=l.length;u<c;u++){var h=l[u],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;i[s.uuid].push(r(h))}}else h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.resourcePath+s.url,i[s.uuid]=r(h)}}return i},parseTextures:function(t,e){function r(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o=t[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new(Array.isArray(e[o.image])?$:d)(e[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=r(o.mapping,np)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=r(o.wrap[0],ip),s.wrapT=r(o.wrap[1],ip)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=r(o.minFilter,ap)),void 0!==o.magFilter&&(s.magFilter=r(o.magFilter,ap)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),n[o.uuid]=s}return n},parseObject:function(t,e,a){function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function n(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];void 0===a[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(a[i])}return e}return void 0===a[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),a[t]}}switch(t.type){case"Scene":var i=new Tt;void 0!==t.background&&Vu(t.background)&&(i.background=new U(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new ke(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new Ue(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new q(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Hu({},t.view));break;case"OrthographicCamera":i=new vi(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.view&&(i.view=Hu({},t.view));break;case"AmbientLight":i=new bi(t.color,t.intensity);break;case"DirectionalLight":i=new xi(t.color,t.intensity);break;case"PointLight":i=new gi(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new _i(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new fi(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new hi(t.color,t.groundColor,t.intensity);break;case"LightProbe":i=(new wi).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var i=r(t.geometry),o=n(t.material);i=new V(i,o);break;case"InstancedMesh":i=r(t.geometry);var o=n(t.material),s=t.instanceMatrix;(i=new Je(i,o,t.count)).instanceMatrix=new G(new Float32Array(s.array),16);break;case"LOD":i=new Xe;break;case"Line":i=new Qe(r(t.geometry),n(t.material),t.mode);break;case"LineLoop":i=new tr(r(t.geometry),n(t.material));break;case"LineSegments":i=new $e(r(t.geometry),n(t.material));break;case"PointCloud":case"Points":i=new rr(r(t.geometry),n(t.material));break;case"Sprite":i=new We(n(t.material));break;case"Group":i=new Oe;break;default:i=new B}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(i.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.frustumCulled&&(i.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(i.renderOrder=t.renderOrder),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.layers&&(i.layers.mask=t.layers),void 0!==t.children)for(s=t.children,o=0;o<s.length;o++)i.add(this.parseObject(s[o],e,a));if("LOD"===t.type)for(void 0!==t.autoUpdate&&(i.autoUpdate=t.autoUpdate),t=t.levels,s=0;s<t.length;s++){o=t[s];var l=i.getObjectByProperty("uuid",o.object);void 0!==l&&i.addLevel(l,o.distance)}return i}});var np={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},ip={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},ap={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};Ii.prototype=Hu(Uu(zn.prototype),{constructor:Ii,setOptions:function(t){return this.options=t,this},load:function(e,r,t,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Xd.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){r&&r(a),i.manager.itemEnd(e)},0),a;fetch(e).then(function(t){return t.blob()}).then(function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)}).then(function(t){Xd.add(e,t),r&&r(t),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}}),Hu(Li.prototype,{moveTo:function(t,e){return this.currentPath=new li,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,r,n){return this.currentPath.quadraticCurveTo(t,e,r,n),this},bezierCurveTo:function(t,e,r,n,i,a){return this.currentPath.bezierCurveTo(t,e,r,n,i,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],a=new ui;a.curves=i.curves,e.push(a)}return e}var n=Hd.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===e)return r(i);if(e=[],1===i.length){var a=i[0],o=new ui;return o.curves=a.curves,e.push(o),e}var s=!n(i[0].getPoints()),s=t?!s:s,o=[],l=[],u=[],c=0;l[c]=void 0,u[c]=[];for(var h=0,d=i.length;h<d;h++){var p=(a=i[h]).getPoints(),f=n(p);(f=t?!f:f)?(!s&&l[c]&&c++,l[c]={s:new ui,p:p},l[c].s.curves=a.curves,s&&c++,u[c]=[]):u[c].push({h:a,p:p[0]})}if(!l[0])return r(i);if(1<l.length){for(h=!1,t=[],n=0,i=l.length;n<i;n++)o[n]=[];for(n=0,i=l.length;n<i;n++)for(a=u[n],f=0;f<a.length;f++){for(s=a[f],c=!0,p=0;p<l.length;p++)!function(t,e){for(var r=e.length,n=!1,i=r-1,a=0;a<r;i=a++){var o=e[i],s=e[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Wu){if(u<0&&(o=e[a],l=-l,s=e[i],u=-u),!(t.y<o.y||t.y>s.y))if(t.y===o.y){if(t.x===o.x)return 1}else{if(0===(i=u*(t.x-o.x)-l*(t.y-o.y)))return 1;i<0||(n=!n)}}else if(t.y===o.y&&(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x))return 1}return n}(s.p,l[p].p)||(n!==p&&t.push({froms:n,tos:p,hole:f}),c?(c=!1,o[p].push(s)):h=!0);c&&o[n].push(s)}0<t.length&&(h||(u=o))}for(h=0,n=l.length;h<n;h++)for(o=l[h].s,e.push(o),i=0,a=(t=u[h]).length;i<a;i++)o.holes.push(t[i].h);return e}}),Hu(Ri.prototype,{isFont:!0,generateShapes:function(t,e){var r=[],n=e=void 0===e?100:e;e=this.data;var i=Ru?Ru(t):String(t).split("");n/=e.resolution;var a=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*n;t=[];for(var o=0,s=0,l=0;l<i.length;l++)if("\n"===(c=i[l]))o=0,s-=a;else{var u=c,c=n,h=o,d=s,p=(f=e).glyphs[u]||f.glyphs["?"];if(p){if(u=new Li,p.o)for(var f,m=0,g=(f=p._cachedOutline||(p._cachedOutline=p.o.split(" "))).length;m<g;)switch(f[m++]){case"m":var v=f[m++]*c+h,y=f[m++]*c+d;u.moveTo(v,y);break;case"l":v=f[m++]*c+h,y=f[m++]*c+d,u.lineTo(v,y);break;case"q":var x=f[m++]*c+h,b=f[m++]*c+d,_=f[m++]*c+h,A=f[m++]*c+d;u.quadraticCurveTo(_,A,x,b);break;case"b":x=f[m++]*c+h,b=f[m++]*c+d,_=f[m++]*c+h,A=f[m++]*c+d,v=f[m++]*c+h,y=f[m++]*c+d,u.bezierCurveTo(_,A,v,y,x,b)}c={offsetX:p.ha*c,path:u}}else console.error('THREE.Font: character "'+u+'" does not exists in font family '+f.familyName+"."),c=void 0;o+=c.offsetX,t.push(c.path)}for(e=0,i=t.length;e<i;e++)Array.prototype.push.apply(r,t[e].toShapes());return r}}),Pi.prototype=Hu(Uu(zn.prototype),{constructor:Pi,load:function(t,n,e,r){var i=this,a=new Un(this.manager);a.setPath(this.path),a.load(t,function(e){try{var r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}e=i.parse(r),n&&n(e)},e,r)},parse:function(t){return new Ri(t)}});var op,sp=function(){return op=void 0===op?new(window.AudioContext||window.webkitAudioContext):op};Di.prototype=Hu(Uu(zn.prototype),{constructor:Di,load:function(r,n,t,i){var a=this,e=new Un(a.manager);e.setResponseType("arraybuffer"),e.setPath(a.path),e.load(r,function(t){try{var e=t.slice(0);sp().decodeAudioData(e,function(t){n(t)})}catch(t){i?i(t):console.error(t),a.manager.itemError(r)}},t,i)}}),Oi.prototype=Hu(Uu(wi.prototype),{constructor:Oi,isHemisphereLightProbe:!0,copy:function(t){return wi.prototype.copy.call(this,t),this},toJSON:function(t){return wi.prototype.toJSON.call(this,t)}}),Fi.prototype=Hu(Uu(wi.prototype),{constructor:Fi,isAmbientLightProbe:!0,copy:function(t){return wi.prototype.copy.call(this,t),this},toJSON:function(t){return wi.prototype.toJSON.call(this,t)}});var lp=new Ct,up=new Ct;Hu(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new q,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new q,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var e,r,n,i,a,o=this._cache;o.focus===t.focus&&o.fov===t.fov&&o.aspect===t.aspect*this.aspect&&o.near===t.near&&o.far===t.far&&o.zoom===t.zoom&&o.eyeSep===this.eyeSep||(o.focus=t.focus,o.fov=t.fov,o.aspect=t.aspect*this.aspect,o.near=t.near,o.far=t.far,o.zoom=t.zoom,o.eyeSep=this.eyeSep,e=t.projectionMatrix.clone(),r=(i=o.eyeSep/2)*o.near/o.focus,n=o.near*Math.tan(Qu.DEG2RAD*o.fov*.5)/o.zoom,up.elements[12]=-i,lp.elements[12]=i,i=-n*o.aspect+r,a=n*o.aspect+r,e.elements[0]=2*o.near/(a-i),e.elements[8]=(a+i)/(a-i),this.cameraL.projectionMatrix.copy(e),i=-n*o.aspect-r,a=n*o.aspect-r,e.elements[0]=2*o.near/(a-i),e.elements[8]=(a+i)/(a-i),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(up),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(lp)}}),Hu(Bi.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}});var cp=new Mt,hp=new f,dp=new Mt,pp=new Mt;Ni.prototype=Hu(Uu(B.prototype),{constructor:Ni,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){B.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var e,r=this.up;this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(cp,hp,dp),pp.set(0,0,-1).applyQuaternion(hp),t.positionX?(e=this.context.currentTime+this.timeDelta,t.positionX.linearRampToValueAtTime(cp.x,e),t.positionY.linearRampToValueAtTime(cp.y,e),t.positionZ.linearRampToValueAtTime(cp.z,e),t.forwardX.linearRampToValueAtTime(pp.x,e),t.forwardY.linearRampToValueAtTime(pp.y,e),t.forwardZ.linearRampToValueAtTime(pp.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)):(t.setPosition(cp.x,cp.y,cp.z),t.setOrientation(pp.x,pp.y,pp.z,r.x,r.y,r.z))}}),zi.prototype=Hu(Uu(B.prototype),{constructor:zi,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+t,(t=this.context.createBufferSource()).buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t=t||[],!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var fp=new Mt,mp=new f,gp=new Mt,vp=new Mt;Ui.prototype=Hu(Uu(zi.prototype),{constructor:Ui,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,r){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(t){var e;B.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(fp,mp,gp),vp.set(0,0,1).applyQuaternion(mp),(t=this.panner).positionX?(e=this.context.currentTime+this.listener.timeDelta,t.positionX.linearRampToValueAtTime(fp.x,e),t.positionY.linearRampToValueAtTime(fp.y,e),t.positionZ.linearRampToValueAtTime(fp.z,e),t.orientationX.linearRampToValueAtTime(vp.x,e),t.orientationY.linearRampToValueAtTime(vp.y,e),t.orientationZ.linearRampToValueAtTime(vp.z,e)):(t.setPosition(fp.x,fp.y,fp.z),t.setOrientation(vp.x,vp.y,vp.z)))}}),Hu(ki.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),r=0;r<e.length;r++)t+=e[r];return t/e.length}}),Hu(Hi.prototype,{accumulate:function(t,e){var r=this.buffer,n=this.valueSize;t=t*n+n;var i=this.cumulativeWeight;if(0===i){for(i=0;i!==n;++i)r[t+i]=r[i];i=e}else i+=e,this._mixBufferRegion(r,t,0,e/i,n);this.cumulativeWeight=i},accumulateAdditive:function(t){var e=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,r),this.cumulativeWeightAdditive+=t},apply:function(t){var e=this.valueSize,r=this.buffer;t=t*e+e;var n=this.cumulativeWeight,i=this.cumulativeWeightAdditive,a=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,n<1&&this._mixBufferRegion(r,t,e*this._origIndex,1-n,e),0<i&&this._mixBufferRegionAdditive(r,t,this._addIndex*e,1,e),i=(n=e)+e;n!==i;++n)if(r[n]!==r[n+e]){a.setValue(r,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,r=e*this._origIndex;this.binding.getValue(t,r);for(var n=e;n!==r;++n)t[n]=t[r+n%e];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,e=t+this.valueSize;t<e;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[e+r]=this.buffer[t+r]},_select:function(t,e,r,n,i){if(.5<=n)for(n=0;n!==i;++n)t[e+n]=t[r+n]},_slerp:function(t,e,r,n){f.slerpFlat(t,e,t,e,t,r,n)},_slerpAdditive:function(t,e,r,n,i){i*=this._workIndex,f.multiplyQuaternionsFlat(t,i,t,e,t,r),f.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,r,n,i){for(var a=1-n,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[r+o]*n}},_lerpAdditive:function(t,e,r,n,i){for(var a=0;a!==i;++a)t[e+a]+=t[r+a]*n}});var yp=/[\[\]\.:\/]/g,Vs="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Yo=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),ds=/(WCOD+)?/.source.replace("WCOD",Vs),cs=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Vs=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),xp=new RegExp("^"+Yo+ds+cs+Vs+"$"),bp=["material","materials","bones"];Hu(Gi.prototype,{getValue:function(t,e){this.bind();var r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Hu(Vi,{Composite:Gi,create:function(t,e,r){return new(t&&t.isAnimationObjectGroup?Vi.Composite:Vi)(t,e,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(yp,"")},parseTrackName:function(t){var e=xp.exec(t);if(!e)throw Error("PropertyBinding: Cannot parse trackName: "+t);var r,n=(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]}).nodeName&&e.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n&&(r=e.nodeName.substring(n+1),-1!==bp.indexOf(r)&&(e.nodeName=e.nodeName.substring(0,n),e.objectName=r)),null===e.propertyName||0===e.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e},findNode:function(t,i){if(!i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(i);if(void 0!==e)return e}return t.children&&(t=function t(e){for(var r=0;r<e.length;r++){var n=e[r];if(n.name===i||n.uuid===i||(n=t(n.children)))return n}return null}(t.children))?t:null}}),Hu(Vi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,r=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(this.node=t=Vi.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var a=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,r=0;r<t.length;r++)if(t[r].name===a){a=r;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}if(void 0===(a=t[n]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+n+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==(this.targetObject=t).needsUpdate?e=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate),r=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}r=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(r=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(r=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[r],this.setValue=this.SetterByBindingTypeAndVersioning[r][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Hu(Vi.prototype,{_getValue_unbound:Vi.prototype.getValue,_setValue_unbound:Vi.prototype.setValue}),Hu(function(){this.uuid=Qu.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,r=arguments.length;e!==r;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=n[p=h.uuid];if(void 0===d){d=e++,n[p]=d,t.push(h);for(var p=0,f=s;p!==f;++p)o[p].push(new Vi(h,i[p],a[p]))}else if(d<r){var l=t[d],m=--r;for(t[n[(f=t[m]).uuid]=d]=f,t[n[p]=m]=h,p=0,f=s;p!==f;++p){var g=o[p],v=g[d];g[d]=g[m],void 0===v&&(v=new Vi(h,i[p],a[p])),g[m]=v}}else t[d]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=r[l];if(void 0!==u&&e<=u){var c=e++;for(t[r[(h=t[c]).uuid]=u]=h,t[r[l]=c]=s,s=0,l=i;s!==l;++s){var h,d=(h=n[s])[u];h[u]=h[c],h[c]=d}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var l=n[u=arguments[o].uuid];if(void 0!==l)if(delete n[u],l<r){var u,c=t[u=--r],h=--e,d=t[h];for(t[n[c.uuid]=l]=c,t[n[d.uuid]=u]=d,t.pop(),c=0,d=a;c!==d;++c){var p=i[c],f=p[h];p[l]=p[u],p[u]=f,p.pop()}}else for(t[n[(d=t[h=--e]).uuid]=l]=d,t.pop(),c=0,d=a;c!==d;++c)(p=i[c])[l]=p[h],p.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var r=this._bindingsIndicesByPath,n=r[t],i=this._bindings;if(void 0!==n)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,l=this.nCachedObjects_,u=Array(s.length),n=i.length;for(r[t]=n,a.push(t),o.push(e),i.push(u),r=l,n=s.length;r!==n;++r)u[r]=new Vi(s[r],t,e);return u},unsubscribe_:function(t){var e,r,n,i,a,o=this._bindingsIndicesByPath,s=o[t];void 0!==s&&(e=this._paths,r=this._parsedPaths,a=(n=this._bindings)[i=n.length-1],n[o[t[i]]=s]=a,n.pop(),r[s]=r[i],r.pop(),e[s]=e[i],e.pop())}}),Hu(Wi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,r){var n,i;return t.fadeOut(e),this.fadeIn(e),r&&(i=(r=this._clip.duration)/(n=t._clip.duration),t.warp(1,n/r,e),this.warp(i,1,e)),this},crossFadeTo:function(t,e,r){return t.crossFadeFrom(this,e,r)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,r){var n=this._mixer,i=n.time,a=this._timeScaleInterpolant,o=this.timeScale;return null===a&&(this._timeScaleInterpolant=a=n._lendControlInterpolant()),n=a.parameterPositions,a=a.sampleValues,n[0]=i,n[1]=i+r,a[0]=t/o,a[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,r,n){if(this.enabled){var i=this._startTime;if(null!==i){if((e=(t-i)*r)<0||0===r)return;this._startTime=null,e*=r}if(e*=this._updateTimeScale(t),r=this._updateTime(e),0<(t=this._updateWeight(t)))if(2501===(e=this._interpolants,i=this._propertyBindings,this.blendMode))for(var a=0,o=e.length;a!==o;++a)e[a].evaluate(r),i[a].accumulateAdditive(t);else for(a=0,o=e.length;a!==o;++a)e[a].evaluate(r),i[a].accumulate(n,t)}else this._updateWeight(t)},_updateWeight:function(t){var e,r,n=0;return this.enabled&&(n=this.weight,null!==(e=this._weightInterpolant)&&(n*=r=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1)))),this._effectiveWeight=n},_updateTimeScale:function(t){var e,r=0;return this.paused||(r=this.timeScale,null!==(e=this._timeScaleInterpolant)&&(r*=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopWarping(),0===r?this.paused=!0:this.timeScale=r))),this._effectiveTimeScale=r},_updateTime:function(t){var e,r=this.time+t,n=this._clip.duration,i=this.loop,a=this._loopCount,o=2202===i;if(0===t)return-1!==a&&o&&1==(1&a)?n-r:r;if(2200===i)t:{if(-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1)),n<=r)r=n;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}else if(-1===a&&(0<=t?(a=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),n<=r||r<0?(r-=n*(i=Math.floor(r/n)),a+=Math.abs(i),(e=this.repetitions-a)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1==e?(t=t<0,this._setEndings(t,!t,o)):this._setEndings(!1,!1,o),this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i}))):this.time=r,o&&1==(1&a))return n-r;return r},_setEndings:function(t,e,r){var n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;return null===a&&(this._weightInterpolant=a=n._lendControlInterpolant()),n=a.parameterPositions,a=a.sampleValues,n[0]=i,a[0]=e,n[1]=i+t,a[1]=r,this}}),ji.prototype=Hu(Uu(i.prototype),{constructor:ji,_bindAction:function(t,e){var r=t._localRoot||this._root,n=t._clip.tracks,i=n.length,a=t._propertyBindings;t=t._interpolants;var o=r.uuid,s=this._bindingsByRootAndName,l=s[o];for(void 0===l&&(l={},s[o]=l),s=0;s!==i;++s){var u=n[s],c=u.name,h=l[c];if(void 0===h){if(void 0!==(h=a[s])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,o,c));continue}++(h=new Hi(Vi.create(r,c,e&&e._propertyBindings[s].binding.parsedPath),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(h,o,c)}a[s]=h,t[s].resultBuffer=h.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){var e,r,n;for(null===t._cacheIndex&&(e=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r],this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,e)),r=0,n=(e=t._propertyBindings).length;r!==n;++r){var i=e[r];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,r){var n=this._actions,i=this._actionsByClip,a=i[e];void 0===a?(a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a):(e=a.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),a.actionByRoot[r]=t},_removeInactiveAction:function(t){var e=(n=this._actions)[n.length-1],r=t._cacheIndex;n[e._cacheIndex=r]=e,n.pop(),t._cacheIndex=null;var n=t._clip.uuid,i=(r=(e=this._actionsByClip)[n]).knownActions,a=i[i.length-1],o=t._byClipCacheIndex;i[a._byClipCacheIndex=o]=a,i.pop(),t._byClipCacheIndex=null,delete r.actionByRoot[(t._localRoot||this._root).uuid],0===i.length&&delete e[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,r=(t=t._propertyBindings).length;e!==r;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,r=t._cacheIndex,n=this._nActiveActions++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_takeBackAction:function(t){var e=this._actions,r=t._cacheIndex,n=--this._nActiveActions,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_addInactiveBinding:function(t,e,r){var n=this._bindingsByRootAndName,i=n[e],a=this._bindings;void 0===i&&(i={},n[e]=i),(i[r]=t)._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,r=(n=t.binding).rootNode.uuid,n=n.path,i=this._bindingsByRootAndName,a=i[r],o=e[e.length-1];t=t._cacheIndex,e[o._cacheIndex=t]=o,e.pop(),delete a[n],0===Nu(a).length&&delete i[r]},_lendBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_takeBackBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,i=e[n];e[t._cacheIndex=n]=t,e[i._cacheIndex=r]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&(t[(r=new Cn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=r),r},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];e[t.__cacheIndex=n]=t,e[i.__cacheIndex=r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,r){var n=e||this._root,i=n.uuid;t=null!==(n="string"==typeof t?Fn.findByName(n,t):t)?n.uuid:t;var a=this._actionsByClip[t],o=null;if(void 0===r&&(r=null!==n?n.blendMode:2500),void 0!==a){if(void 0!==(o=a.actionByRoot[i])&&o.blendMode===r)return o;o=a.knownActions[0],null===n&&(n=o._clip)}return null===n?null:(e=new Wi(this,n,e,r),this._bindAction(e,o),this._addInactiveAction(e,t,i),e)},existingAction:function(t,e){var r=e||this._root;return e=r.uuid,r="string"==typeof t?Fn.findByName(r,t):t,void 0!==(t=this._actionsByClip[r?r.uuid:t])&&t.actionByRoot[e]||null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions-1;0<=e;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,n=this.time+=t,i=Gu(t),a=this._accuIndex^=1,o=0;o!==r;++o)e[o]._update(n,t,i,a);for(t=this._bindings,e=this._nActiveBindings,o=0;o!==e;++o)t[o].apply(a);return this},setTime:function(t){for(var e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var r=this._actionsByClip;if(void 0!==(n=r[t])){for(var n,i=0,a=(n=n.knownActions).length;i!==a;++i){var o=n[i];this._deactivateAction(o);var s=o._cacheIndex,l=e[e.length-1];o._cacheIndex=null,o._byClipCacheIndex=null,e[l._cacheIndex=s]=l,e.pop(),this._removeInactiveBindingsForAction(o)}delete r[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(n in e){var r=e[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var i in n)t=n[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Xi.prototype.clone=function(){return new Xi(void 0===this.value.clone?this.value:this.value.clone())},qi.prototype=Hu(Uu(He.prototype),{constructor:qi,isInstancedInterleavedBuffer:!0,copy:function(t){return He.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Hu(Yi.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,r){return Ji(t,this,r=r||[],e),r.sort(Zi),r},intersectObjects:function(t,e,r){if(r=r||[],!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,i=t.length;n<i;n++)Ji(t[n],this,r,e);return r.sort(Zi),r}}),Hu(function(t,e,r){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==r?r:0,this}.prototype,{set:function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,r){return this.radius=Math.sqrt(t*t+e*e+r*r),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t,r),this.phi=Math.acos(Qu.clamp(e/this.radius,-1,1))),this}}),Hu(function(t,e,r){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==r?r:0,this}.prototype,{set:function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,r){return this.radius=Math.sqrt(t*t+r*r),this.theta=Math.atan2(t,r),this.y=e,this}});var _p=new At;Hu(Ki.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=_p.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new At),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new At),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new At),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new At),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return _p.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ap=new Mt,wp=new Mt;Hu(Qi.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Mt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Mt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Mt),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){return Ap.subVectors(t,this.start),wp.subVectors(this.end,this.start),t=wp.dot(wp),t=wp.dot(Ap)/t,t=e?Qu.clamp(t,0,1):t},closestPointToPoint:function(t,e,r){return t=this.closestPointToPointParameter(t,e),void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Mt),this.delta(r).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(($i.prototype=Uu(B.prototype)).constructor=$i).prototype.isImmediateRenderObject=!0;var Mp=new Mt;((ta.prototype=Uu(B.prototype)).constructor=ta).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ta.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance||1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Mp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Mp),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Cp=new Mt,Tp=new Ct,Sp=new Ct;((ea.prototype=Uu($e.prototype)).constructor=ea).prototype.isSkeletonHelper=!0,ea.prototype.updateMatrixWorld=function(t){var e=this.bones,r=this.geometry,n=r.getAttribute("position");Sp.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<e.length;i++){var o=e[i];o.parent&&o.parent.isBone&&(Tp.multiplyMatrices(Sp,o.matrixWorld),Cp.setFromMatrixPosition(Tp),n.setXYZ(a,Cp.x,Cp.y,Cp.z),Tp.multiplyMatrices(Sp,o.parent.matrixWorld),Cp.setFromMatrixPosition(Tp),n.setXYZ(a+1,Cp.x,Cp.y,Cp.z),a+=2)}r.getAttribute("position").needsUpdate=!0,B.prototype.updateMatrixWorld.call(this,t)},((ra.prototype=Uu(V.prototype)).constructor=ra).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ra.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var Ep=new Mt,Ip=new U,Lp=new U;((na.prototype=Uu(B.prototype)).constructor=na).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},na.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Ip.copy(this.light.color),Lp.copy(this.light.groundColor);for(var r=0,n=e.count;r<n;r++){var i=r<n/2?Ip:Lp;e.setXYZ(r,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Ep.setFromMatrixPosition(this.light.matrixWorld).negate())},ia.prototype=Hu(Uu($e.prototype),{constructor:ia,copy:function(t){return $e.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),(aa.prototype=Uu($e.prototype)).constructor=aa;var Rp=new Mt,Pp=new Mt,Dp=new Mt;((oa.prototype=Uu(B.prototype)).constructor=oa).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},oa.prototype.update=function(){Rp.setFromMatrixPosition(this.light.matrixWorld),Pp.setFromMatrixPosition(this.light.target.matrixWorld),Dp.subVectors(Pp,Rp),this.lightPlane.lookAt(Pp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Pp),this.targetLine.scale.z=Dp.length()};var Op=new Mt,Fp=new j;((sa.prototype=Uu($e.prototype)).constructor=sa).prototype.update=function(){var t=this.geometry,e=this.pointMap;Fp.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),la("c",e,t,Fp,0,0,-1),la("t",e,t,Fp,0,0,1),la("n1",e,t,Fp,-1,-1,-1),la("n2",e,t,Fp,1,-1,-1),la("n3",e,t,Fp,-1,1,-1),la("n4",e,t,Fp,1,1,-1),la("f1",e,t,Fp,-1,-1,1),la("f2",e,t,Fp,1,-1,1),la("f3",e,t,Fp,-1,1,1),la("f4",e,t,Fp,1,1,1),la("u1",e,t,Fp,.7,1.1,-1),la("u2",e,t,Fp,-.7,1.1,-1),la("u3",e,t,Fp,0,2,-1),la("cf1",e,t,Fp,-1,0,1),la("cf2",e,t,Fp,1,0,1),la("cf3",e,t,Fp,0,-1,1),la("cf4",e,t,Fp,0,1,1),la("cn1",e,t,Fp,-1,0,-1),la("cn2",e,t,Fp,1,0,-1),la("cn3",e,t,Fp,0,-1,-1),la("cn4",e,t,Fp,0,1,-1),t.getAttribute("position").needsUpdate=!0};var Bp=new N;((ua.prototype=Uu($e.prototype)).constructor=ua).prototype.update=function(t){var e,r,n;void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Bp.setFromObject(this.object),Bp.isEmpty()||(t=Bp.min,e=Bp.max,(n=(r=this.geometry.attributes.position).array)[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=t.x,n[4]=e.y,n[5]=e.z,n[6]=t.x,n[7]=t.y,n[8]=e.z,n[9]=e.x,n[10]=t.y,n[11]=e.z,n[12]=e.x,n[13]=e.y,n[14]=t.z,n[15]=t.x,n[16]=e.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=e.x,n[22]=t.y,n[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere())},ua.prototype.setFromObject=function(t){return this.object=t,this.update(),this},ua.prototype.copy=function(t){return $e.prototype.copy.call(this,t),this.object=t.object,this},ua.prototype.clone=function(){return(new this.constructor).copy(this)},((ca.prototype=Uu($e.prototype)).constructor=ca).prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),B.prototype.updateMatrixWorld.call(this,t))},((ha.prototype=Uu(Qe.prototype)).constructor=ha).prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),B.prototype.updateMatrixWorld.call(this,t)};var Np,zp,Up=new Mt;((da.prototype=Uu(B.prototype)).constructor=da).prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(Up.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(Up,Math.acos(t.y)))},da.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},da.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},da.prototype.copy=function(t){return B.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},da.prototype.clone=function(){return(new this.constructor).copy(this)},(pa.prototype=Uu($e.prototype)).constructor=pa;var kp=[.125,.215,.35,.446,.526,.582],Hp=5+kp.length;function Gp(t){zn.call(this,t)}Su(cs={},3e3,0),Su(cs,3001,1),Su(cs,3002,2),Su(cs,3004,3),Su(cs,3005,4),Su(cs,3006,5),Su(cs,3007,6),new vi,function(){for(var t=[],e=[],r=[],n=8,i=0;i<Hp;i++){var a=Math.pow(2,n);e.push(a);var o=1/a;4<i?o=kp[i-8+4-1]:0==i&&(o=0),r.push(o);var s=[a=-(o=1/(a-1))/2,a,o=1+o/2,a,o,o,a,a,o,o,a,o];a=new Float32Array(108),o=new Float32Array(72);for(var l=new Float32Array(36),u=0;u<6;u++){var c=u%3*2/3-1,h=2<u?0:-1;a.set([c,h,0,c+2/3,h,0,c+2/3,1+h,0,c,h,0,c+2/3,1+h,0,c,1+h,0],18*u),o.set(s,12*u),l.set([u,u,u,u,u,u],6*u)}(s=new X).setAttribute("position",new G(a,3)),s.setAttribute("uv",new G(o,2)),s.setAttribute("faceIndex",new G(l,1)),t.push(s),4<n&&n--}}(),Xn.create=function(t,e){return t.prototype=Uu(Xn.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Hu(si.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new D,r=0,n=t.length;r<n;r++){var i=t[r];e.vertices.push(new Mt(i.x,i.y,i.z||0))}return e}}),Hu(li.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Uu(Jn.prototype),Uu(Jn.prototype),fa.prototype=Uu(Jn.prototype),Hu(fa.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),ia.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ea.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Hu(zn.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ep(t)}}),zn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Hu(Ei.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Hu(Ki.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Hu(N.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Hu(z.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Et.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Qi.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Hu(Qu,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Qu.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Qu.ceilPowerOfTwo(t)}}),Hu(g.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Hu(Ct.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Mt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,r,i,a)}}),v.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},f.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Hu(u.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Hu(b.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Hu(b,{barycoordFromPoint:function(t,e,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),b.getBarycoord(t,e,r,n,i)},normal:function(t,e,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),b.getNormal(t,e,r,n)}}),Hu(ui.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new jr(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new rn(this,t)}}),Hu(At.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(Mt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(wt.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Hu(D.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Hu(B.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ku(B.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Hu(V.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),ku(V.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ku(Xe.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ye.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),qe.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Xn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),q.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},ku(ci.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),ku(G.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Hu(G.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Hu(X.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e,r){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new G(e,r)))},addDrawCall:function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ku(X.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ku(Ci.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),ku(Yi.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),ku(He.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Hu(He.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Hu(Xr.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),ku(Xi.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),ku(k.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new U}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),ku(vn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),ku(W.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Hu(ze.prototype,{clearTarget:function(t,e,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,r,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),ku(ze.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}}}),ku(Ie.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),ku(T.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),ku(zi.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Di).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),ki.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Y.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},tc.crossOrigin=void 0,tc.loadTexture=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new jn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,r,void 0,n),e&&(t.mapping=e),t},tc.loadTextureCube=function(t,e,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Wn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,r,void 0,n),e&&(t.mapping=e),t},tc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},tc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}})),Gp.prototype=Hu(Uu(zn.prototype),{constructor:Gp,load:function(e,r,t,n){var i=this,a=""===this.path?ep(e):this.path,o=new Un(this.manager);o.setPath(this.path),o.load(e,function(t){try{r(i.parse(t,a))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,e){var r=t.split("\n"),n={},i=/\s+/;t={};for(var a=0;a<r.length;a++){var o,s,l=r[a];0!==(l=l.trim()).length&&"#"!==l.charAt(0)&&(s=(s=0<=(o=l.indexOf(" "))?l.substring(0,o):l).toLowerCase(),l=(l=0<=o?l.substring(o+1):"").trim(),"newmtl"===s?(n={name:l},t[l]=n):"ka"===s||"kd"===s||"ks"===s||"ke"===s?(l=l.split(i,3),n[s]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]):n[s]=l)}return(e=new Gp.MaterialCreator(this.resourcePath||e,this.materialOptions)).setCrossOrigin(this.crossOrigin),e.setManager(this.manager),e.setMaterials(t),e}}),(Gp.MaterialCreator=function(t,e){this.baseUrl=t||"",this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:0,this.wrap=this.options&&this.options.wrap?this.options.wrap:1e3}).prototype={constructor:Gp.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var e,r={};for(e in t){var n,i=t[e],a={};for(n in r[e]=a,i){var o=!0,s=i[n],l=n.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(a[l]=s)}}return r},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t,e=0;for(t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){function e(t,e){var r,n;a[t]||(e=i.getTextureParams(e,a),(n=i.loadTexture((r=i.baseUrl,"string"!=typeof(n=e.url)||""===n?"":/^https?:\/\//i.test(n)?n:r+n))).repeat.copy(e.scale),n.offset.copy(e.offset),n.wrapS=i.wrap,n.wrapT=i.wrap,a[t]=n)}var r,i=this,n=this.materialsInfo[t],a={name:t,side:this.side};for(r in n){var o=n[r];if(""!==o)switch(r.toLowerCase()){case"kd":a.color=(new U).fromArray(o);break;case"ks":a.specular=(new U).fromArray(o);break;case"ke":a.emissive=(new U).fromArray(o);break;case"map_kd":e("map",o);break;case"map_ks":e("specularMap",o);break;case"map_ke":e("emissiveMap",o);break;case"norm":e("normalMap",o);break;case"map_bump":case"bump":e("bumpMap",o);break;case"map_d":e("alphaMap",o),a.transparent=!0;break;case"ns":a.shininess=parseFloat(o);break;case"d":(o=parseFloat(o))<1&&(a.opacity=o,a.transparent=!0);break;case"tr":o=parseFloat(o),0<(o=this.options&&this.options.invertTrProperty?1-o:o)&&(a.opacity=1-o,a.transparent=!0)}}return this.materials[t]=new vn(a),this.materials[t]},getTextureParams:function(t,e){var r={scale:new At(1,1),offset:new At(0,0)},n=(t=t.split(/\s+/)).indexOf("-bm");return 0<=n&&(e.bumpScale=parseFloat(t[n+1]),t.splice(n,2)),0<=(n=t.indexOf("-s"))&&(r.scale.set(parseFloat(t[n+1]),parseFloat(t[n+2])),t.splice(n,4)),0<=(n=t.indexOf("-o"))&&(r.offset.set(parseFloat(t[n+1]),parseFloat(t[n+2])),t.splice(n,4)),r.url=t.join(" ").trim(),r},loadTexture:function(t,e,r,n,i){var a=void 0!==this.manager?this.manager:qd,o=a.getHandler(t);return(o=null===o?new jn(a):o).setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),t=o.load(t,r,n,i),void 0!==e&&(t.mapping=e),t}},Vs=function(){function v(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){var r;this.object&&!1===this.object.fromDeclaration?(this.object.name=t,this.object.fromDeclaration=!1!==e):(r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0,this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasNormalIndices:!1,hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){var r=this._finalize(!1);return r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1),t={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&0<e.length?e[e.length-1]:"",smooth:(void 0!==r?r:this).smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){return(t={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1}).clone=this.clone.bind(t),t}},this.materials.push(t),t},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&1<this.materials.length)for(var r=this.materials.length-1;0<=r;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},r&&r.name&&"function"==typeof r.clone&&((t=r.clone(0)).inherited=!0,this.object.materials.push(t)),this.objects.push(this.object))},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){return 3*(0<=(t=parseInt(t,10))?t-1:t+e/3)},parseNormalIndex:function(t,e){return 3*(0<=(t=parseInt(t,10))?t-1:t+e/3)},parseUVIndex:function(t,e){return 2*(0<=(t=parseInt(t,10))?t-1:t+e/2)},addVertex:function(t,e,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[t+0],n[t+1],n[t+2]),i.push(n[e+0],n[e+1],n[e+2]),i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[t+0],n[t+1],n[t+2]),i.push(n[e+0],n[e+1],n[e+2]),i.push(n[r+0],n[r+1],n[r+2])},addFaceNormal:function(t,e,r){var n=this.vertices,i=this.object.geometry.normals;a.fromArray(n,t),o.fromArray(n,e),s.fromArray(n,r),u.subVectors(s,o),l.subVectors(a,o),u.cross(l),u.normalize(),i.push(u.x,u.y,u.z),i.push(u.x,u.y,u.z),i.push(u.x,u.y,u.z)},addColor:function(t,e,r){var n=this.colors,i=this.object.geometry.colors;void 0!==n[t]&&i.push(n[t+0],n[t+1],n[t+2]),void 0!==n[e]&&i.push(n[e+0],n[e+1],n[e+2]),void 0!==n[r]&&i.push(n[r+0],n[r+1],n[r+2])},addUV:function(t,e,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[t+0],n[t+1]),i.push(n[e+0],n[e+1]),i.push(n[r+0],n[r+1])},addDefaultUV:function(){var t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,r,n,i,a,o,s,l){var u=this.vertices.length;t=this.parseVertexIndex(t,u),e=this.parseVertexIndex(e,u),r=this.parseVertexIndex(r,u),this.addVertex(t,e,r),this.addColor(t,e,r),void 0!==o&&""!==o?(r=this.normals.length,t=this.parseNormalIndex(o,r),e=this.parseNormalIndex(s,r),r=this.parseNormalIndex(l,r),this.addNormal(t,e,r),this.object.geometry.hasNormalIndices=!0):this.addFaceNormal(t,e,r),void 0!==n&&""!==n?(o=this.uvs.length,t=this.parseUVIndex(n,o),e=this.parseUVIndex(i,o),r=this.parseUVIndex(a,o),this.addUV(t,e,r),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,r=0,n=t.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(t[r],e))},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,i=0,a=t.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(t[i],r));for(t=0,a=e.length;t<a;t++)this.addUVLine(this.parseUVIndex(e[t],n))}};return t.startObject("",!1),t}function t(t){zn.call(this,t),this.materials=null}var y=/^[og]\s*(.+)?/,x=/^mtllib /,b=/^usemtl /,_=/^usemap /,a=new Mt,o=new Mt,s=new Mt,l=new Mt,u=new Mt;return t.prototype=Hu(Uu(zn.prototype),{constructor:t,load:function(e,r,t,n){var i=this,a=new Un(i.manager);a.setPath(this.path),a.load(e,function(t){try{r(i.parse(t))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},t,n)},setMaterials:function(t){return this.materials=t,this},parse:function(t){var e,r=new v,n=(t=-1!==(t=-1!==t.indexOf("\r\n")?t.replace(/\r\n/g,"\n"):t).indexOf("\\\n")?t.replace(/\\\n/g,""):t).split("\n"),i="function"==typeof"".trimLeft;t=0;for(var a=n.length;t<a;t++){var o=n[t],s=(o=i?o.trimLeft():o.trim()).length;if(0!==s&&"#"!==(s=o.charAt(0)))if("v"===s)switch(o=o.split(/\s+/),o[0]){case"v":r.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])),7<=o.length?r.colors.push(parseFloat(o[4]),parseFloat(o[5]),parseFloat(o[6])):r.colors.push(void 0,void 0,void 0);break;case"vn":r.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));break;case"vt":r.uvs.push(parseFloat(o[1]),parseFloat(o[2]))}else if("f"===s){var l=(o=o.substr(1).trim()).split(/\s+/);for(o=[],s=0,e=l.length;s<e;s++){var u=l[s];0<u.length&&(u=u.split("/"),o.push(u))}for(l=o[0],s=1,e=o.length-1;s<e;s++){var u=o[s],c=o[s+1];r.addFace(l[0],u[0],c[0],l[1],u[1],c[1],l[2],u[2],c[2])}}else if("l"===s){if(s=o.substring(1).trim().split(" "),e=[],l=[],-1===o.indexOf("/"))e=s;else for(o=0,u=s.length;o<u;o++)""!==(c=s[o].split("/"))[0]&&e.push(c[0]),""!==c[1]&&l.push(c[1]);r.addLineGeometry(e,l)}else"p"===s?(o=(o=o.substr(1).trim()).split(" "),r.addPointGeometry(o)):null!==(e=y.exec(o))?(o=(" "+e[0].substr(1).trim()).substr(1),r.startObject(o)):b.test(o)?r.object.startMaterial(o.substring(7).trim(),r.materialLibraries):x.test(o)?r.materialLibraries.push(o.substring(7).trim()):_.test(o)?console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.'):"s"===s?(1<(e=o.split(" ")).length?(o=e[1].trim().toLowerCase(),r.object.smooth="0"!==o&&"off"!==o):r.object.smooth=!0,(o=r.object.currentMaterial())&&(o.smooth=r.object.smooth)):"\0"!==o&&console.warn('THREE.OBJLoader: Unexpected line: "'+o+'"')}for(r.finalize(),(n=new Oe).materialLibraries=[].concat(r.materialLibraries),t=0,a=r.objects.length;t<a;t++)if(o=(i=r.objects[t]).geometry,s=i.materials,e="Line"===o.type,l="Points"===o.type,u=!1,0!==o.vertices.length){(c=new X).setAttribute("position",new I(o.vertices,3)),!0===o.hasNormalIndices&&c.setAttribute("normal",new I(o.normals,3)),0<o.colors.length&&(u=!0,c.setAttribute("color",new I(o.colors,3))),!0===o.hasUVIndices&&c.setAttribute("uv",new I(o.uvs,2));for(var h=[],d=0,p=s.length;d<p;d++){var f,m=s[d],g=m.name+"_"+m.smooth+"_"+u;o=r.materials[g],null!==this.materials&&(o=this.materials.create(m.name),!e||!o||o instanceof Ke?!l||!o||o instanceof er||(f=new er({size:10,sizeAttenuation:!1}),k.prototype.copy.call(f,o),f.color.copy(o.color),f.map=o.map,o=f):(f=new Ke,k.prototype.copy.call(f,o),f.color.copy(o.color),o=f)),void 0===o&&((o=e?new Ke:l?new er({size:1,sizeAttenuation:!1}):new vn).name=m.name,o.flatShading=!m.smooth,o.vertexColors=u,r.materials[g]=o),h.push(o)}if(1<h.length){for(d=0,p=s.length;d<p;d++)m=s[d],c.addGroup(m.groupStart,m.groupCount,d);o=new(e?$e:l?rr:V)(c,h)}else o=new(e?$e:l?rr:V)(c,h[0]);o.name=i.name,n.add(o)}return n}}),t}(),cs=function(){function t(t){zn.call(this,t),this.ddsLoader=this.dracoLoader=null}function n(){var r={};return{get:function(t){return r[t]},add:function(t,e){r[t]=e},remove:function(t){delete r[t]},removeAll:function(){r={}}}}function l(t){if(!t)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=T.MSFT_TEXTURE_DDS,this.ddsLoader=t}function u(t){this.name=T.KHR_LIGHTS_PUNCTUAL,this.lightDefs=(t.extensions&&t.extensions[T.KHR_LIGHTS_PUNCTUAL]||{}).lights||[]}function c(){this.name=T.KHR_MATERIALS_UNLIT}function h(){this.name=T.KHR_MATERIALS_CLEARCOAT}function d(t){this.name=T.KHR_BINARY_GLTF,this.body=this.content=null;var e=new DataView(t,0,a);if(this.header={magic:tp(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==S)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");for(var e=new DataView(t,a),r=0;r<e.byteLength;){var n=e.getUint32(r,!0);r+=4;var i=e.getUint32(r,!0);r+=4,i===o.JSON?(i=new Uint8Array(t,a+r,n),this.content=tp(i)):i===o.BIN&&(i=a+r,this.body=t.slice(i,i+n)),r+=n}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}function p(t,e){if(!e)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=T.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function f(){this.name=T.KHR_TEXTURE_TRANSFORM}function m(t){mn.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var r={specular:{value:(new U).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=r,this.onBeforeCompile=function(t){for(var e in r)t.uniforms[e]=r[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),t.fragmentShader=t.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif"),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n\tuniform sampler2D glossinessMap;\n#endif"),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\ttexelSpecular = sRGBToLinear( texelSpecular );\n\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tspecularFactor *= texelSpecular.rgb;\n#endif"),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );\n\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tglossinessFactor *= texelGlossiness.a;\n#endif"),t.fragmentShader=t.fragmentShader.replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\nmaterial.specularColor = specularFactor.rgb;")},ku(this,{specular:{get:function(){return r.specular.value},set:function(t){r.specular.value=t}},specularMap:{get:function(){return r.specularMap.value},set:function(t){r.specularMap.value=t}},glossiness:{get:function(){return r.glossiness.value},set:function(t){r.glossiness.value=t}},glossinessMap:{get:function(){return r.glossinessMap.value},set:function(t){(r.glossinessMap.value=t)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function g(){return{name:T.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:"color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" "),getMaterialType:function(){return m},extendParams:function(t,e,r){var n,i=e.extensions[this.name];return t.color=new U(1,1,1),t.opacity=1,e=[],Array.isArray(i.diffuseFactor)&&(n=i.diffuseFactor,t.color.fromArray(n),t.opacity=n[3]),void 0!==i.diffuseTexture&&e.push(r.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new U(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new U(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture&&(i=i.specularGlossinessTexture,e.push(r.assignTexture(t,"glossinessMap",i)),e.push(r.assignTexture(t,"specularMap",i))),Pu.all(e)},createMaterial:function(t){var e=new m(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=0,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function v(){this.name=T.KHR_MESH_QUANTIZATION}function _(t,e,r,n){wn.call(this,t,e,r,n)}function y(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function x(t,e,r){for(var n in r.extensions)void 0===t[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=r.extensions[n])}function b(t,e){void 0!==e.extras&&("object"===Ou(e.extras)?Hu(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function A(t){for(var e="",r=Nu(t).sort(),n=0,i=r.length;n<i;n++)e+=r[n]+":"+t[r[n]]+";";return e}function w(t,e,r){this.json=t||{},this.extensions=e||{},this.options=r||{},this.cache=new n,this.associations=new Fu,this.primitiveCache={},this.textureLoader=new jn(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Un(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function M(r,t,n){var e,i=t.attributes,a=[];for(e in i){var o=P[e]||e.toLowerCase();o in r.attributes||a.push(function(t,e){return n.getDependency("accessor",t).then(function(t){r.setAttribute(e,t)})}(i[e],o))}return void 0===t.indices||r.index||(i=n.getDependency("accessor",t.indices).then(function(t){r.setIndex(t)}),a.push(i)),b(r,t),function(t,e,r){var n=e.attributes,i=new N;if(void 0!==n.POSITION){var n=(a=r.json.accessors[n.POSITION]).min,a=a.max;if(void 0!==n&&void 0!==a){if(i.set(new Mt(n[0],n[1],n[2]),new Mt(a[0],a[1],a[2])),void 0!==(e=e.targets)){for(var o=new Mt,s=new Mt,l=0,u=e.length;l<u;l++)void 0!==(n=e[l]).POSITION&&(n=(a=r.json.accessors[n.POSITION]).min,a=a.max,void 0!==n&&void 0!==a?(s.setX(Math.max(Math.abs(n[0]),Math.abs(a[0]))),s.setY(Math.max(Math.abs(n[1]),Math.abs(a[1]))),s.setZ(Math.max(Math.abs(n[2]),Math.abs(a[2]))),o.max(s)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."));i.expandByVector(o)}t.boundingBox=i,r=new z,i.getCenter(r.center),r.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=r}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(r,t,n),Pu.all(a).then(function(){return void 0!==t.targets?function(r,t,e){for(var n=!1,i=!1,a=0,o=t.length;a<o;a++){var s=t[a];if(void 0!==s.POSITION&&(n=!0),void 0!==s.NORMAL&&(i=!0),n&&i)break}if(!n&&!i)return Pu.resolve(r);for(var l=[],u=[],a=0,o=t.length;a<o;a++){var c,s=t[a];n&&(c=void 0!==s.POSITION?e.getDependency("accessor",s.POSITION):r.attributes.position,l.push(c)),i&&(c=void 0!==s.NORMAL?e.getDependency("accessor",s.NORMAL):r.attributes.normal,u.push(c))}return Pu.all([Pu.all(l),Pu.all(u)]).then(function(t){var e=t[0];return t=t[1],n&&(r.morphAttributes.position=e),i&&(r.morphAttributes.normal=t),r.morphTargetsRelative=!0,r})}(r,t.targets,n):r})}function C(t,e){if(null===(r=t.getIndex())){var r,n=[];if(void 0===(r=t.getAttribute("position")))return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var i=0;i<r.count;i++)n.push(i);t.setIndex(n),r=t.getIndex()}var a=r.count-2,n=[];if(2===e)for(i=1;i<=a;i++)n.push(r.getX(0)),n.push(r.getX(i)),n.push(r.getX(i+1));else for(i=0;i<a;i++)0==i%2?(n.push(r.getX(i)),n.push(r.getX(i+1)),n.push(r.getX(i+2))):(n.push(r.getX(i+2)),n.push(r.getX(i+1)),n.push(r.getX(i)));return n.length/3!=a&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles."),(t=t.clone()).setIndex(n),t}t.prototype=Hu(Uu(zn.prototype),{constructor:t,load:function(e,r,t,n){var i=this,a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:ep(e);i.manager.itemStart(e);function o(t){n?n(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)}var s=new Un(i.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),"use-credentials"===i.crossOrigin&&s.setWithCredentials(!0),s.load(e,function(t){try{i.parse(t,a,function(t){r(t),i.manager.itemEnd(e)},o)}catch(t){o(t)}},t,o)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},parse:function(t,e,r,n){var i={};if("string"!=typeof t)if(tp(new Uint8Array(t,0,4))===S){try{i[T.KHR_BINARY_GLTF]=new d(t)}catch(t){return void(n&&n(t))}t=i[T.KHR_BINARY_GLTF].content}else t=tp(new Uint8Array(t));if(void 0===(t=JSON.parse(t)).asset||t.asset.version[0]<2)n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(t.extensionsUsed)for(var a=0;a<t.extensionsUsed.length;++a){var o=t.extensionsUsed[a],s=t.extensionsRequired||[];switch(o){case T.KHR_LIGHTS_PUNCTUAL:i[o]=new u(t);break;case T.KHR_MATERIALS_CLEARCOAT:i[o]=new h;break;case T.KHR_MATERIALS_UNLIT:i[o]=new c;break;case T.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:i[o]=new g;break;case T.KHR_DRACO_MESH_COMPRESSION:i[o]=new p(t,this.dracoLoader);break;case T.MSFT_TEXTURE_DDS:i[o]=new l(this.ddsLoader);break;case T.KHR_TEXTURE_TRANSFORM:i[o]=new f;break;case T.KHR_MESH_QUANTIZATION:i[o]=new v;break;default:0<=s.indexOf(o)&&console.warn('THREE.GLTFLoader: Unknown extension "'+o+'".')}}(e=new w(t,i,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager})).fileLoader.setRequestHeader(this.requestHeader),e.parse(r,n)}}});var T={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};u.prototype.loadLight=function(t){var e=this.lightDefs[t],r=new U(16777215);void 0!==e.color&&r.fromArray(e.color);var n=void 0!==e.range?e.range:0;switch(e.type){case"directional":(r=new xi(r)).target.position.set(0,0,-1),r.add(r.target);break;case"point":(r=new gi(r)).distance=n;break;case"spot":(r=new fi(r)).distance=n,e.spot=e.spot||{},e.spot.innerConeAngle=void 0!==e.spot.innerConeAngle?e.spot.innerConeAngle:0,e.spot.outerConeAngle=void 0!==e.spot.outerConeAngle?e.spot.outerConeAngle:Math.PI/4,r.angle=e.spot.outerConeAngle,r.penumbra=1-e.spot.innerConeAngle/e.spot.outerConeAngle,r.target.position.set(0,0,-1),r.add(r.target);break;default:throw Error('THREE.GLTFLoader: Unexpected light type, "'+e.type+'".')}return r.position.set(0,0,0),r.decay=2,void 0!==e.intensity&&(r.intensity=e.intensity),r.name=e.name||"light_"+t,Pu.resolve(r)},c.prototype.getMaterialType=function(){return H},c.prototype.extendParams=function(t,e,r){var n,i=[];return t.color=new U(1,1,1),t.opacity=1,(e=e.pbrMetallicRoughness)&&(Array.isArray(e.baseColorFactor)&&(n=e.baseColorFactor,t.color.fromArray(n),t.opacity=n[3]),void 0!==e.baseColorTexture&&i.push(r.assignTexture(t,"map",e.baseColorTexture))),Pu.all(i)},h.prototype.getMaterialType=function(){return gn},h.prototype.extendParams=function(t,e,r){var n=[];return void 0!==(e=e.extensions[this.name]).clearcoatFactor&&(t.clearcoat=e.clearcoatFactor),void 0!==e.clearcoatTexture&&n.push(r.assignTexture(t,"clearcoatMap",e.clearcoatTexture)),void 0!==e.clearcoatRoughnessFactor&&(t.clearcoatRoughness=e.clearcoatRoughnessFactor),void 0!==e.clearcoatRoughnessTexture&&n.push(r.assignTexture(t,"clearcoatRoughnessMap",e.clearcoatRoughnessTexture)),void 0!==e.clearcoatNormalTexture&&(n.push(r.assignTexture(t,"clearcoatNormalMap",e.clearcoatNormalTexture)),void 0!==e.clearcoatNormalTexture.scale&&(r=e.clearcoatNormalTexture.scale,t.clearcoatNormalScale=new At(r,r))),Pu.all(n)};var S="glTF",a=12,o={JSON:1313821514,BIN:5130562};p.prototype.decodePrimitive=function(t,e){var r,n=this.json,i=this.dracoLoader,a=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,s={},l={},u={};for(r in o){var c=P[r]||r.toLowerCase();s[c]=o[r]}for(r in t.attributes){var h,c=P[r]||r.toLowerCase();void 0!==o[r]&&(h=n.accessors[t.attributes[r]],u[c]=E[h.componentType],l[c]=!0===h.normalized)}return e.getDependency("bufferView",a).then(function(t){return new Pu(function(n){i.decodeDracoFile(t,function(t){for(var e in t.attributes){var r=t.attributes[e],e=l[e];void 0!==e&&(r.normalized=e)}n(t)},s,u)})})},f.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},((m.prototype=Uu(mn.prototype)).constructor=m).prototype.copy=function(t){return mn.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},((_.prototype=Uu(wn.prototype)).constructor=_).prototype.beforeStart_=_.prototype.copySampleValue_=function(t){var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize;t=t*n*3+n;for(var i=0;i!==n;i++)e[i]=r[t+i];return e},_.prototype.afterEnd_=_.prototype.copySampleValue_,_.prototype.interpolate_=function(t,e,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=(r=(e=(r-e)/(n-=e))*e)*e,u=(t*=u=3*o)-u,c=-2*l+3*r,h=1-c;for(e=(l-=r)-r+e,r=0;r!==o;r++)i[r]=h*a[u+r+o]+e*a[u+r+s]*n+c*a[t+r+o]+l*a[t+r]*n;return i};var E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},I={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},L={33071:1001,33648:1002,10497:1e3},R={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},P={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},D={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},O={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},F={"image/png":1023,"image/jpeg":1022};return w.prototype.parse=function(e,t){var r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Pu.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){t={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}},x(i,t,n),b(t,n),e(t)}).catch(t)},w.prototype.markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],r=this.json.meshes||[],n={},i={},a=0,o=e.length;a<o;a++)for(var s=e[a].joints,l=0,u=s.length;l<u;l++)t[s[l]].isBone=!0;for(e=0,a=t.length;e<a;e++)void 0!==(o=t[e]).mesh&&(void 0===n[o.mesh]&&(n[o.mesh]=i[o.mesh]=0),n[o.mesh]++,void 0!==o.skin&&(r[o.mesh].isSkinnedMesh=!0));this.json.meshReferences=n,this.json.meshUses=i},w.prototype.getDependency=function(t,e){var r=t+":"+e,n=this.cache.get(r);if(!n){switch(t){case"scene":n=this.loadScene(e);break;case"node":n=this.loadNode(e);break;case"mesh":n=this.loadMesh(e);break;case"accessor":n=this.loadAccessor(e);break;case"bufferView":n=this.loadBufferView(e);break;case"buffer":n=this.loadBuffer(e);break;case"material":n=this.loadMaterial(e);break;case"texture":n=this.loadTexture(e);break;case"skin":n=this.loadSkin(e);break;case"animation":n=this.loadAnimation(e);break;case"camera":n=this.loadCamera(e);break;case"light":n=this.extensions[T.KHR_LIGHTS_PUNCTUAL].loadLight(e);break;default:throw Error("Unknown type: "+t)}this.cache.add(r,n)}return n},w.prototype.getDependencies=function(r){var n,t=this.cache.get(r);return t||(n=this,t=Pu.all((this.json[r+("mesh"===r?"es":"s")]||[]).map(function(t,e){return n.getDependency(r,e)})),this.cache.add(r,t)),t},w.prototype.loadBuffer=function(t){var r=this.json.buffers[t],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw Error("THREE.GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===t)return Pu.resolve(this.extensions[T.KHR_BINARY_GLTF].body);var i=this.options;return new Pu(function(t,e){n.load(y(r.uri,i.path),t,void 0,function(){e(Error('THREE.GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},w.prototype.loadBufferView=function(t){var r=this.json.bufferViews[t];return this.getDependency("buffer",r.buffer).then(function(t){var e=r.byteOffset||0;return t.slice(e,e+(r.byteLength||0))})},w.prototype.loadAccessor=function(t){var h=this,d=this.json,p=this.json.accessors[t];return void 0===p.bufferView&&void 0===p.sparse?Pu.resolve(null):(t=[],void 0!==p.bufferView?t.push(this.getDependency("bufferView",p.bufferView)):t.push(null),void 0!==p.sparse&&(t.push(this.getDependency("bufferView",p.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",p.sparse.values.bufferView))),Pu.all(t).then(function(t){var e,r,n,i=t[0],a=R[p.type],o=E[p.componentType],s=o.BYTES_PER_ELEMENT,l=p.byteOffset||0,u=void 0!==p.bufferView?d.bufferViews[p.bufferView].byteStride:void 0,c=!0===p.normalized,s=u&&u!==s*a?(e=Math.floor(l/u),r="InterleavedBuffer:"+p.bufferView+":"+p.componentType+":"+e+":"+p.count,(n=h.cache.get(r))||(n=new He(e=new o(i,e*u,p.count*u/s),u/s),h.cache.add(r,n)),new Ge(n,a,l%u/s,c)):new G(e=null===i?new o(p.count*a):new o(i,l,p.count*a),a,c);if(void 0!==p.sparse)for(u=p.sparse.values.byteOffset||0,l=new E[p.sparse.indices.componentType](t[1],p.sparse.indices.byteOffset||0,p.sparse.count*R.SCALAR),t=new o(t[2],u,p.sparse.count*a),null!==i&&(s=new G(s.array.slice(),s.itemSize,s.normalized)),i=0,o=l.length;i<o;i++)if(u=l[i],s.setX(u,t[i*a]),2<=a&&s.setY(u,t[i*a+1]),3<=a&&s.setZ(u,t[i*a+2]),4<=a&&s.setW(u,t[i*a+3]),5<=a)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.");return s}))},w.prototype.loadTexture=function(r){var i=this,n=this.json,a=this.options,t=this.textureLoader,o=self.URL||self.webkitURL,s=n.textures[r],e=s.extensions||{},l=e[T.MSFT_TEXTURE_DDS]?n.images[e[T.MSFT_TEXTURE_DDS].source]:n.images[s.source],u=l.uri,c=!1;return void 0!==l.bufferView&&(u=i.getDependency("bufferView",l.bufferView).then(function(t){return c=!0,t=new Blob([t],{type:l.mimeType}),u=o.createObjectURL(t)})),Pu.resolve(u).then(function(r){var n=(n=a.manager.getHandler(r))||(e[T.MSFT_TEXTURE_DDS]?i.extensions[T.MSFT_TEXTURE_DDS].ddsLoader:t);return new Pu(function(t,e){n.load(y(r,a.path),t,void 0,e)})}).then(function(t){!0===c&&o.revokeObjectURL(u),t.flipY=!1,s.name&&(t.name=s.name),l.mimeType in F&&(t.format=F[l.mimeType]);var e=(n.samplers||{})[s.sampler]||{};return t.magFilter=I[e.magFilter]||1006,t.minFilter=I[e.minFilter]||1008,t.wrapS=L[e.wrapS]||1e3,t.wrapT=L[e.wrapT]||1e3,i.associations.set(t,{type:"textures",index:r}),t})},w.prototype.assignTexture=function(n,i,a){var o=this;return this.getDependency("texture",a.index).then(function(t){if(!t.isCompressedTexture)switch(i){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":t.format=1022}var e,r;void 0===a.texCoord||0==a.texCoord||"aoMap"===i&&1==a.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+a.texCoord+" for texture "+i+" not yet supported."),!o.extensions[T.KHR_TEXTURE_TRANSFORM]||(e=void 0!==a.extensions?a.extensions[T.KHR_TEXTURE_TRANSFORM]:void 0)&&(r=o.associations.get(t),t=o.extensions[T.KHR_TEXTURE_TRANSFORM].extendTexture(t,e),o.associations.set(t,r)),n[i]=t})},w.prototype.assignFinalMaterial=function(t){var e,r,n=t.geometry,i=t.material,a=void 0!==n.attributes.tangent,o=void 0!==n.attributes.color,s=void 0===n.attributes.normal,l=!0===t.isSkinnedMesh,u=0<Nu(n.morphAttributes).length,c=u&&void 0!==n.morphAttributes.normal;t.isPoints?(e="PointsMaterial:"+i.uuid,(r=this.cache.get(e))||(r=new er,k.prototype.copy.call(r,i),r.color.copy(i.color),r.map=i.map,r.sizeAttenuation=!1,this.cache.add(e,r)),i=r):t.isLine&&(e="LineBasicMaterial:"+i.uuid,(r=this.cache.get(e))||(r=new Ke,k.prototype.copy.call(r,i),r.color.copy(i.color),this.cache.add(e,r)),i=r),(a||o||s||l||u)&&(e="ClonedMaterial:"+i.uuid+":",i.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),l&&(e+="skinning:"),a&&(e+="vertex-tangents:"),o&&(e+="vertex-colors:"),s&&(e+="flat-shading:"),u&&(e+="morph-targets:"),c&&(e+="morph-normals:"),(r=this.cache.get(e))||(r=i.clone(),l&&(r.skinning=!0),a&&(r.vertexTangents=!0),o&&(r.vertexColors=!0),s&&(r.flatShading=!0),u&&(r.morphTargets=!0),c&&(r.morphNormals=!0),this.cache.add(e,r),this.associations.set(r,this.associations.get(i))),i=r),i.aoMap&&void 0===n.attributes.uv2&&void 0!==n.attributes.uv&&n.setAttribute("uv2",n.attributes.uv),i.normalScale&&!a&&(i.normalScale.y=-i.normalScale.y),i.clearcoatNormalScale&&!a&&(i.clearcoatNormalScale.y=-i.clearcoatNormalScale.y),t.material=i},w.prototype.loadMaterial=function(e){var t,r,n,i=this,a=this.extensions,o=this.json.materials[e],s={},l=o.extensions||{},u=[];return l[T.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?(n=a[T.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],r=n.getMaterialType(),u.push(n.extendParams(s,o,i))):l[T.KHR_MATERIALS_UNLIT]?(n=a[T.KHR_MATERIALS_UNLIT],r=n.getMaterialType(),u.push(n.extendParams(s,o,i))):(r=mn,n=o.pbrMetallicRoughness||{},s.color=new U(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)&&(t=n.baseColorFactor,s.color.fromArray(t),s.opacity=t[3]),void 0!==n.baseColorTexture&&u.push(i.assignTexture(s,"map",n.baseColorTexture)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(u.push(i.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),u.push(i.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture)))),!0===o.doubleSided&&(s.side=2),"BLEND"===(n=o.alphaMode||"OPAQUE")?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===n&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&r!==H&&(u.push(i.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new At(1,1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&r!==H&&(u.push(i.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&r!==H&&(s.emissive=(new U).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&r!==H&&u.push(i.assignTexture(s,"emissiveMap",o.emissiveTexture)),l[T.KHR_MATERIALS_CLEARCOAT]&&(n=a[T.KHR_MATERIALS_CLEARCOAT],r=n.getMaterialType(),u.push(n.extendParams(s,{extensions:l},i))),Pu.all(u).then(function(){var t=r===m?a[T.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new r(s);return o.name&&(t.name=o.name),t.map&&(t.map.encoding=3001),t.emissiveMap&&(t.emissiveMap.encoding=3001),b(t,o),i.associations.set(t,{type:"materials",index:e}),o.extensions&&x(a,t,o),t})},w.prototype.loadGeometries=function(t){for(var r=this,n=this.extensions,e=this.primitiveCache,i=[],a=0,o=t.length;a<o;a++){var s=t[a],l=(l=void 0,(l=(u=s).extensions&&u.extensions[T.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+A(l.attributes):u.indices+":"+A(u.attributes)+":"+u.mode),u=e[l];u?i.push(u.promise):(u=s.extensions&&s.extensions[T.KHR_DRACO_MESH_COMPRESSION]?function(e){return n[T.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then(function(t){return M(t,e,r)})}(s):M(new X,s,r),e[l]={primitive:s,promise:u},i.push(u))}return Pu.all(i)},w.prototype.loadMesh=function(c){for(var h=this,d=this.json.meshes[c],p=d.primitives,t=[],e=0,r=p.length;e<r;e++){var n=void 0===p[e].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new mn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",p[e].material);t.push(n)}return t.push(h.loadGeometries(p)),Pu.all(t).then(function(t){var e=t.slice(0,t.length-1),r=t[t.length-1];t=[];for(var n=0,i=r.length;n<i;n++){var a=r[n],o=p[n],s=e[n];if(4===o.mode||5===o.mode||6===o.mode||void 0===o.mode)!0!==(a=new(!0===d.isSkinnedMesh?qe:V)(a,s)).isSkinnedMesh||a.geometry.attributes.skinWeight.normalized||a.normalizeSkinWeights(),5===o.mode?a.geometry=C(a.geometry,1):6===o.mode&&(a.geometry=C(a.geometry,2));else if(1===o.mode)a=new $e(a,s);else if(3===o.mode)a=new Qe(a,s);else if(2===o.mode)a=new tr(a,s);else{if(0!==o.mode)throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+o.mode);a=new rr(a,s)}if(0<Nu(a.geometry.morphAttributes).length){var l=d;if((o=a).updateMorphTargets(),void 0!==l.weights)for(var s=0,u=l.weights.length;s<u;s++)o.morphTargetInfluences[s]=l.weights[s];if(l.extras&&Array.isArray(l.extras.targetNames))if(l=l.extras.targetNames,o.morphTargetInfluences.length===l.length)for(o.morphTargetDictionary={},s=0,u=l.length;s<u;s++)o.morphTargetDictionary[l[s]]=s;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}a.name=d.name||"mesh_"+c,1<r.length&&(a.name+="_"+n),b(a,d),h.assignFinalMaterial(a),t.push(a)}if(1===t.length)return t[0];for(e=new Oe,n=0,i=t.length;n<i;n++)e.add(t[n]);return e})},w.prototype.loadCamera=function(t){var e,r=(t=this.json.cameras[t])[t.type];if(r)return"perspective"===t.type?e=new q(Qu.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===t.type&&(e=new vi(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),t.name&&(e.name=t.name),b(e,t),Pu.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},w.prototype.loadSkin=function(t){var e={joints:(t=this.json.skins[t]).joints};return void 0===t.inverseBindMatrices?Pu.resolve(e):this.getDependency("accessor",t.inverseBindMatrices).then(function(t){return e.inverseBindMatrices=t,e})},w.prototype.loadAnimation=function(x){for(var b=this.json.animations[x],t=[],e=[],r=[],n=[],i=[],a=0,o=b.channels.length;a<o;a++){var s=b.channels[a],l=b.samplers[s.sampler],s=s.target,u=void 0!==b.parameters?b.parameters[l.input]:l.input,c=void 0!==b.parameters?b.parameters[l.output]:l.output;t.push(this.getDependency("node",void 0!==s.node?s.node:s.id)),e.push(this.getDependency("accessor",u)),r.push(this.getDependency("accessor",c)),n.push(l),i.push(s)}return Pu.all([Pu.all(t),Pu.all(e),Pu.all(r),Pu.all(n),Pu.all(i)]).then(function(t){var e=t[0],r=t[1],n=t[2],i=t[3];t=t[4];for(var a=[],o=0,s=e.length;o<s;o++){var l=e[o],u=r[o],c=n[o],h=i[o],d=t[o];if(void 0!==l){switch(l.updateMatrix(),l.matrixAutoUpdate=!0,D[d.path]){case D.weights:var p=Ln;break;case D.rotation:p=Pn;break;default:p=On}var f=l.name||l.uuid,m=void 0!==h.interpolation?O[h.interpolation]:2301,g=[];if(D[d.path]===D.weights?l.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&g.push(t.name||t.uuid)}):g.push(f),l=c.array,c.normalized){if(l.constructor===Int8Array)var v=1/127;else if(l.constructor===Uint8Array)v=1/255;else if(l.constructor==Int16Array)v=1/32767;else{if(l.constructor!==Uint16Array)throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");v=1/65535}for(var y=new Float32Array(l.length),c=0,f=l.length;c<f;c++)y[c]=l[c]*v;l=y}for(c=0,f=g.length;c<f;c++)v=new p(g[c]+"."+D[d.path],u.array,l,m),"CUBICSPLINE"===h.interpolation&&(v.createInterpolant=function(t){return new _(this.times,this.values,this.getValueSize()/3,t)},v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),a.push(v)}}return new Fn(b.name||"animation_"+x,void 0,a)})},w.prototype.loadNode=function(i){var t=this.json,a=this.extensions,o=this,r=t.meshReferences,n=t.meshUses,s=t.nodes[i];return t=[],void 0!==s.mesh&&t.push(o.getDependency("mesh",s.mesh).then(function(t){var e;return 1<r[s.mesh]&&(e=n[s.mesh]++,(t=t.clone()).name+="_instance_"+e),void 0!==s.weights&&t.traverse(function(t){if(t.isMesh)for(var e=0,r=s.weights.length;e<r;e++)t.morphTargetInfluences[e]=s.weights[e]}),t})),void 0!==s.camera&&t.push(o.getDependency("camera",s.camera)),s.extensions&&s.extensions[T.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[T.KHR_LIGHTS_PUNCTUAL].light&&t.push(o.getDependency("light",s.extensions[T.KHR_LIGHTS_PUNCTUAL].light)),Pu.all(t).then(function(t){var e=!0===s.isBone?new Ze:1<t.length?new Oe:1===t.length?t[0]:new B;if(e!==t[0])for(var r=0,n=t.length;r<n;r++)e.add(t[r]);return s.name&&(e.userData.name=s.name,e.name=Vi.sanitizeNodeName(s.name)),b(e,s),s.extensions&&x(a,e,s),void 0!==s.matrix?((t=new Ct).fromArray(s.matrix),e.applyMatrix4(t)):(void 0!==s.translation&&e.position.fromArray(s.translation),void 0!==s.rotation&&e.quaternion.fromArray(s.rotation),void 0!==s.scale&&e.scale.fromArray(s.scale)),o.associations.set(e,{type:"nodes",index:i}),e})},w.prototype.loadScene=function(t){var e=this.json,r=this.extensions;t=this.json.scenes[t];var n=new Oe;t.name&&(n.name=t.name),b(n,t),t.extensions&&x(r,n,t),r=t.nodes||[],t=[];for(var i=0,a=r.length;i<a;i++)t.push(function a(t,o,s,l){var u=s.nodes[t];return l.getDependency("node",t).then(function(t){return void 0===u.skin?t:l.getDependency("skin",u.skin).then(function(t){s=t,t=[];for(var e=0,r=s.joints.length;e<r;e++)t.push(l.getDependency("node",s.joints[e]));return Pu.all(t)}).then(function(o){return t.traverse(function(t){if(t.isMesh){for(var e=[],r=[],n=0,i=o.length;n<i;n++){var a=o[n];a?(e.push(a),a=new Ct,void 0!==s.inverseBindMatrices&&a.fromArray(s.inverseBindMatrices.array,16*n),r.push(a)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[n])}t.bind(new Ye(e,r),t.matrixWorld)}}),t});var s}).then(function(t){o.add(t);var e=[];if(u.children)for(var r=u.children,n=0,i=r.length;n<i;n++)e.push(a(r[n],t,s,l));return Pu.all(e)})}(r[i],n,e,this));return Pu.all(t).then(function(){return n})},t}(),Rl.MTLLoader=Gp,Rl.OBJLoader=Vs,Rl.GLTFLoader=cs;var Vp=Rl=window.THREE||Rl,Wp=e(r(function(t,e){e.__esModule=!0;var i=Cu&&Cu.__esModule?Cu:{default:Cu};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(t,n.key,n)}}e.default=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}));ga(va.prototype,{equals:function(t){return this.lat===t.lat&&this.lng===t.lng},clone:function(){return new va(this.lat,this.lng)},getLngSpan:function(t){return t=180<(t=Math.abs(t-this.lng))?360-t:t},sub:function(t){return new va(this.lat-t.lat,this.lng-t.lng)},toString:function(){return"Point"}}),ga(ma,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,e){if(!t||!e)return 0;if(!(t=this.convertMC2LL(t)))return 0;var r=this.toRadians(t.lng);if(t=this.toRadians(t.lat),!(e=this.convertMC2LL(e)))return 0;var n=this.toRadians(e.lng);return e=this.toRadians(e.lat),this.getDistance(r,n,t,e)},getDistanceByLL:function(t,e){if(!t||!e)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74);var r=this.toRadians(t.lng),n=this.toRadians(t.lat);return t=this.toRadians(e.lng),e=this.toRadians(e.lat),this.getDistance(r,t,n,e)},convertMC2LL:function(t){if(null==t)return new va(0,0);if(t.lng<180&&-180<t.lng&&t.lat<90&&-90<t.lat)return t;for(var e=new va(Math.abs(t.lng),Math.abs(t.lat)),r=0;r<this.MCBAND.length;r++)if(e.lat>=this.MCBAND[r]){var n=this.MC2LL[r];break}return new va((t=this.convertor(t,n)).lng.toFixed(6),t.lat.toFixed(6))},convertLL2MC:function(t){if(null==t)return new va(0,0);if(180<t.lng||t.lng<-180||90<t.lat||t.lat<-90)return t;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);for(var e=new va(t.lng,t.lat),r=0;r<this.LLBAND.length;r++)if(e.lat>=this.LLBAND[r]){var n=this.LL2MC[r];break}if(!n)for(r=0;r<this.LLBAND.length;r++)if(e.lat<=-this.LLBAND[r]){n=this.LL2MC[r];break}return t=this.convertor(t,n),new va(Number(t.lng.toFixed(2)),Number(t.lat.toFixed(2)))},convertor:function(t,e){if(t&&e){var r=e[0]+e[1]*Math.abs(t.lng),n=Math.abs(t.lat)/e[9];return e=e[2]+e[3]*n+e[4]*n*n+e[5]*n*n*n+e[6]*n*n*n*n+e[7]*n*n*n*n*n+e[8]*n*n*n*n*n*n,new va(r*=t.lng<0?-1:1,e*=t.lat<0?-1:1)}},getDistance:function(t,e,r,n){return this.EARTHRADIUS*Math.acos(Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos(e-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,e,r){return null!=e&&(t=Math.max(t,e)),t=null!=r?Math.min(t,r):t},getLoop:function(t,e,r){for(;r<t;)t-=r-e;for(;t<e;)t+=r-e;return t}}),ga(ma.prototype,{lngLatToMercator:function(t){return ma.convertLL2MC(t)},lngLatToPoint:function(t){return new ya((t=ma.convertLL2MC(t)).lng,t.lat)},mercatorToLngLat:function(t){return ma.convertMC2LL(t)},pointToLngLat:function(t){return t=new va(t.x,t.y),ma.convertMC2LL(t)},pointToPixel:function(t,e,r,n,i){if(t)return t=this.lngLatToMercator(t,i),e=this.getZoomUnits(e),new ya(Math.round((t.lng-r.lng)/e+n.width/2),Math.round((r.lat-t.lat)/e+n.height/2))},pixelToPoint:function(t,e,r,n,i){if(t)return e=this.getZoomUnits(e),t=new va(r.lng+e*(t.x-n.width/2),r.lat-e*(t.y-n.height/2)),this.mercatorToLngLat(t,i)},getZoomUnits:function(t){return Math.pow(2,18-t)}});var jp=e(r(function(t,e){e.__esModule=!0;var n=Ko&&Ko.__esModule?Ko:{default:Ko};e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}}));!function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ju(this,e),this.options=t,this._initialize()}Wp(e,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(t){return t?(t instanceof Array&&(t={lng:Number(t[0]),lat:Number(t[1])}),ma.convertLL2MC(t)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(t){for(var e=[],r=this.points,n=0;n<r.length-1;n++){var i=this.getCurveByTwoPoints(this._normalizaCoord(r[n]),this._normalizaCoord(r[n+1]),t);i&&0<i.length&&(e=e.concat(i))}return e}},{key:"getCurveByTwoPoints",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:20;if(!t||!e)return null;var n=[],i=0;if(void 0!==(void 0===e?"undefined":Ou(e))){var a=parseFloat(t.lat),o=parseFloat(e.lat),s=parseFloat(t.lng),l=parseFloat(e.lng);s<l&&180<parseFloat(l-s)&&s<0&&(s=parseFloat(360+s),l=parseFloat(360+l));var u,c=0,h=o===a?(u=0,s-l):l===s?(u=Math.PI/2,a-o):(u=Math.atan((o-a)/(l-s)),(o-a)/Math.sin(u));for(0===c&&(c=u+Math.PI/5),u=(h/=2)*Math.cos(c)+s,c=h*Math.sin(c)+a,h=0;h<r+1;h++){var d=s*(1-2*i+i*i)+u*(2*i-2*i*i)+l*i*i,p=e.lng;n.push([t.lng<0&&0<p?d-360:d,a*(1-2*i+i*i)+c*(2*i-2*i*i)+o*i*i]),i+=1/r}return n}void 0===n||Ou(n)}}])}();var Xp=void 0,qp=function(){if(void 0!==Xp)return Xp;var t=navigator.userAgent,e="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Xp=!1;for(var r=0;r<e.length;r++)if(0<t.indexOf(e[r])){Xp=!0;break}return Xp}();xa(Array(576)),xa(Array(60)),xa(Array(512)),xa(Array(256)),xa(Array(29)),xa(Array(30)),new Uint32Array(function(){for(var t=[],e=0;e<256;e++){for(var r=e,n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;t[e]=r}return t}());try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){}for(var Yp=new Uint8Array(256),Zp=0;Zp<256;Zp++)Yp[Zp]=252<=Zp?6:248<=Zp?5:240<=Zp?4:224<=Zp?3:192<=Zp?2:1;Yp[254]=Yp[254]=1;var Jp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Kp=pl.f;function Qp(t,e){return tf.getOwnPropertyDescriptor(t,e)}function $p(t){for(var e={},r=Nu(af),n=r.length,i=0;i<n;i++)e[r[i]]={distance:-1,parent:null};for(r=[t],e[t].distance=0;r.length;){t=r.pop();for(var i=(n=Nu(af[t])).length,a=0;a<i;a++){var o=n[a],s=e[o];-1===s.distance&&(s.distance=e[t].distance+1,s.parent=t,r.unshift(o))}}for(r={},n=(t=Nu(e)).length,i=0;i<n;i++)if(null!==e[u=t[i]].parent){for(var a=u,s=[(o=e)[u].parent,u],l=af[o[u].parent][u],u=o[u].parent;o[u].parent;)s.unshift(o[u].parent),l=function(e,r){return function(t){return r(e(t))}}(af[o[u].parent][u],l),u=o[u].parent;l.conversion=s,r[a]=l}return r}gs("getOwnPropertyDescriptor",function(){return function(t,e){return Kp(Ka(t),e)}});var tf=Na.Object,ef=e(r(function(t){t.exports={default:Qp,__esModule:!0}})),rf=r(function(t){var o=Array.prototype.concat,s=Array.prototype.slice,e=t.exports=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],a=!(!(a=i)||"string"==typeof a)&&(a instanceof Array||Array.isArray(a)||0<=a.length&&(a.splice instanceof Function||ef(a,a.length-1)&&"String"!==a.constructor.name));a?e=o.call(e,s.call(i)):e.push(i)}return e};e.wrap=function(t){return function(){return t(e(arguments))}}}),nf=r(function(t){function a(t,e,r){return Math.min(Math.max(e,t),r)}function e(t){return(t=t.toString(16).toUpperCase()).length<2?"0"+t:t}var r,n={};for(r in Jp)Jp.hasOwnProperty(r)&&(n[Jp[r]]=r);var i=t.exports={to:{},get:{}};i.get=function(t){switch(t.substring(0,3).toLowerCase()){case"hsl":t=i.get.hsl(t);var e="hsl";break;case"hwb":t=i.get.hwb(t),e="hwb";break;default:t=i.get.rgb(t),e="rgb"}return t?{model:e,value:t}:null},i.get.rgb=function(t){if(!t)return null;var e,r=/^#([a-f0-9]{3,4})$/i,n=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,i=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],t=0;t<3;t++)n=2*t,i[t]=parseInt(e.slice(n,n+2),16);r&&(i[3]=Math.round(parseInt(r,16)/255*100)/100)}else if(e=t.match(r)){for(r=(e=e[1])[3],t=0;t<3;t++)i[t]=parseInt(e[t]+e[t],16);r&&(i[3]=Math.round(parseInt(r+r,16)/255*100)/100)}else if(e=t.match(n)){for(t=0;t<3;t++)i[t]=parseInt(e[t+1],0);e[4]&&(i[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(e=t.match(/(\D+)/))?"transparent"===e[1]?[0,0,0,0]:(i=Jp[e[1]])?(i[3]=1,i):null:null;for(t=0;t<3;t++)i[t]=Math.round(2.55*parseFloat(e[t+1]));e[4]&&(i[3]=parseFloat(e[4]))}for(t=0;t<3;t++)i[t]=a(i[t],0,255);return i[3]=a(i[3],0,1),i},i.get.hsl=function(t){if(!t)return null;if(e=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){var e,r=parseFloat(e[4]);return[t=(parseFloat(e[1])+360)%360,a(parseFloat(e[2]),0,100),e=a(parseFloat(e[3]),0,100),r=a(isNaN(r)?1:r,0,1)]}return null},i.get.hwb=function(t){if(!t)return null;if(e=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){var e,r=parseFloat(e[4]);return[t=(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),e=a(parseFloat(e[3]),0,100),r=a(isNaN(r)?1:r,0,1)]}return null},i.to.hex=function(){var t=rf(arguments);return"#"+e(t[0])+e(t[1])+e(t[2])+(t[3]<1?e(Math.round(255*t[3])):"")},i.to.rgb=function(){var t=rf(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},i.to.rgb.percent=function(){var t=rf(arguments),e=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+r+"%, "+n+"%)":"rgba("+e+"%, "+r+"%, "+n+"%, "+t[3]+")"},i.to.hsl=function(){var t=rf(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},i.to.hwb=function(){var t=rf(arguments),e="";return 4<=t.length&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},i.to.keyword=function(t){return n[t.slice(0,3)]}}),af=r(function(t){var a={};for(r in Jp)Jp.hasOwnProperty(r)&&(a[Jp[r]]=r);var e,o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(e in o)if(o.hasOwnProperty(e)){if(!("channels"in o[e]))throw Error("missing channels property: "+e);if(!("labels"in o[e]))throw Error("missing channel labels property: "+e);if(o[e].labels.length!==o[e].channels)throw Error("channel and label counts mismatch: "+e);t=o[e].channels;var r=o[e].labels;delete o[e].channels,delete o[e].labels,Object.defineProperty(o[e],"channels",{value:t}),Object.defineProperty(o[e],"labels",{value:r})}o.rgb.hsl=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255;t=Math.min(e,r,n);var i,a=Math.max(e,r,n),o=a-t;return a===t?i=0:e===a?i=(r-n)/o:r===a?i=2+(n-e)/o:n===a&&(i=4+(e-r)/o),(i=Math.min(60*i,360))<0&&(i+=360),e=(t+a)/2,[i,100*(a===t?0:e<=.5?o/(a+t):o/(2-a-t)),100*e]},o.rgb.hsv=function(t){var e,r,n,i=t[0]/255,a=t[1]/255,o=t[2]/255,s=Math.max(i,a,o),l=s-Math.min(i,a,o);return 0==l?r=e=0:(e=l/s,t=(s-i)/6/l+.5,n=(s-a)/6/l+.5,l=(s-o)/6/l+.5,i===s?r=l-n:a===s?r=1/3+t-l:o===s&&(r=2/3+n-t),r<0?r+=1:1<r&&--r),[360*r,100*e,100*s]},o.rgb.hwb=function(t){var e=t[0],r=t[1],n=t[2];return[t=o.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(r,n))),100*(n=1-1/255*Math.max(e,Math.max(r,n)))]},o.rgb.cmyk=function(t){var e=t[0]/255,r=t[1]/255;t=t[2]/255;var n=Math.min(1-e,1-r,1-t);return[100*((1-e-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-t-n)/(1-n)||0),100*n]},o.rgb.keyword=function(t){var e,r,n,i=a[t];if(i)return i;for(e in i=1/0,Jp)Jp.hasOwnProperty(e)&&(n=Jp[e],(n=Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2)+Math.pow(t[2]-n[2],2))<i&&(i=n,r=e));return r},o.keyword.rgb=function(t){return Jp[t]},o.rgb.xyz=function(t){var e=t[0]/255,r=t[1]/255;return t=t[2]/255,[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)),100*(.2126*e+.7152*r+.0722*t),100*(.0193*e+.1192*r+.9505*t)]},o.rgb.lab=function(t){t=(r=o.rgb.xyz(t))[0];var e=r[1],r=r[2];return e/=100,r/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116))]},o.hsl.rgb=function(t){var e=t[0]/360,r=t[1]/100;if(t=t[2]/100,0===r){var n=255*t;return[n,n,n]}t=2*t-(r=t<.5?t*(1+r):t+r-t*r);for(var i=[0,0,0],a=0;a<3;a++)(n=e+1/3*-(a-1))<0&&n++,1<n&&n--,n=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,i[a]=255*n;return i},o.hsl.hsv=function(t){var e=t[0],r=t[1]/100;t=t[2]/100;var n=r,i=Math.max(t,.01);return r*=(t*=2)<=1?t:2-t,n*=i<=1?i:2-i,[e,100*(0===t?2*n/(i+n):2*r/(t+r)),(t+r)/2*100]},o.hsv.rgb=function(t){var e=t[0]/60,r=t[1]/100;t=t[2]/100;var n=Math.floor(e)%6,i=e-Math.floor(e),e=255*t*(1-r),a=255*t*(1-r*i),r=255*t*(1-r*(1-i));switch(t*=255,n){case 0:return[t,r,e];case 1:return[a,t,e];case 2:return[e,t,r];case 3:return[e,a,t];case 4:return[r,e,t];case 5:return[t,e,a]}},o.hsv.hsl=function(t){var e=t[0],r=t[1]/100;t=t[2]/100;var n=Math.max(t,.01),i=(2-r)*n;return[e,100*(n=r*n/(i<=1?i:2-i)||0),(2-r)*t/2*100]},o.hwb.rgb=function(t){var e=t[0]/360,r=t[1]/100;switch(1<(n=r+(t=t[2]/100))&&(r/=n,t/=n),e=6*e-(n=Math.floor(6*e)),e=r+(e=0!=(1&n)?1-e:e)*((t=1-t)-r),n){default:case 6:case 0:var n=t,i=e;break;case 1:n=e,i=t;break;case 2:n=r,i=t,r=e;break;case 3:n=r,i=e,r=t;break;case 4:n=e,i=r,r=t;break;case 5:n=t,i=r,r=e}return[255*n,255*i,255*r]},o.cmyk.rgb=function(t){var e=t[3]/100;return[255*(1-Math.min(1,t[0]/100*(1-e)+e)),255*(1-Math.min(1,t[1]/100*(1-e)+e)),255*(1-Math.min(1,t[2]/100*(1-e)+e))]},o.xyz.rgb=function(t){var e=t[0]/100,r=t[1]/100,n=t[2]/100;t=3.2406*e+-1.5372*r+-.4986*n;var i=-.9689*e+1.8758*r+.0415*n,e=.0557*e+-.204*r+1.057*n;return t=.0031308<t?1.055*Math.pow(t,1/2.4)-.055:12.92*t,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,e=.0031308<e?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(t=Math.min(Math.max(0,t),1)),255*(i=Math.min(Math.max(0,i),1)),255*(e=Math.min(Math.max(0,e),1))]},o.xyz.lab=function(t){var e=t[0],r=t[1];return t=t[2],r/=100,t/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(e-r),200*(r-(t=.008856<t?Math.pow(t,1/3):7.787*t+16/116))]},o.lab.xyz=function(t){var e=t[1],r=t[2],e=e/500+(t=(t[0]+16)/116),r=t-r/200,n=Math.pow(t,3),i=Math.pow(e,3),a=Math.pow(r,3);return[95.047*(.008856<i?i:(e-16/116)/7.787),100*(.008856<n?n:(t-16/116)/7.787),108.883*(.008856<a?a:(r-16/116)/7.787)]},o.lab.lch=function(t){var e=t[0],r=t[1];t=t[2];var n=360*Math.atan2(t,r)/2/Math.PI;return n<0&&(n+=360),[e,Math.sqrt(r*r+t*t),n]},o.lch.lab=function(t){var e=t[0],r=t[1];return t=t[2]/360*2*Math.PI,[e,r*Math.cos(t),r*Math.sin(t)]},o.rgb.ansi16=function(t){var e=t[0],r=t[1],n=t[2],i=1 in arguments?arguments[1]:o.rgb.hsv(t)[2];return 0===(i=Math.round(i/50))?30:(e=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(e/255)),2===i&&(e+=60),e)},o.hsv.ansi16=function(t){return o.rgb.ansi16(o.hsv.rgb(t),t[2])},o.rgb.ansi256=function(t){var e=t[0],r=t[1];return t=t[2],e===r&&r===t?e<8?16:248<e?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(t/255*5)},o.ansi16.rgb=function(t){var e=t%10;return 0===e||7===e?(50<t&&(e+=3.5),[e=e/10.5*255,e,e]):[(1&e)*(t=.5*(1+~~(50<t)))*255,(e>>1&1)*t*255,(e>>2&1)*t*255]},o.ansi256.rgb=function(t){if(232<=t){var e=10*(t-232)+8;return[e,e,e]}return t-=16,[e=Math.floor(t/36)/5*255,Math.floor((t%=36)/6)/5*255,t%6/5*255]},o.rgb.hex=function(t){return t=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase(),"000000".substring(t.length)+t},o.hex.rgb=function(t){if(!(t=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i)))return[0,0,0];var e=t[0];return 3===t[0].length&&(e=e.split("").map(function(t){return t+t}).join("")),[(t=parseInt(e,16))>>16&255,t>>8&255,255&t]},o.rgb.hcg=function(t){var e=t[0]/255,r=t[1]/255;t=t[2]/255;var n=Math.max(Math.max(e,r),t),i=Math.min(Math.min(e,r),t),a=n-i;return[(a<=0?0:n===e?(r-t)/a%6:n===r?2+(t-e)/a:(e-r)/a+8)/6%1*360,100*a,100*(a<1?i/(1-a):0)]},o.hsl.hcg=function(t){var e=t[1]/100,r=t[2]/100,n=0;return(e=r<.5?2*e*r:2*e*(1-r))<1&&(n=(r-.5*e)/(1-e)),[t[0],100*e,100*n]},o.hsv.hcg=function(t){var e=t[2]/100,r=t[1]/100*e,e=r<1?(e-r)/(1-r):0;return[t[0],100*r,100*e]},o.hcg.rgb=function(t){var e=t[1]/100,r=t[2]/100;if(0==e)return[255*r,255*r,255*r];var n=[0,0,0],i=(t=t[0]/360%1*6)%1,a=1-i;switch(Math.floor(t)){case 0:n[0]=1,n[1]=i,n[2]=0;break;case 1:n[0]=a,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=i;break;case 3:n[0]=0,n[1]=a,n[2]=1;break;case 4:n[0]=i,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=a}return r*=1-e,[255*(e*n[0]+r),255*(e*n[1]+r),255*(e*n[2]+r)]},o.hcg.hsv=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e),e=0<r?e/r:0;return[t[0],100*e,100*r]},o.hcg.hsl=function(t){var e=t[1]/100,r=t[2]/100*(1-e)+.5*e,n=0;return 0<r&&r<.5?n=e/(2*r):.5<=r&&r<1&&(n=e/(2*(1-r))),[t[0],100*n,100*r]},o.hcg.hwb=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},o.hwb.hcg=function(t){var e=1-t[2]/100,r=e-t[1]/100,e=r<1?(e-r)/(1-r):0;return[t[0],100*r,100*e]},o.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},o.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},o.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},o.gray.hsl=o.gray.hsv=function(t){return[0,0,t[0]]},o.gray.hwb=function(t){return[0,100,t[0]]},o.gray.cmyk=function(t){return[0,0,0,t[0]]},o.gray.lab=function(t){return[t[0],0,0]},o.gray.hex=function(t){return t=(((t=255&Math.round(t[0]/100*255))<<16)+(t<<8)+t).toString(16).toUpperCase(),"000000".substring(t.length)+t},o.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}),of={};Nu(af).forEach(function(r){of[r]={},Object.defineProperty(of[r],"channels",{value:af[r].channels}),Object.defineProperty(of[r],"labels",{value:af[r].labels});var n=$p(r);Nu(n).forEach(function(t){var e=n[t];of[r][t]=_a(e),of[r][t].raw=ba(e)})});var sf=of,lf=[].slice,uf=["keyword","gray","hex"],cf={};Nu(sf).forEach(function(t){cf[lf.call(sf[t].labels).sort().join("")]=t});var hf={};Aa.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in nf.to?this:this.rgb();return t=1===(e=e.round("number"==typeof t?t:1)).valpha?e.color:e.color.concat(this.valpha),nf.to[e.model](t)},percentString:function(t){return t=1===(t=this.rgb().round("number"==typeof t?t:1)).valpha?t.color:t.color.concat(this.valpha),nf.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=sf[this.model].channels,r=sf[this.model].labels,n=0;n<e;n++)t[r[n]]=this.color[n];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new Aa(this.color.map((e=t,function(t){return Number(t.toFixed(e))})).concat(this.valpha),this.model);var e},alpha:function(t){return arguments.length?new Aa(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:wa("rgb",0,Ma(255)),green:wa("rgb",1,Ma(255)),blue:wa("rgb",2,Ma(255)),hue:wa(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:wa("hsl",1,Ma(100)),lightness:wa("hsl",2,Ma(100)),saturationv:wa("hsv",1,Ma(100)),value:wa("hsv",2,Ma(100)),chroma:wa("hcg",1,Ma(100)),gray:wa("hcg",2,Ma(100)),white:wa("hwb",1,Ma(100)),wblack:wa("hwb",2,Ma(100)),cyan:wa("cmyk",0,Ma(100)),magenta:wa("cmyk",1,Ma(100)),yellow:wa("cmyk",2,Ma(100)),black:wa("cmyk",3,Ma(100)),x:wa("xyz",0,Ma(100)),y:wa("xyz",1,Ma(100)),z:wa("xyz",2,Ma(100)),l:wa("lab",0,Ma(100)),a:wa("lab",1),b:wa("lab",2),keyword:function(t){return arguments.length?new Aa(t):sf[this.model].keyword(this.color)},hex:function(t){return arguments.length?new Aa(t):nf.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,e=[],r=0;r<t.length;r++){var n=t[r]/255;e[r]=n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity();return(t=t.luminosity())<e?(e+.05)/(t+.05):(t+.05)/(e+.05)},level:function(t){return 7.1<=(t=this.contrast(t))?"AAA":4.5<=t?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=.3*(t=this.rgb().color)[0]+.59*t[1]+.11*t[2];return Aa.rgb(t,t,t)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),r=((r=e.color[0])+t)%360;return e.color[0]=r<0?360+r:r,e},mix:function(t,e){if(!t||!t.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(void 0===t?"undefined":Ou(t)));t=t.rgb();var r=this.rgb(),n=2*(e=void 0===e?.5:e)-1,i=1-(n=((-1==n*(i=t.alpha()-r.alpha())?n:(n+i)/(1+n*i))+1)/2);return Aa.rgb(n*t.red()+i*r.red(),n*t.green()+i*r.green(),n*t.blue()+i*r.blue(),t.alpha()*e+r.alpha()*(1-e))}},Nu(sf).forEach(function(r){var n;-1===uf.indexOf(r)&&(n=sf[r].channels,Aa.prototype[r]=function(){if(this.model===r)return new Aa(this);if(arguments.length)return new Aa(arguments,r);var t="number"==typeof arguments[n]?n:this.valpha,e=sf[this.model][r].raw(this.color);return new Aa((e=Array.isArray(e)?e:[e]).concat(t),r)},Aa[r]=function(t){return new Aa(t="number"==typeof t?Ca(lf.call(arguments),n):t,r)})});var df=r(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=n=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))},e.RANDOM=e.ARRAY_TYPE=e.EPSILON=void 0;var r=1e-6;e.EPSILON=r;var n="undefined"!=typeof Float32Array?Float32Array:Array;e.ARRAY_TYPE=n,e.RANDOM=Math.random;var i=Math.PI/180});e(df);var pf=r(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2];return r=r[3],t[0]=n*o+a*s,t[1]=i*o+e*s,t[2]=n*l+a*r,t[3]=i*l+e*r,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new l.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,r,n){var i=new l.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},e.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},e.transpose=function(t,e){var r;return t===e?(r=e[1],t[1]=e[2],t[2]=r):(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*(e=e[3])-i*n;return a?(a=1/a,t[0]=e*a,t[1]=-n*a,t[2]=-i*a,t[3]=r*a,t):null},e.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+a*o,t[1]=i*r+e*o,t[2]=n*-o+a*r,t[3]=i*-o+e*r,t},e.scale=function(t,e,r){var n=e[1],i=e[2],a=e[3],o=r[0];return r=r[1],t[0]=e[0]*o,t[1]=n*o,t[2]=i*r,t[3]=a*r,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2];t=t[3];var a=e[0],o=e[1],s=e[2];return e=e[3],Math.abs(r-a)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(t-e)<=l.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.sub=e.mul=void 0;var l=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.mul=r,e.sub=n});e(pf);var ff=r(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=r[0],u=r[1],c=r[2],h=r[3],d=r[4];return r=r[5],t[0]=n*l+a*u,t[1]=i*l+o*u,t[2]=n*c+a*h,t[3]=i*c+o*h,t[4]=n*d+a*r+s,t[5]=i*d+o*r+e,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new d.ARRAY_TYPE(6);return d.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new d.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,r,n,i,a){var o=new d.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o},e.set=function(t,e,r,n,i,a,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4];e=e[5];var s=r*a-n*i;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*e-a*o)*s,t[5]=(n*o-r*e)*s,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=Math.sin(r);return r=Math.cos(r),t[0]=n*r+a*l,t[1]=i*r+o*l,t[2]=n*-l+a*r,t[3]=i*-l+o*r,t[4]=s,t[5]=e,t},e.scale=function(t,e,r){var n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=r[0];return r=r[1],t[0]=e[0]*l,t[1]=n*l,t[2]=i*r,t[3]=a*r,t[4]=o,t[5]=s,t},e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];e=e[5];var l=r[0];return r=r[1],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=n*l+a*r+s,t[5]=i*l+o*r+e,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4];t=t[5];var s=e[0],l=e[1],u=e[2],c=e[3],h=e[4];return e=e[5],Math.abs(r-s)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=d.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(t-e)<=d.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var d=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.mul=r,e.sub=n});e(ff);var mf=r(function(t,e){function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=r[0],d=r[1],p=r[2],f=r[3],m=r[4],g=r[5],v=r[6],y=r[7];return r=r[8],t[0]=h*n+d*o+p*u,t[1]=h*i+d*s+p*c,t[2]=h*a+d*l+p*e,t[3]=f*n+m*o+g*u,t[4]=f*i+m*s+g*c,t[5]=f*a+m*l+g*e,t[6]=v*n+y*o+r*u,t[7]=v*i+y*s+r*c,t[8]=v*a+y*l+r*e,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new y.ARRAY_TYPE(9);return y.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new y.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,n,i,a,o,s,l){var u=new y.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u},e.set=function(t,e,r,n,i,a,o,s,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){var r,n,i;return t===e?(r=e[1],n=e[2],i=e[5],t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=(e=e[8])*o-s*u,h=-e*a+s*l,d=u*a-o*l,p=r*c+n*h+i*d;return p?(p=1/p,t[0]=c*p,t[1]=(-e*n+i*u)*p,t[2]=(s*n-i*o)*p,t[3]=h*p,t[4]=(e*r-i*l)*p,t[5]=(-s*r+i*a)*p,t[6]=d*p,t[7]=(-u*r+n*l)*p,t[8]=(o*r-n*a)*p,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7];return e=e[8],t[0]=o*e-s*u,t[1]=i*u-n*e,t[2]=n*s-i*o,t[3]=s*l-a*e,t[4]=r*e-i*l,t[5]=i*a-r*s,t[6]=a*u-o*l,t[7]=n*l-r*u,t[8]=r*o-n*a,t},e.determinant=function(t){var e=t[3],r=t[4],n=t[5],i=t[6],a=t[7],o=t[8];return t[0]*(o*r-n*a)+t[1]*(-o*e+n*i)+t[2]*(a*e-r*i)},e.multiply=r,e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=r[0];return r=r[1],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=h*n+r*o+u,t[7]=h*i+r*s+c,t[8]=h*a+r*l+e,t},e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7];e=e[8];var h=Math.sin(r);return r=Math.cos(r),t[0]=r*n+h*o,t[1]=r*i+h*s,t[2]=r*a+h*l,t[3]=r*o-h*n,t[4]=r*s-h*i,t[5]=r*l-h*a,t[6]=u,t[7]=c,t[8]=e,t},e.scale=function(t,e,r){var n=r[0];return r=r[1],t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=r+r,o=n+n,s=i+i;r*=a;var l=n*a;n*=o;var u=i*a,c=i*o;return i*=s,a*=e=e[3],o*=e,e*=s,t[0]=1-n-i,t[3]=l-e,t[6]=u+o,t[1]=l+e,t[4]=1-r-i,t[7]=c-a,t[2]=u-o,t[5]=c+a,t[8]=1-r-n,t},e.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=r*s-n*o,y=r*l-i*o,x=r*u-a*o,b=n*l-i*s,_=n*u-a*s,A=i*u-a*l,w=c*m-h*f,M=c*g-d*f,C=h*g-d*m;return(p=v*(d=d*(e=e[15])-p*g)-y*(h=h*e-p*m)+x*C+b*(c=c*e-p*f)-_*M+A*w)?(p=1/p,t[0]=(s*d-l*h+u*C)*p,t[1]=(l*c-o*d-u*M)*p,t[2]=(o*h-s*c+u*w)*p,t[3]=(i*h-n*d-a*C)*p,t[4]=(r*d-i*c+a*M)*p,t[5]=(n*c-r*h-a*w)*p,t[6]=(m*A-g*_+e*b)*p,t[7]=(g*x-f*A-e*y)*p,t[8]=(f*_-m*x+e*v)*p,t):null},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7];t=t[8];var c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],m=e[5],g=e[6],v=e[7];return e=e[8],Math.abs(r-c)<=y.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=y.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=y.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-p)<=y.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=y.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=y.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-g)<=y.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=y.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(t-e)<=y.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var y=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.mul=r,e.sub=n});e(mf);var gf=r(function(t,e){function f(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14];e=e[15];var y=r[0],x=r[1],b=r[2],_=r[3];return t[0]=y*n+x*s+b*h+_*m,t[1]=y*i+x*l+b*d+_*g,t[2]=y*a+x*u+b*p+_*v,t[3]=y*o+x*c+b*f+_*e,y=r[4],x=r[5],b=r[6],_=r[7],t[4]=y*n+x*s+b*h+_*m,t[5]=y*i+x*l+b*d+_*g,t[6]=y*a+x*u+b*p+_*v,t[7]=y*o+x*c+b*f+_*e,y=r[8],x=r[9],b=r[10],_=r[11],t[8]=y*n+x*s+b*h+_*m,t[9]=y*i+x*l+b*d+_*g,t[10]=y*a+x*u+b*p+_*v,t[11]=y*o+x*c+b*f+_*e,y=r[12],x=r[13],b=r[14],_=r[15],t[12]=y*n+x*s+b*h+_*m,t[13]=y*i+x*l+b*d+_*g,t[14]=y*a+x*u+b*p+_*v,t[15]=y*o+x*c+b*f+_*e,t}function d(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,l=i+i,u=a+a;e=n*s;var c=n*l;n*=u;var h=i*l;return i*=u,a*=u,s*=o,l*=o,o*=u,t[0]=1-(h+a),t[1]=c+o,t[2]=n-l,t[3]=0,t[4]=c-o,t[5]=1-(e+a),t[6]=i+s,t[7]=0,t[8]=n+l,t[9]=i-s,t[10]=1-(e+h),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new P.ARRAY_TYPE(16);return P.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},e.clone=function(t){var e=new P.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m){var g=new P.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=n,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=l,g[9]=u,g[10]=c,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,g},e.set=function(t,e,r,n,i,a,o,s,l,u,c,h,d,p,f,m,g){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=m,t[15]=g,t},e.identity=f,e.transpose=function(t,e){var r,n,i,a,o,s;return t===e?(r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s):(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=r*s-n*o,y=r*l-i*o,x=r*u-a*o,b=n*l-i*s,_=n*u-a*s,A=i*u-a*l,w=c*m-h*f,M=c*g-d*f,C=c*(e=e[15])-p*f,T=h*g-d*m,S=h*e-p*m,E=d*e-p*g,I=v*E-y*S+x*T+b*C-_*M+A*w;return I?(I=1/I,t[0]=(s*E-l*S+u*T)*I,t[1]=(i*S-n*E-a*T)*I,t[2]=(m*A-g*_+e*b)*I,t[3]=(d*_-h*A-p*b)*I,t[4]=(l*C-o*E-u*M)*I,t[5]=(r*E-i*C+a*M)*I,t[6]=(g*x-f*A-e*y)*I,t[7]=(c*A-d*x+p*y)*I,t[8]=(o*S-s*C+u*w)*I,t[9]=(n*C-r*S-a*w)*I,t[10]=(f*_-m*x+e*v)*I,t[11]=(h*x-c*_-p*v)*I,t[12]=(s*M-o*T-l*w)*I,t[13]=(r*T-n*M+i*w)*I,t[14]=(m*y-f*b-g*v)*I,t[15]=(c*b-h*y+d*v)*I,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14];return e=e[15],t[0]=s*(d*e-p*g)-h*(l*e-u*g)+m*(l*p-u*d),t[1]=-(n*(d*e-p*g)-h*(i*e-a*g)+m*(i*p-a*d)),t[2]=n*(l*e-u*g)-s*(i*e-a*g)+m*(i*u-a*l),t[3]=-(n*(l*p-u*d)-s*(i*p-a*d)+h*(i*u-a*l)),t[4]=-(o*(d*e-p*g)-c*(l*e-u*g)+f*(l*p-u*d)),t[5]=r*(d*e-p*g)-c*(i*e-a*g)+f*(i*p-a*d),t[6]=-(r*(l*e-u*g)-o*(i*e-a*g)+f*(i*u-a*l)),t[7]=r*(l*p-u*d)-o*(i*p-a*d)+c*(i*u-a*l),t[8]=o*(h*e-p*m)-c*(s*e-u*m)+f*(s*p-u*h),t[9]=-(r*(h*e-p*m)-c*(n*e-a*m)+f*(n*p-a*h)),t[10]=r*(s*e-u*m)-o*(n*e-a*m)+f*(n*u-a*s),t[11]=-(r*(s*p-u*h)-o*(n*p-a*h)+c*(n*u-a*s)),t[12]=-(o*(h*g-d*m)-c*(s*g-l*m)+f*(s*d-l*h)),t[13]=r*(h*g-d*m)-c*(n*g-i*m)+f*(n*d-i*h),t[14]=-(r*(s*g-l*m)-o*(n*g-i*m)+f*(n*l-i*s)),t[15]=r*(s*d-l*h)-o*(n*d-i*h)+c*(n*l-i*s),t},e.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14];return(e*o-r*a)*(h*(t=t[15])-d*m)-(e*s-n*a)*(c*t-d*f)+(e*l-i*a)*(c*m-h*f)+(r*s-n*o)*(u*t-d*p)-(r*l-i*o)*(u*m-h*p)+(n*l-i*s)*(u*f-c*p)},e.multiply=r,e.translate=function(t,e,r){var n,i,a,o,s,l,u,c,h,d,p,f,m=r[0],g=r[1];return r=r[2],e===t?(t[12]=e[0]*m+e[4]*g+e[8]*r+e[12],t[13]=e[1]*m+e[5]*g+e[9]*r+e[13],t[14]=e[2]*m+e[6]*g+e[10]*r+e[14],t[15]=e[3]*m+e[7]*g+e[11]*r+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*m+s*g+h*r+e[12],t[13]=i*m+l*g+d*r+e[13],t[14]=a*m+u*g+p*r+e[14],t[15]=o*m+c*g+f*r+e[15]),t},e.scale=function(t,e,r){var n=r[0],i=r[1];return r=r[2],t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,r,n){var i=n[0],a=n[1];if(n=n[2],(u=Math.sqrt(i*i+a*a+n*n))<P.EPSILON)return null;i*=u=1/u,a*=u,n*=u;var o=Math.sin(r),s=Math.cos(r),l=1-s;r=e[0];var u=e[1],c=e[2],h=e[3],d=e[4],p=e[5],f=e[6],m=e[7],g=e[8],v=e[9],y=e[10],x=e[11],b=i*i*l+s,_=a*i*l+n*o,A=n*i*l-a*o,w=i*a*l-n*o,M=a*a*l+s,C=n*a*l+i*o,T=i*n*l+a*o,i=a*n*l-i*o,a=n*n*l+s;return t[0]=r*b+d*_+g*A,t[1]=u*b+p*_+v*A,t[2]=c*b+f*_+y*A,t[3]=h*b+m*_+x*A,t[4]=r*w+d*M+g*C,t[5]=u*w+p*M+v*C,t[6]=c*w+f*M+y*C,t[7]=h*w+m*M+x*C,t[8]=r*T+d*i+g*a,t[9]=u*T+p*i+v*a,t[10]=c*T+f*i+y*a,t[11]=h*T+m*i+x*a,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},e.rotateX=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[4],a=e[5],o=e[6],s=e[7],l=e[8],u=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*r+l*n,t[5]=a*r+u*n,t[6]=o*r+c*n,t[7]=s*r+h*n,t[8]=l*r-i*n,t[9]=u*r-a*n,t[10]=c*r-o*n,t[11]=h*r-s*n,t},e.rotateY=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[0],a=e[1],o=e[2],s=e[3],l=e[8],u=e[9],c=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r-l*n,t[1]=a*r-u*n,t[2]=o*r-c*n,t[3]=s*r-h*n,t[8]=i*n+l*r,t[9]=a*n+u*r,t[10]=o*n+c*r,t[11]=s*n+h*r,t},e.rotateZ=function(t,e,r){var n=Math.sin(r);r=Math.cos(r);var i=e[0],a=e[1],o=e[2],s=e[3],l=e[4],u=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r+l*n,t[1]=a*r+u*n,t[2]=o*r+c*n,t[3]=s*r+h*n,t[4]=l*r-i*n,t[5]=u*r-a*n,t[6]=c*r-o*n,t[7]=h*r-s*n,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,r){var n=r[0],i=r[1];if(r=r[2],(a=Math.sqrt(n*n+i*i+r*r))<P.EPSILON)return null;n*=a=1/a,i*=a,r*=a;var a=Math.sin(e),o=1-(e=Math.cos(e));return t[0]=n*n*o+e,t[1]=i*n*o+r*a,t[2]=r*n*o-i*a,t[3]=0,t[4]=n*i*o-r*a,t[5]=i*i*o+e,t[6]=r*i*o+n*a,t[7]=0,t[8]=n*r*o+i*a,t[9]=i*r*o-n*a,t[10]=r*r*o+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var r=Math.sin(e);return e=Math.cos(e),t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=d,e.fromQuat2=function(t,e){var r=new P.ARRAY_TYPE(3),n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=n*n+i*i+a*a+o*o;return 0<h?(r[0]=2*(s*o+c*n+l*a-u*i)/h,r[1]=2*(l*o+c*i+u*n-s*a)/h,r[2]=2*(u*o+c*a+s*i-l*n)/h):(r[0]=2*(s*o+c*n+l*a-u*i),r[1]=2*(l*o+c*i+u*n-s*a),r[2]=2*(u*o+c*a+s*i-l*n)),d(t,e,r),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9];return e=e[10],t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+o*o+s*s),t[2]=Math.sqrt(l*l+u*u+e*e),t},e.getRotation=function(t,e){var r=e[0]+e[5]+e[10];return 0<r?(r=2*Math.sqrt(r+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,u=a+a;e=i*l;var c=i*u;i*=d=o+o;var h=a*u;a*=d,o*=d,l*=s,u*=s,s*=d;var d=n[0],p=n[1];return n=n[2],t[0]=(1-(h+o))*d,t[1]=(c+s)*d,t[2]=(i-u)*d,t[3]=0,t[4]=(c-s)*p,t[5]=(1-(e+o))*p,t[6]=(a+l)*p,t[7]=0,t[8]=(i+u)*n,t[9]=(a-l)*n,t[10]=(1-(e+h))*n,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],l=e[3],u=o+o;e=a*(v=a+a);var c=a*u,h=a*(g=s+s),a=o*u;o*=g;var d=s*g,s=l*v;u*=l;var p=l*g,f=n[0],m=n[1],g=n[2];n=i[0],l=i[1],i=i[2];var v=(1-(a+d))*f,y=(c+p)*f;return f*=h-u,c=(c-p)*m,d=(1-(e+d))*m,m*=o+s,h=(h+u)*g,o=(o-s)*g,e=(1-(e+a))*g,t[0]=v,t[1]=y,t[2]=f,t[3]=0,t[4]=c,t[5]=d,t[6]=m,t[7]=0,t[8]=h,t[9]=o,t[10]=e,t[11]=0,t[12]=r[0]+n-(v*n+c*l+h*i),t[13]=r[1]+l-(y*n+d*l+o*i),t[14]=r[2]+i-(f*n+m*l+e*i),t[15]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=r+r,o=n+n,s=i+i;r*=a;var l=n*a;n*=o;var u=i*a,c=i*o;return i*=s,a*=e=e[3],o*=e,e*=s,t[0]=1-n-i,t[1]=l+e,t[2]=u-o,t[3]=0,t[4]=l-e,t[5]=1-r-i,t[6]=c+a,t[7]=0,t[8]=u+o,t[9]=c-a,t[10]=1-r-n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,r,n,i,a,o){var s=1/(r-e),l=1/(i-n),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t},e.perspective=function(t,e,r,n,i){return e=1/Math.tan(e/2),t[0]=e/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&1/0!==i?(r=1/(n-i),t[10]=(i+n)*r,t[14]=2*i*n*r):(t[10]=-1,t[14]=-2*n),t},e.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=2/(o+(e=Math.tan(e.rightDegrees*Math.PI/180))),l=2/(i+a);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(o-e)*s*.5,t[9]=(i-a)*l*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},e.ortho=function(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(o+a)*u,t[15]=1,t},e.lookAt=function(t,e,r,n){var i=e[0],a=e[1];e=e[2];var o=n[0],s=n[1],l=n[2],u=r[0];n=r[1];var c=r[2];if(Math.abs(i-u)<P.EPSILON&&Math.abs(a-n)<P.EPSILON&&Math.abs(e-c)<P.EPSILON)return f(t);r=i-u,n=a-n;var u=e-c,h=1/Math.sqrt(r*r+n*n+u*u),c=s*(u*=h)-l*(n*=h),l=l*(r*=h)-o*u,o=o*n-s*r;(h=Math.sqrt(c*c+l*l+o*o))?(c*=h=1/h,l*=h,o*=h):o=l=c=0;var s=n*o-u*l,d=u*c-r*o,p=r*l-n*c;return(h=Math.sqrt(s*s+d*d+p*p))?(s*=h=1/h,d*=h,p*=h):p=d=s=0,t[0]=c,t[1]=s,t[2]=r,t[3]=0,t[4]=l,t[5]=d,t[6]=n,t[7]=0,t[8]=o,t[9]=p,t[10]=u,t[11]=0,t[12]=-(c*i+l*a+o*e),t[13]=-(s*i+d*a+p*e),t[14]=-(r*i+n*a+u*e),t[15]=1,t},e.targetTo=function(t,e,r,n){var i=e[0],a=e[1];e=e[2];var o=n[0],s=n[1],l=n[2];n=i-r[0];var u=a-r[1],c=n*n+u*u+(r=e-r[2])*r;0<c&&(n*=c=1/Math.sqrt(c),u*=c,r*=c);var h=s*r-l*u;return 0<(c=h*h+(l=l*n-o*r)*l+(o=o*u-s*n)*o)&&(h*=c=1/Math.sqrt(c),l*=c,o*=c),t[0]=h,t[1]=l,t[2]=o,t[3]=0,t[4]=u*o-r*l,t[5]=r*h-n*o,t[6]=n*l-u*h,t[7]=0,t[8]=n,t[9]=u,t[10]=r,t[11]=0,t[12]=i,t[13]=a,t[14]=e,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14];t=t[15];var v=e[0],y=e[1],x=e[2],b=e[3],_=e[4],A=e[5],w=e[6],M=e[7],C=e[8],T=e[9],S=e[10],E=e[11],I=e[12],L=e[13],R=e[14];return e=e[15],Math.abs(r-v)<=P.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-y)<=P.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-x)<=P.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-b)<=P.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-_)<=P.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-A)<=P.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-w)<=P.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-M)<=P.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-C)<=P.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-T)<=P.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-S)<=P.EPSILON*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-E)<=P.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(f-I)<=P.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-L)<=P.EPSILON*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(g-R)<=P.EPSILON*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(t-e)<=P.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sub=e.mul=void 0;var P=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.mul=r,e.sub=n});e(gf);var vf=r(function(t,e){function r(){var t=new f.ARRAY_TYPE(3);return f.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function n(t){var e=t[0],r=t[1];return t=t[2],Math.sqrt(e*e+r*r+t*t)}function i(t,e,r){var n=new f.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function s(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1];return t=e[2]-t[2],Math.sqrt(r*r+n*n+t*t)}function u(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n+(t=e[2]-t[2])*t}function c(t){var e=t[0],r=t[1];return e*e+r*r+(t=t[2])*t}function h(t,e){var r=e[0],n=e[1],i=e[2];return 0<(r=r*r+n*n+i*i)&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new f.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=n,e.fromValues=i,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=a,e.multiply=o,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},e.distance=l,e.squaredDistance=u,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=h,e.dot=d,e.cross=function(t,e,r){var n=e[0],i=e[1];e=e[2];var a=r[0],o=r[1];return r=r[2],t[0]=i*r-e*o,t[1]=e*a-n*r,t[2]=n*o-i*a,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1];return e=e[2],t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=e+n*(r[2]-e),t},e.hermite=function(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1);return a=o*(3-2*a),t[0]=e[0]*s+r[0]*l+n[0]*u+i[0]*a,t[1]=e[1]*s+r[1]*l+n[1]*u+i[1]*a,t[2]=e[2]*s+r[2]*l+n[2]*u+i[2]*a,t},e.bezier=function(t,e,r,n,i,a){var o=1-a,s=o*o,l=a*a,u=s*o;return s*=3*a,o*=3*l,a*=l,t[0]=e[0]*u+r[0]*s+n[0]*o+i[0]*a,t[1]=e[1]*u+r[1]*s+n[1]*o+i[1]*a,t[2]=e[2]*u+r[2]*s+n[2]*o+i[2]*a,t},e.random=function(t,e){e=e||1;var r=2*f.RANDOM()*Math.PI,n=2*f.RANDOM()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1];e=e[2];var a=(a=r[3]*n+r[7]*i+r[11]*e+r[15])||1;return t[0]=(r[0]*n+r[4]*i+r[8]*e+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*e+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*e+r[14])/a,t},e.transformMat3=function(t,e,r){var n=e[0],i=e[1];return e=e[2],t[0]=n*r[0]+i*r[3]+e*r[6],t[1]=n*r[1]+i*r[4]+e*r[7],t[2]=n*r[2]+i*r[5]+e*r[8],t},e.transformQuat=function(t,e,r){var n=r[0],i=r[1],a=r[2],o=e[0],s=e[1],l=i*(e=e[2])-a*s,u=a*o-n*e,c=n*s-i*o;return r=2*r[3],t[0]=o+l*r+2*(i*c-a*u),t[1]=s+u*r+2*(a*l-n*c),t[2]=e+c*r+2*(n*u-i*l),t},e.rotateX=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateY=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateZ=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.angle=function(t,e){return t=i(t[0],t[1],t[2]),e=i(e[0],e[1],e[2]),h(t,t),h(e,e),1<(e=d(t,e))?0:e<-1?Math.PI:Math.acos(e)},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var r=t[0],n=t[1];t=t[2];var i=e[0],a=e[1];return e=e[2],Math.abs(r-i)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(t-e)<=f.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var p,f=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.sub=a,e.mul=o,e.div=s,e.dist=l,e.sqrDist=u,e.len=n,e.sqrLen=c,p=r(),t=function(t,e,r,n,i,a){for(e=e||3,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)p[0]=t[r],p[1]=t[r+1],p[2]=t[r+2],i(p,p,a),t[r]=p[0],t[r+1]=p[1],t[r+2]=p[2];return t},e.forEach=t});e(vf);var yf=r(function(t,e){function r(){var t=new h.ARRAY_TYPE(4);return h.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function a(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function o(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return t=e[3]-t[3],Math.sqrt(r*r+n*n+i*i+t*t)}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i+(t=e[3]-t[3])*t}function l(t){var e=t[0],r=t[1],n=t[2];return t=t[3],Math.sqrt(e*e+r*r+n*n+t*t)}function u(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n+(t=t[3])*t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new h.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,n){var i=new h.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.multiply=i,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.distance=o,e.squaredDistance=s,e.length=l,e.squaredLength=u,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i+(e=e[3])*e;return 0<a&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=e*a,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.cross=function(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1];r=r[2]*n[3]-r[3]*n[2],n=e[0];var u=e[1],c=e[2];return e=e[3],t[0]=u*r-c*l+e*s,t[1]=-n*r+c*o-e*a,t[2]=n*l-u*o+e*i,t[3]=-n*s+u*a-c*i,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2];return e=e[3],t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=e+n*(r[3]-e),t},e.random=function(t,e){e=e||1;do{var r=2*h.RANDOM()-1,n=2*h.RANDOM()-1,i=r*r+n*n}while(1<=i);do{var a=2*h.RANDOM()-1,o=2*h.RANDOM()-1,s=a*a+o*o}while(1<=s);return i=Math.sqrt((1-i)/s),t[0]=e*r,t[1]=e*n,t[2]=e*a*i,t[3]=e*o*i,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2];return e=e[3],t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*e,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*e,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*e,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*e,t},e.transformQuat=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2],u=(r=r[3])*n+s*a-l*i,c=r*i+l*n-o*a,h=r*a+o*i-s*n,n=-o*n-s*i-l*a;return t[0]=u*r+n*-o+c*-l-h*-s,t[1]=c*r+n*-s+h*-o-u*-l,t[2]=h*r+n*-l+u*-s-c*-o,t[3]=e[3],t},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2];t=t[3];var a=e[0],o=e[1],s=e[2];return e=e[3],Math.abs(r-a)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=h.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var c,h=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.sub=n,e.mul=i,e.div=a,e.dist=o,e.sqrDist=s,e.len=l,e.sqrLen=u,c=r(),t=function(t,e,r,n,i,a){for(e=e||4,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)c[0]=t[r],c[1]=t[r+1],c[2]=t[r+2],c[3]=t[r+3],i(c,c,a),t[r]=c[0],t[r+1]=c[1],t[r+2]=c[2],t[r+3]=c[3];return t},e.forEach=t});e(yf);var xf=r(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}function n(){var t=new p.ARRAY_TYPE(4);return p.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function i(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function a(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2];return r=r[3],t[0]=n*r+e*o+i*l-a*s,t[1]=i*r+e*s+a*o-n*l,t[2]=a*r+e*l+n*s-i*o,t[3]=e*r-n*o-i*s-a*l,t}function o(t,e,r,n){var i=e[0],a=e[1],o=e[2];e=e[3];var s,l,u=r[0],c=r[1],h=r[2],d=i*u+a*c+o*h+e*(r=r[3]);return d<0&&(d=-d,u=-u,c=-c,h=-h,r=-r),1-d>p.EPSILON?(s=Math.acos(d),l=Math.sin(s),d=Math.sin((1-n)*s)/l,n=Math.sin(n*s)/l):d=1-n,t[0]=d*i+n*u,t[1]=d*a+n*c,t[2]=d*o+n*h,t[3]=d*e+n*r,t}function s(t,e){var r,n,i,a=e[0]+e[4]+e[8];return 0<a?(a=Math.sqrt(a+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a):(r=0,e[4]>e[0]&&(r=1),n=((r=e[8]>e[3*r+r]?2:r)+1)%3,i=(r+2)%3,a=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*i+i]+1),t[r]=.5*a,a=.5/a,t[3]=(e[3*n+i]-e[3*i+n])*a,t[n]=(e[3*n+r]+e[3*r+n])*a,t[i]=(e[3*i+r]+e[3*r+i])*a),t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=n,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=i,e.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>p.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},e.multiply=a,e.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+e*o,t[1]=i*r+a*o,t[2]=a*r-i*o,t[3]=e*r-n*o,t},e.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r-a*o,t[1]=i*r+e*o,t[2]=a*r+n*o,t[3]=e*r-i*o,t},e.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2];e=e[3];var o=Math.sin(r);return r=Math.cos(r),t[0]=n*r+i*o,t[1]=i*r-n*o,t[2]=a*r+e*o,t[3]=e*r-a*o,t},e.calculateW=function(t,e){var r=e[0],n=e[1];return e=e[2],t[0]=r,t[1]=n,t[2]=e,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-e*e)),t},e.slerp=o,e.random=function(t){var e=p.RANDOM(),r=p.RANDOM(),n=p.RANDOM(),i=Math.sqrt(1-e),e=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=e*Math.sin(2*Math.PI*n),t[3]=e*Math.cos(2*Math.PI*n),t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=(a=r*r+n*n+i*i+(e=e[3])*e)?1/a:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=e*a,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=s,e.fromEuler=function(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i,i=Math.sin(e),e=Math.cos(e);var a=Math.sin(r);r=Math.cos(r);var o=Math.sin(n);return n=Math.cos(n),t[0]=i*r*n-e*a*o,t[1]=e*a*n+i*r*o,t[2]=e*r*o-i*a*n,t[3]=e*r*n+i*a*o,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0;var p=r(df),l=r(mf),u=r(vf);t=r(yf),e.clone=t.clone,e.fromValues=t.fromValues,e.copy=t.copy,e.set=t.set,e.add=t.add,e.mul=a,e.scale=t.scale,e.dot=t.dot,e.lerp=t.lerp;var c=t.length;e.length=c,e.len=c,c=t.squaredLength,e.squaredLength=c,e.sqrLen=c;var h,d,f,m,g,v,y=t.normalize;e.normalize=y,e.exactEquals=t.exactEquals,e.equals=t.equals,h=u.create(),d=u.fromValues(1,0,0),f=u.fromValues(0,1,0),t=function(t,e,r){var n=u.dot(e,r);return n<-.999999?(u.cross(h,d,e),u.len(h)<1e-6&&u.cross(h,f,e),u.normalize(h,h),i(t,h,Math.PI),t):.999999<n?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(u.cross(h,e,r),t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=1+n,y(t,t))},e.rotationTo=t,m=n(),g=n(),t=function(t,e,r,n,i,a){return o(m,e,i,a),o(g,r,n,a),o(t,m,g,2*a*(1-a)),t},e.sqlerp=t,v=l.create(),t=function(t,e,r,n){return v[0]=r[0],v[3]=r[1],v[6]=r[2],v[1]=n[0],v[4]=n[1],v[7]=n[2],v[2]=-e[0],v[5]=-e[1],v[8]=-e[2],y(t,s(t,v))},e.setAxes=t});e(xf);var bf=r(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}function i(t,e,r){var n=.5*r[0],i=.5*r[1];r=.5*r[2];var a=e[0],o=e[1],s=e[2];return e=e[3],t[0]=a,t[1]=o,t[2]=s,t[3]=e,t[4]=n*e+i*s-r*o,t[5]=i*e+r*a-n*s,t[6]=r*e+n*o-i*a,t[7]=-n*a-i*o-r*s,t}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function n(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[4],l=r[5],u=r[6],c=r[7],h=e[4],d=e[5],p=e[6];e=e[7];var f=r[0],m=r[1],g=r[2];return r=r[3],t[0]=n*r+o*f+i*g-a*m,t[1]=i*r+o*m+a*f-n*g,t[2]=a*r+o*g+n*m-i*f,t[3]=o*r-n*f-i*m-a*g,t[4]=n*c+o*s+i*u-a*l+h*r+e*f+d*g-p*m,t[5]=i*c+o*l+a*s-n*u+d*r+e*m+p*f-h*g,t[6]=a*c+o*u+n*l-i*s+p*r+e*g+h*m-d*f,t[7]=o*c-n*s-i*l-a*u+e*r-h*f-d*m-p*g,t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new g.ARRAY_TYPE(8);return g.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},e.clone=function(t){var e=new g.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},e.fromValues=function(t,e,r,n,i,a,o,s){var l=new g.ARRAY_TYPE(8);return l[0]=t,l[1]=e,l[2]=r,l[3]=n,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l},e.fromRotationTranslationValues=function(t,e,r,n,i,a,o){var s=new g.ARRAY_TYPE(8);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,i*=.5,a*=.5,o*=.5,s[4]=i*n+a*r-o*e,s[5]=a*n+o*t-i*r,s[6]=o*n+i*e-a*t,s[7]=-i*t-a*e-o*r,s},e.fromRotationTranslation=i,e.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},e.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.fromMat4=function(t,e){var r=f.create();a.getRotation(r,e);var n=new g.ARRAY_TYPE(3);return a.getTranslation(n,e),i(t,r,n),t},e.copy=c,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.set=function(t,e,r,n,i,a,o,s,l){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t},e.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},e.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.getTranslation=function(t,e){var r=e[4],n=e[5],i=e[6],a=e[7],o=-e[0],s=-e[1],l=-e[2];return e=e[3],t[0]=2*(r*e+a*o+n*l-i*s),t[1]=2*(n*e+a*s+i*o-r*l),t[2]=2*(i*e+a*l+r*s-n*o),t},e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=.5*r[0],l=.5*r[1];r=.5*r[2];var u=e[4],c=e[5],h=e[6];return e=e[7],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=o*s+i*r-a*l+u,t[5]=o*l+a*s-n*r+c,t[6]=o*r+n*l-i*s+h,t[7]=-n*s-i*l-a*r+e,t},e.rotateX=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateX(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateY=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateY(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateZ=function(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=s*o+c*n+l*a-u*i,d=l*o+c*i+u*n-s*a,p=u*o+c*a+s*i-l*n,s=c*o-s*n-l*i-u*a;return f.rotateZ(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+s*n+d*a-p*i,t[5]=d*o+s*i+p*n-h*a,t[6]=p*o+s*a+h*i-d*n,t[7]=s*o-h*n-d*i-p*a,t},e.rotateByQuatAppend=function(t,e,r){var n=r[0],i=r[1],a=r[2];r=r[3];var o=e[0],s=e[1],l=e[2],u=e[3];return t[0]=o*r+u*n+s*a-l*i,t[1]=s*r+u*i+l*n-o*a,t[2]=l*r+u*a+o*i-s*n,t[3]=u*r-o*n-s*i-l*a,o=e[4],s=e[5],l=e[6],u=e[7],t[4]=o*r+u*n+s*a-l*i,t[5]=s*r+u*i+l*n-o*a,t[6]=l*r+u*a+o*i-s*n,t[7]=u*r-o*n-s*i-l*a,t},e.rotateByQuatPrepend=function(t,e,r){var n=e[0],i=e[1],a=e[2];e=e[3];var o=r[0],s=r[1],l=r[2],u=r[3];return t[0]=n*u+e*o+i*l-a*s,t[1]=i*u+e*s+a*o-n*l,t[2]=a*u+e*l+n*s-i*o,t[3]=e*u-n*o-i*s-a*l,o=r[4],s=r[5],l=r[6],u=r[7],t[4]=n*u+e*o+i*l-a*s,t[5]=i*u+e*s+a*o-n*l,t[6]=a*u+e*l+n*s-i*o,t[7]=e*u-n*o-i*s-a*l,t},e.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<g.EPSILON)return c(t,e);var i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;var a=(s=Math.sin(n))*r[0]/i,o=s*r[1]/i;r=s*r[2]/i,n=Math.cos(n);var i=e[0],s=e[1],l=e[2],u=e[3];return t[0]=i*n+u*a+s*r-l*o,t[1]=s*n+u*o+l*a-i*r,t[2]=l*n+u*r+i*o-s*a,t[3]=u*n-i*a-s*o-l*r,i=e[4],s=e[5],l=e[6],e=e[7],t[4]=i*n+e*a+s*r-l*o,t[5]=s*n+e*o+l*a-i*r,t[6]=l*n+e*r+i*o-s*a,t[7]=e*n-i*a-s*o-l*r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},e.multiply=n,e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},e.lerp=function(t,e,r,n){var i=1-n;return o(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t},e.invert=function(t,e){var r=h(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},e.normalize=function(t,e){var r,n,i,a,o,s,l,u,c=h(e);return 0<c&&(c=Math.sqrt(c),r=e[0]/c,n=e[1]/c,i=e[2]/c,a=e[3]/c,u=r*(o=e[4])+n*(s=e[5])+i*(l=e[6])+a*(e=e[7]),t[0]=r,t[1]=n,t[2]=i,t[3]=a,t[4]=(o-r*u)/c,t[5]=(s-n*u)/c,t[6]=(l-i*u)/c,t[7]=(e-a*u)/c),t},e.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},e.equals=function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6];t=t[7];var u=e[0],c=e[1],h=e[2],d=e[3],p=e[4],f=e[5],m=e[6];return e=e[7],Math.abs(r-u)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-d)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-p)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-f)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-m)<=g.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(t-e)<=g.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.sqrLen=e.squaredLength=e.len=e.length=e.dot=e.mul=e.setReal=e.getReal=void 0;var g=r(df),f=r(xf),a=r(gf);e.getReal=f.copy,e.setReal=f.copy,e.mul=n;var o=f.dot;e.dot=o,t=f.length,e.length=t,e.len=t;var h=f.squaredLength;e.squaredLength=h,e.sqrLen=h});e(bf);var _f=r(function(t,e){function r(){var t=new h.ARRAY_TYPE(2);return h.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function a(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function o(t,e){var r=e[0]-t[0];return t=e[1]-t[1],Math.sqrt(r*r+t*t)}function s(t,e){var r=e[0]-t[0];return r*r+(t=e[1]-t[1])*t}function l(t){var e=t[0];return t=t[1],Math.sqrt(e*e+t*t)}function u(t){var e=t[0];return e*e+(t=t[1])*t}Object.defineProperty(e,"__esModule",{value:!0}),e.create=r,e.clone=function(t){var e=new h.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var r=new h.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,r){return t[0]=e,t[1]=r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},e.subtract=n,e.multiply=i,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},e.distance=o,e.squaredDistance=s,e.length=l,e.squaredLength=u,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var r=e[0],n=e[1];return 0<(r=r*r+n*n)&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,r){return e=e[0]*r[1]-e[1]*r[0],t[0]=t[1]=0,t[2]=e,t},e.lerp=function(t,e,r,n){var i=e[0];return e=e[1],t[0]=i+n*(r[0]-i),t[1]=e+n*(r[1]-e),t},e.random=function(t,e){e=e||1;var r=2*h.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},e.transformMat2=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[2]*e,t[1]=r[1]*n+r[3]*e,t},e.transformMat2d=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[2]*e+r[4],t[1]=r[1]*n+r[3]*e+r[5],t},e.transformMat3=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[3]*e+r[6],t[1]=r[1]*n+r[4]*e+r[7],t},e.transformMat4=function(t,e,r){var n=e[0];return e=e[1],t[0]=r[0]*n+r[4]*e+r[12],t[1]=r[1]*n+r[5]*e+r[13],t},e.rotate=function(t,e,r,n){var i=e[0]-r[0];e=e[1]-r[1];var a=Math.sin(n);return n=Math.cos(n),t[0]=i*n-e*a+r[0],t[1]=i*a+e*n+r[1],t},e.angle=function(t,e){var r=t[0];t=t[1];var n=e[0],i=r*r+t*t,a=n*n+(e=e[1])*e;return 1<(r=(r*n+t*e)*(i=0<i?1/Math.sqrt(i):i)*(a=0<a?1/Math.sqrt(a):a))?0:r<-1?Math.PI:Math.acos(r)},e.zero=function(t){return t[0]=0,t[1]=0,t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var r=t[0];t=t[1];var n=e[0];return e=e[1],Math.abs(r-n)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0;var c,h=function(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}(df);e.len=l,e.sub=n,e.mul=i,e.div=a,e.dist=o,e.sqrDist=s,e.sqrLen=u,c=r(),t=function(t,e,r,n,i,a){for(e=e||2,r=r||0,n=n?Math.min(n*e+r,t.length):t.length;r<n;r+=e)c[0]=t[r],c[1]=t[r+1],i(c,c,a),t[r]=c[0],t[r+1]=c[1];return t},e.forEach=t});function Af(t,e,r,n){if(void 0!==(s=r?r.call(n,t,e):void 0))return!!s;if(t===e)return 1;if("object"===(void 0===t?"undefined":Ou(t))&&t&&"object"===(void 0===e?"undefined":Ou(e))&&e){var i=Nu(t),a=Nu(e);if(i.length===a.length){for(var a=Object.prototype.hasOwnProperty.bind(e),o=0;o<i.length;o++){if(!a(s=i[o]))return;var s,l=t[s],u=e[s];if(!1===(s=r?r.call(n,l,u,s):void 0)||void 0===s&&l!==u)return}return 1}}}e(_f),e(cs=r(function(t,e){function r(t){if(t&&t.__esModule)return t;var e,r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&((e=Tu&&ef?ef(t,n):{}).get||e.set?Tu(r,n,e):r[n]=t[n]);return r.default=t,r}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0,t=r(df),e.glMatrix=t,t=r(pf),e.mat2=t,t=r(ff),e.mat2d=t,t=r(mf),e.mat3=t,t=r(gf),e.mat4=t,t=r(xf),e.quat=t,t=r(bf),e.quat2=t,t=r(_f),e.vec2=t,t=r(vf),e.vec3=t,t=r(yf),e.vec4=t}));var wf=cs.mat4,Mf=function(){function u(t,e,r){ju(this,u),this.options=e,this.gl=t,r&&(this.map=r.map),r=this.getVertexShader(e.vertexShader);var n=this.getFragmentShader(e.fragmentShader);e=t.createShader(t.VERTEX_SHADER),t.shaderSource(e,r),t.compileShader(e),e=t.getShaderParameter(e,t.COMPILE_STATUS)?(r=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?(n=t.createProgram(),t.attachShader(n,e),t.attachShader(n,r),t.deleteShader(e),t.deleteShader(r),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)?n:(e="Shader program failed to link.  The error log is:"+t.getProgramInfoLog(n),console.error(e),-1)):(e="Fragment shader failed to compile.  The error log is:"+t.getShaderInfoLog(r),console.error(e),-1)):(e="Vertex shader failed to compile.  The error log is:"+t.getShaderInfoLog(e),console.error(e),-1),e=this.program=e,r={};for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=t.getActiveAttrib(e,i);r[a.name]=t.getAttribLocation(e,a.name)}for(var i={},a={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;s++){var l=t.getActiveUniform(e,s);i[l.name]=t.getUniformLocation(e,l.name),a[l.name]=l.type}this.parameter=t={attributes:r,numAttributes:n,uniformsType:a,uniforms:i},this.attributes=t.attributes,this.uniforms=t.uniforms,this.parameter=t}return Wp(u,[{key:"getVertexShader",value:function(t){var e="";return this.map&&"cesium"===this.map.type&&(e="#define LOG_DEPTH\n"),e+="#ifdef LOG_DEPTH\nuniform float currentFrustumX;varying float v_depthFromNearPlusOne;\n#endif\nuniform vec2 MAPV_resolution;\n#if defined(PICK)\nuniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}\n#endif\nvoid afterMain(){\n#if defined(LOG_DEPTH)\nv_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;\n#endif\n#if defined(PICK)\nvPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}\n#endif\n}",(t=(t=this.getDefines()+e+t).replace("void main","void originMain"))+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(t){var e="";return this.map&&"cesium"===this.map.type&&(e="#define LOG_DEPTH\n"),e+="#if defined(LOG_DEPTH)\n#extension GL_EXT_frag_depth : enable\n#endif\nprecision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;\n#if defined(PICK)\nvarying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}\n#endif\n#if defined(LOG_DEPTH)\nuniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}\n#endif\nvoid afterMain(){\n#if defined(PICK)\nif(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}\n#endif\n#if defined(LOG_DEPTH)\nwriteLogDepth(v_depthFromNearPlusOne);\n#endif\n}",(t=(t=this.getDefines()+e+t).replace("void main","void originMain"))+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var t="",e=this.options.defines;if(e)for(var r=0;r<e.length;r++)t+="#define "+e[r]+"\n";return t}},{key:"use",value:function(t,e){(this.gl=t).useProgram(this.program),this.map&&"cesium"===this.map.type&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[t.canvas.width,t.canvas.height]})}},{key:"setUniform",value:function(t,e){var r=this.gl,n=this.uniforms[t];if(n)switch(this.parameter.uniformsType[t]){case r.FLOAT:r.uniform1f(n,e);break;case r.FLOAT_VEC2:r.uniform2f(n,e[0],e[1]);break;case r.FLOAT_VEC3:r.uniform3f(n,e[0],e[1],e[2]);break;case r.FLOAT_VEC4:r.uniform4f(n,e[0],e[1],e[2],e[3]);break;case r.SAMPLER_2D:case r.SAMPLER_CUBE:r.activeTexture(r["TEXTURE"+this.textureIndex]),r.uniform1i(n,this.textureIndex),r.bindTexture(r.TEXTURE_2D,e),this.textureIndex++;break;case r.INT:case r.BOOL:r.uniform1i(n,e);break;case r.INT_VEC2:case r.BOOL_VEC2:r.uniform2i(n,e[0],e[1]);break;case r.INT_VEC3:case r.BOOL_VEC3:r.uniform3i(n,e[0],e[1],e[2]);break;case r.INT_VEC4:case r.BOOL_VEC4:r.uniform4i(n,e[0],e[1],e[2],e[3]);break;case r.FLOAT_MAT2:r.uniformMatrix2fv(n,!1,e);break;case r.FLOAT_MAT3:r.uniformMatrix3fv(n,!1,e);break;case r.FLOAT_MAT4:r.uniformMatrix4fv(n,!1,e);break;default:console.error("Unrecognized uniform type: "+t)}else console.warn("Unrecognized uniform type: "+t)}},{key:"setUniforms",value:function(t){for(var e in this.textureIndex=0,t)this.setUniform(e,t[e])}}]),u}(),Cf=function(){function e(t){ju(this,e),this.options=t,this.gl=t.gl,this.savedState=[],this.currentState=this.getDefaultState()}return Wp(e,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var t=this.gl;return{blend:!1,blendEquation:t.FUNC_ADD,blendFunc:[t.ONE,t.ZERO],depthMask:!0,depthTest:!0,depthFunc:t.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var t=this.gl;return{blend:t.getParameter(t.BLEND),blendEquation:t.getParameter(t.BLEND_EQUATION),depthMask:t.getParameter(t.DEPTH_WRITEMASK),depthTest:t.getParameter(t.DEPTH_TEST),depthFunc:t.getParameter(t.DEPTH_FUNC),polygonOffset:[t.getParameter(t.POLYGON_OFFSET_FACTOR),t.getParameter(t.POLYGON_OFFSET_UNITS)],cullFace:t.getParameter(t.CULL_FACE),stencilTest:t.getParameter(t.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var t=this.savedState.pop();this.setState(t,{force:!0})}},{key:"setState",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t=Hu(this.getDefaultState(),t),this.setBlend(t,e),this.setDepth(t,e),this.setCullFace(t,e),this.setPolygonOffset(t,e),this.setStencil(t,e),this.currentState=t}},{key:"setBlend",value:function(t,e){var r=this.gl,n=this.getCurrentState();!(e=e.force)&&Af(t.blend,n.blend)||(t.blend?r.enable(r.BLEND):r.disable(r.BLEND)),!e&&Af(t.blendEquation,n.blendEquation)||r.blendEquation(t.blendEquation),!e&&Af(t.blendFunc,n.blendFunc)||r.blendFunc(t.blendFunc[0],t.blendFunc[1])}},{key:"setDepth",value:function(t,e){var r=this.gl,n=this.getCurrentState();!(e=e.force)&&Af(t.depthTest,n.depthTest)||(t.depthTest?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST)),!e&&Af(t.depthMask,n.depthMask)||(t.depthMask?r.depthMask(!0):r.depthMask(!1)),!e&&Af(t.depthFunc,n.depthFunc)||r.depthFunc(t.depthFunc)}},{key:"setPolygonOffset",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Af(t.polygonOffset,n.polygonOffset)||(0!==t.polygonOffset[0]&&0!==t.polygonOffset[1]?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),r.polygonOffset(t.polygonOffset[0],t.polygonOffset[1]))}},{key:"setCullFace",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Af(t.cullFace,n.cullFace)||(t.cullFace?(r.enable(r.CULL_FACE),r.cullFace(r.BACK)):r.disable(r.CULL_FACE))}},{key:"setStencil",value:function(t,e){var r=this.gl,n=this.getCurrentState();!e.force&&Af(t.stencilTest,n.stencilTest)||(t.stencilTest?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST))}}]),e}(),Tf=function(){function e(t){ju(this,e),this.options=t,this.gl=t.gl,this.buffer=this.gl.createBuffer(),t.data&&this.updateData(t.data)}return Wp(e,[{key:"updateData",value:function(t){var e=this.options,r=this.gl;this.bind(),r.bufferData(r[e.target],t,r[e.usage])}},{key:"bind",value:function(t){(t=t||this.gl).bindBuffer(t[this.options.target],this.buffer)}},{key:"unBind",value:function(t){(t=t||this.gl).bindBuffer(t[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),e}(),Sf={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},Ef=function(){function e(t){for(ju(this,e),this.options=t,this.attributes=t.attributes,this.gl=t.gl,this.program=t.program,t=this.stride=0;t<this.attributes.length;t++)this.stride+=Sf[this.attributes[t].type]*this.attributes[t].size}return Wp(e,[{key:"setVertexAttribPointers",value:function(){for(var t=this.gl,e=this.program,r=0;r<this.attributes.length;r++){var n=this.attributes[r],i=e.attributes[n.name];void 0!==i&&(n.buffer.bind(t),t.vertexAttribPointer(i,n.size,t[n.type],n.normalize||!1,(void 0!==n.stride?n:this).stride,n.offset),t.enableVertexAttribArray(i))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),e}(),If=function t(e,r,n){ju(this,t),r=r||e.canvas.width,n=n||e.canvas.height;var i=e.createFramebuffer(),a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i.texture=a;var o=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r,n),i.depthBuffer=o,e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,o),r=e.checkFramebufferStatus(e.FRAMEBUFFER),e.FRAMEBUFFER_COMPLETE===r&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),this.framebuffer=i)},Lf=function(){function e(t){ju(this,e),this.options={},Hu(this.options,t),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return Wp(e,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(t){}},{key:"render",value:function(t){var e=t.gl;t=t.texture;var r=this.programSample;e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);var i=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,0),e.drawArrays(e.TRIANGLES,0,i.length/3)}}]),e}();(function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture,this.getOptions(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.getProgram(e);e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.uniform2fv(r.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}])})(),function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){var e;return this.program1||(this.program1=new Mf(t,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;\n#define SMAA_THRESHOLD 0.1\nuniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}"})),this.program2||(this.program2=new Mf(t,{vertexShader:"precision highp float;\n#define SMAA_MAX_SEARCH_STEPS 8\n#define SMAA_AREATEX_MAX_DISTANCE 16\n#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\nattribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;\n#define SMAA_MAX_SEARCH_STEPS 8\n#define SMAA_AREATEX_MAX_DISTANCE 16\n#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\nuniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}"})),this.program3||(this.program3=new Mf(t,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),this.vertexBuffer&&this.sampleBuffer||(this.vertexBuffer=new Tf({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Tf({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),e=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}],this.vertexArray1=new Ef({gl:t,program:this.program1,attributes:e}),this.vertexArray2=new Ef({gl:t,program:this.program2,attributes:e}),this.vertexArray3=new Ef({gl:t,program:this.program3,attributes:e})),{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new If(t),this.bloomBuffer=new If(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new If(t)),this.bloomBuffer||(this.bloomBuffer=new If(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo,this.getOptions(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var n=(a=this.getProgram(e)).program1,i=a.program2,a=a.program3,o=(s=this.getExtraFbo(e)).collectBrightBuffer,s=s.bloomBuffer,l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(n.attributes.position),e.vertexAttribPointer(n.attributes.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.attributes.position),e.vertexAttribPointer(i.attributes.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.position),e.vertexAttribPointer(a.attributes.position,3,e.FLOAT,!1,0,0),l=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(n.attributes.uv),e.vertexAttribPointer(n.attributes.uv,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.attributes.uv),e.vertexAttribPointer(i.attributes.uv,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.uv),e.vertexAttribPointer(a.attributes.uv,2,e.FLOAT,!1,0,0),e.useProgram(n.program),e.bindFramebuffer(e.FRAMEBUFFER,o),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(n.uniforms.tDiffuse,2),e.uniform2fv(n.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(i.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,o.texture),e.uniform1i(i.uniforms.uSampler,2),e.uniform2fv(i.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(a.uniforms.tDiffuse,2),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(a.uniforms.tColor,3),e.uniform2fv(a.uniforms.resolution,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}])}(),function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new Tf({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Tf({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new Ef({gl:t,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture,e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.getProgram(e);r.use(e),this.vertexArray.bind(),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3)}}])}(),function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){return this.programBright||(this.programBright=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new If(t),this.bloomBuffer=new If(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new If(t)),this.bloomBuffer||(this.bloomBuffer=new If(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo;var n=this.getOptions();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=(o=this.getProgram(e)).programBright,a=o.programBloom,o=o.programResult,s=(l=this.getExtraFbo(e)).collectBrightBuffer,l=l.bloomBuffer,u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(i.attributes.aPos),e.vertexAttribPointer(i.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.aPos),e.vertexAttribPointer(a.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aPos),e.vertexAttribPointer(o.attributes.aPos,3,e.FLOAT,!1,0,0),u=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(i.attributes.aTextureCoord),e.vertexAttribPointer(i.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a.attributes.aTextureCoord),e.vertexAttribPointer(a.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aTextureCoord),e.vertexAttribPointer(o.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.useProgram(i.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(i.uniforms.uSampler,1),e.uniform1f(i.uniforms.threshold,n.threshold||0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(a.uniforms.uSampler,1),e.uniform1i(a.uniforms.isVertical,!0),e.uniform1f(a.uniforms.blurSize,n.blurSize||2),e.uniform1f(a.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(a.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,s),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(a.uniforms.uSampler,1),e.uniform1i(a.uniforms.isVertical,!1),e.uniform1f(a.uniforms.blurSize,n.blurSize||2),e.uniform1f(a.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(a.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(o.uniforms.originalTexture,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(o.uniforms.bloomTexture,0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}])}(),function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){return this.programBright||(this.programBright=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(t){this.collectBrightBuffer=new If(t),this.bloomBuffer=new If(t)}},{key:"getExtraFbo",value:function(t){return this.collectBrightBuffer||(this.collectBrightBuffer=new If(t)),this.bloomBuffer||(this.bloomBuffer=new If(t)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(t){var e=t.gl,r=t.texture;t=t.fbo;var n=this.getOptions(),i="clarity"in n?n.clarity:1,i=Math.max(0,i);i=Math.min(1,i),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var a=(s=this.getProgram(e)).programBright,o=s.programBloom,s=s.programResult,l=(u=this.getExtraFbo(e)).collectBrightBuffer,u=u.bloomBuffer,c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(a.attributes.aPos),e.vertexAttribPointer(a.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aPos),e.vertexAttribPointer(o.attributes.aPos,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.attributes.aPos),e.vertexAttribPointer(s.attributes.aPos,3,e.FLOAT,!1,0,0),c=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(a.attributes.aTextureCoord),e.vertexAttribPointer(a.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.attributes.aTextureCoord),e.vertexAttribPointer(o.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.attributes.aTextureCoord),e.vertexAttribPointer(s.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.useProgram(a.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(a.uniforms.uSampler,1),e.uniform1f(a.uniforms.threshold,n.threshold||0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,u),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(o.uniforms.uSampler,1),e.uniform1i(o.uniforms.isVertical,!0),e.uniform1f(o.uniforms.blurSize,n.blurSize||2),e.uniform1f(o.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(o.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(o.program),e.bindFramebuffer(e.FRAMEBUFFER,l),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,u.texture),e.uniform1i(o.uniforms.uSampler,1),e.uniform1i(o.uniforms.isVertical,!1),e.uniform1f(o.uniforms.blurSize,n.blurSize||2),e.uniform1f(o.uniforms.devicePixelRatio,window.devicePixelRatio),e.uniform2fv(o.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.useProgram(s.program),e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),e.uniform1i(s.uniforms.originalTexture,1),e.uniform1f(s.uniforms.toneScale,i),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,l.texture),e.uniform1i(s.uniforms.bloomTexture,0),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}}])}(),function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}Zu(e,Lf),Wp(e,[{key:"getProgram",value:function(t){return this.programSample||(this.programSample=new Mf(t,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(t){var e=t.gl;t=t.texture;var r=this.getProgram(e);e.useProgram(r.program);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.vertex),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aPos),e.vertexAttribPointer(r.attributes.aPos,3,e.FLOAT,!1,0,0),n=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sampleCoord),e.STATIC_DRAW),e.enableVertexAttribArray(r.attributes.aTextureCoord),e.vertexAttribPointer(r.attributes.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(r.uniforms.uSampler,1),e.uniform2fv(r.uniforms.canvasSize,[e.canvas.width,e.canvas.height]),e.drawArrays(e.TRIANGLES,0,this.vertex.length/3)}}])}();var Rf=function(){function e(t){ju(this,e),this.gl=t,this.effects=[],this.initFbo()}return Wp(e,[{key:"addEffect",value:function(t){this.effects.push(t)}},{key:"removeEffect",value:function(t){}},{key:"setEffects",value:function(t){this.effects=t}},{key:"onResize",value:function(){this.initFbo();var t=this.gl,e=this.effects;if(e&&1<e.length)for(var r=1;r<e.length;r++){var n=e[r];n.onResize&&n.onResize(t)}}},{key:"initFbo",value:function(){var t=this.gl;t&&(this.fbo=[new If(t),new If(t)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var t=this.gl,e=this.effects;if(e&&0<e.length)for(var r={},n=0;n<e.length;n++){var i=this.fbo[n%2].framebuffer;n===e.length-1&&(i=null),t.bindFramebuffer(t.FRAMEBUFFER,i);var a=[0,0,0,0];t.clearColor(a[0],a[1],a[2],a[3]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),e[n].render({isPickRender:!1,gl:t,texture:r.texture,fbo:i}),r=i}}}]),e}(),Pf=function(){function r(t,e){ju(this,r),this.map=t,this.options=e||{},this.eventMap={}}return Wp(r,[{key:"onResize",value:function(t){}},{key:"onUpdate",value:function(t){throw"未实现onUpdate方法"}},{key:"getContainer",value:function(){throw"未实现getContainer方法"}},{key:"getSize",value:function(){throw"未实现getSize方法"}},{key:"getTilt",value:function(){throw"未实现getTilt方法"}},{key:"getHeading",value:function(){throw"未实现getHeading方法"}},{key:"getZoomUnits",value:function(){throw"未实现getZoomUnits方法"}},{key:"getCenter",value:function(){throw"未实现getCenter方法"}},{key:"getMapType",value:function(){throw"未实现getMapType方法"}},{key:"lnglatToMercator",value:function(t,e){return"gcj02"===this.options.coordinateSystem?(e=e*Math.PI/180,e=3189068.5*Math.log((1+Math.sin(e))/(1-Math.sin(e))),[parseFloat((t*Math.PI/180*6378137).toFixed(2)),parseFloat(e.toFixed(2))]):[(t=ma.convertLL2MC({lng:t,lat:e})).lng,t.lat]}}]),r}(),Df=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).eventMap={},t}return Zu(e,Pf),Wp(e,[{key:"onResize",value:function(t){this.map.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onMousemove",value:function(t){t=this.extendCallback(t),this.map.addEventListener("mousemove",t),this.eventMap.mousemove=t}},{key:"onClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("click",t),this.eventMap.click=t}},{key:"onDblClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("dblclick",t),this.eventMap.dblclick=t}},{key:"onRightClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("rightclick",t),this.eventMap.rightclick=t}},{key:"onUpdate",value:function(t){this.map.addEventListener("update",t),this.map.addEventListener("onearthstatuschange",t),this.eventMap.update=t,this.eventMap.onearthstatuschange=t}},{key:"extendCallback",value:function(e){return function(t){e(Hu(t,{x:t.x,y:t.y}))}}},{key:"unbind",value:function(t){var e=this;this.eventMap[t]?(this.map.removeEventListener(t,this.eventMap[t]),delete this.eventMap[t]):(Nu(this.eventMap).forEach(function(t){e.map.removeEventListener(t,e.eventMap[t])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var t=this.map.getCenter();return t=-180<=t.lng&&t.lng<=180?{lng:(t=this.map.lnglatToMercator(t.lng,t.lat))[0],lat:t[1]}:t}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(t,e){return this.map.lnglatToMercator(t,e)}},{key:"mercatorToLnglat",value:function(t,e){return this.map.mercatorToLnglat(t,e)}}]),e}(),Of=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).div=document.createElement("div"),t.div.style.position="absolute",t.div.style.userSelect="none",t.map.getPanes().mapPane.appendChild(t.div),t.eventMap={},t}return Zu(e,Pf),Wp(e,[{key:"onResize",value:function(t){this.map.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onMousemove",value:function(t){t=this.extendCallback(t),this.map.addEventListener("mousemove",t),this.eventMap.mousemove=t}},{key:"onClick",value:function(t){t=this.extendCallback(t),qp?(this.map.addEventListener("touchend",t),this.eventMap.touchend=t):(this.map.addEventListener("click",t),this.eventMap.click=t)}},{key:"onDblClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("dblclick",t),this.eventMap.dblclick=t}},{key:"onRightClick",value:function(t){t=this.extendCallback(t),this.map.addEventListener("rightclick",t),this.eventMap.rightclick=t}},{key:"changeCanvas",value:function(){var t=(r=this.map).getSize(),e=r.getCenter(),r=r.pointToOverlayPixel(e);this.div.style.left=r.x-t.width/2+"px",this.div.style.top=r.y-t.height/2+"px"}},{key:"onUpdate",value:function(t){function e(){r.changeCanvas(),t()}var r=this;this.map.addEventListener("moveend",e),this.map.addEventListener("moving",e),this.map.addEventListener("zoomend",e),this.eventMap.moveend=e,this.eventMap.moving=e,this.eventMap.zoomend=e}},{key:"extendCallback",value:function(e){return function(t){e(Hu(t,{x:t.pixel.x,y:t.pixel.y}))}}},{key:"unbind",value:function(){var e=this;Nu(this.eventMap).forEach(function(t){e.map.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var t=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(t):Math.pow(2,18-t)}},{key:"getCenter",value:function(){var t=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:t.x,lat:t.y}}},{key:"lnglatToMercator",value:function(t,e){return[(t=this.map.getMapType().getProjection().lngLatToPoint({lng:t,lat:e})).x,t.y]}},{key:"mercatorToLnglat",value:function(t,e){return[(t=this.map.getMapType().getProjection().pointToLngLat({lng:t,lat:e})).lng,t.lat]}}]),e}(),Ff=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).eventMap={},t}return Zu(e,Pf),Wp(e,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;Nu(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var t=this.map;return{width:t.canvas.clientWidth,height:t.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var t=this.map;return 6.8*t.scene.globe.ellipsoid.cartesianToCartographic(t.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var t=(t=this.map).camera.pickEllipsoid(new Cesium.Cartesian2(t.canvas.clientWidth/2,t.canvas.clientHeight/2));return t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),{lng:(t=this.getMercator([180*t.longitude/Math.PI,180*t.latitude/Math.PI]))[0],lat:t[1]}}},{key:"getMercator",value:function(t){var e=[];return e[0]=t[0]*Math.PI/180*6378137,t=t[1]*Math.PI/180,e[1]=3189068.5*Math.log((1+Math.sin(t))/(1-Math.sin(t))),e}}]),e}(),Bf=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).eventMap={},t}return Zu(e,Pf),Wp(e,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;Nu(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),e}(),Nf=function(){function r(t,e){return ju(this,r),(t=Xu(this,(r.__proto__||Iu(r)).call(this,t,e))).eventMap={},t}return Zu(r,Pf),Wp(r,[{key:"onResize",value:function(t){window.addEventListener("resize",t),this.eventMap.resize=t}},{key:"onUpdate",value:function(t){}},{key:"unbind",value:function(){var e=this;Nu(this.eventMap).forEach(function(t){window.removeEventListener(t,e.eventMap[t])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),r}(),zf=function(){function n(t,e){var r=this;ju(this,n),"bmap"===(e=e||{}).mapType?this.map=new Of(t,e):"blank"===e.mapType?this.map=new Bf(t,e):"cesium"===e.mapType?this.map=new Ff(t,e):"three"===e.mapType?this.map=new Nf(t,e):(e.mapType="bmapgl",this.map=new Df(t,e)),this.map.type=e.mapType,this._dpr=window.devicePixelRatio,"bmapgl"===e.mapType&&(this._dpr=this.map.map.config.ratio),this.options=e||{},this.renderArr=[],(t=e.canvas)||(t=document.createElement("canvas")),this.canvas=t,this.gl=e.gl||function(t,e){for(var r=["webgl2","experimental-webgl2","webgl","experimental-webgl"],n=void 0,i=0;i<r.length;i++)try{if(n=t.getContext(r[i],{alpha:!0,premultipliedAlpha:!1,antialias:e.antialias||!0,preserveDrawingBuffer:e.preserveDrawingBuffer||!1}))break}catch(t){}return n}(t,e),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(t){r.gl.getExtension(t)}),this.changeSize(),this.projectionMatrix=wf.create(Float64Array),this.orthoMatrix=wf.create(Float64Array),this.matrix=wf.create(Float64Array),this.viewMatrix=wf.create(Float64Array),this.pointToPixelMatrix=wf.create(Float64Array),this.pixelToViewMatrix=wf.create(Float64Array),this.fovy=35,this.fps=Math.min(e.fps,60)||60,this.renderTime=(new Date).valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new Cf({gl:this.gl}),this.pickFBO=new If(this.gl),this.transferOptions={},this.bind()}return Wp(n,[{key:"bind",value:function(){var e=this,t=this.map;t.onResize(function(){e.changeSize(),e.render()}),t.onUpdate(this._update),t.onClick&&t.onClick(function(t){e.onClick&&e.onClick(t)}),t.onDblClick&&t.onDblClick(function(t){e.onDblClick&&e.onDblClick(t)}),t.onRightClick&&t.onRightClick(function(t){e.onRightClick&&e.onRightClick(t)}),t.onMousemove&&t.onMousemove(function(t){e.onMousemove&&e.onMousemove(t)}),this.options.canvas||t.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var t=this.map;t.unbind&&t.unbind()}},{key:"setOptions",value:function(t){this.options=t}},{key:"onInitialize",value:function(t){t&&(this.transferOptions=t.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(t){var e=this.gl;t?e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer):e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var t=this.gl;this.preFramebuffer=t.getParameter(t.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(t){this.renderArr.push(t)}},{key:"changeSize",value:function(){var t,e,r,n=this.canvas,i=this.options;n&&(t=n.style,e=this.map.getSize(),r=this._dpr,n.width=e.width*r,n.height=e.height*r,t.cssText="position: absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px;z-index:2;","cesium"!==i.mapType||i.canvas||(t.pointerEvents="none"),this.gl.viewport(0,0,n.width,n.height))}},{key:"update",value:function(){!1===this.options.autoUpdate||this.isAnimation&&60<=this.fps||this.render()}},{key:"render",value:function(){if(this.map&&this.gl){var t,e=this.options,r=this.projectionMatrix,n=this.viewMatrix;for("three"===e.mapType?(r=(n=this.map.map.camera).projectionMatrix.elements,n=n.matrixWorldInverse.elements):"cesium"===e.mapType?(t=(n=this.map.map).camera.frustum.projectionMatrix,r=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]),t=n.camera.viewMatrix,n=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]])):"B_EARTH_MAP"===this.map.map.mapType?(r=this.map.map.getEarth().scene._camera.getProjectionMatrix(),n=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix()),t=wf.multiply(this.matrix,r,n),Hu(this.transferOptions,{gl:this.gl,matrix:t,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:r,orthoMatrix:this.orthoMatrix,viewMatrix:n,stateManager:this.stateManager}),"three"!==e.mapType&&"cesium"!==e.mapType&&!1!==e.autoUpdate&&this.clear(),e=0;e<this.renderArr.length;e++)this.renderArr[e]&&this.renderArr[e].bind(this)(this.transferOptions)}}},{key:"clear",value:function(t){var e=this.gl,r=this.options.clearColor||[0,0,0,0];e.clearColor(r[0],r[1],r[2],r[3]),t&&(t instanceof Array||(t=Aa(t).unitArray()),e.clearColor(t[0],t[1],t[2],t[3])),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var t=this.options.cameraNear||1,e=this.options.cameraFar||4e3;wf.perspective(this.projectionMatrix,this.fovy*Math.PI/180,this.gl.canvas.width/this.gl.canvas.height,t,e);var r=this.map.getSize();wf.ortho(this.orthoMatrix,-r.width/2,r.width/2,-r.height/2,r.height/2,t,e)}},{key:"updateModelViewMatrix",value:function(){var t=this.map,e=this.viewMatrix,r=this.pointToPixelMatrix,n=this.pixelToViewMatrix;wf.identity(e),wf.identity(r),wf.identity(n);var i=t.getSize();wf.translate(n,n,[0,0,Math.round(-i.height/(2*Math.tan(this.fovy*Math.PI/180/2)))]),wf.rotate(n,n,t.getTilt()*Math.PI/180,[-1,0,0]),wf.rotate(n,n,t.getHeading()*Math.PI/180,[0,0,-1]);var i=t.getCenter(),a=this.options.pointOffset||[0,0],t=t.getZoomUnits();wf.translate(r,r,[(a[0]-i.lng)/t,(a[1]-i.lat)/t,0]),t=1/t,wf.scale(r,r,[t,t,t]),wf.multiply(e,n,r)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var t=this.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this.map.getContainer().removeChild(this.canvas),this.gl=this.canvas=null}},{key:"animation",value:function(){var t,e,r;this.isAnimation&&(60<=this.fps?this.render():(t=(new Date).valueOf(),(e=Math.floor(1e3/this.fps))<(r=t-this.renderTime)&&(this.render(),this.renderTime=t-r%e)),window.requestAnimationFrame(this._animation))}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),n}(),Uf=function(){function e(t){ju(this,e),this.layers=[],this.options=t,this.webglLayer=t.webglLayer}return Wp(e,[{key:"addLayer",value:function(t){for(var e=!1,r=0;r<this.layers.length;r++)if(this.layers[r]===t){e=!0;break}e||(t.map=this.webglLayer.map,"threeLayer"===t.layerType?(t.setWebglLayer(this.webglLayer),e=t.getThreeLayer(),this.addLayer(e),t.initialize&&t.initialize(e)):(t.setWebglLayer(this.webglLayer),t.commonInitialize&&t.commonInitialize(this.webglLayer.gl),t.initialize&&t.initialize(this.webglLayer.gl),t.onOptionsChanged(t.getOptions(),{}),t.onDataChanged(t.getData()),t.onChanged(t.getOptions(),t.getData())),this.putInLayer(t)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(t){void 0===t.options.renderOrder&&(t.options.renderOrder=this.layers.length),this.layers.push(t),this.layers=this.layers.sort(function(t,e){return t.options.renderOrder-e.options.renderOrder})}},{key:"removeLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&this.layers.splice(e,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&t.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(t){for(var e=0;e<this.layers.length;e++)this.layers[e]===t&&t.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var t=0;t<this.layers.length;t++){var e=this.layers[t];e.destroy&&e.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var t=[],e=0;e<this.layers.length;e++){var r=this.layers[e];"ThreeLayer"===r.layerType&&t.push(r)}return t}},{key:"isRequestAnimation",value:function(){for(var t=!1,e=0;e<this.layers.length;e++)if(this.layers[e].isRequestAnimation()){t=!0;break}return t}},{key:"beforeRender",value:function(t){t.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(t){(t=t.gl)&&(t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.useProgram(null))}},{key:"renderGLLayers",value:function(t){this.webglLayer.stateManager.save();for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||(this.beforeRender(t),i.render(t),this.afterRender(t)))}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(t){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[t.gl.SRC_ALPHA,t.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:t.gl.LESS,cullFace:!1});for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"ThreeLayer"===i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||i.render(t))}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(t){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[t.gl.SRC_ALPHA,t.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:t.gl.LESS,cullFace:!1});for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"===i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<n[0]||r>=n[1])||i.render(t))}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onDblClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onDblClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onDblClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onRightClick",value:function(t){for(var e=0;e<this.layers.length;e++){var r,n,i=this.layers[e];!0===i._visible&&"threeLayer"!==i.layerType&&"ThreeLayer"!==i.layerType&&(r=i.map.getZoom(),(n=i.getOptions().zoomThreshold)&&(r<=n[0]||r>=n[1])||!i.options.enablePicked||!i.options.onRightClick||!i.pick||(r=i.pick(t.x,t.y),i.options.onRightClick(r,t),i.options.autoSelect&&this.webglLayer.render()))}}},{key:"onMousemove",value:function(t){for(var e=!1,r=0;r<this.layers.length;r++){var n,i,a=this.layers[r];!0===a._visible&&"threeLayer"!==a.layerType&&"ThreeLayer"!==a.layerType&&(n=a.map.getZoom(),(i=a.getOptions().zoomThreshold)&&(n<=i[0]||n>=i[1])||!a.options.enablePicked||!a.pick||(n=a.pick(t.x,t.y),this.webglLayer.map.map.platform.style.cursor=-1===n.dataIndex?"default":"pointer",a.options.onMousemove&&a.options.onMousemove(n,t),a.options.autoSelect&&(e=!0)))}e&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),e}();!function(){function n(t){var e=this;ju(this,n),this.options={autoUpdate:!0},this._visible=!0,Hu(this.options,t);var r=t.pointOffset;this.webglLayer=t.webglLayer||new zf(t.map,this.options),this.layerManager=new Uf({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new Rf(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(t){e._render(t)}),this.webglLayer.onClick=function(t){e._visible&&e.layerManager.onClick(t)},this.webglLayer.onDblClick=function(t){e._visible&&e.layerManager.onDblClick(t)},this.webglLayer.onRightClick=function(t){e._visible&&e.layerManager.onRightClick(t)},this.webglLayer.onMousemove=function(t){e._visible&&e.layerManager.onMousemove(t)},r||"cesium"===this.webglLayer.options.mapType||(r=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[r.lng,r.lat]),this.webglLayer.map.onResize(function(){e.effectManager.onResize()}),(this.postProcessing=t.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),t=this.postProcessing.getThreeLayer(),this.addLayer(t),this.postProcessing.initialize(t),t.postProcessing=this.postProcessing)}Wp(n,[{key:"renderCanvas",value:function(t){var e=this;this.postProcessing?this.postProcessing.addRender(function(){e.layerManager.renderGLLayers(t)}):this.layerManager.renderGLLayers(t),this.layerManager.renderThreeLayers(t),this.layerManager.renderThreeLayer(t)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(t){var e,r=this;this._visible&&((e=this.options.effects)&&0<e.length?(this.webglRender.render=function(){r.renderCanvas(t)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(t),this.webglLayer.restoreFramebuffer()))}},{key:"onRender",value:function(t){this.webglLayer.onRender(t)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){!0!==this._visible&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){!1!==this._visible&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(t){this.layerManager.showLayer(t)}},{key:"hideLayer",value:function(t){this.layerManager.hideLayer(t)}},{key:"add",value:function(t){this.addLayer(t)}},{key:"remove",value:function(t){this.removeLayer(t)}},{key:"addLayer",value:function(t){this.layerManager.addLayer(t)}},{key:"removeLayer",value:function(t){this.layerManager.removeLayer(t)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}])}();var kf=function(){function e(t){ju(this,e),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=Hu(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=Hu(this.options,t),this.options.data&&(this.data=this.options.data,delete this.options.data)}return Wp(e,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(t){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(t,e){e=e||{},this.data=t,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),e),!1!==e.autoRender&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(t,e){t=t||{},e=e||{};var r=Hu({},this.getOptions());Hu(this.options,t),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),r),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),e),t.data?(this.setData(t.data,e),delete t.data):!1!==e.autoRender&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(t,e){}},{key:"onDataChanged",value:function(t){}},{key:"onChanged",value:function(t,e){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(t,e){}},{key:"setWebglLayer",value:function(t){this.webglLayer=t}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),e}(),Hf=To("iterator"),Gf=Na.isIterable=function(t){return void 0!==(t=Object(t))[Hf]||"@@iterator"in t||oo.hasOwnProperty(Uo(t))},Vf=r(function(t){t.exports={default:Gf,__esModule:!0}});e(Vf);var Wf=Na.getIterator=function(t){var e=jo(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return La(e.call(t))},jf=r(function(t){t.exports={default:Wf,__esModule:!0}});e(jf);var Xf=e(r(function(t,e){e.__esModule=!0;var l=Vf&&Vf.__esModule?Vf:{default:Vf},u=jf&&jf.__esModule?jf:{default:jf};e.default=function(t,e){if(Array.isArray(t))return t;if((0,l.default)(Object(t))){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=(0,u.default)(t);!(n=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")}})),qf=function(t){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).layerType="ThreeLayer",t}return Zu(e,t),Wp(e,[{key:"initialize",value:function(t){this.getOptions();var e=this.webglLayer.map.map;"three"===this.webglLayer.map.type?(this.camera=e.camera,this.scene=e.scene):(this.camera=new Vp.PerspectiveCamera,this.scene=new Vp.Scene),this.world=new Vp.Group,this.scene.add(this.world),"three"!==this.webglLayer.map.type&&(this.camera.matrixAutoUpdate=!1,this.world.matrixAutoUpdate=!1,this.renderer=new Vp.WebGLRenderer({alpha:!0,antialias:!0,canvas:t.canvas,context:t}),this.renderer.autoClear=!1,this.renderer.outputEncoding=Vp.sRGBEncoding)}},{key:"_add",value:function(t,e){var r=this.getOptions();this.scene.add(t);var n=[0,0];!0===r.enabledPointOffset&&(n=this.getPointOffset()),e?((r=new Vp.Group).isGeoGroup=!0,r.object=t,r.point=e,r.add(t),r.position.x=e.lng-n[0],r.position.y=e.lat-n[1],r.position.z=t.position.z,this.world.add(r)):this.world.add(t)}},{key:"add",value:function(t,e){this._add(t,e),this.update()}},{key:"update",value:function(){this.webglLayer.render()}},{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getWorld",value:function(){return this.world}},{key:"updatePoint",value:function(t,e){for(var r,n=this.world.children,i=0;i<n.length;i++)n[i].isGeoGroup&&n[i].object===t&&((r=n[i]).position.x=e.lng,r.position.y=e.lat,r.position.z=t.position.z)}},{key:"remove",value:function(t){this.world.remove(t);for(var e=this.world.children,r=0;r<e.length;r++)e[r].children&&0<e[r].children.length&&e[r].children[0]===t&&this.world.remove(e[r]);this.update()}},{key:"updateCamera",value:function(){for(var t=this.world,e=this.map.getZoomUnits(),t=t.children,r=0;r<t.length;r++)t[r].point&&t[r].scale.set(e,e,e)}},{key:"render",value:function(t){var e,r,n=this.getOptions();t?this.webglLayer.map.map.camera||(this.updateCamera(),e=this.getPointOffset(),r=(new Vp.Matrix4).fromArray(t.viewMatrix),this.camera.projectionMatrix=(new Vp.Matrix4).fromArray(t.projectionMatrix),this.camera.projectionMatrixInverse.getInverse(this.camera.projectionMatrix),!0===n.enabledPointOffset?this.world.matrix=r:(t=(new Vp.Matrix4).makeTranslation(-e[0],-e[1],0),this.world.matrix=r.multiply(t)),this.renderer.state.reset(),this.postProcessing?this.postProcessing.render():this.renderer.render(this.scene,this.camera)):this.update()}}]),e}(function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).pickedColor=[-1,-1,-1],t}return Zu(e,kf),Wp(e,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(t){var e=this.getOptions();this.gl=t,e.enablePicked&&(this.pickBuffer=new Tf({gl:t,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var t=[];return this.getOptions().enablePicked&&t.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),t}},{key:"getProperty",value:function(t,e,r){return"[object Function]"===Object.prototype.toString.call(e)?e(r):(e=r[t]||e,e="properties"in r&&t in r.properties?r.properties[t]:e)}},{key:"normizedColor",value:function(t){var e=t;return void 0===(e=!(t instanceof Array)?Aa(t).unitArray():e)[3]&&(e[3]=1),e}},{key:"normizedPoint",value:function(t){var e=this.getPointOffset();if(!t||!t[0]||!t[1])return[e[0],e[1],0];var r=Number(t[0]),n=Number(t[1]);-180<=r&&r<=180&&-90<=n&&n<=90&&(r=(n=this.webglLayer.map.lnglatToMercator(r,n))[0],n=n[1]);var i=Number(t[2])||0;return this.webglLayer&&"cesium"===this.webglLayer.options.mapType&&window.Cesium?(r=this.convertLngLat([r,n]),r=(i=window.Cesium.Cartesian3.fromDegrees(r[0],r[1],i)).x,n=i.y,i=i.z):this.webglLayer&&"bmapgl"===this.webglLayer.options.mapType&&"B_EARTH_MAP"===this.webglLayer.map.map.mapType&&(r=this.convertLngLat([r,n]),r=(i=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:r[0],lat:r[1]})).x,n=i.y,i=i.z),3<t.length?[r-e[0],n-e[1],i].concat(jp(t.slice(3))):[r-e[0],n-e[1],i]}},{key:"convertLngLat",value:function(t){return[t[0]/20037508.34*180,180/Math.PI*(2*Math.atan(Math.exp(t[1]/20037508.34*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var t=[0,0],e=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?t=this.webglLayer.options.pointOffset:e.pointOffset&&(t=e.pointOffset),t}},{key:"indexToRgb",value:function(t){t++;var e=Math.floor(t/65536);t-=65536*e;var r=Math.floor(t/256);return[t-256*r,r,e]}},{key:"rgbToIndex",value:function(t){return t[0]+256*t[1]+65536*t[2]-1}},{key:"getCommonUniforms",value:function(t){t=t.isPickRender;var e,r=this.getOptions(),n={};return r.enablePicked&&(e=0<=r.selectedIndex?r.selectedIndex:-1,e=r.autoSelect?this.pickedColor:this.indexToRgb(e),n=Hu(n,{uSelectedColor:this.normizedColor(r.selectedColor),uEnablePicked:r.enablePicked,uPickedColor:e.map(function(t){return t/255}),uIsPickRender:!!t})),n}},{key:"pick",value:function(t,e){var r=this.gl,n=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:r,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var i=new Uint8Array(4);return r.readPixels(t*n,r.canvas.height-e*n,1,1,r.RGBA,r.UNSIGNED_BYTE,i),t=this.rgbToIndex(i),e=this.getData(),this.pickedColor=[i[0],i[1],i[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:t,dataItem:e[t]}}},{key:"setGLState",value:function(t){this.webglLayer.stateManager.setState(t)}},{key:"addMultipleCoords",value:function(t,e,r){if(!this.options.repeat||!this.webglLayer||"bmapgl"!==this.webglLayer.options.mapType||"B_EARTH_MAP"===this.webglLayer.map.map.mapType)return[t];var n=this.webglLayer.map.map;e=e||n.getZoom();var i=r?n.worldSize(e):40075452.74461451;if(e=function(t){return[[t[0]-i,t[1],t[2]||0],[t[0]+i,t[1],t[2]||0]]},t instanceof Array&&!(t[0]instanceof Array))return e=e(t),[t,(e=Xf(e,2))[0],e[1]];if(t instanceof Array&&t[0]instanceof Array&&!(t[0][0]instanceof Array)){r=[];for(var n=[],a=0;a<t.length;a++){var o=e(t[a]),s=(o=Xf(o,2))[1];r.push(o[0]),n.push(s)}return[t,r,n]}for(r=[],n=[],a=0;a<t.length;a++){o=[];for(var s=[],l=0;l<t[a].length;l++){var u=e(t[a][l]),c=(u=Xf(u,2))[1];o.push(u[0]),s.push(c)}r.push(o),n.push(s)}return[t,r,n]}}]),e}()),Yf=function(){function r(t){ju(this,r);var e=Xu(this,(r.__proto__||Iu(r)).call(this,t));return e.layerType="threeLayer",e.setOptions(t),e}return Zu(r,kf),Wp(r,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30]}}},{key:"setWebglLayer",value:function(t){t.threeLayer||(t.threeLayer=new qf({enabledPointOffset:!0,webglLayer:t})),this.threeLayer=t.threeLayer}},{key:"getPointOffset",value:function(){return this.threeLayer.getPointOffset()}},{key:"getThreeLayer",value:function(){return this.threeLayer}}]),r}(),Zf={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texel = texture2D( tDiffuse, vUv );\n\tgl_FragColor = opacity * texel;\n}"};function Jf(t,e){Ta.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof W?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=kh.clone(t.uniforms),this.material=new W({defines:Hu({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new Ta.FullScreenQuad(this.material)}function Kf(t,e){Ta.call(this),this.scene=t,this.camera=e,this.clear=!0,this.inverse=this.needsSwap=!1}function Qf(){Ta.call(this),this.needsSwap=!1}function $f(t,e){this.renderer=t,void 0===e?(e=t.getSize(new At),this._pixelRatio=t.getPixelRatio(),this._width=e.width,this._height=e.height,(e=new T(this._width*this._pixelRatio,this._height*this._pixelRatio,{minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1})).texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=e.width,this._height=e.height),this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Jf(Zf),this.clock=new Bi}function tm(t,e,r,n,i){Ta.call(this),this.scene=t,this.camera=e,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.needsSwap=this.clearDepth=!1}function em(t,e){Ta.call(this),this.edgesRT=new T(t,e,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1022}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new T(t,e,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1023}),this.weightsRT.texture.name="SMAAPass.weights";var r=this,n=new Image;n.src=this.getAreaTexture(),n.onload=function(){r.areaTexture.needsUpdate=!0},this.areaTexture=new d,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=n,this.areaTexture.format=1022,this.areaTexture.minFilter=1006,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1,(n=new Image).src=this.getSearchTexture(),n.onload=function(){r.searchTexture.needsUpdate=!0},this.searchTexture=new d,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=n,this.searchTexture.magFilter=1003,this.searchTexture.minFilter=1003,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=kh.clone(rm.uniforms),this.uniformsEdges.resolution.value.set(1/t,1/e),this.materialEdges=new W({defines:Hu({},rm.defines),uniforms:this.uniformsEdges,vertexShader:rm.vertexShader,fragmentShader:rm.fragmentShader}),this.uniformsWeights=kh.clone(im),this.uniformsWeights.resolution.value.set(1/t,1/e),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new W({defines:Hu({},nm),uniforms:this.uniformsWeights,vertexShader:"uniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[ 3 ];\nvarying vec2 vPixcoord;\nvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n\tvPixcoord = texcoord / resolution;\n\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );\n\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );\n\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n}\nvoid main() {\n\tvUv = uv;\n\tSMAABlendingWeightCalculationVS( vUv );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\nuniform sampler2D tDiffuse;\nuniform sampler2D tArea;\nuniform sampler2D tSearch;\nuniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[3];\nvarying vec2 vPixcoord;\n#if __VERSION__ == 100\nvec2 round( vec2 x ) {\n\treturn sign( x ) * floor( abs( x ) + 0.5 );\n}\n#endif\nfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n\te.r = bias + e.r * scale;\n\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n}\nfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\tvec2 e = vec2( 0.0, 1.0 );\n\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t}\n\ttexcoord.x += 0.25 * resolution.x;\n\ttexcoord.x += resolution.x;\n\ttexcoord.x += 2.0 * resolution.x;\n\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\treturn texcoord.x;\n}\nfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\tvec2 e = vec2( 0.0, 1.0 );\n\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t}\n\ttexcoord.x -= 0.25 * resolution.x;\n\ttexcoord.x -= resolution.x;\n\ttexcoord.x -= 2.0 * resolution.x;\n\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\treturn texcoord.x;\n}\nfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\tvec2 e = vec2( 1.0, 0.0 );\n\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution;\n\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t}\n\ttexcoord.y -= 0.25 * resolution.y;\n\ttexcoord.y -= resolution.y;\n\ttexcoord.y -= 2.0 * resolution.y;\n\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );\n\treturn texcoord.y;\n}\nfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\tvec2 e = vec2( 1.0, 0.0 );\n\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;\n\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t}\n\ttexcoord.y += 0.25 * resolution.y;\n\ttexcoord.y += resolution.y;\n\ttexcoord.y += 2.0 * resolution.y;\n\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );\n\treturn texcoord.y;\n}\nvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\treturn texture2D( areaTex, texcoord, 0.0 ).rg;\n}\nvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\tvec2 e = texture2D( edgesTex, texcoord ).rg;\n\tif ( e.g > 0.0 ) {\n\t\tvec2 d;\n\t\tvec2 coords;\n\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n\t\tcoords.y = offset[ 1 ].y;\n\t\td.x = coords.x;\n\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n\t\td.y = coords.x;\n\t\td = d / resolution.x - pixcoord.x;\n\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\t\tcoords.y -= 1.0 * resolution.y;\n\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n\t}\n\tif ( e.r > 0.0 ) {\n\t\tvec2 d;\n\t\tvec2 coords;\n\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n\t\tcoords.x = offset[ 0 ].x;\n\t\td.x = coords.y;\n\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n\t\td.y = coords.y;\n\t\td = d / resolution.y - pixcoord.y;\n\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\t\tcoords.y -= 1.0 * resolution.y;\n\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\t}\n\treturn weights;\n}\nvoid main() {\n\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );\n}"}),this.uniformsBlend=kh.clone(am),this.uniformsBlend.resolution.value.set(1/t,1/e),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new W({uniforms:this.uniformsBlend,vertexShader:"uniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[ 2 ];\nvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );\n\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );\n}\nvoid main() {\n\tvUv = uv;\n\tSMAANeighborhoodBlendingVS( vUv );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform sampler2D tColor;\nuniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[ 2 ];\nvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n\tvec4 a;\n\ta.xz = texture2D( blendTex, texcoord ).xz;\n\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n\t\treturn texture2D( colorTex, texcoord, 0.0 );\n\t} else {\n\t\tvec2 offset;\n\t\toffset.x = a.a > a.b ? a.a : -a.b;\n\t\toffset.y = a.g > a.r ? -a.g : a.r;\n\t\tif ( abs( offset.x ) > abs( offset.y )) {\n\t\t\toffset.y = 0.0;\n\t\t} else {\n\t\t\toffset.x = 0.0;\n\t\t}\n\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );\n\t\ttexcoord += sign( offset ) * resolution;\n\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\tvec4 mixed = mix(C, Cop, s);\n\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\t\treturn mixed;\n\t}\n}\nvoid main() {\n\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );\n}"}),this.needsSwap=!1,this.fsQuad=new Ta.FullScreenQuad(null)}Hu(Ta.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Ta.FullScreenQuad=function(){function t(t){this._mesh=new V(r,t)}var e=new vi(-1,1,1,-1,0,1),r=new K(2,2);return Object.defineProperty(t.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Hu(t.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),t}(),Jf.prototype=Hu(Uu(Ta.prototype),{constructor:Jf,render:function(t,e,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil)),this.fsQuad.render(t)}}),Kf.prototype=Hu(Uu(Ta.prototype),{constructor:Kf,render:function(t,e,r){var n,i,a=t.getContext(),o=t.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),i=this.inverse?(n=0,1):(n=1,0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,n,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),t.setRenderTarget(r),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}}),Qf.prototype=Uu(Ta.prototype),Hu(Qf.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}),Hu($f.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},isLastEnabledPass:function(t){for(t+=1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());for(var e=this.renderer.getRenderTarget(),r=!1,n=this.passes.length,i=0;i<n;i++){var a,o,s=this.passes[i];!1!==s.enabled&&(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),s.render(this.renderer,this.writeBuffer,this.readBuffer,t,r),s.needsSwap&&(r&&(a=this.renderer.getContext(),(o=this.renderer.state.buffers.stencil).setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.setFunc(a.EQUAL,1,4294967295)),this.swapBuffers()),s instanceof Kf?r=!0:s instanceof Qf&&(r=!1))}this.renderer.setRenderTarget(e)},reset:function(t){void 0===t&&(t=this.renderer.getSize(new At),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this._width=t,this._height=e,t=this._width*this._pixelRatio,e=this._height*this._pixelRatio,this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(t,e)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}),Hu((Rl=function(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1}).prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Rl.FullScreenQuad=function(){function t(t){this._mesh=new V(r,t)}var e=new vi(-1,1,1,-1,0,1),r=new K(2,2);return Object.defineProperty(t.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Hu(t.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),t}(),tm.prototype=Hu(Uu(Ta.prototype),{constructor:tm,render:function(t,e,r){var n,i,a;e=t.autoClear,t.autoClear=!1,void 0!==this.overrideMaterial&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(i=t.getClearColor().getHex(),a=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(i,a),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=n),t.autoClear=e}});var rm={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new At(1/1024,1/512)}},vertexShader:"uniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[ 3 ];\nvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );\n\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );\n\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );\n}\nvoid main() {\n\tvUv = uv;\n\tSMAAEdgeDetectionVS( vUv );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvarying vec4 vOffset[ 3 ];\nvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\tvec4 delta;\n\tvec3 C = texture2D( colorTex, texcoord ).rgb;\n\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n\tvec3 t = abs( C - Cleft );\n\tdelta.x = max( max( t.r, t.g ), t.b );\n\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n\tt = abs( C - Ctop );\n\tdelta.y = max( max( t.r, t.g ), t.b );\n\tvec2 edges = step( threshold, delta.xy );\n\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n\t\tdiscard;\n\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n\tt = abs( C - Cright );\n\tdelta.z = max( max( t.r, t.g ), t.b );\n\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n\tt = abs( C - Cbottom );\n\tdelta.w = max( max( t.r, t.g ), t.b );\n\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n\tt = abs( C - Cleftleft );\n\tdelta.z = max( max( t.r, t.g ), t.b );\n\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n\tt = abs( C - Ctoptop );\n\tdelta.w = max( max( t.r, t.g ), t.b );\n\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );\n\tedges.xy *= step( 0.5 * maxDelta, delta.xy );\n\treturn vec4( edges, 0.0, 0.0 );\n}\nvoid main() {\n\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );\n}"},nm={SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},im={tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new At(1/1024,1/512)}},am={tDiffuse:{value:null},tColor:{value:null},resolution:{value:new At(1/1024,1/512)}};function om(t,e,r,n){Ta.call(this),this.strength=void 0!==e?e:1,this.radius=r,this.threshold=n,this.resolution=void 0!==t?new At(t.x,t.y):new At(256,256),this.clearColor=new U(0,0,0);var i={minFilter:1006,magFilter:1006,format:1023};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5,t=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2),this.renderTargetBright=new T(t,r,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var a=0;a<this.nMips;a++){var o=new T(t,r,i);o.texture.name="UnrealBloomPass.h"+a,o.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(o),(o=new T(t,r,i)).texture.name="UnrealBloomPass.v"+a,o.texture.generateMipmaps=!1,this.renderTargetsVertical.push(o),t=Math.round(t/2),r=Math.round(r/2)}for(this.highPassUniforms=kh.clone(sm.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new W({uniforms:this.highPassUniforms,vertexShader:sm.vertexShader,fragmentShader:sm.fragmentShader,defines:{}}),this.separableBlurMaterials=[],n=[3,5,7,9,11],t=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2),a=0;a<this.nMips;a++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(n[a])),this.separableBlurMaterials[a].uniforms.texSize.value=new At(t,r),t=Math.round(t/2),r=Math.round(r/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Mt(1,1,1),new Mt(1,1,1),new Mt(1,1,1),new Mt(1,1,1),new Mt(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.copyUniforms=kh.clone(Zf.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new W({uniforms:this.copyUniforms,vertexShader:Zf.vertexShader,fragmentShader:Zf.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new U,this.oldClearAlpha=1,this.basic=new H,this.fsQuad=new Ta.FullScreenQuad(null)}em.prototype=Hu(Uu(Ta.prototype),{constructor:em,render:function(t,e,r){this.uniformsEdges.tDiffuse.value=r.texture,this.fsQuad.material=this.materialEdges,t.setRenderTarget(this.edgesRT),this.clear&&t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialWeights,t.setRenderTarget(this.weightsRT),this.clear&&t.clear(),this.fsQuad.render(t),this.uniformsBlend.tColor.value=r.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(e),this.clear&&t.clear()),this.fsQuad.render(t)},setSize:function(t,e){this.edgesRT.setSize(t,e),this.weightsRT.setSize(t,e),this.materialEdges.uniforms.resolution.value.set(1/t,1/e),this.materialWeights.uniforms.resolution.value.set(1/t,1/e),this.materialBlend.uniforms.resolution.value.set(1/t,1/e)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var sm={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new U(0)},defaultOpacity:{value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec3 defaultColor;\nuniform float defaultOpacity;\nuniform float luminosityThreshold;\nuniform float smoothWidth;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texel = texture2D( tDiffuse, vUv );\n\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\tfloat v = dot( texel.xyz, luma );\n\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\tgl_FragColor = mix( outputColor, texel, alpha );\n}"};om.prototype=Hu(Uu(Ta.prototype),{constructor:om,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,e){t=Math.round(t/2),e=Math.round(e/2),this.renderTargetBright.setSize(t,e);for(var r=0;r<this.nMips;r++)this.renderTargetsHorizontal[r].setSize(t,e),this.renderTargetsVertical[r].setSize(t,e),this.separableBlurMaterials[r].uniforms.texSize.value=new At(t,e),t=Math.round(t/2),e=Math.round(e/2)},render:function(t,e,r,n,i){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),e=t.autoClear,t.autoClear=!1,t.setClearColor(this.clearColor,0),i&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t),n=this.renderTargetBright;for(var a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=n.texture,this.separableBlurMaterials[a].uniforms.direction.value=om.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[a]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=om.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[a]),t.clear(),this.fsQuad.render(t),n=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(r),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=e},getSeperableBlurMaterial:function(t){return new W({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new At(.5,.5)},direction:{value:new At(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(t){return new W({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),om.BlurDirectionX=new At(1,0),om.BlurDirectionY=new At(0,1),gs=function(){function e(t){return ju(this,e),Xu(this,(e.__proto__||Iu(e)).call(this,t))}return Zu(e,Yf),Wp(e,[{key:"initialize",value:function(t){var e=t.camera,r=t.renderer;if(!this._initialize){if(this.scene=t.scene,this.camera=e,this.renderer=r,t=this.options.passes,this._initialize=!0,this.renderScene=new tm(this.scene,this.camera),(e=new $f(this.renderer)).addPass(this.renderScene),this.passes=[],t)for(var n=0;n<t.length;n++){var i=t[n],a=void 0;switch(i.name){case"unrealBloom":var a=i.strength||1,o=i.radius||0,s=i.threshold||.5;a=new om(new Vp.Vector2(window.innerWidth,window.innerHeight),a,o,s);break;case"SMAA":a=new em(window.innerWidth*r.getPixelRatio(),window.innerHeight*r.getPixelRatio())}if(a){for(var l in i)a[l]=i[l];e.addPass(a)}}this.composer=e}}},{key:"addRender",value:function(t){this.renderScene&&this.renderScene.addRender(t)}},{key:"render",value:function(){this.composer.render(this.scene,this.camera)}}]),e}(),om.prototype.getSeperableBlurMaterial=function(t){return new Vp.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new Vp.Vector2(.5,.5)},direction:{value:new Vp.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }",fragmentShader:"#include <common>            varying vec2 vUv;\n            uniform sampler2D colorTexture;\n            uniform vec2 texSize;            uniform vec2 direction;                        float gaussianPdf(in float x, in float sigma) {                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;            }            void main() {\n                vec2 invSize = 1.0 / texSize;                float fSigma = float(SIGMA);                float weightSum = gaussianPdf(0.0, fSigma);                vec4 diffuseSum = texture2D( colorTexture, vUv).rgba * weightSum;                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {                    float x = float(i);                    float w = gaussianPdf(x, fSigma);                    vec2 uvOffset = direction * invSize * x;                    vec4 sample1 = texture2D( colorTexture, vUv + uvOffset).rgba;                    vec4 sample2 = texture2D( colorTexture, vUv - uvOffset).rgba;                    diffuseSum += (sample1 + sample2) * w;                    weightSum += 2.0 * w;                }                gl_FragColor = vec4(diffuseSum/weightSum);\n            }"})},tm.prototype.addRender=function(t){this.renderCbk=t},tm.prototype.render=function(t,e,r){var n,i;e=t.autoClear,t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(n=t.getClearColor().getHex(),i=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.renderCbk&&this.renderCbk(),this.clearColor&&t.setClearColor(n,i),this.scene.overrideMaterial=null,t.autoClear=e};var cs=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).time=0,t.autoUpdate=!0,t}return Zu(e,Yf),Wp(e,[{key:"getDefaultOptions",value:function(){return{totalRadian:Math.PI,color:16711680,radius:50,step:.1}}},{key:"initialize",value:function(t){this.threeLayer=t,this.addOverlay()}},{key:"onChanged",value:function(t,e){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){this.time+=this.options.step/10,1<this.time&&(this.time=0);for(var t=this.shapeMarker.children,e=0;e<t.length;e++)t[e].material.uniforms.periodRatio.value=this.time}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.shapeMarker)}},{key:"addOverlay",value:function(){this.shapeMarker=new Vp.Group;for(var t=this.threeLayer,e=this.getData(),r=0;r<e.length;r++){var n=t.normizedPoint(e[r].geometry.coordinates),n=this.create3dCanvasRipple({originalData:e[r],normizedData:n});this.shapeMarker.add(n)}t.add(this.shapeMarker)}},{key:"create3dCanvasRipple",value:function(t){var e=(n=this.options).totalRadian,r=n.color,n=n.size,i=t.originalData;t=t.normizedData,"[object Function]"===Object.prototype.toString.call(r)&&(r=r(i)),n="[object Function]"===Object.prototype.toString.call(n)?n(i):Number(n);for(var i={totalRadian:{type:"f",value:e},glowColor:{type:"c",value:new Vp.Color(r)},radius:{type:"f",value:n},periodRatio:{type:"f",value:0}},r=new Vp.Geometry,a=e/(n/2),o=a;o<=e;o+=a){var s=n*Math.sin(o),l=n*Math.cos(o);r.vertices.push(new Vp.Vector3(0,0,o/e)),r.vertices.push(new Vp.Vector3(l,s,o/e))}for(e=0,n=r.vertices.length;e<n-2;++e)r.faces.push(new Vp.Face3(e,e+1,e+3));return e=new Vp.ShaderMaterial({uniforms:i,vertexShader:"varying vec4 vFragColor;varying vec4 vPosition;uniform float radius;uniform float totalRadian;uniform float periodRatio;uniform vec3 glowColor;void main(){float radian=radians(360.0*periodRatio);float s=sin(radian);float c=cos(radian);vec2 rotatedPostion=vec2(position.x*s+position.y*c,position.y*s-position.x*c);gl_Position=projectionMatrix*modelViewMatrix*vec4(rotatedPostion,0,1.0);vFragColor=vec4(glowColor,pow(position.z,1.3));}",fragmentShader:"varying vec4 vFragColor;void main(){gl_FragColor=vFragColor;}",blending:Vp.NormalBlending,transparent:!0,depthWrite:!1}),(e=new Vp.Mesh(r,e)).position.set(t[0],t[1],t[2]||0),e}}]),e}(),lm=(Rl=r(function(r,n){!function(){function t(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new g.BufferGeometry,this.widthCallback=null,this.matrixWorld=new g.Matrix4}function i(t,e,r,n,i){if(t=t.subarray||t.slice?t:t.buffer,r=r.subarray||r.slice?r:r.buffer,t=e?t.subarray?t.subarray(e,i&&e+i):t.slice(e,i&&e+i):t,r.set)r.set(t,n);else for(e=0;e<t.length;e++)r[e+n]=t[e];return r}function e(t){g.ShaderMaterial.call(this,{uniforms:Hu({},g.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new g.Color(16777215)},opacity:{value:1},resolution:{value:new g.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new g.Vector2(1,1)}}),vertexShader:g.ShaderChunk.meshline_vert,fragmentShader:g.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",ku(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(t){this.uniforms.map.value=t}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(t){this.uniforms.useMap.value=t}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(t){this.uniforms.alphaMap.value=t}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(t){this.uniforms.useAlphaMap.value=t}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(t){this.uniforms.color.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(t){this.uniforms.sizeAttenuation.value=t}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(t){this.uniforms.near.value=t}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(t){this.uniforms.far.value=t}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(t){this.uniforms.dashArray.value=t,this.useDash=0!==t?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(t){this.uniforms.dashRatio.value=t}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(t){this.uniforms.useDash.value=t}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(t){this.uniforms.visibility.value=t}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(t){this.uniforms.alphaTest.value=t}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(t){this.uniforms.repeat.value.copy(t)}}}),this.setValues(t)}var p,f,m,g=Au||this.THREE;if(!g)throw Error("MeshLine requires three.js");t.prototype.setMatrixWorld=function(t){this.matrixWorld=t},t.prototype.setGeometry=function(t,e){if(this.widthCallback=e,this.positions=[],this.counters=[],t instanceof g.Geometry)for(var r=0;r<t.vertices.length;r++){var n=t.vertices[r];e=r/t.vertices.length,this.positions.push(n.x,n.y,n.z),this.positions.push(n.x,n.y,n.z),this.counters.push(e),this.counters.push(e)}if(t instanceof Float32Array||t instanceof Array)for(r=0;r<t.length;r+=3)e=r/t.length,this.positions.push(t[r],t[r+1],t[r+2]),this.positions.push(t[r],t[r+1],t[r+2]),this.counters.push(e),this.counters.push(e);this.process()},t.prototype.raycast=(p=new g.Matrix4,f=new g.Ray,m=new g.Sphere,function(t,e){var r=t.linePrecision;if(r*=r,null===(c=this.geometry).boundingSphere&&c.computeBoundingSphere(),m.copy(c.boundingSphere),m.applyMatrix4(this.matrixWorld),!1!==t.ray.intersectSphere(m)){p.getInverse(this.matrixWorld),f.copy(t.ray).applyMatrix4(p);var n=new g.Vector3,i=new g.Vector3,a=new g.Vector3,o=new g.Vector3,s=this instanceof g.LineSegments?2:1;if(c instanceof g.BufferGeometry){var l=c.index,u=c.attributes;if(null!==l)for(var c=l.array,u=u.position.array,l=0,h=c.length-1;l<h;l+=s){var d=c[l+1];n.fromArray(u,3*c[l]),i.fromArray(u,3*d),r<(d=f.distanceSqToSegment(n,i,o,a))||(o.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(o))<t.near||d>t.far||e.push({distance:d,point:a.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}else for(l=0,h=(u=u.position.array).length/3-1;l<h;l+=s)n.fromArray(u,3*l),i.fromArray(u,3*l+3),r<(d=f.distanceSqToSegment(n,i,o,a))||(o.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(o))<t.near||d>t.far||e.push({distance:d,point:a.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}else if(c instanceof g.Geometry)for(i=(n=c.vertices).length,l=0;l<i-1;l+=s)r<(d=f.distanceSqToSegment(n[l],n[l+1],o,a))||(o.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(o))<t.near||d>t.far||e.push({distance:d,point:a.clone().applyMatrix4(this.matrixWorld),index:l,face:null,faceIndex:null,object:this}))}}),t.prototype.compareV3=function(t,e){return t*=6,e*=6,this.positions[t]===this.positions[e]&&this.positions[t+1]===this.positions[e+1]&&this.positions[t+2]===this.positions[e+2]},t.prototype.copyV3=function(t){return t*=6,[this.positions[t],this.positions[t+1],this.positions[t+2]]},t.prototype.process=function(){var t=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var e=0;e<t;e++)this.side.push(1),this.side.push(-1);for(e=0;e<t;e++){var r=this.widthCallback?this.widthCallback(e/(t-1)):1;this.width.push(r),this.width.push(r)}for(e=0;e<t;e++)this.uvs.push(e/(t-1),0),this.uvs.push(e/(t-1),1);for(r=this.compareV3(0,t-1)?this.copyV3(t-2):this.copyV3(0),this.previous.push(r[0],r[1],r[2]),this.previous.push(r[0],r[1],r[2]),e=0;e<t-1;e++)r=this.copyV3(e),this.previous.push(r[0],r[1],r[2]),this.previous.push(r[0],r[1],r[2]);for(e=1;e<t;e++)r=this.copyV3(e),this.next.push(r[0],r[1],r[2]),this.next.push(r[0],r[1],r[2]);for(r=this.compareV3(t-1,0)?this.copyV3(1):this.copyV3(t-1),this.next.push(r[0],r[1],r[2]),this.next.push(r[0],r[1],r[2]),e=0;e<t-1;e++)r=2*e,this.indices_array.push(r,r+1,r+2),this.indices_array.push(r+2,r+1,r+3);this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new g.BufferAttribute(new Float32Array(this.positions),3),previous:new g.BufferAttribute(new Float32Array(this.previous),3),next:new g.BufferAttribute(new Float32Array(this.next),3),side:new g.BufferAttribute(new Float32Array(this.side),1),width:new g.BufferAttribute(new Float32Array(this.width),1),uv:new g.BufferAttribute(new Float32Array(this.uvs),2),index:new g.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new g.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},t.prototype.advance=function(t){var e=this.attributes.position.array,r=this.attributes.next.array,n=e.length;i(e,0,this.attributes.previous.array,0,n),i(e,6,e,0,n-6),e[n-6]=t.x,e[n-5]=t.y,e[n-4]=t.z,e[n-3]=t.x,e[n-2]=t.y,e[n-1]=t.z,i(e,6,r,0,n-6),r[n-6]=t.x,r[n-5]=t.y,r[n-4]=t.z,r[n-3]=t.x,r[n-2]=t.y,r[n-1]=t.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},g.ShaderChunk.meshline_vert=["",g.ShaderChunk.logdepthbuf_pars_vertex,g.ShaderChunk.fog_pars_vertex,"\r\nattribute vec3 previous;\r\nattribute vec3 next;\r\nattribute float side;\r\nattribute float width;\r\nattribute float counters;\r\n\r\nuniform vec2 resolution;\r\nuniform float lineWidth;\r\nuniform vec3 color;\r\nuniform float opacity;\r\nuniform float near;\r\nuniform float far;\r\nuniform float sizeAttenuation;\r\n\r\nvarying vec2 vUV;\r\nvarying vec4 vColor;\r\nvarying float vCounters;\r\n\r\nvec2 fix( vec4 i, float aspect ) {\r\n\r\n    vec2 res = i.xy / i.w;\r\n    res.x *= aspect;\r\n\t vCounters = counters;\r\n    return res;\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n    float aspect = resolution.x / resolution.y;\r\n    float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\r\n\r\n    vColor = vec4( color, opacity );\r\n    vUV = uv;\r\n\r\n    mat4 m = projectionMatrix * modelViewMatrix;\r\n    vec4 finalPosition = m * vec4( position, 1.0 );\r\n    vec4 prevPos = m * vec4( previous, 1.0 );\r\n    vec4 nextPos = m * vec4( next, 1.0 );\r\n\r\n    vec2 currentP = fix( finalPosition, aspect );\r\n    vec2 prevP = fix( prevPos, aspect );\r\n    vec2 nextP = fix( nextPos, aspect );\r\n\r\n    float pixelWidth = finalPosition.w * pixelWidthRatio;\r\n    float w = 1.8 * pixelWidth * lineWidth * width;\r\n\r\n    if( sizeAttenuation == 1. ) {\r\n        w = 1.8 * lineWidth * width;\r\n    }\r\n\r\n    vec2 dir;\r\n    if( nextP == currentP ) dir = normalize( currentP - prevP );\r\n    else if( prevP == currentP ) dir = normalize( nextP - currentP );\r\n    else {\r\n        vec2 dir1 = normalize( currentP - prevP );\r\n        vec2 dir2 = normalize( nextP - currentP );\r\n        dir = normalize( dir1 + dir2 );\r\n\r\n        vec2 perp = vec2( -dir1.y, dir1.x );\r\n        vec2 miter = vec2( -dir.y, dir.x );\r\n        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );\r\n\r\n    }\r\n\r\n    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;\r\n    vec2 normal = vec2( -dir.y, dir.x );\r\n    normal.x /= aspect;\r\n    normal *= .5 * w;\r\n\r\n    vec4 offset = vec4( normal * side, 0.0, 1.0 );\r\n    finalPosition.xy += offset.xy;\r\n\r\n    gl_Position = finalPosition;\r\n",g.ShaderChunk.logdepthbuf_vertex,g.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",g.ShaderChunk.fog_vertex,"}"].join("\r\n"),g.ShaderChunk.meshline_frag=["",g.ShaderChunk.fog_pars_fragment,g.ShaderChunk.logdepthbuf_pars_fragment,"\r\nuniform sampler2D map;\r\nuniform sampler2D alphaMap;\r\nuniform float useMap;\r\nuniform float useAlphaMap;\r\nuniform float useDash;\r\nuniform float dashArray;\r\nuniform float dashOffset;\r\nuniform float dashRatio;\r\nuniform float visibility;\r\nuniform float alphaTest;\r\nuniform vec2 repeat;\r\n\r\nvarying vec2 vUV;\r\nvarying vec4 vColor;\r\nvarying float vCounters;\r\n\r\nvoid main() {\r\n",g.ShaderChunk.logdepthbuf_fragment,"\r\n    vec4 c = vColor;\r\n    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );\r\n    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;\r\n    if( c.a < alphaTest ) discard;\r\n    if( useDash == 1. ){\r\n        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\r\n    }\r\n    gl_FragColor = c;\r\n    gl_FragColor.a *= step(vCounters, visibility);\r\n",g.ShaderChunk.fog_fragment,"}"].join("\r\n"),((e.prototype=Uu(g.ShaderMaterial.prototype)).constructor=e).prototype.isMeshLineMaterial=!0,e.prototype.copy=function(t){return g.ShaderMaterial.prototype.copy.call(this,t),this.lineWidth=t.lineWidth,this.map=t.map,this.useMap=t.useMap,this.alphaMap=t.alphaMap,this.useAlphaMap=t.useAlphaMap,this.color.copy(t.color),this.opacity=t.opacity,this.resolution.copy(t.resolution),this.sizeAttenuation=t.sizeAttenuation,this.near=t.near,this.far=t.far,this.dashArray.copy(t.dashArray),this.dashOffset.copy(t.dashOffset),this.dashRatio.copy(t.dashRatio),this.useDash=t.useDash,this.visibility=t.visibility,this.alphaTest=t.alphaTest,this.repeat.copy(t.repeat),this},(n=r.exports?r.exports={MeshLine:t,MeshLineMaterial:e}:n).MeshLine=t,n.MeshLineMaterial=e}.call(Fa)})).MeshLine,um=Rl.MeshLineMaterial,Rl=function(){function e(t){return ju(this,e),(t=Xu(this,(e.__proto__||Iu(e)).call(this,t))).staticDashArray=2,t.time=0,t.autoUpdate=!0,t}return Zu(e,Yf),Wp(e,[{key:"getDefaultOptions",value:function(){return{color:16777215,textureColor:16777215,textureWidth:10,textureLength:30,step:.1}}},{key:"initialize",value:function(t){this.threeLayer=t,this.addOverlay()}},{key:"onChanged",value:function(t,e){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){var t=(r=this.getOptions()).textureWidth,e=r.style,r=r.step/10;this.time+=r,2<this.time&&(this.time=0);for(var n=this.flyLine.children,i=0;i<n.length;i++){var a=n[i],o=a.hash;a.children[0].material.uniforms.lineWidth.value=t*(1+.2*Math.sin(5*this.time)),a.children[0].material.uniforms.dashOffset.value="chaos"===e?a.children[0].material.uniforms.dashOffset.value-r:(this.staticDashArray+o)*(1-this.time/2)}}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.flyLine)}},{key:"addOverlay",value:function(){var n=this;this.flyLine=new Vp.Group;var i=this.threeLayer,t=new Vp.TextureLoader,a=this.getData();t.load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAQAAAD/AkAkAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBA3y7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BUNTVQYqg4jIKAX08EGIIUByaVEZhMXIwMDAIMCgxeDHUMmwiuEBozRjFOM8xqdMhkwNTJeYNZgbme+y2LDMY2VmzWa9yubEtoldhX0mhwBHJycrZzMXM1cbNzf3RB4pnqW8xryH+IL5nvFXCwgJrBZ0E3wk1CisKHxYJF2UV3SrWJw4p/hWiRRJYcmjUhXSutJPZObIhsoJyp2V71HwUeRVvKA0RTlKRUnltepWtUZ1Pw1Zjbea+7QmaqfqWOsK6b7SO6I/36DGMMrI0ljS+LfJPdPDZivM+y0qLBOtfKwtbFRtRexY7L7aP3e47XjB6ZjzXpetruvdVrov9VjkudBrgfdCn8W+y/xW+a8P2Bq4N+hY8PmQW6HPwr5EMEUKRilFG8e4xUbF5cW3JMxO3Jx0Nvl5KlOaXLpNRlRmVdas7D059/KY8tULfAqLi2YXHy55WyZR7lJRWDmv6mz131q9uvj6SQ3HGn83G7Skt85ru94h2Ond1d59uJehz76/bsK+if8nO05pnXpiOu+M4JmzZj2aozW3ZN6+BVwLwxYtXvxxqcOyCcsfrjRe1br65lrddU3rb2402NSx+cFWq21Tt3/Y6btr1R6Oven7jh9QP9h56PURv6Obj4ufqD355LT3mS3nZM+3X/h0Ke7yqasW15bdEL3ZeuvrnfS7N+/7PDjwyPTx6qeKz2a+EHzZ9Zr5Td3bn+9LP3z6VPD53de8b+9+5P/88Lv4z7d/Vf//AwAqvx2K829RWwAAOGtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTktMDYtMjdUMTk6MzE6MTUrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOS0wOC0xOVQxNjo1Nzo1MCswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTktMDgtMTlUMTY6NTc6NTArMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjE8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDxwaG90b3Nob3A6SUNDUHJvZmlsZT5Eb3QgR2FpbiAxNSU8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjQ5MmI1NTQ1LWIwNmQtNGI0Yi1iMWExLTZiN2NiNzExNzA5MjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NDkyYjU1NDUtYjA2ZC00YjRiLWIxYTEtNmI3Y2I3MTE3MDkyPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE5LTA2LTI3VDE5OjMxOjE1KzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoTWFjaW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0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",function(t){for(var e=0;e<a.length;e++){var r=a[e].geometry.coordinates.map(function(t){return new(Function.prototype.bind.apply(Vp.Vector3,[null].concat(jp(i.normizedPoint(t)))))}),r=n.createFlyLine({originalData:a[e],curveData:r,texture:t});n.flyLine.add(r)}i.add(n.flyLine)})}},{key:"createFlyLine",value:function(t){var e=(s=this.options).color,r=s.textureColor,n=s.textureWidth,i=t.originalData,a=t.curveData;t=t.texture;var o=Math.random(),s=Math.min(1,1-s.textureLength/100);s=Math.max(0,s),"[object Function]"===Object.prototype.toString.call(e)&&(e=e(i)),"[object Function]"===Object.prototype.toString.call(r)&&(r=r(i)),(i=new Vp.Geometry).vertices=a,i.verticesNeedUpdate=!0,e=new Vp.LineBasicMaterial({linewidth:1,color:new Vp.Color(e),blending:Vp.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.3,linecap:"round",linejoin:"round"}),(e=new Vp.Line(i,e)).renderDepth=!1,e.hash=o;for(var i=new lm,l=new Vp.Geometry,u=0;u<a.length;u++){var c=a[u];l.vertices.push(new Vp.Vector3(c.x,c.y,c.z))}return i.setGeometry(l,function(t){return 1-t}),r=new um({map:t,useMap:!0,color:new Vp.Color(r),opacity:1,dashArray:this.staticDashArray+o,dashOffset:0,dashRatio:s,sizeAttenuation:!0,lineWidth:n,depthWrite:!1,depthTest:!0,alphaTest:!1,transparent:!0,blending:Vp.AdditiveBlending,side:Vp.DoubleSide}),r=new Vp.Mesh(i.geometry,r),e.add(r),e}}]),e}();t.THREE=Vp,t.PostProcessing=gs,t.FanLayer=cs,t.FlyLineLayer=Rl,t.ThreeLayer=qf,Object.defineProperty(t,"__esModule",{value:!0})}(e)}.call(this,r(18))},function(t,e,r){"use strict";var n=r(7),i=r(4);e.a=function(t){return!!Object(i.a)(t)&&("[object Function]"==(t=Object(n.a)(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},function(t,i,a){"use strict";!function(t){var e=a(3),r=a(46),n="object"==typeof exports&&exports&&!exports.nodeType&&exports,t=n&&"object"==typeof t&&t&&!t.nodeType&&t,e=t&&t.exports===n?e.a.Buffer:void 0,r=(e?e.isBuffer:void 0)||r.a;i.a=r}.call(this,a(41)(t))},function(t,e,r){"use strict";var n=Object.prototype;e.a=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,r){"use strict";r=r(32),r=Object(r.a)(Object.getPrototypeOf,Object);e.a=r},function(t,e,r){"use strict";var n=r(27);e.a=function(t,e,r){"__proto__"==e&&n.a?Object(n.a)(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},function(t,e,r){"use strict";e.a=function(e){return function(t){return e(t)}}},function(t,e,r){"use strict";var n=r(3).a.Uint8Array;e.a=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},function(t,e,r){"use strict";var n=r(6),r=function(){try{var t=Object(n.a)(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.a=r},function(t,e,r){"use strict";var n=r(7),i=r(5);var a=function(t){return Object(i.a)(t)&&"[object Arguments]"==Object(n.a)(t)},r=Object.prototype,o=r.hasOwnProperty,s=r.propertyIsEnumerable,a=a(function(){return arguments}())?a:function(t){return Object(i.a)(t)&&o.call(t,"callee")&&!s.call(t,"callee")};e.a=a},function(t,e,r){"use strict";e.a=function(t,e){var r=-1,n=t.length;for(e=e||Array(n);++r<n;)e[r]=t[r];return e}},function(t,e,r){"use strict";!function(t){t="object"==typeof t&&t&&t.Object===Object&&t;e.a=t}.call(this,r(18))},function(t,i,a){"use strict";!function(t){var e=a(3),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,t=r&&"object"==typeof t&&t&&!t.nodeType&&t,e=t&&t.exports===r?e.a.Buffer:void 0,n=e?e.allocUnsafe:void 0;i.a=function(t,e){return e?t.slice():(e=t.length,e=n?n(e):new t.constructor(e),t.copy(e),e)}}.call(this,a(41)(t))},function(t,e,r){"use strict";e.a=function(e,r){return function(t){return e(r(t))}}},function(t,e,r){"use strict";var i=r(24),a=r(15),o=Object.prototype.hasOwnProperty;e.a=function(t,e,r){var n=t[e];o.call(t,e)&&Object(a.a)(n,r)&&(void 0!==r||e in t)||Object(i.a)(t,e,r)}},function(t,e,r){"use strict";e.a=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e,r){"use strict";var n=/^(?:0|[1-9]\d*)$/;e.a=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,r){"use strict";var n=r(26);e.a=function(t,e){return e=e?Object(n.a)(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.length)}},function(t,e,r){"use strict";var n=function(){this.__data__=[],this.size=0},i=r(15);var a=function(t,e){for(var r=t.length;r--;)if(Object(i.a)(t[r][0],e))return r;return-1},o=Array.prototype.splice;var s=function(t){var e=this.__data__;return!((t=a(e,t))<0)&&(t==e.length-1?e.pop():o.call(e,t,1),--this.size,!0)};var l=function(t){var e=this.__data__;return(t=a(e,t))<0?void 0:e[t][1]};var u=function(t){return-1<a(this.__data__,t)};var c=function(t,e){var r=this.__data__,n=a(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function h(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}h.prototype.clear=n,h.prototype.delete=s,h.prototype.get=l,h.prototype.has=u,h.prototype.set=c;var d=h;function p(){this.__data__=new d,this.size=0}function f(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}function m(t){return this.__data__.get(t)}var n=function(t){return this.__data__.has(t)},g=r(17),s=r(6),v=Object(s.a)(Object,"create");l=function(){this.__data__=v?v(null):{},this.size=0};var u=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},y=Object.prototype.hasOwnProperty;var c=function(t){var e=this.__data__;if(v){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return y.call(e,t)?e[t]:void 0},x=Object.prototype.hasOwnProperty;r=function(t){var e=this.__data__;return v?void 0!==e[t]:x.call(e,t)};s=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=v&&void 0===e?"__lodash_hash_undefined__":e,this};function b(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}b.prototype.clear=l,b.prototype.delete=u,b.prototype.get=c,b.prototype.has=r,b.prototype.set=s;var _=b;var A=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var w=function(t,e){return t=t.__data__,A(e)?t["string"==typeof e?"string":"hash"]:t.map};u=function(t){return t=w(this,t).delete(t),this.size-=t?1:0,t};c=function(t){return w(this,t).get(t)};r=function(t){return w(this,t).has(t)};s=function(t,e){var r=w(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function M(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}M.prototype.clear=function(){this.size=0,this.__data__={hash:new _,map:new(g.a||d),string:new _}},M.prototype.delete=u,M.prototype.get=c,M.prototype.has=r,M.prototype.set=s;var C=M;s=function(t,e){var r=this.__data__;if(r instanceof d){var n=r.__data__;if(!g.a||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new C(n)}return r.set(t,e),this.size=r.size,this};function T(t){t=this.__data__=new d(t);this.size=t.size}T.prototype.clear=p,T.prototype.delete=f,T.prototype.get=m,T.prototype.has=n,T.prototype.set=s;e.a=T},function(t,e,r){"use strict";var n=r(7),i=r(34),a=r(5),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var s=function(t){return Object(a.a)(t)&&Object(i.a)(t.length)&&!!o[Object(n.a)(t)]},l=r(25),r=r(12),r=r.a&&r.a.isTypedArray,s=r?Object(l.a)(r):s;e.a=s},function(t,e,r){"use strict";var c=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},h=r(28),d=r(10),p=r(21),f=r(35),m=r(38),g=Object.prototype.hasOwnProperty;e.a=function(t,e){var r,n=Object(d.a)(t),i=!n&&Object(h.a)(t),a=!n&&!i&&Object(p.a)(t),o=!n&&!i&&!a&&Object(m.a)(t),s=n||i||a||o,l=s?c(t.length,String):[],u=l.length;for(r in t)!e&&!g.call(t,r)||s&&("length"==r||a&&("offset"==r||"parent"==r)||o&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||Object(f.a)(r,u))||l.push(r);return l}},function(t,e,r){"use strict";var n=r(4),i=Object.create;function a(){}var o=function(t){if(!Object(n.a)(t))return{};if(i)return i(t);a.prototype=t;t=new a;return a.prototype=void 0,t},s=r(23),l=r(22);e.a=function(t){return"function"!=typeof t.constructor||Object(l.a)(t)?{}:o(Object(s.a)(t))}},function(t,e){t.exports=function(t){var e;return t.webpackPolyfill||((e=Object.create(t)).children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1),e}},function(t,Uo,e){"use strict";!function(t,e){
/*!
 * Vue.js v2.6.12
 * (c) 2014-2020 Evan You
 * Released under the MIT License.
 */
var m=Object.freeze({});function D(t){return null==t}function O(t){return null!=t}function h(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function F(t){return null!==t&&"object"==typeof t}var r=Object.prototype.toString;function l(t){return"[object Object]"===r.call(t)}function n(t){return"[object RegExp]"===r.call(t)}function i(t){var e=parseFloat(String(t));return 0<=e&&Math.floor(e)===e&&isFinite(t)}function g(t){return O(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function a(t){return null==t?"":Array.isArray(t)||l(t)&&t.toString===r?JSON.stringify(t,null,2):String(t)}function B(t){var e=parseFloat(t);return isNaN(e)?t:e}function c(t,e){for(var r=Object.create(null),n=t.split(","),i=0;i<n.length;i++)r[n[i]]=!0;return e?function(t){return r[t.toLowerCase()]}:function(t){return r[t]}}var o=c("slot,component",!0),u=c("key,ref,slot,slot-scope,is");function v(t,e){if(t.length){e=t.indexOf(e);if(-1<e)return t.splice(e,1)}}var s=Object.prototype.hasOwnProperty;function d(t,e){return s.call(t,e)}function p(e){var r=Object.create(null);return function(t){return r[t]||(r[t]=e(t))}}var f=/-(\w)/g,y=p(function(t){return t.replace(f,function(t,e){return e?e.toUpperCase():""})}),x=p(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),b=/\B([A-Z])/g,_=p(function(t){return t.replace(b,"-$1").toLowerCase()});var A=Function.prototype.bind?function(t,e){return t.bind(e)}:function(r,n){function t(t){var e=arguments.length;return e?1<e?r.apply(n,arguments):r.call(n,t):r.call(n)}return t._length=r.length,t};function w(t,e){e=e||0;for(var r=t.length-e,n=new Array(r);r--;)n[r]=t[r+e];return n}function M(t,e){for(var r in e)t[r]=e[r];return t}function C(t){for(var e={},r=0;r<t.length;r++)t[r]&&M(e,t[r]);return e}function T(t,e,r){}var S=function(t,e,r){return!1},E=function(t){return t};function I(e,r){if(e===r)return!0;var t=F(e),n=F(r);if(!t||!n)return!t&&!n&&String(e)===String(r);try{var i=Array.isArray(e),a=Array.isArray(r);if(i&&a)return e.length===r.length&&e.every(function(t,e){return I(t,r[e])});if(e instanceof Date&&r instanceof Date)return e.getTime()===r.getTime();if(i||a)return!1;i=Object.keys(e),a=Object.keys(r);return i.length===a.length&&i.every(function(t){return I(e[t],r[t])})}catch(t){return!1}}function L(t,e){for(var r=0;r<t.length;r++)if(I(t[r],e))return r;return-1}function N(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var R="data-server-rendered",P=["component","directive","filter"],z=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:S,isReservedAttr:S,isUnknownElement:S,getTagNamespace:T,parsePlatformTagName:E,mustUseProp:S,async:!0,_lifecycleHooks:z},k=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function H(t,e,r,n){Object.defineProperty(t,e,{value:r,enumerable:!!n,writable:!0,configurable:!0})}var G=new RegExp("[^"+k.source+".$_\\d]");var V,W="__proto__"in{},j="undefined"!=typeof window,X="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,q=X&&WXEnvironment.platform.toLowerCase(),Y=j&&window.navigator.userAgent.toLowerCase(),Z=Y&&/msie|trident/.test(Y),J=Y&&0<Y.indexOf("msie 9.0"),K=Y&&0<Y.indexOf("edge/"),Q=(Y&&Y.indexOf("android"),Y&&/iphone|ipad|ipod|ios/.test(Y)||"ios"===q),$=(Y&&/chrome\/\d+/.test(Y),Y&&/phantomjs/.test(Y),Y&&Y.match(/firefox\/(\d+)/)),tt={}.watch,et=!1;if(j)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){et=!0}}),window.addEventListener("test-passive",null,rt)}catch(t){}var nt=function(){return V=void 0===V?!j&&!X&&void 0!==t&&(t.process&&"server"===t.process.env.VUE_ENV):V},it=j&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function at(t){return"function"==typeof t&&/native code/.test(t.toString())}var ot="undefined"!=typeof Symbol&&at(Symbol)&&"undefined"!=typeof Reflect&&at(Reflect.ownKeys),st="undefined"!=typeof Set&&at(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}(),lt=T,ut=0,ct=function(){this.id=ut++,this.subs=[]};ct.prototype.addSub=function(t){this.subs.push(t)},ct.prototype.removeSub=function(t){v(this.subs,t)},ct.prototype.depend=function(){ct.target&&ct.target.addDep(this)},ct.prototype.notify=function(){var t=this.subs.slice();for(var e=0,r=t.length;e<r;e++)t[e].update()},ct.target=null;var ht=[];function dt(t){ht.push(t),ct.target=t}function pt(){ht.pop(),ct.target=ht[ht.length-1]}var ft=function(t,e,r,n,i,a,o,s){this.tag=t,this.data=e,this.children=r,this.text=n,this.elm=i,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},mt={child:{configurable:!0}};mt.child.get=function(){return this.componentInstance},Object.defineProperties(ft.prototype,mt);var gt=function(t){void 0===t&&(t="");var e=new ft;return e.text=t,e.isComment=!0,e};function vt(t){return new ft(void 0,void 0,void 0,String(t))}function yt(t){var e=new ft(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var xt=Array.prototype,bt=Object.create(xt);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(a){var o=xt[a];H(bt,a,function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,n=o.apply(this,t),i=this.__ob__;switch(a){case"push":case"unshift":r=t;break;case"splice":r=t.slice(2)}return r&&i.observeArray(r),i.dep.notify(),n})});var _t=Object.getOwnPropertyNames(bt),At=!0;function wt(t){At=t}var Mt=function(t){var e;this.value=t,this.dep=new ct,this.vmCount=0,H(t,"__ob__",this),Array.isArray(t)?(W?(e=bt,t.__proto__=e):function(t,e,r){for(var n=0,i=r.length;n<i;n++){var a=r[n];H(t,a,e[a])}}(t,bt,_t),this.observeArray(t)):this.walk(t)};function Ct(t,e){var r;if(F(t)&&!(t instanceof ft))return d(t,"__ob__")&&t.__ob__ instanceof Mt?r=t.__ob__:At&&!nt()&&(Array.isArray(t)||l(t))&&Object.isExtensible(t)&&!t._isVue&&(r=new Mt(t)),e&&r&&r.vmCount++,r}function Tt(r,t,n,e,i){var a,o,s,l=new ct,u=Object.getOwnPropertyDescriptor(r,t);u&&!1===u.configurable||(a=u&&u.get,o=u&&u.set,a&&!o||2!==arguments.length||(n=r[t]),s=!i&&Ct(n),Object.defineProperty(r,t,{enumerable:!0,configurable:!0,get:function(){var t=a?a.call(r):n;return ct.target&&(l.depend(),s&&(s.dep.depend(),Array.isArray(t)&&function t(e){for(var r=void 0,n=0,i=e.length;n<i;n++)(r=e[n])&&r.__ob__&&r.__ob__.dep.depend(),Array.isArray(r)&&t(r)}(t))),t},set:function(t){var e=a?a.call(r):n;t===e||t!=t&&e!=e||a&&!o||(o?o.call(r,t):n=t,s=!i&&Ct(t),l.notify())}}))}function St(t,e,r){if(0,Array.isArray(t)&&i(e))return t.length=Math.max(t.length,e),t.splice(e,1,r),r;if(e in t&&!(e in Object.prototype))return t[e]=r;var n=t.__ob__;return t._isVue||n&&n.vmCount?r:n?(Tt(n.value,e,r),n.dep.notify(),r):t[e]=r}function Et(t,e){var r;Array.isArray(t)&&i(e)?t.splice(e,1):(r=t.__ob__,t._isVue||r&&r.vmCount||d(t,e)&&(delete t[e],r&&r.dep.notify()))}Mt.prototype.walk=function(t){for(var e=Object.keys(t),r=0;r<e.length;r++)Tt(t,e[r])},Mt.prototype.observeArray=function(t){for(var e=0,r=t.length;e<r;e++)Ct(t[e])};var It=U.optionMergeStrategies;function Lt(t,e){if(!e)return t;for(var r,n,i,a=ot?Reflect.ownKeys(e):Object.keys(e),o=0;o<a.length;o++)"__ob__"!==(r=a[o])&&(n=t[r],i=e[r],d(t,r)?n!==i&&l(n)&&l(i)&&Lt(n,i):St(t,r,i));return t}function Rt(r,n,i){return i?function(){var t="function"==typeof n?n.call(i,i):n,e="function"==typeof r?r.call(i,i):r;return t?Lt(t,e):e}:n?r?function(){return Lt("function"==typeof n?n.call(this,this):n,"function"==typeof r?r.call(this,this):r)}:n:r}function Pt(t,e){t=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return t&&function(t){for(var e=[],r=0;r<t.length;r++)-1===e.indexOf(t[r])&&e.push(t[r]);return e}(t)}function Dt(t,e,r,n){t=Object.create(t||null);return e?M(t,e):t}It.data=function(t,e,r){return r?Rt(t,e,r):e&&"function"!=typeof e?t:Rt(t,e)},z.forEach(function(t){It[t]=Pt}),P.forEach(function(t){It[t+"s"]=Dt}),It.watch=function(t,e,r,n){if(t===tt&&(t=void 0),!(e=e===tt?void 0:e))return Object.create(t||null);if(0,!t)return e;var i,a={};for(i in M(a,t),e){var o=a[i],s=e[i];o&&!Array.isArray(o)&&(o=[o]),a[i]=o?o.concat(s):Array.isArray(s)?s:[s]}return a},It.props=It.methods=It.inject=It.computed=function(t,e,r,n){if(0,!t)return e;var i=Object.create(null);return M(i,t),e&&M(i,e),i},It.provide=Rt;var Ot=function(t,e){return void 0===e?t:e};function Ft(r,n,i){if(0,"function"==typeof n&&(n=n.options),function(t){var e=t.props;if(e){var r,n,i={};if(Array.isArray(e))for(r=e.length;r--;)"string"==typeof(n=e[r])&&(i[y(n)]={type:null});else if(l(e))for(var a in e)n=e[a],i[y(a)]=l(n)?n:{type:n};else 0;t.props=i}}(n),function(t){var e=t.inject;if(e){var r=t.inject={};if(Array.isArray(e))for(var n=0;n<e.length;n++)r[e[n]]={from:e[n]};else if(l(e))for(var i in e){var a=e[i];r[i]=l(a)?M({from:i},a):{from:a}}else 0}}(n),function(){var t=n.directives;if(t)for(var e in t){var r=t[e];"function"==typeof r&&(t[e]={bind:r,update:r})}}(),!n._base&&(n.extends&&(r=Ft(r,n.extends,i)),n.mixins))for(var t=0,e=n.mixins.length;t<e;t++)r=Ft(r,n.mixins[t],i);var a,o={};for(a in r)s(a);for(a in n)d(r,a)||s(a);function s(t){var e=It[t]||Ot;o[t]=e(r[t],n[t],i,t)}return o}function Bt(t,e,r){if("string"==typeof r){var n=t[e];if(d(n,r))return n[r];t=y(r);if(d(n,t))return n[t];e=x(t);return d(n,e)?n[e]:n[r]||n[t]||n[e]}}function Nt(t,e,r,n){var i=e[t],a=!d(r,t),e=r[t],r=kt(Boolean,i.type);return-1<r&&(a&&!d(i,"default")?e=!1:""!==e&&e!==_(t)||((a=kt(String,i.type))<0||r<a)&&(e=!0)),void 0===e&&(e=function(t,e,r){if(!d(e,"default"))return;var n=e.default;0;if(t&&t.$options.propsData&&void 0===t.$options.propsData[r]&&void 0!==t._props[r])return t._props[r];return"function"==typeof n&&"Function"!==zt(e.type)?n.call(t):n}(n,i,t),t=At,wt(!0),Ct(e),wt(t)),e}function zt(t){t=t&&t.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function Ut(t,e){return zt(t)===zt(e)}function kt(t,e){if(!Array.isArray(e))return Ut(e,t)?0:-1;for(var r=0,n=e.length;r<n;r++)if(Ut(e[r],t))return r;return-1}function Ht(t,e,r){dt();try{if(e)for(var n=e;n=n.$parent;){var i=n.$options.errorCaptured;if(i)for(var a=0;a<i.length;a++)try{if(!1===i[a].call(n,t,e,r))return}catch(t){Vt(t,n,"errorCaptured hook")}}Vt(t,e,r)}finally{pt()}}function Gt(t,e,r,n,i){var a;try{(a=r?t.apply(e,r):t.call(e))&&!a._isVue&&g(a)&&!a._handled&&(a.catch(function(t){return Ht(t,n,i+" (Promise/async)")}),a._handled=!0)}catch(t){Ht(t,n,i)}return a}function Vt(e,t,r){if(U.errorHandler)try{return U.errorHandler.call(null,e,t,r)}catch(t){t!==e&&Wt(t)}Wt(e)}function Wt(t){if(0,!j&&!X||"undefined"==typeof console)throw t;console.error(t)}var jt,Xt,qt,Yt,Zt=!1,Jt=[],Kt=!1;function Qt(){Kt=!1;for(var t=Jt.slice(0),e=Jt.length=0;e<t.length;e++)t[e]()}function $t(t,e){var r;if(Jt.push(function(){if(t)try{t.call(e)}catch(t){Ht(t,e,"nextTick")}else r&&r(e)}),Kt||(Kt=!0,Xt()),!t&&"undefined"!=typeof Promise)return new Promise(function(t){r=t})}"undefined"!=typeof Promise&&at(Promise)?(jt=Promise.resolve(),Xt=function(){jt.then(Qt),Q&&setTimeout(T)},Zt=!0):Z||"undefined"==typeof MutationObserver||!at(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString()?Xt=void 0!==e&&at(e)?function(){e(Qt)}:function(){setTimeout(Qt,0)}:(qt=1,fn=new MutationObserver(Qt),Yt=document.createTextNode(String(qt)),fn.observe(Yt,{characterData:!0}),Xt=function(){qt=(qt+1)%2,Yt.data=String(qt)},Zt=!0);var te=new st;function ee(t){!function t(e,r){var n,i;var a=Array.isArray(e);if(!a&&!F(e)||Object.isFrozen(e)||e instanceof ft)return;if(e.__ob__){var o=e.__ob__.dep.id;if(r.has(o))return;r.add(o)}if(a)for(n=e.length;n--;)t(e[n],r);else for(i=Object.keys(e),n=i.length;n--;)t(e[i[n]],r)}(t,te),te.clear()}var re=p(function(t){var e="&"===t.charAt(0),r="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=r?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:r,capture:n,passive:e}});function ne(t,i){function a(){var t=arguments,e=a.fns;if(!Array.isArray(e))return Gt(e,null,arguments,i,"v-on handler");for(var r=e.slice(),n=0;n<r.length;n++)Gt(r[n],null,t,i,"v-on handler")}return a.fns=t,a}function ie(t,e,r,n,i,a){var o,s,l,u;for(o in t)s=t[o],l=e[o],u=re(o),D(s)||(D(l)?(D(s.fns)&&(s=t[o]=ne(s,a)),!0===u.once&&(s=t[o]=i(u.name,s,u.capture)),r(u.name,s,u.capture,u.passive,u.params)):s!==l&&(l.fns=s,t[o]=l));for(o in e)D(t[o])&&n((u=re(o)).name,e[o],u.capture)}function ae(t,e,r){var n,i=(t=t instanceof ft?t.data.hook||(t.data.hook={}):t)[e];function a(){r.apply(this,arguments),v(n.fns,a)}D(i)?n=ne([a]):O(i.fns)&&!0===i.merged?(n=i).fns.push(a):n=ne([i,a]),n.merged=!0,t[e]=n}function oe(t,e,r,n,i){if(O(e)){if(d(e,r))return t[r]=e[r],i||delete e[r],1;if(d(e,n))return t[r]=e[n],i||delete e[n],1}}function se(t){return h(t)?[vt(t)]:Array.isArray(t)?function t(e,r){var n=[];var i,a,o,s;for(i=0;i<e.length;i++)D(a=e[i])||"boolean"==typeof a||(o=n.length-1,s=n[o],Array.isArray(a)?0<a.length&&(le((a=t(a,(r||"")+"_"+i))[0])&&le(s)&&(n[o]=vt(s.text+a[0].text),a.shift()),n.push.apply(n,a)):h(a)?le(s)?n[o]=vt(s.text+a):""!==a&&n.push(vt(a)):le(a)&&le(s)?n[o]=vt(s.text+a.text):(!0===e._isVList&&O(a.tag)&&D(a.key)&&O(r)&&(a.key="__vlist"+r+"_"+i+"__"),n.push(a)));return n}(t):void 0}function le(t){return O(t)&&O(t.text)&&!1===t.isComment}function ue(t,e){if(t){for(var r=Object.create(null),n=ot?Reflect.ownKeys(t):Object.keys(t),i=0;i<n.length;i++){var a=n[i];if("__ob__"!==a){for(var o,s=t[a].from,l=e;l;){if(l._provided&&d(l._provided,s)){r[a]=l._provided[s];break}l=l.$parent}l||"default"in t[a]&&(o=t[a].default,r[a]="function"==typeof o?o.call(e):o)}}return r}}function ce(t,e){if(!t||!t.length)return{};for(var r,n={},i=0,a=t.length;i<a;i++){var o=t[i],s=o.data;s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==e&&o.fnContext!==e||!s||null==s.slot?(n.default||(n.default=[])).push(o):(s=n[s=s.slot]||(n[s]=[]),"template"===o.tag?s.push.apply(s,o.children||[]):s.push(o))}for(r in n)n[r].every(he)&&delete n[r];return n}function he(t){return t.isComment&&!t.asyncFactory||" "===t.text}function de(t,e,r){var n,i,a=0<Object.keys(e).length,o=t?!!t.$stable:!a,s=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(o&&r&&r!==m&&s===r.$key&&!a&&!r.$hasNormal)return r;for(var l in n={},t)t[l]&&"$"!==l[0]&&(n[l]=function(t,e,r){function n(){var t=arguments.length?r.apply(null,arguments):r({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:se(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t}r.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0});return n}(e,l,t[l]))}else n={};for(i in e)i in n||(n[i]=function(t,e){return function(){return t[e]}}(e,i));return t&&Object.isExtensible(t)&&(t._normalized=n),H(n,"$stable",o),H(n,"$key",s),H(n,"$hasNormal",a),n}function pe(t,e){var r,n,i,a;if(Array.isArray(t)||"string"==typeof t)for(o=new Array(t.length),r=0,n=t.length;r<n;r++)o[r]=e(t[r],r);else if("number"==typeof t)for(o=new Array(t),r=0;r<t;r++)o[r]=e(r+1,r);else if(F(t))if(ot&&t[Symbol.iterator])for(var o=[],s=t[Symbol.iterator](),l=s.next();!l.done;)o.push(e(l.value,o.length)),l=s.next();else for(i=Object.keys(t),o=new Array(i.length),r=0,n=i.length;r<n;r++)a=i[r],o[r]=e(t[a],a,r);return(o=!O(o)?[]:o)._isVList=!0,o}function fe(t,e,r,n){var i=this.$scopedSlots[t],e=i?(r=r||{},i(r=n?M(M({},n),r):r)||e):this.$slots[t]||e,r=r&&r.slot;return r?this.$createElement("template",{slot:r},e):e}function me(t){return Bt(this.$options,"filters",t)||E}function ge(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function ve(t,e,r,n,i){r=U.keyCodes[e]||r;return i&&n&&!U.keyCodes[e]?ge(i,n):r?ge(r,t):n?_(n)!==e:void 0}function ye(n,i,a,o,s){if(a)if(F(a)){var l,t;for(t in a=Array.isArray(a)?C(a):a)!function(e){l="class"===e||"style"===e||u(e)?n:(r=n.attrs&&n.attrs.type,o||U.mustUseProp(i,r,e)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={}));var t=y(e),r=_(e);t in l||r in l||(l[e]=a[e],s&&((n.on||(n.on={}))["update:"+e]=function(t){a[e]=t}))}(t)}else;return n}function xe(t,e){var r=this._staticTrees||(this._staticTrees=[]),n=r[t];return n&&!e||_e(n=r[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n}function be(t,e,r){return _e(t,"__once__"+e+(r?"_"+r:""),!0),t}function _e(t,e,r){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Ae(t[n],e+"_"+n,r);else Ae(t,e,r)}function Ae(t,e,r){t.isStatic=!0,t.key=e,t.isOnce=r}function we(t,e){if(e)if(l(e)){var r,n=t.on=t.on?M({},t.on):{};for(r in e){var i=n[r],a=e[r];n[r]=i?[].concat(i,a):a}}else;return t}function Me(t,e,r,n){e=e||{$stable:!r};for(var i=0;i<t.length;i++){var a=t[i];Array.isArray(a)?Me(a,e,r):a&&(a.proxy&&(a.fn.proxy=!0),e[a.key]=a.fn)}return n&&(e.$key=n),e}function Ce(t,e){for(var r=0;r<e.length;r+=2){var n=e[r];"string"==typeof n&&n&&(t[e[r]]=e[r+1])}return t}function Te(t,e){return"string"==typeof t?e+t:t}function Se(t){t._o=be,t._n=B,t._s=a,t._l=pe,t._t=fe,t._q=I,t._i=L,t._m=xe,t._f=me,t._k=ve,t._b=ye,t._v=vt,t._e=gt,t._u=Me,t._g=we,t._d=Ce,t._p=Te}function Ee(t,e,r,i,n){var a,o=this,s=n.options;d(i,"_uid")?(a=Object.create(i))._original=i:i=(a=i)._original;var n=!0===s._compiled,l=!n;this.data=t,this.props=e,this.children=r,this.parent=i,this.listeners=t.on||m,this.injections=ue(s.inject,i),this.slots=function(){return o.$slots||de(t.scopedSlots,o.$slots=ce(r,i)),o.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return de(t.scopedSlots,this.slots())}}),n&&(this.$options=s,this.$slots=this.slots(),this.$scopedSlots=de(t.scopedSlots,this.$slots)),s._scopeId?this._c=function(t,e,r,n){n=Be(a,t,e,r,n,l);return n&&!Array.isArray(n)&&(n.fnScopeId=s._scopeId,n.fnContext=i),n}:this._c=function(t,e,r,n){return Be(a,t,e,r,n,l)}}function Ie(t,e,r,n){t=yt(t);return t.fnContext=r,t.fnOptions=n,e.slot&&((t.data||(t.data={})).slot=e.slot),t}function Le(t,e){for(var r in e)t[y(r)]=e[r]}Se(Ee.prototype);var Re={init:function(t,e){t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive?Re.prepatch(t,t):(t.componentInstance=function(t,e){var r={_isComponent:!0,_parentVnode:t,parent:e},e=t.data.inlineTemplate;O(e)&&(r.render=e.render,r.staticRenderFns=e.staticRenderFns);return new t.componentOptions.Ctor(r)}(t,Xe)).$mount(e?t.elm:void 0,e)},prepatch:function(t,e){var r=e.componentOptions;!function(t,e,r,n,i){var a=n.data.scopedSlots,o=t.$scopedSlots,o=!!(a&&!a.$stable||o!==m&&!o.$stable||a&&t.$scopedSlots.$key!==a.$key),a=!!(i||t.$options._renderChildren||o);if(t.$options._parentVnode=n,t.$vnode=n,t._vnode&&(t._vnode.parent=n),t.$options._renderChildren=i,t.$attrs=n.data.attrs||m,t.$listeners=r||m,e&&t.$options.props){wt(!1);for(var s=t._props,l=t.$options._propKeys||[],u=0;u<l.length;u++){var c=l[u],h=t.$options.props;s[c]=Nt(c,h,e,t)}wt(!0),t.$options.propsData=e}r=r||m,o=t.$options._parentListeners,t.$options._parentListeners=r,je(t,r,o),a&&(t.$slots=ce(i,n.context),t.$forceUpdate())}(e.componentInstance=t.componentInstance,r.propsData,r.listeners,e,r.children)},insert:function(t){var e=t.context,r=t.componentInstance;r._isMounted||(r._isMounted=!0,Je(r,"mounted")),t.data.keepAlive&&(e._isMounted?((e=r)._inactive=!1,Qe.push(e)):Ze(r,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?function t(e,r){if(r&&(e._directInactive=!0,Ye(e)))return;if(!e._inactive){e._inactive=!0;for(var n=0;n<e.$children.length;n++)t(e.$children[n]);Je(e,"deactivated")}}(e,!0):e.$destroy())}},Pe=Object.keys(Re);function De(t,e,r,n,i){if(!D(t)){var a,o,s,l,u,c,h=r.$options._base;if("function"==typeof(t=F(t)?h.extend(t):t)){if(D(t.cid)&&void 0===(t=function(e,r){if(!0===e.error&&O(e.errorComp))return e.errorComp;if(O(e.resolved))return e.resolved;var t=ze;t&&O(e.owners)&&-1===e.owners.indexOf(t)&&e.owners.push(t);if(!0===e.loading&&O(e.loadingComp))return e.loadingComp;if(t&&!O(e.owners)){var n=e.owners=[t],i=!0,a=null,o=null;t.$on("hook:destroyed",function(){return v(n,t)});var s=function(t){for(var e=0,r=n.length;e<r;e++)n[e].$forceUpdate();t&&(n.length=0,null!==a&&(clearTimeout(a),a=null),null!==o&&(clearTimeout(o),o=null))},l=N(function(t){e.resolved=Ue(t,r),i?n.length=0:s(!0)}),u=N(function(t){O(e.errorComp)&&(e.error=!0,s(!0))}),c=e(l,u);return F(c)&&(g(c)?D(e.resolved)&&c.then(l,u):g(c.component)&&(c.component.then(l,u),O(c.error)&&(e.errorComp=Ue(c.error,r)),O(c.loading)&&(e.loadingComp=Ue(c.loading,r),0===c.delay?e.loading=!0:a=setTimeout(function(){a=null,D(e.resolved)&&D(e.error)&&(e.loading=!0,s(!1))},c.delay||200)),O(c.timeout)&&(o=setTimeout(function(){o=null,D(e.resolved)&&u(null)},c.timeout)))),i=!1,e.loading?e.loadingComp:e.resolved}}(a=t,h)))return o=a,s=e,l=r,h=n,u=i,(c=gt()).asyncFactory=o,c.asyncMeta={data:s,context:l,children:h,tag:u},c;e=e||{},Cr(t),O(e.model)&&(u=t.options,p=e,c=u.model&&u.model.prop||"value",d=u.model&&u.model.event||"input",(p.attrs||(p.attrs={}))[c]=p.model.value,u=p.on||(p.on={}),c=u[d],p=p.model.callback,O(c)?(Array.isArray(c)?-1===c.indexOf(p):c!==p)&&(u[d]=[p].concat(c)):u[d]=p);var d=function(t,e){if(!D(e=e.options.props)){var r={},n=t.attrs,i=t.props;if(O(n)||O(i))for(var a in e){var o=_(a);oe(r,i,a,o,!0)||oe(r,n,a,o,!1)}return r}}(e,t);if(!0===t.options.functional)return function(t,e,r,n,i){var a=t.options,o={},s=a.props;if(O(s))for(var l in s)o[l]=Nt(l,s,e||m);else O(r.attrs)&&Le(o,r.attrs),O(r.props)&&Le(o,r.props);var u=new Ee(r,o,i,n,t);if((t=a.render.call(null,u._c,u))instanceof ft)return Ie(t,r,u.parent,a);if(Array.isArray(t)){for(var c=se(t)||[],h=new Array(c.length),d=0;d<c.length;d++)h[d]=Ie(c[d],r,u.parent,a);return h}}(t,d,e,r,n);var p=e.on;e.on=e.nativeOn,!0===t.options.abstract&&(f=e.slot,e={},f&&(e.slot=f)),function(t){for(var e=t.hook||(t.hook={}),r=0;r<Pe.length;r++){var n=Pe[r],i=e[n],a=Re[n];i===a||i&&i._merged||(e[n]=i?function(r,n){function t(t,e){r(t,e),n(t,e)}return t._merged=!0,t}(a,i):a)}}(e);var f=t.options.name||i;return new ft("vue-component-"+t.cid+(f?"-"+f:""),e,void 0,void 0,void 0,r,{Ctor:t,propsData:d,listeners:p,tag:i,children:n},a)}}}var Oe=1,Fe=2;function Be(t,e,r,n,i,a){return(Array.isArray(r)||h(r))&&(i=n,n=r,r=void 0),function(t,e,r,n,i){if(O(r)&&O(r.__ob__))return gt();O(r)&&O(r.is)&&(e=r.is);if(!e)return gt();0;Array.isArray(n)&&"function"==typeof n[0]&&((r=r||{}).scopedSlots={default:n[0]},n.length=0);i===Fe?n=se(n):i===Oe&&(n=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(n));var a,o;n="string"==typeof e?(a=t.$vnode&&t.$vnode.ns||U.getTagNamespace(e),U.isReservedTag(e)?new ft(U.parsePlatformTagName(e),r,n,void 0,void 0,t):r&&r.pre||!O(o=Bt(t.$options,"components",e))?new ft(e,r,n,void 0,void 0,t):De(o,r,t,n,e)):De(e,r,t,n);return Array.isArray(n)?n:O(n)?(O(a)&&function t(e,r,n){e.ns=r;"foreignObject"===e.tag&&(n=!(r=void 0));if(O(e.children))for(var i=0,a=e.children.length;i<a;i++){var o=e.children[i];O(o.tag)&&(D(o.ns)||!0===n&&"svg"!==o.tag)&&t(o,r,n)}}(n,a),O(r)&&function(t){F(t.style)&&ee(t.style),F(t.class)&&ee(t.class)}(r),n):gt()}(t,e,r,n,i=!0===a?Fe:i)}var Ne,ze=null;function Ue(t,e){return F(t=t.__esModule||ot&&"Module"===t[Symbol.toStringTag]?t.default:t)?e.extend(t):t}function ke(t){return t.isComment&&t.asyncFactory}function He(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var r=t[e];if(O(r)&&(O(r.componentOptions)||ke(r)))return r}}function Ge(t,e){Ne.$on(t,e)}function Ve(t,e){Ne.$off(t,e)}function We(e,r){var n=Ne;return function t(){null!==r.apply(null,arguments)&&n.$off(e,t)}}function je(t,e,r){ie(e,r||{},Ge,Ve,We,Ne=t),Ne=void 0}var Xe=null;function qe(t){var e=Xe;return Xe=t,function(){Xe=e}}function Ye(t){for(;t=t&&t.$parent;)if(t._inactive)return 1}function Ze(t,e){if(e){if(t._directInactive=!1,Ye(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var r=0;r<t.$children.length;r++)Ze(t.$children[r]);Je(t,"activated")}}function Je(t,e){dt();var r=t.$options[e],n=e+" hook";if(r)for(var i=0,a=r.length;i<a;i++)Gt(r[i],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),pt()}var Ke=[],Qe=[],$e={},tr=!1,er=!1,rr=0;var nr,ir=0,ar=Date.now;function or(){var t,e;for(ir=ar(),er=!0,Ke.sort(function(t,e){return t.id-e.id}),rr=0;rr<Ke.length;rr++)(t=Ke[rr]).before&&t.before(),e=t.id,$e[e]=null,t.run();var r=Qe.slice(),n=Ke.slice();rr=Ke.length=Qe.length=0,tr=er=!($e={}),function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Ze(t[e],!0)}(r),function(t){for(var e=t.length;e--;){var r=t[e],n=r.vm;n._watcher===r&&n._isMounted&&!n._isDestroyed&&Je(n,"updated")}}(n),it&&U.devtools&&it.emit("flush")}!j||Z||(nr=window.performance)&&"function"==typeof nr.now&&ar()>document.createEvent("Event").timeStamp&&(ar=function(){return nr.now()});var sr=0,lr=function(t,e,r,n,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=r,this.id=++sr,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new st,this.newDepIds=new st,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!G.test(t)){var r=t.split(".");return function(t){for(var e=0;e<r.length;e++){if(!t)return;t=t[r[e]]}return t}}}(e),this.getter||(this.getter=T)),this.value=this.lazy?void 0:this.get()};lr.prototype.get=function(){var t;dt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Ht(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ee(t),pt(),this.cleanupDeps()}return t},lr.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},lr.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var r=this.depIds;this.depIds=this.newDepIds,this.newDepIds=r,this.newDepIds.clear(),r=this.deps,this.deps=this.newDeps,this.newDeps=r,this.newDeps.length=0},lr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==$e[e]){if($e[e]=!0,er){for(var r=Ke.length-1;rr<r&&Ke[r].id>t.id;)r--;Ke.splice(r+1,0,t)}else Ke.push(t);tr||(tr=!0,$t(or))}}(this)},lr.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||F(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){Ht(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},lr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},lr.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},lr.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var ur={enumerable:!0,configurable:!0,get:T,set:T};function cr(t,e,r){ur.get=function(){return this[e][r]},ur.set=function(t){this[e][r]=t},Object.defineProperty(t,r,ur)}function hr(t){t._watchers=[];var e=t.$options;e.props&&function(r,n){var t,i=r.$options.propsData||{},a=r._props={},o=r.$options._propKeys=[];for(t in r.$parent&&wt(!1),n)!function(t){o.push(t);var e=Nt(t,n,i,r);Tt(a,t,e),t in r||cr(r,"_props",t)}(t);wt(!0)}(t,e.props),e.methods&&function(t,e){for(var r in t.$options.props,e)t[r]="function"!=typeof e[r]?T:A(e[r],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;l(e=t._data="function"==typeof e?function(t,e){dt();try{return t.call(e,e)}catch(t){return Ht(t,e,"data()"),{}}finally{pt()}}(e,t):e||{})||(e={});for(var r=Object.keys(e),n=t.$options.props,i=(t.$options.methods,r.length);i--;){var a=r[i];0,n&&d(n,a)||(function(t){return 36===(t=(t+"").charCodeAt(0))||95===t}(a)||cr(t,"_data",a))}Ct(e,!0)}(t):Ct(t._data={},!0),e.computed&&function(t,e){var r,n=t._computedWatchers=Object.create(null),i=nt();for(r in e){var a=e[r],o="function"==typeof a?a:a.get;0,i||(n[r]=new lr(t,o||T,T,dr)),r in t||pr(t,r,a)}}(t,e.computed),e.watch&&e.watch!==tt&&function(t,e){for(var r in e){var n=e[r];if(Array.isArray(n))for(var i=0;i<n.length;i++)gr(t,r,n[i]);else gr(t,r,n)}}(t,e.watch)}var dr={lazy:!0};function pr(t,e,r){var n=!nt();"function"==typeof r?(ur.get=n?fr(e):mr(r),ur.set=T):(ur.get=r.get?n&&!1!==r.cache?fr(e):mr(r.get):T,ur.set=r.set||T),Object.defineProperty(t,e,ur)}function fr(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),ct.target&&t.depend(),t.value}}function mr(t){return function(){return t.call(this,this)}}function gr(t,e,r,n){return"string"==typeof(r=l(r)?(n=r).handler:r)&&(r=t[r]),t.$watch(e,r,n)}var vr,yr,xr,br,_r,Ar,wr,Mr=0;function Cr(t){var e,r,n=t.options;return!t.super||(e=Cr(t.super))!==t.superOptions&&(t.superOptions=e,(r=function(t){var e,r,n=t.options,i=t.sealedOptions;for(r in n)n[r]!==i[r]&&((e=e||{})[r]=n[r]);return e}(t))&&M(t.extendOptions,r),(n=t.options=Ft(e,t.extendOptions)).name&&(n.components[n.name]=t)),n}function Tr(t){this._init(t)}function Sr(t){t.cid=0;var o=1;t.extend=function(t){t=t||{};var e=this,r=e.cid,n=t._Ctor||(t._Ctor={});if(n[r])return n[r];var i=t.name||e.options.name;function a(t){this._init(t)}return((a.prototype=Object.create(e.prototype)).constructor=a).cid=o++,a.options=Ft(e.options,t),a.super=e,a.options.props&&function(t){for(var e in t.options.props)cr(t.prototype,"_props",e)}(a),a.options.computed&&function(t){var e,r=t.options.computed;for(e in r)pr(t.prototype,e,r[e])}(a),a.extend=e.extend,a.mixin=e.mixin,a.use=e.use,P.forEach(function(t){a[t]=e[t]}),i&&(a.options.components[i]=a),a.superOptions=e.options,a.extendOptions=t,a.sealedOptions=M({},a.options),n[r]=a}}function Er(t){return t&&(t.Ctor.options.name||t.tag)}function Ir(t,e){return Array.isArray(t)?-1<t.indexOf(e):"string"==typeof t?-1<t.split(",").indexOf(e):!!n(t)&&t.test(e)}function Lr(t,e){var r,n=t.cache,i=t.keys,a=t._vnode;for(r in n){var o=n[r];!o||(o=Er(o.componentOptions))&&!e(o)&&Rr(n,r,i,a)}}function Rr(t,e,r,n){var i=t[e];!i||n&&i.tag===n.tag||i.componentInstance.$destroy(),t[e]=null,v(r,e)}Tr.prototype._init=function(t){var e,r,n,i,a,o=this;o._uid=Mr++,o._isVue=!0,t&&t._isComponent?(a=t,r=(e=o).$options=Object.create(e.constructor.options),e=a._parentVnode,r.parent=a.parent,e=(r._parentVnode=e).componentOptions,r.propsData=e.propsData,r._parentListeners=e.listeners,r._renderChildren=e.children,r._componentTag=e.tag,a.render&&(r.render=a.render,r.staticRenderFns=a.staticRenderFns)):o.$options=Ft(Cr(o.constructor),t||{},o),function(t){var e=t.$options,r=e.parent;if(r&&!e.abstract){for(;r.$options.abstract&&r.$parent;)r=r.$parent;r.$children.push(t)}t.$parent=r,t.$root=r?r.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}((o._renderProxy=o)._self=o),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&je(t,e)}(o),function(i){i._vnode=null,i._staticTrees=null;var t=i.$options,e=i.$vnode=t._parentVnode,r=e&&e.context;i.$slots=ce(t._renderChildren,r),i.$scopedSlots=m,i._c=function(t,e,r,n){return Be(i,t,e,r,n,!1)},i.$createElement=function(t,e,r,n){return Be(i,t,e,r,n,!0)},e=e&&e.data,Tt(i,"$attrs",e&&e.attrs||m,null,!0),Tt(i,"$listeners",t._parentListeners||m,null,!0)}(o),Je(o,"beforeCreate"),(i=ue((n=o).$options.inject,n))&&(wt(!1),Object.keys(i).forEach(function(t){Tt(n,t,i[t])}),wt(!0)),hr(o),(t=(a=o).$options.provide)&&(a._provided="function"==typeof t?t.call(a):t),Je(o,"created"),o.$options.el&&o.$mount(o.$options.el)},vr=Tr,yr={get:function(){return this._data}},xr={get:function(){return this._props}},Object.defineProperty(vr.prototype,"$data",yr),Object.defineProperty(vr.prototype,"$props",xr),vr.prototype.$set=St,vr.prototype.$delete=Et,vr.prototype.$watch=function(t,e,r){if(l(e))return gr(this,t,e,r);(r=r||{}).user=!0;var n=new lr(this,t,e,r);if(r.immediate)try{e.call(this,n.value)}catch(t){Ht(t,this,'callback for immediate watcher "'+n.expression+'"')}return function(){n.teardown()}},_r=/^hook:/,(br=Tr).prototype.$on=function(t,e){if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)this.$on(t[r],e);else(this._events[t]||(this._events[t]=[])).push(e),_r.test(t)&&(this._hasHookEvent=!0);return this},br.prototype.$once=function(t,e){var r=this;function n(){r.$off(t,n),e.apply(r,arguments)}return n.fn=e,r.$on(t,n),r},br.prototype.$off=function(t,e){if(!arguments.length)return this._events=Object.create(null),this;if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)this.$off(t[r],e);return this}var i,a=this._events[t];if(!a)return this;if(!e)return this._events[t]=null,this;for(var o=a.length;o--;)if((i=a[o])===e||i.fn===e){a.splice(o,1);break}return this},br.prototype.$emit=function(t){if(e=this._events[t])for(var e=1<e.length?w(e):e,r=w(arguments,1),n='event handler for "'+t+'"',i=0,a=e.length;i<a;i++)Gt(e[i],this,r,this,n);return this},(Ar=Tr).prototype._update=function(t,e){var r=this,n=r.$el,i=r._vnode,a=qe(r);r._vnode=t,r.$el=i?r.__patch__(i,t):r.__patch__(r.$el,t,e,!1),a(),n&&(n.__vue__=null),r.$el&&(r.$el.__vue__=r),r.$vnode&&r.$parent&&r.$vnode===r.$parent._vnode&&(r.$parent.$el=r.$el)},Ar.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},Ar.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Je(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||v(e.$children,t),t._watcher&&t._watcher.teardown();for(var r=t._watchers.length;r--;)t._watchers[r].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Je(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}},Se((wr=Tr).prototype),wr.prototype.$nextTick=function(t){return $t(t,this)},wr.prototype._render=function(){var e,r=this,t=r.$options,n=t.render,t=t._parentVnode;t&&(r.$scopedSlots=de(t.data.scopedSlots,r.$slots,r.$scopedSlots)),r.$vnode=t;try{ze=r,e=n.call(r._renderProxy,r.$createElement)}catch(t){Ht(t,r,"render"),e=r._vnode}finally{ze=null}return(e=!((e=Array.isArray(e)&&1===e.length?e[0]:e)instanceof ft)?gt():e).parent=t,e};var Pr,Dr,Or,Fr=[String,RegExp,Array],Br={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Fr,exclude:Fr,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Rr(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",function(e){Lr(t,function(t){return Ir(e,t)})}),this.$watch("exclude",function(e){Lr(t,function(t){return!Ir(e,t)})})},render:function(){var t=this.$slots.default,e=He(t),r=e&&e.componentOptions;if(r){var n=Er(r),i=this.include,a=this.exclude;if(i&&(!n||!Ir(i,n))||a&&n&&Ir(a,n))return e;a=this.cache,n=this.keys,r=null==e.key?r.Ctor.cid+(r.tag?"::"+r.tag:""):e.key;a[r]?(e.componentInstance=a[r].componentInstance,v(n,r),n.push(r)):(a[r]=e,n.push(r),this.max&&n.length>parseInt(this.max)&&Rr(a,n[0],n,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};Pr=Tr,Or={get:function(){return U}},Object.defineProperty(Pr,"config",Or),Pr.util={warn:lt,extend:M,mergeOptions:Ft,defineReactive:Tt},Pr.set=St,Pr.delete=Et,Pr.nextTick=$t,Pr.observable=function(t){return Ct(t),t},Pr.options=Object.create(null),P.forEach(function(t){Pr.options[t+"s"]=Object.create(null)}),M((Pr.options._base=Pr).options.components,Br),Pr.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(-1<e.indexOf(t))return this;var r=w(arguments,1);return r.unshift(this),"function"==typeof t.install?t.install.apply(t,r):"function"==typeof t&&t.apply(null,r),e.push(t),this},Pr.mixin=function(t){return this.options=Ft(this.options,t),this},Sr(Pr),Dr=Pr,P.forEach(function(r){Dr[r]=function(t,e){return e?("component"===r&&l(e)&&(e.name=e.name||t,e=this.options._base.extend(e)),"directive"===r&&"function"==typeof e&&(e={bind:e,update:e}),this.options[r+"s"][t]=e):this.options[r+"s"][t]}}),Object.defineProperty(Tr.prototype,"$isServer",{get:nt}),Object.defineProperty(Tr.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Tr,"FunctionalRenderContext",{value:Ee}),Tr.version="2.6.12";var Nr=c("style,class"),zr=c("input,textarea,option,select,progress"),q=function(t,e,r){return"value"===r&&zr(t)&&"button"!==e||"selected"===r&&"option"===t||"checked"===r&&"input"===t||"muted"===r&&"video"===t},Ur=c("contenteditable,draggable,spellcheck"),kr=c("events,caret,typing,plaintext-only"),Hr=function(t,e){return Xr(e)||"false"===e?"false":"contenteditable"===t&&kr(e)?e:"true"},Gr=c("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Vr="http://www.w3.org/1999/xlink",Wr=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},jr=function(t){return Wr(t)?t.slice(6,t.length):""},Xr=function(t){return null==t||!1===t};function qr(t){for(var e=t.data,r=t,n=t;O(n.componentInstance);)(n=n.componentInstance._vnode)&&n.data&&(e=Yr(n.data,e));for(;O(r=r.parent);)r&&r.data&&(e=Yr(e,r.data));return function(t,e){if(O(t)||O(e))return Zr(t,Jr(e));return""}(e.staticClass,e.class)}function Yr(t,e){return{staticClass:Zr(t.staticClass,e.staticClass),class:O(t.class)?[t.class,e.class]:e.class}}function Zr(t,e){return t?e?t+" "+e:t:e||""}function Jr(t){return Array.isArray(t)?function(t){for(var e,r="",n=0,i=t.length;n<i;n++)O(e=Jr(t[n]))&&""!==e&&(r&&(r+=" "),r+=e);return r}(t):F(t)?function(t){var e,r="";for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}(t):"string"==typeof t?t:""}function Kr(t){return $r(t)||tn(t)}var Qr={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},$r=c("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),tn=c("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0);function en(t){return tn(t)?"svg":"math"===t?"math":void 0}var rn=Object.create(null);var nn=c("text,number,password,search,email,tel,url");function an(t){if("string"!=typeof t)return t;t=document.querySelector(t);return t||document.createElement("div")}Y=Object.freeze({createElement:function(t,e){var r=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&r.setAttribute("multiple","multiple"),r},createElementNS:function(t,e){return document.createElementNS(Qr[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,r){t.insertBefore(e,r)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),mt={create:function(t,e){on(e)},update:function(t,e){t.data.ref!==e.data.ref&&(on(t,!0),on(e))},destroy:function(t){on(t,!0)}};function on(t,e){var r,n,i=t.data.ref;O(i)&&(n=t.context,r=t.componentInstance||t.elm,n=n.$refs,e?Array.isArray(n[i])?v(n[i],r):n[i]===r&&(n[i]=void 0):t.data.refInFor?Array.isArray(n[i])?n[i].indexOf(r)<0&&n[i].push(r):n[i]=[r]:n[i]=r)}var sn=new ft("",{},[]),ln=["create","activate","update","remove","destroy"];function un(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&O(t.data)===O(e.data)&&function(t,e){if("input"!==t.tag)return 1;var t=O(r=t.data)&&O(r=r.attrs)&&r.type,r=O(r=e.data)&&O(r=r.attrs)&&r.type;return t===r||nn(t)&&nn(r)}(t,e)||!0===t.isAsyncPlaceholder&&t.asyncFactory===e.asyncFactory&&D(e.asyncFactory.error))}z={create:cn,update:cn,destroy:function(t){cn(t,sn)}};function cn(t,e){(t.data.directives||e.data.directives)&&function(e,r){var t,n,i,a,o=e===sn,s=r===sn,l=dn(e.data.directives,e.context),u=dn(r.data.directives,r.context),c=[],h=[];for(t in u)n=l[t],i=u[t],n?(i.oldValue=n.value,i.oldArg=n.arg,pn(i,"update",r,e),i.def&&i.def.componentUpdated&&h.push(i)):(pn(i,"bind",r,e),i.def&&i.def.inserted&&c.push(i));if(c.length&&(a=function(){for(var t=0;t<c.length;t++)pn(c[t],"inserted",r,e)},o?ae(r,"insert",a):a()),h.length&&ae(r,"postpatch",function(){for(var t=0;t<h.length;t++)pn(h[t],"componentUpdated",r,e)}),!o)for(t in l)u[t]||pn(l[t],"unbind",e,e,s)}(t,e)}var hn=Object.create(null);function dn(t,e){var r,n,i,a=Object.create(null);if(!t)return a;for(r=0;r<t.length;r++)(n=t[r]).modifiers||(n.modifiers=hn),(a[(i=n).rawName||i.name+"."+Object.keys(i.modifiers||{}).join(".")]=n).def=Bt(e.$options,"directives",n.name);return a}function pn(e,r,n,t,i){var a=e.def&&e.def[r];if(a)try{a(n.elm,e,n,t,i)}catch(t){Ht(t,n.context,"directive "+e.name+" "+r+" hook")}}var fn=[mt,z];function mn(t,e){var r=e.componentOptions;if(!(O(r)&&!1===r.Ctor.options.inheritAttrs||D(t.data.attrs)&&D(e.data.attrs))){var n,i,a=e.elm,o=t.data.attrs||{},s=e.data.attrs||{};for(n in s=O(s.__ob__)?e.data.attrs=M({},s):s)i=s[n],o[n]!==i&&gn(a,n,i);for(n in(Z||K)&&s.value!==o.value&&gn(a,"value",s.value),o)D(s[n])&&(Wr(n)?a.removeAttributeNS(Vr,jr(n)):Ur(n)||a.removeAttribute(n))}}function gn(t,e,r){-1<t.tagName.indexOf("-")?vn(t,e,r):Gr(e)?Xr(r)?t.removeAttribute(e):(r="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,r)):Ur(e)?t.setAttribute(e,Hr(e,r)):Wr(e)?Xr(r)?t.removeAttributeNS(Vr,jr(e)):t.setAttributeNS(Vr,e,r):vn(t,e,r)}function vn(e,t,r){var n;Xr(r)?e.removeAttribute(t):(!Z||J||"TEXTAREA"!==e.tagName||"placeholder"!==t||""===r||e.__ieph||(n=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",n)},e.addEventListener("input",n),e.__ieph=!0),e.setAttribute(t,r))}Fr={create:mn,update:mn};function yn(t,e){var r=e.elm,n=e.data,t=t.data;D(n.staticClass)&&D(n.class)&&(D(t)||D(t.staticClass)&&D(t.class))||(t=qr(e),(t=O(e=r._transitionClasses)?Zr(t,Jr(e)):t)!==r._prevClass&&(r.setAttribute("class",t),r._prevClass=t))}var xn,bn,_n,An,wn,Mn,mt={create:yn,update:yn},Cn=/[\w).+\-_$\]]/;function Tn(t){for(var e,r,n,i,a=!1,o=!1,s=!1,l=!1,u=0,c=0,h=0,d=0,p=0;p<t.length;p++)if(r=e,e=t.charCodeAt(p),a)39===e&&92!==r&&(a=!1);else if(o)34===e&&92!==r&&(o=!1);else if(s)96===e&&92!==r&&(s=!1);else if(l)47===e&&92!==r&&(l=!1);else if(124!==e||124===t.charCodeAt(p+1)||124===t.charCodeAt(p-1)||u||c||h){switch(e){case 34:o=!0;break;case 39:a=!0;break;case 96:s=!0;break;case 40:h++;break;case 41:h--;break;case 91:c++;break;case 93:c--;break;case 123:u++;break;case 125:u--}if(47===e){for(var f=p-1,m=void 0;0<=f&&" "===(m=t.charAt(f));f--);m&&Cn.test(m)||(l=!0)}}else void 0===n?(d=p+1,n=t.slice(0,p).trim()):g();function g(){(i=i||[]).push(t.slice(d,p).trim()),d=p+1}if(void 0===n?n=t.slice(0,p).trim():0!==d&&g(),i)for(p=0;p<i.length;p++)n=function(t,e){var r=e.indexOf("(");{if(r<0)return'_f("'+e+'")('+t+")";var n=e.slice(0,r),r=e.slice(r+1);return'_f("'+n+'")('+t+(")"!==r?","+r:r)}}(n,i[p]);return n}function Sn(t,e){console.error("[Vue compiler]: "+t)}function En(t,e){return t?t.map(function(t){return t[e]}).filter(function(t){return t}):[]}function In(t,e,r,n,i){(t.props||(t.props=[])).push(Nn({name:e,value:r,dynamic:i},n)),t.plain=!1}function Ln(t,e,r,n,i){(i?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Nn({name:e,value:r,dynamic:i},n)),t.plain=!1}function Rn(t,e,r,n){t.attrsMap[e]=r,t.attrsList.push(Nn({name:e,value:r},n))}function Pn(t,e,r){return r?"_p("+e+',"'+t+'")':t+e}function Dn(t,e,r,n,i,a,o,s){(n=n||m).right?s?e="("+e+")==='click'?'contextmenu':("+e+")":"click"===e&&(e="contextmenu",delete n.right):n.middle&&(s?e="("+e+")==='click'?'mouseup':("+e+")":"click"===e&&(e="mouseup")),n.capture&&(delete n.capture,e=Pn("!",e,s)),n.once&&(delete n.once,e=Pn("~",e,s)),n.passive&&(delete n.passive,e=Pn("&",e,s));var l=n.native?(delete n.native,t.nativeEvents||(t.nativeEvents={})):t.events||(t.events={}),o=Nn({value:r.trim(),dynamic:s},o);n!==m&&(o.modifiers=n);n=l[e];Array.isArray(n)?i?n.unshift(o):n.push(o):l[e]=n?i?[o,n]:[n,o]:o,t.plain=!1}function On(t,e,r){var n=Fn(t,":"+e)||Fn(t,"v-bind:"+e);if(null!=n)return Tn(n);if(!1!==r){e=Fn(t,e);if(null!=e)return JSON.stringify(e)}}function Fn(t,e,r){var n;if(null!=(n=t.attrsMap[e]))for(var i=t.attrsList,a=0,o=i.length;a<o;a++)if(i[a].name===e){i.splice(a,1);break}return r&&delete t.attrsMap[e],n}function Bn(t,e){for(var r=t.attrsList,n=0,i=r.length;n<i;n++){var a=r[n];if(e.test(a.name))return r.splice(n,1),a}}function Nn(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function zn(t,e,r){var n=r||{},r=n.trim?"(typeof $$v === 'string'? $$v.trim(): $$v)":"$$v",r=Un(e,r=n.number?"_n("+r+")":r);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+r+"}"}}function Un(t,e){var r=function(t){if(t=t.trim(),xn=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<xn-1)return-1<(An=t.lastIndexOf("."))?{exp:t.slice(0,An),key:'"'+t.slice(An+1)+'"'}:{exp:t,key:null};bn=t,An=wn=Mn=0;for(;!Hn();)Gn(_n=kn())?Vn(_n):91===_n&&function(t){var e=1;for(wn=An;!Hn();)if(Gn(t=kn()))Vn(t);else if(91===t&&e++,93===t&&e--,0===e){Mn=An;break}}(_n);return{exp:t.slice(0,wn),key:t.slice(wn+1,Mn)}}(t);return null===r.key?t+"="+e:"$set("+r.exp+", "+r.key+", "+e+")"}function kn(){return bn.charCodeAt(++An)}function Hn(){return xn<=An}function Gn(t){return 34===t||39===t}function Vn(t){for(var e=t;!Hn()&&(t=kn())!==e;);}var Wn,jn="__r",Xn="__c";function qn(e,r,n){var i=Wn;return function t(){null!==r.apply(null,arguments)&&Jn(e,t,n,i)}}var Yn=Zt&&!($&&Number($[1])<=53);function Zn(t,e,r,n){var i,a;Yn&&(i=ir,e=(a=e)._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=i||t.timeStamp<=0||t.target.ownerDocument!==document)return a.apply(this,arguments)}),Wn.addEventListener(t,e,et?{capture:r,passive:n}:r)}function Jn(t,e,r,n){(n||Wn).removeEventListener(t,e._wrapper||e,r)}function Kn(t,e){var r,n,i;D(t.data.on)&&D(e.data.on)||(r=e.data.on||{},n=t.data.on||{},Wn=e.elm,O((i=r)[jn])&&(i[t=Z?"change":"input"]=[].concat(i[jn],i[t]||[]),delete i[jn]),O(i[Xn])&&(i.change=[].concat(i[Xn],i.change||[]),delete i[Xn]),ie(r,n,Zn,Jn,qn,e.context),Wn=void 0)}var Qn,z={create:Kn,update:Kn};function $n(t,e){if(!D(t.data.domProps)||!D(e.data.domProps)){var r,n,i,a,o=e.elm,s=t.data.domProps||{},l=e.data.domProps||{};for(r in O(l.__ob__)&&(l=e.data.domProps=M({},l)),s)r in l||(o[r]="");for(r in l){if(n=l[r],"textContent"===r||"innerHTML"===r){if(e.children&&(e.children.length=0),n===s[r])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===r&&"PROGRESS"!==o.tagName){var u=D(o._value=n)?"":String(n);a=u,(i=o).composing||"OPTION"!==i.tagName&&!function(t,e){var r=!0;try{r=document.activeElement!==t}catch(t){}return r&&t.value!==e}(i,a)&&!function(t,e){var r=t.value,t=t._vModifiers;if(O(t)){if(t.number)return B(r)!==B(e);if(t.trim)return r.trim()!==e.trim()}return r!==e}(i,a)||(o.value=u)}else if("innerHTML"===r&&tn(o.tagName)&&D(o.innerHTML)){(Qn=Qn||document.createElement("div")).innerHTML="<svg>"+n+"</svg>";for(var c=Qn.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}else if(n!==s[r])try{o[r]=n}catch(t){}}}}var Zt={create:$n,update:$n},ti=p(function(t){var e={},r=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach(function(t){!t||1<(t=t.split(r)).length&&(e[t[0].trim()]=t[1].trim())}),e});function ei(t){var e=ri(t.style);return t.staticStyle?M(t.staticStyle,e):e}function ri(t){return Array.isArray(t)?C(t):"string"==typeof t?ti(t):t}function ni(t,e,r){if(ai.test(e))t.style.setProperty(e,r);else if(oi.test(r))t.style.setProperty(_(e),r.replace(oi,""),"important");else{var n=li(e);if(Array.isArray(r))for(var i=0,a=r.length;i<a;i++)t.style[n]=r[i];else t.style[n]=r}}var ii,ai=/^--/,oi=/\s*!important$/,si=["Webkit","Moz","ms"],li=p(function(t){if(ii=ii||document.createElement("div").style,"filter"!==(t=y(t))&&t in ii)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),r=0;r<si.length;r++){var n=si[r]+e;if(n in ii)return n}});function ui(t,e){var r=e.data,t=t.data;if(!(D(r.staticStyle)&&D(r.style)&&D(t.staticStyle)&&D(t.style))){var n,i,a=e.elm,r=t.staticStyle,t=t.normalizedStyle||t.style||{},o=r||t,t=ri(e.data.style)||{};e.data.normalizedStyle=O(t.__ob__)?M({},t):t;var s=function(t,e){var r,n={};if(e)for(var i=t;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(r=ei(i.data))&&M(n,r);(r=ei(t.data))&&M(n,r);for(var a=t;a=a.parent;)a.data&&(r=ei(a.data))&&M(n,r);return n}(e,!0);for(i in o)D(s[i])&&ni(a,i,"");for(i in s)(n=s[i])!==o[i]&&ni(a,i,null==n?"":n)}}var $={create:ui,update:ui},ci=/\s+/;function hi(e,t){var r;(t=t&&t.trim())&&(e.classList?-1<t.indexOf(" ")?t.split(ci).forEach(function(t){return e.classList.add(t)}):e.classList.add(t):(r=" "+(e.getAttribute("class")||"")+" ").indexOf(" "+t+" ")<0&&e.setAttribute("class",(r+t).trim()))}function di(e,t){if(t=t&&t.trim())if(e.classList)-1<t.indexOf(" ")?t.split(ci).forEach(function(t){return e.classList.remove(t)}):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{for(var r=" "+(e.getAttribute("class")||"")+" ",n=" "+t+" ";0<=r.indexOf(n);)r=r.replace(n," ");(r=r.trim())?e.setAttribute("class",r):e.removeAttribute("class")}}function pi(t){if(t){if("object"!=typeof t)return"string"==typeof t?fi(t):void 0;var e={};return!1!==t.css&&M(e,fi(t.name||"v")),M(e,t),e}}var fi=p(function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}}),mi=j&&!J,gi="transition",vi="animation",yi="transition",xi="transitionend",bi="animation",_i="animationend";mi&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(yi="WebkitTransition",xi="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(bi="WebkitAnimation",_i="webkitAnimationEnd"));var Ai=j?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function wi(t){Ai(function(){Ai(t)})}function Mi(t,e){var r=t._transitionClasses||(t._transitionClasses=[]);r.indexOf(e)<0&&(r.push(e),hi(t,e))}function Ci(t,e){t._transitionClasses&&v(t._transitionClasses,e),di(t,e)}function Ti(e,t,r){var n=Ei(e,t),i=n.type,t=n.timeout,a=n.propCount;if(!i)return r();function o(){e.removeEventListener(s,u),r()}var s=i===gi?xi:_i,l=0,u=function(t){t.target===e&&++l>=a&&o()};setTimeout(function(){l<a&&o()},t+1),e.addEventListener(s,u)}var Si=/\b(transform|all)(,|$)/;function Ei(t,e){var r,n=window.getComputedStyle(t),i=(n[yi+"Delay"]||"").split(", "),a=(n[yi+"Duration"]||"").split(", "),o=Ii(i,a),s=(n[bi+"Delay"]||"").split(", "),l=(n[bi+"Duration"]||"").split(", "),t=Ii(s,l),i=0,s=0;return e===gi?0<o&&(r=gi,i=o,s=a.length):e===vi?0<t&&(r=vi,i=t,s=l.length):s=(r=0<(i=Math.max(o,t))?t<o?gi:vi:null)?(r===gi?a:l).length:0,{type:r,timeout:i,propCount:s,hasTransform:r===gi&&Si.test(n[yi+"Property"])}}function Ii(r,t){for(;r.length<t.length;)r=r.concat(r);return Math.max.apply(null,t.map(function(t,e){return Li(t)+Li(r[e])}))}function Li(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Ri(e,t){var r=e.elm;O(r._leaveCb)&&(r._leaveCb.cancelled=!0,r._leaveCb());var n=pi(e.data.transition);if(!D(n)&&!O(r._enterCb)&&1===r.nodeType){for(var i=n.css,a=n.type,o=n.enterClass,s=n.enterToClass,l=n.enterActiveClass,u=n.appearClass,c=n.appearToClass,h=n.appearActiveClass,d=n.beforeEnter,p=n.enter,f=n.afterEnter,m=n.enterCancelled,g=n.beforeAppear,v=n.appear,y=n.afterAppear,x=n.appearCancelled,b=n.duration,_=Xe,A=Xe.$vnode;A&&A.parent;)_=A.context,A=A.parent;var w,M,C,T,S,E,I,L,R,P,n=!_._isMounted||!e.isRootInsert;n&&!v&&""!==v||(w=n&&u?u:o,M=n&&h?h:l,C=n&&c?c:s,d=n&&g||d,T=n&&"function"==typeof v?v:p,S=n&&y||f,E=n&&x||m,I=B(F(b)?b.enter:b),L=!1!==i&&!J,R=Oi(T),P=r._enterCb=N(function(){L&&(Ci(r,C),Ci(r,M)),P.cancelled?(L&&Ci(r,w),E&&E(r)):S&&S(r),r._enterCb=null}),e.data.show||ae(e,"insert",function(){var t=r.parentNode,t=t&&t._pending&&t._pending[e.key];t&&t.tag===e.tag&&t.elm._leaveCb&&t.elm._leaveCb(),T&&T(r,P)}),d&&d(r),L&&(Mi(r,w),Mi(r,M),wi(function(){Ci(r,w),P.cancelled||(Mi(r,C),R||(Di(I)?setTimeout(P,I):Ti(r,a,P)))})),e.data.show&&(t&&t(),T&&T(r,P)),L||R||P())}}function Pi(t,e){var r=t.elm;O(r._enterCb)&&(r._enterCb.cancelled=!0,r._enterCb());var n,i,a,o,s,l,u,c,h,d,p,f,m,g,v=pi(t.data.transition);if(D(v)||1!==r.nodeType)return e();function y(){g.cancelled||(!t.data.show&&r.parentNode&&((r.parentNode._pending||(r.parentNode._pending={}))[t.key]=t),l&&l(r),p&&(Mi(r,a),Mi(r,s),wi(function(){Ci(r,a),g.cancelled||(Mi(r,o),f||(Di(m)?setTimeout(g,m):Ti(r,i,g)))})),u&&u(r,g),p||f||g())}O(r._leaveCb)||(n=v.css,i=v.type,a=v.leaveClass,o=v.leaveToClass,s=v.leaveActiveClass,l=v.beforeLeave,u=v.leave,c=v.afterLeave,h=v.leaveCancelled,d=v.delayLeave,v=v.duration,p=!1!==n&&!J,f=Oi(u),m=B(F(v)?v.leave:v),g=r._leaveCb=N(function(){r.parentNode&&r.parentNode._pending&&(r.parentNode._pending[t.key]=null),p&&(Ci(r,o),Ci(r,s)),g.cancelled?(p&&Ci(r,a),h&&h(r)):(e(),c&&c(r)),r._leaveCb=null}),d?d(y):y())}function Di(t){return"number"==typeof t&&!isNaN(t)}function Oi(t){if(D(t))return!1;var e=t.fns;return O(e)?Oi(Array.isArray(e)?e[0]:e):1<(t._length||t.length)}function Fi(t,e){!0!==e.data.show&&Ri(e)}mt=function(t){for(var e,f={},r=t.modules,v=t.nodeOps,n=0;n<ln.length;++n)for(f[ln[n]]=[],e=0;e<r.length;++e)O(r[e][ln[n]])&&f[ln[n]].push(r[e][ln[n]]);function a(t,e){function r(){0==--r.listeners&&o(t)}return r.listeners=e,r}function o(t){var e=v.parentNode(t);O(e)&&v.removeChild(e,t)}function y(t,e,r,n,i,a,o){(t=O(t.elm)&&O(a)?a[o]=yt(t):t).isRootInsert=!i,function(t,e,r,n){var i=t.data;if(O(i)){var a=O(t.componentInstance)&&i.keepAlive;if(O(i=i.hook)&&O(i=i.init)&&i(t,!1),O(t.componentInstance))return p(t,e),s(r,t.elm,n),!0===a&&function(t,e,r,n){for(var i,a=t;a.componentInstance;)if(a=a.componentInstance._vnode,O(i=a.data)&&O(i=i.transition)){for(i=0;i<f.activate.length;++i)f.activate[i](sn,a);e.push(a);break}s(r,t.elm,n)}(t,e,r,n),!0}}(t,e,r,n)||(a=t.data,o=t.children,O(i=t.tag)?(t.elm=t.ns?v.createElementNS(t.ns,i):v.createElement(i,t),l(t),m(t,o,e),O(a)&&x(t,e)):!0===t.isComment?t.elm=v.createComment(t.text):t.elm=v.createTextNode(t.text),s(r,t.elm,n))}function p(t,e){O(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,g(t)?(x(t,e),l(t)):(on(t),e.push(t))}function s(t,e,r){O(t)&&(O(r)?v.parentNode(r)===t&&v.insertBefore(t,e,r):v.appendChild(t,e))}function m(t,e,r){if(Array.isArray(e)){0;for(var n=0;n<e.length;++n)y(e[n],r,t.elm,null,!0,e,n)}else h(t.text)&&v.appendChild(t.elm,v.createTextNode(String(t.text)))}function g(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return O(t.tag)}function x(t,e){for(var r=0;r<f.create.length;++r)f.create[r](sn,t);O(n=t.data.hook)&&(O(n.create)&&n.create(sn,t),O(n.insert)&&e.push(t))}function l(t){var e;if(O(e=t.fnScopeId))v.setStyleScope(t.elm,e);else for(var r=t;r;)O(e=r.context)&&O(e=e.$options._scopeId)&&v.setStyleScope(t.elm,e),r=r.parent;O(e=Xe)&&e!==t.context&&e!==t.fnContext&&O(e=e.$options._scopeId)&&v.setStyleScope(t.elm,e)}function b(t,e,r,n,i,a){for(;n<=i;++n)y(r[n],a,t,e,!1,r,n)}function _(t){var e,r,n=t.data;if(O(n))for(O(e=n.hook)&&O(e=e.destroy)&&e(t),e=0;e<f.destroy.length;++e)f.destroy[e](t);if(O(e=t.children))for(r=0;r<t.children.length;++r)_(t.children[r])}function A(t,e,r){for(;e<=r;++e){var n=t[e];O(n)&&(O(n.tag)?(function t(e,r){if(O(r)||O(e.data)){var n,i=f.remove.length+1;for(O(r)?r.listeners+=i:r=a(e.elm,i),O(n=e.componentInstance)&&O(n=n._vnode)&&O(n.data)&&t(n,r),n=0;n<f.remove.length;++n)f.remove[n](e,r);O(n=e.data.hook)&&O(n=n.remove)?n(e,r):r()}else o(e.elm)}(n),_(n)):o(n.elm))}}function u(t,e,r,n,i){var a,o,s,l=0,u=0,c=e.length-1,h=e[0],d=e[c],p=r.length-1,f=r[0],m=r[p],g=!i;for(0;l<=c&&u<=p;)D(h)?h=e[++l]:D(d)?d=e[--c]:un(h,f)?(w(h,f,n,r,u),h=e[++l],f=r[++u]):un(d,m)?(w(d,m,n,r,p),d=e[--c],m=r[--p]):un(h,m)?(w(h,m,n,r,p),g&&v.insertBefore(t,h.elm,v.nextSibling(d.elm)),h=e[++l],m=r[--p]):f=(un(d,f)?(w(d,f,n,r,u),g&&v.insertBefore(t,d.elm,h.elm),d=e[--c]):(D(a)&&(a=function(t,e,r){for(var n,i={},a=e;a<=r;++a)O(n=t[a].key)&&(i[n]=a);return i}(e,l,c)),!D(o=O(f.key)?a[f.key]:function(t,e,r,n){for(var i=r;i<n;i++){var a=e[i];if(O(a)&&un(t,a))return i}}(f,e,l,c))&&un(s=e[o],f)?(w(s,f,n,r,u),e[o]=void 0,g&&v.insertBefore(t,s.elm,h.elm)):y(f,n,t,h.elm,!1,r,u)),r[++u]);c<l?b(t,D(r[p+1])?null:r[p+1].elm,r,u,p,n):p<u&&A(e,l,c)}function w(t,e,r,n,i,a){if(t!==e){var o=(e=O(e.elm)&&O(n)?n[i]=yt(e):e).elm=t.elm;if(!0!==t.isAsyncPlaceholder)if(!0!==e.isStatic||!0!==t.isStatic||e.key!==t.key||!0!==e.isCloned&&!0!==e.isOnce){var s,l=e.data;O(l)&&O(s=l.hook)&&O(s=s.prepatch)&&s(t,e);n=t.children,i=e.children;if(O(l)&&g(e)){for(s=0;s<f.update.length;++s)f.update[s](t,e);O(s=l.hook)&&O(s=s.update)&&s(t,e)}D(e.text)?O(n)&&O(i)?n!==i&&u(o,n,i,r,a):O(i)?(O(t.text)&&v.setTextContent(o,""),b(o,null,i,0,i.length-1,r)):O(n)?A(n,0,n.length-1):O(t.text)&&v.setTextContent(o,""):t.text!==e.text&&v.setTextContent(o,e.text),O(l)&&O(s=l.hook)&&O(s=s.postpatch)&&s(t,e)}else e.componentInstance=t.componentInstance;else O(e.asyncFactory.resolved)?T(t.elm,e,r):e.isAsyncPlaceholder=!0}}function M(t,e,r){if(!0===r&&O(t.parent))t.parent.data.pendingInsert=e;else for(var n=0;n<e.length;++n)e[n].data.hook.insert(e[n])}var C=c("attrs,class,staticClass,staticStyle,key");function T(t,e,r,n){var i,a=e.tag,o=e.data,s=e.children;if(n=n||o&&o.pre,e.elm=t,!0===e.isComment&&O(e.asyncFactory))return e.isAsyncPlaceholder=!0;if(0,O(o)&&(O(i=o.hook)&&O(i=i.init)&&i(e,!0),O(i=e.componentInstance)))return p(e,r),1;if(O(a)){if(O(s))if(t.hasChildNodes())if(O(i=o)&&O(i=i.domProps)&&O(i=i.innerHTML)){if(i!==t.innerHTML)return void 0}else{for(var l=!0,u=t.firstChild,c=0;c<s.length;c++){if(!u||!T(u,s[c],r,n)){l=!1;break}u=u.nextSibling}if(!l||u)return void 0}else m(e,s,r);if(O(o)){var h,d=!1;for(h in o)if(!C(h)){d=!0,x(e,r);break}!d&&o.class&&ee(o.class)}}else t.data!==e.text&&(t.data=e.text);return 1}return function(t,e,r,n){if(!D(e)){var i=!1,a=[];if(D(t))i=!0,y(e,a);else{var o=O(t.nodeType);if(!o&&un(t,e))w(t,e,a,null,null,n);else{if(o){if(1===t.nodeType&&t.hasAttribute(R)&&(t.removeAttribute(R),r=!0),!0===r&&T(t,e,a))return M(e,a,!0),t;s=t,t=new ft(v.tagName(s).toLowerCase(),{},[],void 0,s)}var r=t.elm,s=v.parentNode(r);if(y(e,a,r._leaveCb?null:s,v.nextSibling(r)),O(e.parent))for(var l=e.parent,u=g(e);l;){for(var c=0;c<f.destroy.length;++c)f.destroy[c](l);if(l.elm=e.elm,u){for(var h=0;h<f.create.length;++h)f.create[h](sn,l);var d=l.data.hook.insert;if(d.merged)for(var p=1;p<d.fns.length;p++)d.fns[p]()}else on(l);l=l.parent}O(s)?A([t],0,0):O(t.tag)&&_(t)}}return M(e,a,i),e.elm}O(t)&&_(t)}}({nodeOps:Y,modules:[Fr,mt,z,Zt,$,j?{create:Fi,activate:Fi,remove:function(t,e){!0!==t.data.show?Pi(t,e):e()}}:{}].concat(fn)});J&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&Vi(t,"input")});var Bi={inserted:function(t,e,r,n){"select"===r.tag?(n.elm&&!n.elm._vOptions?ae(r,"postpatch",function(){Bi.componentUpdated(t,e,r)}):Ni(t,e,r.context),t._vOptions=[].map.call(t.options,ki)):"textarea"!==r.tag&&!nn(t.type)||(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Hi),t.addEventListener("compositionend",Gi),t.addEventListener("change",Gi),J&&(t.vmodel=!0)))},componentUpdated:function(t,e,r){var n,i;"select"===r.tag&&(Ni(t,e,r.context),n=t._vOptions,(i=t._vOptions=[].map.call(t.options,ki)).some(function(t,e){return!I(t,n[e])})&&(t.multiple?e.value.some(function(t){return Ui(t,i)}):e.value!==e.oldValue&&Ui(e.value,i))&&Vi(t,"change"))}};function Ni(t,e,r){zi(t,e),(Z||K)&&setTimeout(function(){zi(t,e)},0)}function zi(t,e){var r=e.value,n=t.multiple;if(!n||Array.isArray(r)){for(var i,a,o=0,s=t.options.length;o<s;o++)if(a=t.options[o],n)i=-1<L(r,ki(a)),a.selected!==i&&(a.selected=i);else if(I(ki(a),r))return void(t.selectedIndex!==o&&(t.selectedIndex=o));n||(t.selectedIndex=-1)}}function Ui(e,t){return t.every(function(t){return!I(t,e)})}function ki(t){return"_value"in t?t._value:t.value}function Hi(t){t.target.composing=!0}function Gi(t){t.target.composing&&(t.target.composing=!1,Vi(t.target,"input"))}function Vi(t,e){var r=document.createEvent("HTMLEvents");r.initEvent(e,!0,!0),t.dispatchEvent(r)}function Wi(t){return!t.componentInstance||t.data&&t.data.transition?t:Wi(t.componentInstance._vnode)}z={model:Bi,show:{bind:function(t,e,r){var n=e.value,e=(r=Wi(r)).data&&r.data.transition,i=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&e?(r.data.show=!0,Ri(r,function(){t.style.display=i})):t.style.display=n?i:"none"},update:function(t,e,r){var n=e.value;!n!=!e.oldValue&&((r=Wi(r)).data&&r.data.transition?(r.data.show=!0,n?Ri(r,function(){t.style.display=t.__vOriginalDisplay}):Pi(r,function(){t.style.display="none"})):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,r,n,i){i||(t.style.display=t.__vOriginalDisplay)}}},Zt={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ji(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?ji(He(e.children)):t}function Xi(t){var e,r={},n=t.$options;for(e in n.propsData)r[e]=t[e];var i,a=n._parentListeners;for(i in a)r[y(i)]=a[i];return r}function qi(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function Yi(t){return t.tag||ke(t)}function Zi(t){return"show"===t.name}$={name:"transition",props:Zt,abstract:!0,render:function(t){var e=this,r=this.$slots.default;if(r&&(r=r.filter(Yi)).length){0;var n=this.mode;0;var i=r[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return 1}(this.$vnode))return i;var a=ji(i);if(!a)return i;if(this._leaving)return qi(t,i);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:!h(a.key)||0===String(a.key).indexOf(o)?a.key:o+a.key;var s=(a.data||(a.data={})).transition=Xi(this),l=this._vnode,u=ji(l);if(a.data.directives&&a.data.directives.some(Zi)&&(a.data.show=!0),u&&u.data&&(r=a,(o=u).key!==r.key||o.tag!==r.tag)&&!ke(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){u=u.data.transition=M({},s);if("out-in"===n)return this._leaving=!0,ae(u,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()}),qi(t,i);if("in-out"===n){if(ke(a))return l;var c,l=function(){c()};ae(s,"afterEnter",l),ae(s,"enterCancelled",l),ae(u,"delayLeave",function(t){c=t})}}return i}}},fn=M({tag:String,moveClass:String},Zt);function Ji(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function Ki(t){t.data.newPos=t.elm.getBoundingClientRect()}function Qi(t){var e=t.data.pos,r=t.data.newPos,n=e.left-r.left,r=e.top-r.top;(n||r)&&(t.data.moved=!0,(t=t.elm.style).transform=t.WebkitTransform="translate("+n+"px,"+r+"px)",t.transitionDuration="0s")}delete fn.mode;Zt={Transition:$,TransitionGroup:{props:fn,beforeMount:function(){var n=this,i=this._update;this._update=function(t,e){var r=qe(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,r(),i.call(n,t,e)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",r=Object.create(null),n=this.prevChildren=this.children,i=this.$slots.default||[],a=this.children=[],o=Xi(this),s=0;s<i.length;s++){var l=i[s];l.tag&&null!=l.key&&0!==String(l.key).indexOf("__vlist")&&(a.push(l),((r[l.key]=l).data||(l.data={})).transition=o)}if(n){for(var u=[],c=[],h=0;h<n.length;h++){var d=n[h];d.data.transition=o,d.data.pos=d.elm.getBoundingClientRect(),(r[d.key]?u:c).push(d)}this.kept=t(e,null,u),this.removed=c}return t(e,null,a)},updated:function(){var t=this.prevChildren,n=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,n)&&(t.forEach(Ji),t.forEach(Ki),t.forEach(Qi),this._reflow=document.body.offsetHeight,t.forEach(function(t){var r;t.data.moved&&(t=(r=t.elm).style,Mi(r,n),t.transform=t.WebkitTransform=t.transitionDuration="",r.addEventListener(xi,r._moveCb=function t(e){e&&e.target!==r||e&&!/transform$/.test(e.propertyName)||(r.removeEventListener(xi,t),r._moveCb=null,Ci(r,n))}))}))},methods:{hasMove:function(t,e){if(!mi)return!1;if(this._hasMove)return this._hasMove;var r=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach(function(t){di(r,t)}),hi(r,e),r.style.display="none",this.$el.appendChild(r);e=Ei(r);return this.$el.removeChild(r),this._hasMove=e.hasTransform}}}};Tr.config.mustUseProp=q,Tr.config.isReservedTag=Kr,Tr.config.isReservedAttr=Nr,Tr.config.getTagNamespace=en,Tr.config.isUnknownElement=function(t){if(!j)return!0;if(Kr(t))return!1;if(t=t.toLowerCase(),null!=rn[t])return rn[t];var e=document.createElement(t);return-1<t.indexOf("-")?rn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:rn[t]=/HTMLUnknownElement/.test(e.toString())},M(Tr.options.directives,z),M(Tr.options.components,Zt),Tr.prototype.__patch__=j?mt:T,Tr.prototype.$mount=function(t,e){return t=t&&j?an(t):void 0,t=t,n=e,(r=this).$el=t,r.$options.render||(r.$options.render=gt),Je(r,"beforeMount"),t=function(){r._update(r._render(),n)},new lr(r,t,T,{before:function(){r._isMounted&&!r._isDestroyed&&Je(r,"beforeUpdate")}},!0),n=!1,null==r.$vnode&&(r._isMounted=!0,Je(r,"mounted")),r;var r,n},j&&setTimeout(function(){U.devtools&&it&&it.emit("init",Tr)},0);var $i=/\{\{((?:.|\r?\n)+?)\}\}/g,ta=/[-.*+?^${}()|[\]\/\\]/g,ea=p(function(t){var e=t[0].replace(ta,"\\$&"),t=t[1].replace(ta,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+t,"g")});$={staticKeys:["staticClass"],transformNode:function(t,e){e.warn,(e=Fn(t,"class"))&&(t.staticClass=JSON.stringify(e)),(e=On(t,"class",!1))&&(t.classBinding=e)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}};var ra,fn={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn,(e=Fn(t,"style"))&&(t.staticStyle=JSON.stringify(ti(e))),(e=On(t,"style",!1))&&(t.styleBinding=e)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},Nr=function(t){return(ra=ra||document.createElement("div")).innerHTML=t,ra.textContent},z=c("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),Zt=c("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),na=c("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),ia=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,aa=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,mt="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+k.source+"]*",mt="((?:"+mt+"\\:)?"+mt+")",oa=new RegExp("^<"+mt),sa=/^\s*(\/?)>/,la=new RegExp("^<\\/"+mt+"[^>]*>"),ua=/^<!DOCTYPE [^>]+>/i,ca=/^<!\--/,ha=/^<!\[/,da=c("script,style,textarea",!0),pa={},fa={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},ma=/&(?:lt|gt|quot|amp|#39);/g,ga=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,va=c("pre,textarea",!0),ya=function(t,e){return t&&va(t)&&"\n"===e[0]};function xa(i,u){for(var t,c,h=[],d=u.expectHTML,p=u.isUnaryTag||S,f=u.canBeLeftOpenTag||S,o=0;i;){if(t=i,c&&da(c)){var n=0,a=c.toLowerCase(),e=pa[a]||(pa[a]=new RegExp("([\\s\\S]*?)(</"+a+"[^>]*>)","i")),e=i.replace(e,function(t,e,r){return n=r.length,da(a)||"noscript"===a||(e=e.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),ya(a,e)&&(e=e.slice(1)),u.chars&&u.chars(e),""});o+=i.length-e.length,i=e,y(a,o-n,o)}else{var r=i.indexOf("<");if(0===r){if(ca.test(i)){e=i.indexOf("--\x3e");if(0<=e){u.shouldKeepComment&&u.comment(i.substring(4,e),o,o+e+3),v(e+3);continue}}if(ha.test(i)){var s=i.indexOf("]>");if(0<=s){v(s+2);continue}}s=i.match(ua);if(s){v(s[0].length);continue}s=i.match(la);if(s){var l=o;v(s[0].length),y(s[1],l,o);continue}l=function(){var t,e,r=i.match(oa);if(r){var n={tagName:r[1],attrs:[],start:o};for(v(r[0].length);!(t=i.match(sa))&&(e=i.match(aa)||i.match(ia));)e.start=o,v(e[0].length),e.end=o,n.attrs.push(e);if(t)return n.unarySlash=t[1],v(t[0].length),n.end=o,n}}();if(l){!function(t){var e=t.tagName,r=t.unarySlash;d&&("p"===c&&na(e)&&y(c),f(e)&&c===e&&y(e));for(var r=p(e)||!!r,n=t.attrs.length,i=new Array(n),a=0;a<n;a++){var o=t.attrs[a],s=o[3]||o[4]||o[5]||"",l="a"===e&&"href"===o[1]?u.shouldDecodeNewlinesForHref:u.shouldDecodeNewlines;i[a]={name:o[1],value:function(t,e){return e=e?ga:ma,t.replace(e,function(t){return fa[t]})}(s,l)}}r||(h.push({tag:e,lowerCasedTag:e.toLowerCase(),attrs:i,start:t.start,end:t.end}),c=e),u.start&&u.start(e,i,r,t.start,t.end)}(l),ya(l.tagName,i)&&v(1);continue}}var m,l=void 0,g=void 0;if(0<=r){for(g=i.slice(r);!(la.test(g)||oa.test(g)||ca.test(g)||ha.test(g)||(m=g.indexOf("<",1))<0);)r+=m,g=i.slice(r);l=i.substring(0,r)}(l=r<0?i:l)&&v(l.length),u.chars&&l&&u.chars(l,o-l.length,o)}if(i===t){u.chars&&u.chars(i);break}}function v(t){o+=t,i=i.substring(t)}function y(t,e,r){var n,i;if(null==e&&(e=o),null==r&&(r=o),t)for(i=t.toLowerCase(),n=h.length-1;0<=n&&h[n].lowerCasedTag!==i;n--);else n=0;if(0<=n){for(var a=h.length-1;n<=a;a--)u.end&&u.end(h[a].tag,e,r);h.length=n,c=n&&h[n-1].tag}else"br"===i?u.start&&u.start(t,[],!0,e,r):"p"===i&&(u.start&&u.start(t,[],!1,e,r),u.end&&u.end(t,e,r))}y()}var ba,_a,Aa,wa,Ma,Ca,Ta,Sa,Ea=/^@|^v-on:/,Ia=/^v-|^@|^:|^#/,La=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Ra=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Pa=/^\(|\)$/g,Da=/^\[.*\]$/,Oa=/:(.*)$/,Fa=/^:|^\.|^v-bind:/,Ba=/\.[^.\]]+(?=[^\]]*$)/g,Na=/^v-slot(:|$)|^#/,za=/[\r\n]/,Ua=/\s+/g,ka=p(Nr),Ha="_empty_";function Ga(t,e,r){return{type:1,tag:t,attrsList:e,attrsMap:function(t){for(var e={},r=0,n=t.length;r<n;r++)e[t[r].name]=t[r].value;return e}(e),rawAttrsMap:{},parent:r,children:[]}}function Va(t,u){ba=u.warn||Sn,Ca=u.isPreTag||S,Ta=u.mustUseProp||S,Sa=u.getTagNamespace||S;var e=u.isReservedTag||S;Aa=En(u.modules,"transformNode"),wa=En(u.modules,"preTransformNode"),Ma=En(u.modules,"postTransformNode"),_a=u.delimiters;var c,h,d=[],s=!1!==u.preserveWhitespace,l=u.whitespace,p=!1,f=!1;function m(t){var e,r;i(t),p||t.processed||(t=Wa(t,u)),d.length||t===c||c.if&&(t.elseif||t.else)&&Xa(c,{exp:t.elseif,block:t}),h&&!t.forbidden&&(t.elseif||t.else?(e=t,(r=function(t){var e=t.length;for(;e--;){if(1===t[e].type)return t[e];t.pop()}}((r=h).children))&&r.if&&Xa(r,{exp:e.elseif,block:e})):(t.slotScope&&(e=t.slotTarget||'"default"',(h.scopedSlots||(h.scopedSlots={}))[e]=t),h.children.push(t),t.parent=h)),t.children=t.children.filter(function(t){return!t.slotScope}),i(t),t.pre&&(p=!1),Ca(t.tag)&&(f=!1);for(var n=0;n<Ma.length;n++)Ma[n](t,u)}function i(t){if(!f)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return xa(t,{warn:ba,expectHTML:u.expectHTML,isUnaryTag:u.isUnaryTag,canBeLeftOpenTag:u.canBeLeftOpenTag,shouldDecodeNewlines:u.shouldDecodeNewlines,shouldDecodeNewlinesForHref:u.shouldDecodeNewlinesForHref,shouldKeepComment:u.comments,outputSourceRange:u.outputSourceRange,start:function(t,e,r,n,i){var a=h&&h.ns||Sa(t),o=Ga(t,e=Z&&"svg"===a?function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Ya.test(n.name)||(n.name=n.name.replace(Za,""),e.push(n))}return e}(e):e,h);a&&(o.ns=a),"style"!==(a=o).tag&&("script"!==a.tag||a.attrsMap.type&&"text/javascript"!==a.attrsMap.type)||nt()||(o.forbidden=!0);for(var s,l=0;l<wa.length;l++)o=wa[l](o,u)||o;p||(null!=Fn(s=o,"v-pre")&&(s.pre=!0),o.pre&&(p=!0)),Ca(o.tag)&&(f=!0),p?function(t){var e=t.attrsList,r=e.length;if(r)for(var n=t.attrs=new Array(r),i=0;i<r;i++)n[i]={name:e[i].name,value:JSON.stringify(e[i].value)},null!=e[i].start&&(n[i].start=e[i].start,n[i].end=e[i].end);else t.pre||(t.plain=!0)}(o):o.processed||(ja(o),(s=Fn(a=o,"v-if"))?(a.if=s,Xa(a,{exp:s,block:a})):(null!=Fn(a,"v-else")&&(a.else=!0),(s=Fn(a,"v-else-if"))&&(a.elseif=s)),null!=Fn(s=o,"v-once")&&(s.once=!0)),c=c||o,r?m(o):(h=o,d.push(o))},end:function(t,e,r){var n=d[d.length-1];--d.length,h=d[d.length-1],m(n)},chars:function(t,e,r){var n,i,a,o;h&&(Z&&"textarea"===h.tag&&h.attrsMap.placeholder===t||(n=h.children,(t=f||t.trim()?"script"===(i=h).tag||"style"===i.tag?t:ka(t):n.length?l?"condense"===l&&za.test(t)?"":" ":s?" ":"":"")&&(f||"condense"!==l||(t=t.replace(Ua," ")),!p&&" "!==t&&(a=function(t,e){var r=e?ea(e):$i;if(r.test(t)){for(var n,i,a,o=[],s=[],l=r.lastIndex=0;n=r.exec(t);){l<(i=n.index)&&(s.push(a=t.slice(l,i)),o.push(JSON.stringify(a)));var u=Tn(n[1].trim());o.push("_s("+u+")"),s.push({"@binding":u}),l=i+n[0].length}return l<t.length&&(s.push(a=t.slice(l)),o.push(JSON.stringify(a))),{expression:o.join("+"),tokens:s}}}(t,_a))?o={type:2,expression:a.expression,tokens:a.tokens,text:t}:" "===t&&n.length&&" "===n[n.length-1].text||(o={type:3,text:t}),o&&n.push(o))))},comment:function(t,e,r){h&&(t={type:3,text:t,isComment:!0},h.children.push(t))}}),c}function Wa(t,e){var r,n;(n=On(r=t,"key"))&&(r.key=n),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,(n=On(r=t,"ref"))&&(r.ref=n,r.refInFor=function(t){var e=t;for(;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(r)),function(t){"template"===t.tag?(o=Fn(t,"scope"),t.slotScope=o||Fn(t,"slot-scope")):(o=Fn(t,"slot-scope"))&&(t.slotScope=o);var e,r,n,i,a,o=On(t,"slot");o&&(t.slotTarget='""'===o?'"default"':o,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||Ln(t,"slot",o,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot"))),"template"===t.tag?(n=Bn(t,Na))&&(e=qa(n),r=e.name,i=e.dynamic,t.slotTarget=r,t.slotTargetDynamic=i,t.slotScope=n.value||Ha):(e=Bn(t,Na))&&(r=t.scopedSlots||(t.scopedSlots={}),i=qa(e),n=i.name,i=i.dynamic,(a=r[n]=Ga("template",[],t)).slotTarget=n,a.slotTargetDynamic=i,a.children=t.children.filter(function(t){if(!t.slotScope)return t.parent=a,!0}),a.slotScope=e.value||Ha,t.children=[],t.plain=!1)}(t),"slot"===(n=t).tag&&(n.slotName=On(n,"name")),(n=On(r=t,"is"))&&(r.component=n),null!=Fn(r,"inline-template")&&(r.inlineTemplate=!0);for(var i=0;i<Aa.length;i++)t=Aa[i](t,e)||t;return function(t){var e,r,n,i,a,o,s,l,u=t.attrsList;for(e=0,r=u.length;e<r;e++)n=i=u[e].name,a=u[e].value,Ia.test(n)?(t.hasBindings=!0,(o=function(t){t=t.match(Ba);if(t){var e={};return t.forEach(function(t){e[t.slice(1)]=!0}),e}}(n.replace(Ia,"")))&&(n=n.replace(Ba,"")),Fa.test(n)?(n=n.replace(Fa,""),a=Tn(a),(s=Da.test(n))&&(n=n.slice(1,-1)),o&&(o.prop&&!s&&"innerHtml"===(n=y(n))&&(n="innerHTML"),o.camel&&!s&&(n=y(n)),o.sync&&(l=Un(a,"$event"),s?Dn(t,'"update:"+('+n+")",l,null,!1,0,u[e],!0):(Dn(t,"update:"+y(n),l,null,!1,0,u[e]),_(n)!==y(n)&&Dn(t,"update:"+_(n),l,null,!1,0,u[e])))),(o&&o.prop||!t.component&&Ta(t.tag,t.attrsMap.type,n)?In:Ln)(t,n,a,u[e],s)):Ea.test(n)?(n=n.replace(Ea,""),(s=Da.test(n))&&(n=n.slice(1,-1)),Dn(t,n,a,o,!1,0,u[e],s)):(l=(n=n.replace(Ia,"")).match(Oa),l=l&&l[1],s=!1,l&&(n=n.slice(0,-(l.length+1)),Da.test(l)&&(l=l.slice(1,-1),s=!0)),function(t,e,r,n,i,a,o,s){(t.directives||(t.directives=[])).push(Nn({name:e,rawName:r,value:n,arg:i,isDynamicArg:a,modifiers:o},s)),t.plain=!1}(t,n,i,a,l,s,o,u[e]))):(Ln(t,n,JSON.stringify(a),u[e]),!t.component&&"muted"===n&&Ta(t.tag,t.attrsMap.type,n)&&In(t,n,"true",u[e]))}(t),t}function ja(t){var e;!(e=Fn(t,"v-for"))||(e=function(t){var e=t.match(La);if(!e)return;var r={};r.for=e[2].trim();t=e[1].trim().replace(Pa,""),e=t.match(Ra);e?(r.alias=t.replace(Ra,"").trim(),r.iterator1=e[1].trim(),e[2]&&(r.iterator2=e[2].trim())):r.alias=t;return r}(e))&&M(t,e)}function Xa(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function qa(t){var e=t.name.replace(Na,"");return e||"#"!==t.name[0]&&(e="default"),Da.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}var Ya=/^xmlns:NS\d+/,Za=/^NS\d+:/;function Ja(t){return Ga(t.tag,t.attrsList.slice(),t.parent)}var Ka=[$,fn,{preTransformNode:function(t,e){if("input"===t.tag){var r,n=t.attrsMap;if(n["v-model"])if((n[":type"]||n["v-bind:type"])&&(r=On(t,"type")),r=!n.type&&!r&&n["v-bind"]?"("+n["v-bind"]+").type":r){var i=Fn(t,"v-if",!0),a=i?"&&("+i+")":"",o=null!=Fn(t,"v-else",!0),s=Fn(t,"v-else-if",!0),l=Ja(t);ja(l),Rn(l,"type","checkbox"),Wa(l,e),l.processed=!0,l.if="("+r+")==='checkbox'"+a,Xa(l,{exp:l.if,block:l});n=Ja(t);Fn(n,"v-for",!0),Rn(n,"type","radio"),Wa(n,e),Xa(l,{exp:"("+r+")==='radio'"+a,block:n});t=Ja(t);return Fn(t,"v-for",!0),Rn(t,":type",r),Wa(t,e),Xa(l,{exp:i,block:t}),o?l.else=!0:s&&(l.elseif=s),l}}}}];var Qa,$a,Zt={expectHTML:!0,modules:Ka,directives:{model:function(t,e,r){0;var n,i,a,o,s,l,u,c,h=e.value,d=e.modifiers,p=t.tag,f=t.attrsMap.type;if(0,t.component)return zn(t,h,d),!1;if("select"===p)u=t,c=(c='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+((c=d)&&c.number?"_n(val)":"val")+"});")+" "+Un(h,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),!void Dn(u,"change",c,null,!0);else if("input"===p&&"checkbox"===f)r=t,s=h,u=(e=d)&&e.number,l=On(r,"value")||"null",c=On(r,"true-value")||"true",e=On(r,"false-value")||"false",In(r,"checked","Array.isArray("+s+")?_i("+s+","+l+")>-1"+("true"===c?":("+s+")":":_q("+s+","+c+")")),Dn(r,"change","var $$a="+s+",$$el=$event.target,$$c=$$el.checked?("+c+"):("+e+");if(Array.isArray($$a)){var $$v="+(u?"_n("+l+")":l)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Un(s,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Un(s,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Un(s,"$$c")+"}",null,!0);else if("input"===p&&"radio"===f)n=t,i=h,o=(a=d)&&a.number,a=On(n,"value")||"null",In(n,"checked","_q("+i+","+(a=o?"_n("+a+")":a)+")"),Dn(n,"change",Un(i,a),null,!0);else if("input"===p||"textarea"===p)l=h,s=d,o=(f=t).attrsMap.type,i=(n=s||{}).number,s=n.trim,n=!(a=n.lazy)&&"range"!==o,a=a?"change":"range"===o?jn:"input",o=s?"$event.target.value.trim()":"$event.target.value",o=Un(l,o=i?"_n("+o+")":o),n&&(o="if($event.target.composing)return;"+o),In(f,"value","("+l+")"),Dn(f,a,o,null,!0),!void((s||i)&&Dn(f,"blur","$forceUpdate()"));else{if(!U.isReservedTag(p))return zn(t,h,d),!1}return!0},text:function(t,e){e.value&&In(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&In(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:z,mustUseProp:q,canBeLeftOpenTag:Zt,isReservedTag:Kr,getTagNamespace:en,staticKeys:Ka.reduce(function(t,e){return t.concat(e.staticKeys||[])},[]).join(",")},to=p(function(t){return c("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))});function eo(t,e){t&&(Qa=to(e.staticKeys||""),$a=e.isReservedTag||S,function t(e){e.static=ro(e);if(1===e.type&&($a(e.tag)||"slot"===e.tag||null!=e.attrsMap["inline-template"])){for(var r=0,n=e.children.length;r<n;r++){var i=e.children[r];t(i),i.static||(e.static=!1)}if(e.ifConditions)for(var a=1,o=e.ifConditions.length;a<o;a++){var s=e.ifConditions[a].block;t(s),s.static||(e.static=!1)}}}(t),function t(e,r){if(1===e.type)if((e.static||e.once)&&(e.staticInFor=r),!e.static||!e.children.length||1===e.children.length&&3===e.children[0].type){if(e.staticRoot=!1,e.children)for(var n=0,i=e.children.length;n<i;n++)t(e.children[n],r||!!e.for);if(e.ifConditions)for(var a=1,o=e.ifConditions.length;a<o;a++)t(e.ifConditions[a].block,r)}else e.staticRoot=!0}(t,!1))}function ro(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||o(t.tag)||!$a(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(Qa))))}var no=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,io=/\([^)]*?\);*$/,ao=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,oo={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},so={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},lo=function(t){return"if("+t+")return null;"},uo={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:lo("$event.target !== $event.currentTarget"),ctrl:lo("!$event.ctrlKey"),shift:lo("!$event.shiftKey"),alt:lo("!$event.altKey"),meta:lo("!$event.metaKey"),left:lo("'button' in $event && $event.button !== 0"),middle:lo("'button' in $event && $event.button !== 1"),right:lo("'button' in $event && $event.button !== 2")};function co(t,e){var r,e=e?"nativeOn:":"on:",n="",i="";for(r in t){var a=function e(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map(function(t){return e(t)}).join(",")+"]";var r=ao.test(t.value);var n=no.test(t.value);var i=ao.test(t.value.replace(io,""));{if(t.modifiers){var a,o,s="",l="",u=[];for(a in t.modifiers)uo[a]?(l+=uo[a],oo[a]&&u.push(a)):"exact"===a?(o=t.modifiers,l+=lo(["ctrl","shift","alt","meta"].filter(function(t){return!o[t]}).map(function(t){return"$event."+t+"Key"}).join("||"))):u.push(a);u.length&&(s+=ho(u)),l&&(s+=l);var c=r?"return "+t.value+"($event)":n?"return ("+t.value+")($event)":i?"return "+t.value:t.value;return"function($event){"+s+c+"}"}return r||n?t.value:"function($event){"+(i?"return "+t.value:t.value)+"}"}}(t[r]);t[r]&&t[r].dynamic?i+=r+","+a+",":n+='"'+r+'":'+a+","}return n="{"+n.slice(0,-1)+"}",i?e+"_d("+n+",["+i.slice(0,-1)+"])":e+n}function ho(t){return"if(!$event.type.indexOf('key')&&"+t.map(po).join("&&")+")return null;"}function po(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var r=oo[t],e=so[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(r)+",$event.key,"+JSON.stringify(e)+")"}var fo={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(e,r){e.wrapData=function(t){return"_b("+t+",'"+e.tag+"',"+r.value+","+(r.modifiers&&r.modifiers.prop?"true":"false")+(r.modifiers&&r.modifiers.sync?",true":"")+")"}},cloak:T},mo=function(t){this.options=t,this.warn=t.warn||Sn,this.transforms=En(t.modules,"transformCode"),this.dataGenFns=En(t.modules,"genData"),this.directives=M(M({},fo),t.directives);var e=t.isReservedTag||S;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function go(t,e){e=new mo(e);return{render:"with(this){return "+(t?vo(t,e):'_c("div")')+"}",staticRenderFns:e.staticRenderFns}}function vo(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return yo(t,e);if(t.once&&!t.onceProcessed)return xo(t,e);if(t.for&&!t.forProcessed)return _o(t,e);if(t.if&&!t.ifProcessed)return bo(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var r=t.slotName||'"default"',n=Co(t,e),e="_t("+r+(n?","+n:""),r=t.attrs||t.dynamicAttrs?Eo((t.attrs||[]).concat(t.dynamicAttrs||[]).map(function(t){return{name:y(t.name),value:t.value,dynamic:t.dynamic}})):null,t=t.attrsMap["v-bind"];!r&&!t||n||(e+=",null");r&&(e+=","+r);t&&(e+=(r?"":",null")+","+t);return e+")"}(t,e);var r,n;n=t.component?(a=t.component,s=e,l=(o=t).inlineTemplate?null:Co(o,s,!0),"_c("+a+","+Ao(o,s)+(l?","+l:"")+")"):((!t.plain||t.pre&&e.maybeComponent(t))&&(r=Ao(t,e)),l=t.inlineTemplate?null:Co(t,e,!0),"_c('"+t.tag+"'"+(r?","+r:"")+(l?","+l:"")+")");for(var i=0;i<e.transforms.length;i++)n=e.transforms[i](t,n);return n}return Co(t,e)||"void 0";var a,o,s,l}function yo(t,e){t.staticProcessed=!0;var r=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+vo(t,e)+"}"),e.pre=r,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function xo(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return bo(t,e);if(t.staticInFor){for(var r="",n=t.parent;n;){if(n.for){r=n.key;break}n=n.parent}return r?"_o("+vo(t,e)+","+e.onceId+++","+r+")":vo(t,e)}return yo(t,e)}function bo(t,e,r,n){return t.ifProcessed=!0,function t(e,r,n,i){if(!e.length)return i||"_e()";var a=e.shift();return a.exp?"("+a.exp+")?"+o(a.block)+":"+t(e,r,n,i):""+o(a.block);function o(t){return(n||(t.once?xo:vo))(t,r)}}(t.ifConditions.slice(),e,r,n)}function _o(t,e,r,n){var i=t.for,a=t.alias,o=t.iterator1?","+t.iterator1:"",s=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(n||"_l")+"(("+i+"),function("+a+o+s+"){return "+(r||vo)(t,e)+"})"}function Ao(t,e){var r="{",n=function(t,e){var r=t.directives;if(!r)return;var n,i,a,o,s="directives:[",l=!1;for(n=0,i=r.length;n<i;n++){a=r[n],o=!0;var u=e.directives[a.name];(o=u?!!u(t,a,e.warn):o)&&(l=!0,s+='{name:"'+a.name+'",rawName:"'+a.rawName+'"'+(a.value?",value:("+a.value+"),expression:"+JSON.stringify(a.value):"")+(a.arg?",arg:"+(a.isDynamicArg?a.arg:'"'+a.arg+'"'):"")+(a.modifiers?",modifiers:"+JSON.stringify(a.modifiers):"")+"},")}if(l)return s.slice(0,-1)+"]"}(t,e);n&&(r+=n+","),t.key&&(r+="key:"+t.key+","),t.ref&&(r+="ref:"+t.ref+","),t.refInFor&&(r+="refInFor:true,"),t.pre&&(r+="pre:true,"),t.component&&(r+='tag:"'+t.tag+'",');for(var i=0;i<e.dataGenFns.length;i++)r+=e.dataGenFns[i](t);return t.attrs&&(r+="attrs:"+Eo(t.attrs)+","),t.props&&(r+="domProps:"+Eo(t.props)+","),t.events&&(r+=co(t.events,!1)+","),t.nativeEvents&&(r+=co(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(r+="slot:"+t.slotTarget+","),t.scopedSlots&&(r+=function(t,e,r){var n=t.for||Object.keys(e).some(function(t){t=e[t];return t.slotTargetDynamic||t.if||t.for||wo(t)}),i=!!t.if;if(!n)for(var a=t.parent;a;){if(a.slotScope&&a.slotScope!==Ha||a.for){n=!0;break}a.if&&(i=!0),a=a.parent}t=Object.keys(e).map(function(t){return Mo(e[t],r)}).join(",");return"scopedSlots:_u(["+t+"]"+(n?",null,true":"")+(!n&&i?",null,false,"+function(t){var e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return e>>>0}(t):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(r+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),!t.inlineTemplate||(n=function(t,e){t=t.children[0];0;if(t&&1===t.type){e=go(t,e.options);return"inlineTemplate:{render:function(){"+e.render+"},staticRenderFns:["+e.staticRenderFns.map(function(t){return"function(){"+t+"}"}).join(",")+"]}"}}(t,e))&&(r+=n+","),r=r.replace(/,$/,"")+"}",t.dynamicAttrs&&(r="_b("+r+',"'+t.tag+'",'+Eo(t.dynamicAttrs)+")"),t.wrapData&&(r=t.wrapData(r)),r=t.wrapListeners?t.wrapListeners(r):r}function wo(t){return 1===t.type&&("slot"===t.tag||t.children.some(wo))}function Mo(t,e){var r=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!r)return bo(t,e,Mo,"null");if(t.for&&!t.forProcessed)return _o(t,e,Mo);var n=t.slotScope===Ha?"":String(t.slotScope),e="function("+n+"){return "+("template"===t.tag?t.if&&r?"("+t.if+")?"+(Co(t,e)||"undefined")+":undefined":Co(t,e)||"undefined":vo(t,e))+"}",n=n?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+e+n+"}"}function Co(t,e,r,n,i){var a=t.children;if(a.length){var o=a[0];if(1===a.length&&o.for&&"template"!==o.tag&&"slot"!==o.tag){t=r?e.maybeComponent(o)?",1":",0":"";return(n||vo)(o,e)+t}var r=r?function(t,e){for(var r=0,n=0;n<t.length;n++){var i=t[n];if(1===i.type){if(To(i)||i.ifConditions&&i.ifConditions.some(function(t){return To(t.block)})){r=2;break}(e(i)||i.ifConditions&&i.ifConditions.some(function(t){return e(t.block)}))&&(r=1)}}return r}(a,e.maybeComponent):0,s=i||So;return"["+a.map(function(t){return s(t,e)}).join(",")+"]"+(r?","+r:"")}}function To(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function So(t,e){return 1===t.type?vo(t,e):3===t.type&&t.isComment?(e=t,"_e("+JSON.stringify(e.text)+")"):"_v("+(2===(t=t).type?t.expression:Io(JSON.stringify(t.text)))+")"}function Eo(t){for(var e="",r="",n=0;n<t.length;n++){var i=t[n],a=Io(i.value);i.dynamic?r+=i.name+","+a+",":e+='"'+i.name+'":'+a+","}return e="{"+e.slice(0,-1)+"}",r?"_d("+e+",["+r.slice(0,-1)+"])":e}function Io(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b"),new RegExp("\\b"+"delete,typeof,void".split(",").join("\\s*\\([^\\)]*\\)|\\b")+"\\s*\\([^\\)]*\\)");function Lo(e,r){try{return new Function(e)}catch(t){return r.push({err:t,code:e}),T}}var Ro,Po,Zt=(Ro=function(t,e){t=Va(t.trim(),e);!1!==e.optimize&&eo(t,e);e=go(t,e);return{ast:t,render:e.render,staticRenderFns:e.staticRenderFns}},function(o){function t(t,e){var r,n=Object.create(o),i=[],a=[];if(e)for(r in e.modules&&(n.modules=(o.modules||[]).concat(e.modules)),e.directives&&(n.directives=M(Object.create(o.directives||null),e.directives)),e)"modules"!==r&&"directives"!==r&&(n[r]=e[r]);n.warn=function(t,e,r){(r?a:i).push(t)};t=Ro(t.trim(),n);return t.errors=i,t.tips=a,t}return{compile:t,compileToFunctions:(a=t,s=Object.create(null),function(t,e,r){(e=M({},e)).warn;delete e.warn;var n=e.delimiters?String(e.delimiters)+t:t;if(s[n])return s[n];t=a(t,e);var e={},i=[];return e.render=Lo(t.render,i),e.staticRenderFns=t.staticRenderFns.map(function(t){return Lo(t,i)}),s[n]=e})};var a,s})(Zt),Do=(Zt.compile,Zt.compileToFunctions);function Oo(t){return(Po=Po||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',0<Po.innerHTML.indexOf("&#10;")}var Fo=!!j&&Oo(!1),Bo=!!j&&Oo(!0),No=p(function(t){t=an(t);return t&&t.innerHTML}),zo=Tr.prototype.$mount;Tr.prototype.$mount=function(t,e){if((t=t&&an(t))===document.body||t===document.documentElement)return this;var r=this.$options;if(!r.render){var n,i=r.template;if(i)if("string"==typeof i)"#"===i.charAt(0)&&(i=No(i));else{if(!i.nodeType)return this;i=i.innerHTML}else t&&(i=function(t){{if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}}(t));i&&(i=(n=Do(i,{outputSourceRange:!1,shouldDecodeNewlines:Fo,shouldDecodeNewlinesForHref:Bo,delimiters:r.delimiters,comments:r.comments},this)).render,n=n.staticRenderFns,r.render=i,r.staticRenderFns=n)}return zo.call(this,t,e)},Tr.compile=Do,Uo.a=Tr}.call(this,e(18),e(51).setImmediate)},,function(t,e){var r,n,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,l=[],u=!1,c=-1;function h(){u&&s&&(u=!1,s.length?l=s.concat(l):c=-1,l.length&&d())}function d(){if(!u){var t=o(h);u=!0;for(var e=l.length;e;){for(s=l,l=[];++c<e;)s&&s[c].run();c=-1,e=l.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||u||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=f,t.addListener=f,t.once=f,t.off=f,t.removeListener=f,t.removeAllListeners=f,t.emit=f,t.prependListener=f,t.prependOnceListener=f,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,r){"use strict";var n=r(50);t.exports=function(){var t=n.apply(n,arguments);return t.charAt(0).toUpperCase()+t.slice(1)}},function(t,e,r){"use strict";e.a=function(){return!1}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var W=r(0),j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t){W.J.call(this,t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new n(t)}),this.register(function(t){return new a(t)}),this.register(function(t){return new o(t)}),this.register(function(t){return new i(t)}),this.register(function(t){return new e(t)}),this.register(function(t){return new s(t)})}function r(){var r={};return{get:function(t){return r[t]},add:function(t,e){r[t]=e},remove:function(t){delete r[t]},removeAll:function(){r={}}}}t.prototype=Object.assign(Object.create(W.J.prototype),{constructor:t,load:function(e,r,t,n){var i=this,a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:W.K.extractUrlBase(e);this.manager.itemStart(e);function o(t){n?n(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)}var s=new W.q(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(t){try{i.parse(t,a,function(t){r(t),i.manager.itemEnd(e)},o)}catch(t){o(t)}},t,o)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(t){return this.ktx2Loader=t,this},setMeshoptDecoder:function(t){return this.meshoptDecoder=t,this},register:function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},unregister:function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},parse:function(t,e,r,n){var i,a={},o={};if("string"==typeof t)i=t;else if(W.K.decodeText(new Uint8Array(t,0,4))===m){try{a[p.KHR_BINARY_GLTF]=new g(t)}catch(t){return void(n&&n(t))}i=a[p.KHR_BINARY_GLTF].content}else i=W.K.decodeText(new Uint8Array(t));var s=JSON.parse(i);if(void 0===s.asset||s.asset.version[0]<2)n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new H(s,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(var u=0;u<this.pluginCallbacks.length;u++){var c=this.pluginCallbacks[u](l);a[(o[c.name]=c).name]=!0}if(s.extensionsUsed)for(u=0;u<s.extensionsUsed.length;++u){var h=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(h){case p.KHR_MATERIALS_UNLIT:a[h]=new f;break;case p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[h]=new x;break;case p.KHR_DRACO_MESH_COMPRESSION:a[h]=new v(s,this.dracoLoader);break;case p.KHR_TEXTURE_TRANSFORM:a[h]=new y;break;case p.KHR_MESH_QUANTIZATION:a[h]=new b;break;default:0<=d.indexOf(h)&&void 0===o[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(r,n)}}});var p={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function e(t){this.parser=t,this.name=p.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function f(){this.name=p.KHR_MATERIALS_UNLIT}function n(t){this.parser=t,this.name=p.KHR_MATERIALS_CLEARCOAT}function i(t){this.parser=t,this.name=p.KHR_MATERIALS_TRANSMISSION}function a(t){this.parser=t,this.name=p.KHR_TEXTURE_BASISU}function o(t){this.parser=t,this.name=p.EXT_TEXTURE_WEBP,this.isSupported=null}function s(t){this.name=p.EXT_MESHOPT_COMPRESSION,this.parser=t}e.prototype._markDefs=function(){for(var t=this.parser,e=this.parser.json.nodes||[],r=0,n=e.length;r<n;r++){var i=e[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}},e.prototype._loadLight=function(t){var e=this.parser,r="light:"+t,n=e.cache.get(r);if(n)return n;var i,a=e.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[t],s=new W.j(16777215);void 0!==o.color&&s.fromArray(o.color);var l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(i=new W.o(s)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new W.ab(s)).distance=l;break;case"spot":(i=new W.ob(s)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=e.createUniqueName(o.name||"light_"+t),n=Promise.resolve(i),e.cache.add(r,n),n},e.prototype.createNodeAttachment=function(t){var e=this,r=this.parser,t=r.json.nodes[t],n=(t.extensions&&t.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(t){return r._getNodeRef(e.cache,n,t)})},f.prototype.getMaterialType=function(){return W.P},f.prototype.extendParams=function(t,e,r){var n=[];t.color=new W.j(1,1,1),t.opacity=1;var i=e.pbrMetallicRoughness;return i&&(Array.isArray(i.baseColorFactor)&&(e=i.baseColorFactor,t.color.fromArray(e),t.opacity=e[3]),void 0!==i.baseColorTexture&&n.push(r.assignTexture(t,"map",i.baseColorTexture))),Promise.all(n)},n.prototype.getMaterialType=function(t){t=this.parser.json.materials[t];return t.extensions&&t.extensions[this.name]?W.Q:null},n.prototype.extendMaterialParams=function(t,e){var r=this.parser,n=r.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();t=[],n=n.extensions[this.name];return void 0!==n.clearcoatFactor&&(e.clearcoat=n.clearcoatFactor),void 0!==n.clearcoatTexture&&t.push(r.assignTexture(e,"clearcoatMap",n.clearcoatTexture)),void 0!==n.clearcoatRoughnessFactor&&(e.clearcoatRoughness=n.clearcoatRoughnessFactor),void 0!==n.clearcoatRoughnessTexture&&t.push(r.assignTexture(e,"clearcoatRoughnessMap",n.clearcoatRoughnessTexture)),void 0!==n.clearcoatNormalTexture&&(t.push(r.assignTexture(e,"clearcoatNormalMap",n.clearcoatNormalTexture)),void 0!==n.clearcoatNormalTexture.scale&&(n=n.clearcoatNormalTexture.scale,e.clearcoatNormalScale=new W.ub(n,-n))),Promise.all(t)},i.prototype.getMaterialType=function(t){t=this.parser.json.materials[t];return t.extensions&&t.extensions[this.name]?W.Q:null},i.prototype.extendMaterialParams=function(t,e){var r=this.parser,n=r.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();t=[],n=n.extensions[this.name];return void 0!==n.transmissionFactor&&(e.transmission=n.transmissionFactor),void 0!==n.transmissionTexture&&t.push(r.assignTexture(e,"transmissionMap",n.transmissionTexture)),Promise.all(t)},a.prototype.loadTexture=function(t){var e=this.parser,r=e.json,n=r.textures[t];if(!n.extensions||!n.extensions[this.name])return null;var i=n.extensions[this.name],n=r.images[i.source],i=e.options.ktx2Loader;if(i)return e.loadTextureImage(t,n,i);if(r.extensionsRequired&&0<=r.extensionsRequired.indexOf(this.name))throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null},o.prototype.loadTexture=function(e){var r=this.name,n=this.parser,i=n.json,t=i.textures[e];if(!t.extensions||!t.extensions[r])return null;var t=t.extensions[r],a=i.images[t.source],o=n.textureLoader;return!a.uri||null!==(t=n.options.manager.getHandler(a.uri))&&(o=t),this.detectSupport().then(function(t){if(t)return n.loadTextureImage(e,a,o);if(i.extensionsRequired&&0<=i.extensionsRequired.indexOf(r))throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})},o.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}})),this.isSupported},s.prototype.loadBufferView=function(t){var e=this.parser.json,t=e.bufferViews[t];if(t.extensions&&t.extensions[this.name]){var o=t.extensions[this.name],t=this.parser.getDependency("buffer",o.buffer),s=this.parser.options.meshoptDecoder;if(s&&s.supported)return Promise.all([t,s.ready]).then(function(t){var e=o.byteOffset||0,r=o.byteLength||0,n=o.count,i=o.byteStride,a=new ArrayBuffer(n*i),r=new Uint8Array(t[0],e,r);return s.decodeGltfBuffer(new Uint8Array(a),n,i,r,o.mode,o.filter),a});if(e.extensionsRequired&&0<=e.extensionsRequired.indexOf(this.name))throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return null};var m="glTF",l=12,u={JSON:1313821514,BIN:5130562};function g(t){this.name=p.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,l);if(this.header={magic:W.K.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==m)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-l,n=new DataView(t,l),i=0;i<r;){var a=n.getUint32(i,!0);i+=4;var o,s=n.getUint32(i,!0);i+=4,s===u.JSON?(o=new Uint8Array(t,l+i,a),this.content=W.K.decodeText(o)):s===u.BIN&&(s=l+i,this.body=t.slice(s,s+a)),i+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=p.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function y(){this.name=p.KHR_TEXTURE_TRANSFORM}function h(t){W.R.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var r=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new W.j).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(t){for(var e in s)t.uniforms[e]=s[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",r).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",a).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(t){s.specular.value=t}},specularMap:{get:function(){return s.specularMap.value},set:function(t){(s.specularMap.value=t)?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(t){s.glossiness.value=t}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(t){(s.glossinessMap.value=t)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function x(){return{name:p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return h},extendParams:function(t,e,r){var n=e.extensions[this.name];t.color=new W.j(1,1,1),t.opacity=1;var i=[];return Array.isArray(n.diffuseFactor)&&(e=n.diffuseFactor,t.color.fromArray(e),t.opacity=e[3]),void 0!==n.diffuseTexture&&i.push(r.assignTexture(t,"map",n.diffuseTexture)),t.emissive=new W.j(0,0,0),t.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,t.specular=new W.j(1,1,1),Array.isArray(n.specularFactor)&&t.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture&&(n=n.specularGlossinessTexture,i.push(r.assignTexture(t,"glossinessMap",n)),i.push(r.assignTexture(t,"specularMap",n))),Promise.all(i)},createMaterial:function(t){var e=new h(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=W.pb,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function b(){this.name=p.KHR_MESH_QUANTIZATION}function T(t,e,r,n){W.y.call(this,t,e,r,n)}v.prototype.decodePrimitive=function(t,e){var r,n=this.json,i=this.dracoLoader,a=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,s={},l={},u={};for(r in o){var c=D[r]||r.toLowerCase();s[c]=o[r]}for(r in t.attributes){var h,d,c=D[r]||r.toLowerCase();void 0!==o[r]&&(h=n.accessors[t.attributes[r]],d=I[h.componentType],u[c]=d,l[c]=!0===h.normalized)}return e.getDependency("bufferView",a).then(function(t){return new Promise(function(n){i.decodeDracoFile(t,function(t){for(var e in t.attributes){var r=t.attributes[e],e=l[e];void 0!==e&&(r.normalized=e)}n(t)},s,u)})})},y.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},((h.prototype=Object.create(W.R.prototype)).constructor=h).prototype.copy=function(t){return W.R.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},((T.prototype=Object.create(W.y.prototype)).constructor=T).prototype.beforeStart_=T.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=t*n*3+n,a=0;a!==n;a++)e[a]=r[i+a];return e},T.prototype.afterEnd_=T.prototype.copySampleValue_,T.prototype.interpolate_=function(t,e,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=n-e,n=(r-e)/u,r=n*n,e=r*n,c=t*l,h=c-l,d=-2*e+3*r,p=e-r,f=1-d,m=p-r+n,g=0;g!==o;g++){var v=a[h+g+o],y=a[h+g+s]*u,x=a[c+g+o],b=a[c+g]*u;i[g]=f*v+m*y+d*x+p*b}return i};var _=0,A=1,w=2,M=3,C=4,S=5,E=6,I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},L={9728:W.T,9729:W.G,9984:W.V,9985:W.I,9986:W.U,9987:W.H},R={33071:W.i,33648:W.S,10497:W.kb},P={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},D={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},O={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},F={CUBICSPLINE:void 0,LINEAR:W.A,STEP:W.z},d="OPAQUE",B="MASK",N="BLEND";function z(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function U(t,e,r){for(var n in r.extensions)void 0===t[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=r.extensions[n])}function k(t,e){void 0!==e.extras&&("object"===j(e.extras)?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function c(t){for(var e="",r=Object.keys(t).sort(),n=0,i=r.length;n<i;n++)e+=r[n]+":"+t[r[n]]+";";return e}function H(t,e){this.json=t||{},this.extensions={},this.plugins={},this.options=e||{},this.cache=new r,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new W.v(this.options.manager):this.textureLoader=new W.qb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new W.q(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function G(r,t,n){var e,i,a=t.attributes,o=[];for(e in a){var s=D[e]||e.toLowerCase();s in r.attributes||o.push(function(t,e){return n.getDependency("accessor",t).then(function(t){r.setAttribute(e,t)})}(a[e],s))}return void 0===t.indices||r.index||(i=n.getDependency("accessor",t.indices).then(function(t){r.setIndex(t)}),o.push(i)),k(r,t),function(t,e,r){var n=e.attributes,i=new W.d;if(void 0!==n.POSITION){var a=(d=r.json.accessors[n.POSITION]).min,o=d.max;if(void 0!==a&&void 0!==o){i.set(new W.vb(a[0],a[1],a[2]),new W.vb(o[0],o[1],o[2]));var s=e.targets;if(void 0!==s){for(var l=new W.vb,u=new W.vb,c=0,h=s.length;c<h;c++){var d,p=s[c];void 0!==p.POSITION&&(a=(d=r.json.accessors[p.POSITION]).min,o=d.max,void 0!==a&&void 0!==o?(u.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),u.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),u.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),l.max(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}i.expandByVector(l)}t.boundingBox=i;e=new W.nb;i.getCenter(e.center),e.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=e}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(r,t,n),Promise.all(o).then(function(){return void 0!==t.targets?function(r,t,e){for(var n=!1,i=!1,a=0,o=t.length;a<o;a++)if(void 0!==(c=t[a]).POSITION&&(n=!0),void 0!==c.NORMAL&&(i=!0),n&&i)break;if(!n&&!i)return Promise.resolve(r);for(var s=[],l=[],a=0,o=t.length;a<o;a++){var u,c=t[a];n&&(u=void 0!==c.POSITION?e.getDependency("accessor",c.POSITION):r.attributes.position,s.push(u)),i&&(u=void 0!==c.NORMAL?e.getDependency("accessor",c.NORMAL):r.attributes.normal,l.push(u))}return Promise.all([Promise.all(s),Promise.all(l)]).then(function(t){var e=t[0],t=t[1];return n&&(r.morphAttributes.position=e),i&&(r.morphAttributes.normal=t),r.morphTargetsRelative=!0,r})}(r,t.targets,n):r})}function V(t,e){var r=t.getIndex();if(null===r){var n=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var a=0;a<i.count;a++)n.push(a);t.setIndex(n),r=t.getIndex()}var o=r.count-2,s=[];if(e===W.rb)for(a=1;a<=o;a++)s.push(r.getX(0)),s.push(r.getX(a)),s.push(r.getX(a+1));else for(a=0;a<o;a++)a%2==0?(s.push(r.getX(a)),s.push(r.getX(a+1)),s.push(r.getX(a+2))):(s.push(r.getX(a+2)),s.push(r.getX(a+1)),s.push(r.getX(a)));s.length/3!=o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");t=t.clone();return t.setIndex(s),t}return H.prototype.setExtensions=function(t){this.extensions=t},H.prototype.setPlugins=function(t){this.plugins=t},H.prototype.parse=function(r,t){var n=this,i=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll(function(t){return t._markDefs&&t._markDefs()}),Promise.all(this._invokeAll(function(t){return t.beforeRoot&&t.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(t){var e={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};U(a,e,i),k(e,i),Promise.all(n._invokeAll(function(t){return t.afterRoot&&t.afterRoot(e)})).then(function(){r(e)})}).catch(t)},H.prototype._markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],r=this.json.meshes||[],n=0,i=e.length;n<i;n++)for(var a=e[n].joints,o=0,s=a.length;o<s;o++)t[a[o]].isBone=!0;for(var l=0,u=t.length;l<u;l++){var c=t[l];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(r[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}},H.prototype._addNodeRef=function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)},H.prototype._getNodeRef=function(t,e,r){if(t.refs[e]<=1)return r;r=r.clone();return r.name+="_instance_"+t.uses[e]++,r},H.prototype._invokeOne=function(t){var e=Object.values(this.plugins);e.push(this);for(var r=0;r<e.length;r++){var n=t(e[r]);if(n)return n}},H.prototype._invokeAll=function(t){var e=Object.values(this.plugins);e.unshift(this);for(var r=[],n=0;n<e.length;n++){var i=t(e[n]);i&&r.push(i)}return r},H.prototype.getDependency=function(t,e){var r=t+":"+e,n=this.cache.get(r);if(!n){switch(t){case"scene":n=this.loadScene(e);break;case"node":n=this.loadNode(e);break;case"mesh":n=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(e)});break;case"accessor":n=this.loadAccessor(e);break;case"bufferView":n=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(e)});break;case"buffer":n=this.loadBuffer(e);break;case"material":n=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(e)});break;case"texture":n=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(e)});break;case"skin":n=this.loadSkin(e);break;case"animation":n=this.loadAnimation(e);break;case"camera":n=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(r,n)}return n},H.prototype.getDependencies=function(r){var n,t,e=this.cache.get(r);return e||(t=(n=this).json[r+("mesh"===r?"es":"s")]||[],e=Promise.all(t.map(function(t,e){return n.getDependency(r,e)})),this.cache.add(r,e)),e},H.prototype.loadBuffer=function(t){var r=this.json.buffers[t],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE.GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===t)return Promise.resolve(this.extensions[p.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(t,e){n.load(z(r.uri,i.path),t,void 0,function(){e(new Error('THREE.GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},H.prototype.loadBufferView=function(t){var n=this.json.bufferViews[t];return this.getDependency("buffer",n.buffer).then(function(t){var e=n.byteLength||0,r=n.byteOffset||0;return t.slice(r,r+e)})},H.prototype.loadAccessor=function(t){var y=this,x=this.json,b=this.json.accessors[t];if(void 0===b.bufferView&&void 0===b.sparse)return Promise.resolve(null);t=[];return void 0!==b.bufferView?t.push(this.getDependency("bufferView",b.bufferView)):t.push(null),void 0!==b.sparse&&(t.push(this.getDependency("bufferView",b.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",b.sparse.values.bufferView))),Promise.all(t).then(function(t){var e,r,n=t[0],i=P[b.type],a=I[b.componentType],o=a.BYTES_PER_ELEMENT,s=o*i,l=b.byteOffset||0,u=void 0!==b.bufferView?x.bufferViews[b.bufferView].byteStride:void 0,c=!0===b.normalized,h=u&&u!==s?(e=Math.floor(l/u),r="InterleavedBuffer:"+b.bufferView+":"+b.componentType+":"+e+":"+b.count,(s=y.cache.get(r))||(d=new a(n,e*u,b.count*u/o),s=new W.w(d,u/o),y.cache.add(r,s)),new W.x(s,i,l%u/o,c)):(d=null===n?new a(b.count*i):new a(n,l,b.count*i),new W.f(d,i,c));if(void 0!==b.sparse){var o=P.SCALAR,l=I[b.sparse.indices.componentType],d=b.sparse.indices.byteOffset||0,c=b.sparse.values.byteOffset||0,p=new l(t[1],d,b.sparse.count*o),f=new a(t[2],c,b.sparse.count*i);null!==n&&(h=new W.f(h.array.slice(),h.itemSize,h.normalized));for(var m=0,g=p.length;m<g;m++){var v=p[m];if(h.setX(v,f[m*i]),2<=i&&h.setY(v,f[m*i+1]),3<=i&&h.setZ(v,f[m*i+2]),4<=i&&h.setW(v,f[m*i+3]),5<=i)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return h})},H.prototype.loadTexture=function(t){var e=this.json,r=this.options,n=e.textures[t],e=e.images[n.source],n=this.textureLoader;return!e.uri||null!==(r=r.manager.getHandler(e.uri))&&(n=r),this.loadTextureImage(t,e,n)},H.prototype.loadTextureImage=function(r,n,i){var a=this,o=this.json,s=this.options,l=o.textures[r],u=self.URL||self.webkitURL,c=n.uri,h=!1,d=!0;if("image/jpeg"===n.mimeType&&(d=!1),void 0!==n.bufferView)c=a.getDependency("bufferView",n.bufferView).then(function(t){var e;"image/png"===n.mimeType&&(e=new DataView(t,25,1).getUint8(0,!1),d=6===e||4===e||3===e),h=!0;t=new Blob([t],{type:n.mimeType});return c=u.createObjectURL(t)});else if(void 0===n.uri)throw new Error("THREE.GLTFLoader: Image "+r+" is missing URI and bufferView");return Promise.resolve(c).then(function(n){return new Promise(function(e,t){var r=e;!0===i.isImageBitmapLoader&&(r=function(t){e(new W.h(t))}),i.load(z(n,s.path),r,void 0,t)})}).then(function(t){!0===h&&u.revokeObjectURL(c),t.flipY=!1,l.name&&(t.name=l.name),d||(t.format=W.ib);var e=(o.samplers||{})[l.sampler]||{};return t.magFilter=L[e.magFilter]||W.G,t.minFilter=L[e.minFilter]||W.H,t.wrapS=R[e.wrapS]||W.kb,t.wrapT=R[e.wrapT]||W.kb,a.associations.set(t,{type:"textures",index:r}),t})},H.prototype.assignTexture=function(n,i,a){var o=this;return this.getDependency("texture",a.index).then(function(t){var e,r;void 0===a.texCoord||0==a.texCoord||"aoMap"===i&&1==a.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+a.texCoord+" for texture "+i+" not yet supported."),!o.extensions[p.KHR_TEXTURE_TRANSFORM]||(e=void 0!==a.extensions?a.extensions[p.KHR_TEXTURE_TRANSFORM]:void 0)&&(r=o.associations.get(t),t=o.extensions[p.KHR_TEXTURE_TRANSFORM].extendTexture(t,e),o.associations.set(t,r)),n[i]=t})},H.prototype.assignFinalMaterial=function(t){var e,r,n,i=t.geometry,a=t.material,o=void 0!==i.attributes.tangent,s=void 0!==i.attributes.color,l=void 0===i.attributes.normal,u=!0===t.isSkinnedMesh,c=0<Object.keys(i.morphAttributes).length,h=c&&void 0!==i.morphAttributes.normal;t.isPoints?(r="PointsMaterial:"+a.uuid,(e=this.cache.get(r))||(e=new W.cb,W.L.prototype.copy.call(e,a),e.color.copy(a.color),e.map=a.map,e.sizeAttenuation=!1,this.cache.add(r,e)),a=e):t.isLine&&(r="LineBasicMaterial:"+a.uuid,(n=this.cache.get(r))||(n=new W.C,W.L.prototype.copy.call(n,a),n.color.copy(a.color),this.cache.add(r,n)),a=n),(o||s||l||u||c)&&(r="ClonedMaterial:"+a.uuid+":",a.isGLTFSpecularGlossinessMaterial&&(r+="specular-glossiness:"),u&&(r+="skinning:"),o&&(r+="vertex-tangents:"),s&&(r+="vertex-colors:"),l&&(r+="flat-shading:"),c&&(r+="morph-targets:"),h&&(r+="morph-normals:"),(n=this.cache.get(r))||(n=a.clone(),u&&(n.skinning=!0),s&&(n.vertexColors=!0),l&&(n.flatShading=!0),c&&(n.morphTargets=!0),h&&(n.morphNormals=!0),o&&(n.vertexTangents=!0,n.normalScale&&(n.normalScale.y*=-1),n.clearcoatNormalScale&&(n.clearcoatNormalScale.y*=-1)),this.cache.add(r,n),this.associations.set(n,this.associations.get(a))),a=n),a.aoMap&&void 0===i.attributes.uv2&&void 0!==i.attributes.uv&&i.setAttribute("uv2",i.attributes.uv),t.material=a},H.prototype.getMaterialType=function(){return W.R},H.prototype.loadMaterial=function(e){var r,t,n=this,i=this.json,a=this.extensions,o=i.materials[e],s={},l=o.extensions||{},u=[];l[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?(i=a[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],r=i.getMaterialType(),u.push(i.extendParams(s,o,n))):l[p.KHR_MATERIALS_UNLIT]?(t=a[p.KHR_MATERIALS_UNLIT],r=t.getMaterialType(),u.push(t.extendParams(s,o,n))):(c=o.pbrMetallicRoughness||{},s.color=new W.j(1,1,1),s.opacity=1,Array.isArray(c.baseColorFactor)&&(t=c.baseColorFactor,s.color.fromArray(t),s.opacity=t[3]),void 0!==c.baseColorTexture&&u.push(n.assignTexture(s,"map",c.baseColorTexture)),s.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,s.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture&&(u.push(n.assignTexture(s,"metalnessMap",c.metallicRoughnessTexture)),u.push(n.assignTexture(s,"roughnessMap",c.metallicRoughnessTexture))),r=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)})))),!0===o.doubleSided&&(s.side=W.p);var c=o.alphaMode||d;return c===N?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,c===B&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&r!==W.P&&(u.push(n.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new W.ub(1,-1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,-o.normalTexture.scale)),void 0!==o.occlusionTexture&&r!==W.P&&(u.push(n.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&r!==W.P&&(s.emissive=(new W.j).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&r!==W.P&&u.push(n.assignTexture(s,"emissiveMap",o.emissiveTexture)),Promise.all(u).then(function(){var t=r===h?a[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new r(s);return o.name&&(t.name=o.name),t.map&&(t.map.encoding=W.xb),t.emissiveMap&&(t.emissiveMap.encoding=W.xb),k(t,o),n.associations.set(t,{type:"materials",index:e}),o.extensions&&U(a,t,o),t})},H.prototype.createUniqueName=function(t){for(var e=W.db.sanitizeNodeName(t||""),r=e,n=1;this.nodeNamesUsed[r];++n)r=e+"_"+n;return this.nodeNamesUsed[r]=!0,r},H.prototype.loadGeometries=function(t){var r=this,n=this.extensions,e=this.primitiveCache;for(var i=[],a=0,o=t.length;a<o;a++){var s=t[a],l=(l=void 0,u=(l=(u=s).extensions&&u.extensions[p.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+c(l.attributes):u.indices+":"+c(u.attributes)+":"+u.mode),u=e[l];u?i.push(u.promise):(u=s.extensions&&s.extensions[p.KHR_DRACO_MESH_COMPRESSION]?function(e){return n[p.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then(function(t){return G(t,e,r)})}(s):G(new W.g,s,r),e[l]={primitive:s,promise:u},i.push(u))}return Promise.all(i)},H.prototype.loadMesh=function(h){for(var d=this,t=this.json,p=this.extensions,f=t.meshes[h],m=f.primitives,e=[],r=0,n=m.length;r<n;r++){var i=void 0===m[r].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new W.R({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:W.s})),i.DefaultMaterial):this.getDependency("material",m[r].material);e.push(i)}return e.push(d.loadGeometries(m)),Promise.all(e).then(function(t){for(var e=t.slice(0,t.length-1),r=t[t.length-1],n=[],i=0,a=r.length;i<a;i++){var o,s=r[i],l=m[i],u=e[i];if(l.mode===C||l.mode===S||l.mode===E||void 0===l.mode)!0!==(o=new(!0===f.isSkinnedMesh?W.mb:W.O)(s,u)).isSkinnedMesh||o.geometry.attributes.skinWeight.normalized||o.normalizeSkinWeights(),l.mode===S?o.geometry=V(o.geometry,W.sb):l.mode===E&&(o.geometry=V(o.geometry,W.rb));else if(l.mode===A)o=new W.E(s,u);else if(l.mode===M)o=new W.B(s,u);else if(l.mode===w)o=new W.D(s,u);else{if(l.mode!==_)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+l.mode);o=new W.bb(s,u)}0<Object.keys(o.geometry.morphAttributes).length&&function(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var r=0,n=e.weights.length;r<n;r++)t.morphTargetInfluences[r]=e.weights[r];if(e.extras&&Array.isArray(e.extras.targetNames)){var i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)t.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(o,f),o.name=d.createUniqueName(f.name||"mesh_"+h),k(o,f),l.extensions&&U(p,o,l),d.assignFinalMaterial(o),n.push(o)}if(1===n.length)return n[0];for(var c=new W.t,i=0,a=n.length;i<a;i++)c.add(n[i]);return c})},H.prototype.loadCamera=function(t){var e,r=this.json.cameras[t],t=r[r.type];if(t)return"perspective"===r.type?e=new W.Z(W.M.radToDeg(t.yfov),t.aspectRatio||1,t.znear||1,t.zfar||2e6):"orthographic"===r.type&&(e=new W.Y(-t.xmag,t.xmag,t.ymag,-t.ymag,t.znear,t.zfar)),r.name&&(e.name=this.createUniqueName(r.name)),k(e,r),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},H.prototype.loadSkin=function(t){var t=this.json.skins[t],e={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(e):this.getDependency("accessor",t.inverseBindMatrices).then(function(t){return e.inverseBindMatrices=t,e})},H.prototype.loadAnimation=function(M){for(var C=this.json.animations[M],t=[],e=[],r=[],n=[],i=[],a=0,o=C.channels.length;a<o;a++){var s=C.channels[a],l=C.samplers[s.sampler],u=s.target,c=void 0!==u.node?u.node:u.id,h=void 0!==C.parameters?C.parameters[l.input]:l.input,s=void 0!==C.parameters?C.parameters[l.output]:l.output;t.push(this.getDependency("node",c)),e.push(this.getDependency("accessor",h)),r.push(this.getDependency("accessor",s)),n.push(l),i.push(u)}return Promise.all([Promise.all(t),Promise.all(e),Promise.all(r),Promise.all(n),Promise.all(i)]).then(function(t){for(var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=[],s=0,l=e.length;s<l;s++){var u,c=e[s],h=r[s],d=n[s],p=i[s],f=a[s];if(void 0!==c){switch(c.updateMatrix(),c.matrixAutoUpdate=!0,O[f.path]){case O.weights:u=W.W;break;case O.rotation:u=W.eb;break;case O.position:case O.scale:default:u=W.wb}var m=c.name||c.uuid,g=void 0!==p.interpolation?F[p.interpolation]:W.A,v=[];O[f.path]===O.weights?c.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&v.push(t.name||t.uuid)}):v.push(m);var y,x=d.array;if(d.normalized){if(x.constructor===Int8Array)y=1/127;else if(x.constructor===Uint8Array)y=1/255;else if(x.constructor==Int16Array)y=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");y=1/65535}for(var b=new Float32Array(x.length),_=0,A=x.length;_<A;_++)b[_]=x[_]*y;x=b}for(_=0,A=v.length;_<A;_++){var w=new u(v[_]+"."+O[f.path],h.array,x,g);"CUBICSPLINE"===p.interpolation&&(w.createInterpolant=function(t){return new T(this.times,this.values,this.getValueSize()/3,t)},w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),o.push(w)}}}t=C.name||"animation_"+M;return new W.a(t,void 0,o)})},H.prototype.loadNode=function(a){var e,t=this.json,o=this.extensions,s=this,l=t.nodes[a],u=l.name?s.createUniqueName(l.name):"";return e=[],void 0!==l.mesh&&e.push(s.getDependency("mesh",l.mesh).then(function(t){t=s._getNodeRef(s.meshCache,l.mesh,t);return void 0!==l.weights&&t.traverse(function(t){if(t.isMesh)for(var e=0,r=l.weights.length;e<r;e++)t.morphTargetInfluences[e]=l.weights[e]}),t})),void 0!==l.camera&&e.push(s.getDependency("camera",l.camera).then(function(t){return s._getNodeRef(s.cameraCache,l.camera,t)})),s._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(a)}).forEach(function(t){e.push(t)}),Promise.all(e).then(function(t){var e,r=!0===l.isBone?new W.c:1<t.length?new W.t:1===t.length?t[0]:new W.X;if(r!==t[0])for(var n=0,i=t.length;n<i;n++)r.add(t[n]);return l.name&&(r.userData.name=l.name,r.name=u),k(r,l),l.extensions&&U(o,r,l),void 0!==l.matrix?((e=new W.N).fromArray(l.matrix),r.applyMatrix4(e)):(void 0!==l.translation&&r.position.fromArray(l.translation),void 0!==l.rotation&&r.quaternion.fromArray(l.rotation),void 0!==l.scale&&r.scale.fromArray(l.scale)),s.associations.set(r,{type:"nodes",index:a}),r})},H.prototype.loadScene=function(t){var e=this.json,r=this.extensions,t=this.json.scenes[t],n=new W.t;t.name&&(n.name=this.createUniqueName(t.name)),k(n,t),t.extensions&&U(r,n,t);for(var i=t.nodes||[],a=[],o=0,s=i.length;o<s;o++)a.push(function o(t,s,l,u){var c=l.nodes[t];return u.getDependency("node",t).then(function(t){return void 0===c.skin?t:u.getDependency("skin",c.skin).then(function(t){for(var e=[],r=0,n=(s=t).joints.length;r<n;r++)e.push(u.getDependency("node",s.joints[r]));return Promise.all(e)}).then(function(o){return t.traverse(function(t){if(t.isMesh){for(var e=[],r=[],n=0,i=o.length;n<i;n++){var a=o[n];a?(e.push(a),a=new W.N,void 0!==s.inverseBindMatrices&&a.fromArray(s.inverseBindMatrices.array,16*n),r.push(a)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[n])}t.bind(new W.lb(e,r),t.matrixWorld)}}),t});var s}).then(function(t){s.add(t);var e=[];if(c.children)for(var r=c.children,n=0,i=r.length;n<i;n++){var a=r[n];e.push(o(a,t,l,u))}return Promise.all(e)})}(i[o],n,e,this));return Promise.all(a).then(function(){return n})},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return i});function n(t){M.m.call(this,t),this.type=M.tb}var M=r(0);n.prototype=Object.assign(Object.create(M.m.prototype),{constructor:n,parse:function(t){function y(t,e){switch(t){case 1:console.error("THREE.RGBELoader Read Error: "+(e||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(e||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(e||""));break;default:console.error("THREE.RGBELoader: Error: "+(e||""))}return-1}function l(t,e,r){e=e||1024;for(var n=t.pos,i=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));(i=s.indexOf("\n"))<0&&a<e&&n<t.byteLength;)o+=s,a+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));return-1<i&&(!1!==r&&(t.pos+=a+i+1),o+s.slice(0,i))}var e=new Uint8Array(t);e.pos=0;var r,n,i,a,o,s,u,c,h,d,p=function(t){var e,r,n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(e=l(t)))return y(1,"no header found");if(!(r=e.match(/^#\?(\S+)/)))return y(3,"bad initial token");for(s.valid|=1,s.programtype=r[1],s.string+=e+"\n";!1!==(e=l(t));)if(s.string+=e+"\n","#"!==e.charAt(0)){if((r=e.match(n))&&(s.gamma=parseFloat(r[1],10)),(r=e.match(i))&&(s.exposure=parseFloat(r[1],10)),(r=e.match(a))&&(s.valid|=2,s.format=r[1]),(r=e.match(o))&&(s.valid|=4,s.height=parseInt(r[1],10),s.width=parseInt(r[2],10)),2&s.valid&&4&s.valid)break}else s.comments+=e+"\n";return 2&s.valid?4&s.valid?s:y(3,"missing image size specifier"):y(3,"missing format specifier")}(e);if(-1!==p){var f=p.width,t=p.height,m=function(t,e,r){var n,i,a,o,s,l,u,c,h,d,p,f,m,g=e,v=r;if(g<8||32767<g||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(g!==(t[2]<<8|t[3]))return y(3,"wrong scanline width");if(!(n=new Uint8Array(4*e*r)).length)return y(4,"unable to allocate buffer space");for(a=i=0,c=4*g,m=new Uint8Array(4),l=new Uint8Array(c);0<v&&a<t.byteLength;){if(a+4>t.byteLength)return y(1);if(m[0]=t[a++],m[1]=t[a++],m[2]=t[a++],m[3]=t[a++],2!=m[0]||2!=m[1]||(m[2]<<8|m[3])!=g)return y(3,"bad rgbe scanline format");for(u=0;u<c&&a<t.byteLength;){if((f=128<(o=t[a++]))&&(o-=128),0===o||c<u+o)return y(3,"bad scanline data");if(f)for(s=t[a++],h=0;h<o;h++)l[u++]=s;else l.set(t.subarray(a,a+o),u),u+=o,a+=o}for(d=g,h=0;h<d;h++)p=0,n[i]=l[h+0],p+=g,n[i+1]=l[h+p],p+=g,n[i+2]=l[h+p],p+=g,n[i+3]=l[h+p],i+=4;v--}return n}(e.subarray(e.pos),f,t);if(-1!==m){switch(this.type){case M.tb:var g=m,v=M.hb,x=M.tb;break;case M.r:for(var b=m.length/4*3,_=new Float32Array(b),A=0;A<b;A++)c=_,h=3*A,d=d=void 0,d=(s=m)[(u=4*A)+3],d=Math.pow(2,d-128)/255,c[h+0]=s[u+0]*d,c[h+1]=s[u+1]*d,c[h+2]=s[u+2]*d;g=_,v=M.ib,x=M.r;break;case M.u:for(var b=m.length/4*3,w=new Uint16Array(b),A=0;A<b;A++)i=w,a=3*A,o=o=void 0,o=(r=m)[(n=4*A)+3],o=Math.pow(2,o-128)/255,i[a+0]=M.n.toHalfFloat(r[n+0]*o),i[a+1]=M.n.toHalfFloat(r[n+1]*o),i[a+2]=M.n.toHalfFloat(r[n+2]*o);g=w,v=M.ib,x=M.u;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:f,height:t,data:g,header:p.string,gamma:p.gamma,exposure:p.exposure,format:v,type:x}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,r,e,n){return M.m.prototype.load.call(this,t,function(t,e){switch(t.type){case M.tb:t.encoding=M.gb,t.minFilter=M.T,t.magFilter=M.T,t.generateMipmaps=!1,t.flipY=!0;break;case M.r:case M.u:t.encoding=M.F,t.minFilter=M.G,t.magFilter=M.G,t.generateMipmaps=!1,t.flipY=!0}r&&r(t,e)},e,n)}});var i=function(t){M.J.call(this,t),this.hdrLoader=new n,this.type=M.tb};i.prototype=Object.assign(Object.create(M.J.prototype),{constructor:i,load:function(i,t,e,r){Array.isArray(i)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(i),i=t,t=e,e=r,r=arguments[4]);var a=new M.k;switch(a.type=this.type,a.type){case M.tb:a.encoding=M.gb,a.format=M.fb,a.minFilter=M.T,a.magFilter=M.T,a.generateMipmaps=!1;break;case M.r:case M.u:a.encoding=M.F,a.format=M.ib,a.minFilter=M.G,a.magFilter=M.G,a.generateMipmaps=!1}var o=this,s=0;for(var n=0;n<i.length;n++)!function(e,r,t,n){new M.q(o.manager).setPath(o.path).setResponseType("arraybuffer").setWithCredentials(o.withCredentials).load(i[e],function(t){s++;t=o.hdrLoader.parse(t);t&&(void 0!==t.data&&((t=new M.l(t.data,t.width,t.height)).type=a.type,t.encoding=a.encoding,t.format=a.format,t.minFilter=a.minFilter,t.magFilter=a.magFilter,t.generateMipmaps=a.generateMipmaps,a.images[e]=t),6===s&&(a.needsUpdate=!0,r&&r(a)))},t,n)}(n,t,e,r);return a},setDataType:function(t){return this.type=t,this.hdrLoader.setDataType(t),this}})},,function(t,e,r){"use strict";t.exports=function(){var t=[].map.call(arguments,function(t){return t.trim()}).filter(function(t){return t.length}).join("-");return t.length?1!==t.length&&/[_.\- ]+/.test(t)?t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(t,e){return e.toUpperCase()}):t[0]===t[0].toLowerCase()&&t.slice(1)!==t.slice(1).toLowerCase()?t:t.toLowerCase():""}},function(t,i,a){!function(t){var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}i.setTimeout=function(){return new n(r.call(setTimeout,e,arguments),clearTimeout)},i.setInterval=function(){return new n(r.call(setInterval,e,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(e,this._id)},i.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},i.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},i._unrefActive=i.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a(52),i.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,i.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}.call(this,a(18))},function(t,e,r){!function(t,f){!function(r,n){"use strict";var i,a,e,o,s,l,u,c,t;function h(t){delete a[t]}function d(t){if(e)setTimeout(d,0,t);else{var r=a[t];if(r){e=!0;try{!function(){var t=r.callback,e=r.args;switch(e.length){case 0:t();break;case 1:t(e[0]);break;case 2:t(e[0],e[1]);break;case 3:t(e[0],e[1],e[2]);break;default:t.apply(n,e)}}()}finally{h(t),e=!1}}}}function p(t){t.source===r&&"string"==typeof t.data&&0===t.data.indexOf(c)&&d(+t.data.slice(c.length))}r.setImmediate||(i=1,e=!(a={}),o=r.document,t=(t=Object.getPrototypeOf&&Object.getPrototypeOf(r))&&t.setTimeout?t:r,s="[object process]"==={}.toString.call(r.process)?function(t){f.nextTick(function(){d(t)})}:function(){if(r.postMessage&&!r.importScripts){var t=!0,e=r.onmessage;return r.onmessage=function(){t=!1},r.postMessage("","*"),r.onmessage=e,t}}()?(c="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",p,!1):r.attachEvent("onmessage",p),function(t){r.postMessage(c+t,"*")}):r.MessageChannel?((u=new MessageChannel).port1.onmessage=function(t){d(t.data)},function(t){u.port2.postMessage(t)}):o&&"onreadystatechange"in o.createElement("script")?(l=o.documentElement,function(t){var e=o.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,l.removeChild(e),e=null},l.appendChild(e)}):function(t){setTimeout(d,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];return t={callback:t,args:e},a[i]=t,s(i),i++},t.clearImmediate=h)}("undefined"==typeof self?void 0===t?this:t:self)}.call(this,r(18),r(44))},,,function(t,e,r){"use strict";var f=r(37);var m=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},g=r(33),n=r(8),i=r(39),a=r(22),o=r(32),s=Object(o.a)(Object.keys,Object),l=Object.prototype.hasOwnProperty;var u=function(t){if(!Object(a.a)(t))return s(t);var e,r=[];for(e in Object(t))l.call(t,e)&&"constructor"!=e&&r.push(e);return r},c=r(16);var v=function(t){return(Object(c.a)(t)?Object(i.a):u)(t)};var y=function(t,e){return t&&Object(n.a)(e,v(e),t)},x=r(9);var b=function(t,e){return t&&Object(n.a)(e,Object(x.a)(e),t)},_=r(31),A=r(29);var h=function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a};var d=function(){return[]},p=Object.prototype.propertyIsEnumerable,w=Object.getOwnPropertySymbols,M=w?function(e){return null==e?[]:(e=Object(e),h(w(e),function(t){return p.call(e,t)}))}:d;var C=function(t,e){return Object(n.a)(t,M(t),e)};var T=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t},S=r(23),E=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)T(e,M(t)),t=Object(S.a)(t);return e}:d;var I=function(t,e){return Object(n.a)(t,E(t),e)},L=r(10);var R=function(t,e,r){return e=e(t),Object(L.a)(t)?e:T(e,r(t))};var P=function(t){return R(t,v,M)};var D=function(t){return R(t,x.a,E)},O=r(6),F=r(3),B=Object(O.a)(F.a,"DataView"),N=r(17),o=Object(O.a)(F.a,"Promise"),d=Object(O.a)(F.a,"Set"),O=Object(O.a)(F.a,"WeakMap"),z=r(7),U=r(13),k="[object Map]",H="[object Promise]",G="[object Set]",V="[object WeakMap]",W="[object DataView]",j=Object(U.a)(B),X=Object(U.a)(N.a),q=Object(U.a)(o),Y=Object(U.a)(d),Z=Object(U.a)(O),F=z.a,J=F=B&&F(new B(new ArrayBuffer(1)))!=W||N.a&&F(new N.a)!=k||o&&F(o.resolve())!=H||d&&F(new d)!=G||O&&F(new O)!=V?function(t){var e=Object(z.a)(t),t="[object Object]"==e?t.constructor:void 0,t=t?Object(U.a)(t):"";if(t)switch(t){case j:return W;case X:return k;case q:return H;case Y:return G;case Z:return V}return e}:F,K=Object.prototype.hasOwnProperty;var Q=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&K.call(t,"index")&&(r.index=t.index,r.input=t.input),r},$=r(26);var tt=function(t,e){return e=e?Object($.a)(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.byteLength)},et=/\w*$/;var rt=function(t){var e=new t.constructor(t.source,et.exec(t));return e.lastIndex=t.lastIndex,e},o=r(11),d=o.a?o.a.prototype:void 0,nt=d?d.valueOf:void 0;var it=function(t){return nt?Object(nt.call(t)):{}},at=r(36);var ot=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Object($.a)(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return tt(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Object(at.a)(t,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return rt(t);case"[object Set]":return new n;case"[object Symbol]":return it(t)}},st=r(40),lt=r(21),ut=r(5);var O=function(t){return Object(ut.a)(t)&&"[object Map]"==J(t)},F=r(25),o=r(12),d=o.a&&o.a.isMap,ct=d?Object(F.a)(d):O,ht=r(4);var r=function(t){return Object(ut.a)(t)&&"[object Set]"==J(t)},o=o.a&&o.a.isSet,dt=o?Object(F.a)(o):r,pt=1,ft=2,mt=4,gt="[object Arguments]",vt="[object Function]",yt="[object GeneratorFunction]",xt="[object Object]",bt={};bt[gt]=bt["[object Array]"]=bt["[object ArrayBuffer]"]=bt["[object DataView]"]=bt["[object Boolean]"]=bt["[object Date]"]=bt["[object Float32Array]"]=bt["[object Float64Array]"]=bt["[object Int8Array]"]=bt["[object Int16Array]"]=bt["[object Int32Array]"]=bt["[object Map]"]=bt["[object Number]"]=bt[xt]=bt["[object RegExp]"]=bt["[object Set]"]=bt["[object String]"]=bt["[object Symbol]"]=bt["[object Uint8Array]"]=bt["[object Uint8ClampedArray]"]=bt["[object Uint16Array]"]=bt["[object Uint32Array]"]=!0,bt["[object Error]"]=bt[vt]=bt["[object WeakMap]"]=!1;var _t=function r(n,i,a,t,e,o){var s,l=i&pt,u=i&ft,c=i&mt;if(void 0!==(s=a?e?a(n,t,e,o):a(n):s))return s;if(!Object(ht.a)(n))return n;var h=Object(L.a)(n);if(h){if(s=Q(n),!l)return Object(A.a)(n,s)}else{var d=J(n),t=d==vt||d==yt;if(Object(lt.a)(n))return Object(_.a)(n,l);if(d==xt||d==gt||t&&!e){if(s=u||t?{}:Object(st.a)(n),!l)return u?I(n,b(s,n)):C(n,y(s,n))}else{if(!bt[d])return e?n:{};s=ot(n,d,l)}}l=(o=o||new f.a).get(n);if(l)return l;o.set(n,s),dt(n)?n.forEach(function(t){s.add(r(t,i,a,t,n,o))}):ct(n)&&n.forEach(function(t,e){s.set(e,r(t,i,a,e,n,o))});var u=c?u?D:P:u?x.a:v,p=h?void 0:u(n);return m(p||n,function(t,e){p&&(t=n[e=t]),Object(g.a)(s,e,r(t,i,a,e,n,o))}),s};e.a=function(t){return _t(t,4)}},function(t,e,r){"use strict";var u=r(37),n=r(24),i=r(15);var p=function(t,e,r){(void 0===r||Object(i.a)(t[e],r))&&(void 0!==r||e in t)||Object(n.a)(t,e,r)};var c=function(l){return function(t,e,r){for(var n=-1,i=Object(t),a=r(t),o=a.length;o--;){var s=a[l?o:++n];if(!1===e(i[s],s,i))break}return t}}(),f=r(31),m=r(36),g=r(29),v=r(40),y=r(28),x=r(10),a=r(16),o=r(5);var b=function(t){return Object(o.a)(t)&&Object(a.a)(t)},_=r(21),A=r(20),w=r(4),s=r(7),l=r(23),h=Function.prototype,d=Object.prototype,M=h.toString,C=d.hasOwnProperty,T=M.call(Object);var S=function(t){return!(!Object(o.a)(t)||"[object Object]"!=Object(s.a)(t))&&(null===(t=Object(l.a)(t))||"function"==typeof(t=C.call(t,"constructor")&&t.constructor)&&t instanceof t&&M.call(t)==T)},E=r(38);var I=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},L=r(8),R=r(9);var P=function(t){return Object(L.a)(t,Object(R.a)(t))};var D=function(t,e,r,n,i,a,o){var s,l,u,c=I(t,r),h=I(e,r),d=o.get(h);d?p(t,r,d):((s=void 0===(u=a?a(c,h,r+"",t,e,o):void 0))&&(d=!(l=Object(x.a)(h))&&Object(_.a)(h),e=!l&&!d&&Object(E.a)(h),u=h,l||d||e?u=Object(x.a)(c)?c:b(c)?Object(g.a)(c):d?(s=!1,Object(f.a)(h,!0)):e?(s=!1,Object(m.a)(h,!0)):[]:S(h)||Object(y.a)(h)?(u=c,Object(y.a)(c)?u=P(c):Object(w.a)(c)&&!Object(A.a)(c)||(u=Object(v.a)(h))):s=!1),s&&(o.set(h,u),i(u,h,n,a,o),o.delete(h)),p(t,r,u))};var O=function n(i,a,o,s,l){i!==a&&c(a,function(t,e){var r;l=l||new u.a,Object(w.a)(t)?D(i,a,e,o,n,s,l):(r=s?s(I(i,e),t,e+"",i,a,l):void 0,p(i,e,r=void 0===r?t:r))},R.a)};function F(t){return t}var B=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},N=Math.max;var z=function(a,o,s){return o=N(void 0===o?a.length-1:o,0),function(){for(var t=arguments,e=-1,r=N(t.length-o,0),n=Array(r);++e<r;)n[e]=t[o+e];for(var e=-1,i=Array(o+1);++e<o;)i[e]=t[e];return i[o]=s(n),B(a,this,i)}};var U=function(t){return function(){return t}},k=r(27),d=k.a?function(t,e){return Object(k.a)(t,"toString",{configurable:!0,enumerable:!1,value:U(e),writable:!0})}:F,H=Date.now;var G=function(r){var n=0,i=0;return function(){var t=H(),e=16-(t-i);if(i=t,0<e){if(800<=++n)return arguments[0]}else n=0;return r.apply(void 0,arguments)}}(d);var V=function(t,e){return G(z(t,e,F),t+"")},W=r(35);var j=function(t,e,r){if(!Object(w.a)(r))return!1;var n=typeof e;return!!("number"==n?Object(a.a)(r)&&Object(W.a)(e,r.length):"string"==n&&e in r)&&Object(i.a)(r[e],t)};r=function(s){return V(function(t,e){var r=-1,n=e.length,i=1<n?e[n-1]:void 0,a=2<n?e[2]:void 0,i=3<s.length&&"function"==typeof i?(n--,i):void 0;for(a&&j(e[0],e[1],a)&&(i=n<3?void 0:i,n=1),t=Object(t);++r<n;){var o=e[r];o&&s(t,o,r,i)}return t})}(function(t,e,r){O(t,e,r)}),e.a=r}]]);